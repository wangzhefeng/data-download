var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=206)}({0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(10);t.utils=a;var o=r(7);t.ULS=o.ULS,t.TraceLevel=o.TraceLevel,t.LogCategory=o.LogCategory,t.NulLogger=o.NulLogger,t.ConsoleLogger=o.ConsoleLogger;var n=r(11);t.browserSupport=n;var i=r(12);t.perfWatch=i;var s=r(15);t.initEwaUtils=s.initEwaUtils,t.ewaUtils=s.ewaUtils;var c=r(16);t.initStopwatchFactory=c.initStopwatchFactory;var l=r(17);t.getNewGuid=l.getNewGuid;var d=r(18);t.TextAreaVirtualKeyboardPolicy=d.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=d.TextAreaInputMode},1:function(e,t,r){"use strict";var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",(function(){return ce})),r.d(a,"defaultPromiseTimeoutInMinutes",(function(){return ue})),r.d(a,"getSharedClipboardSettings",(function(){return ge})),r.d(a,"initializeSharedClipboardSettingsFromWindow",(function(){return pe})),r.d(a,"initializeSharedClipboardSettings",(function(){return fe})),r.d(a,"createEmptySharedClipboardSettings",(function(){return he}));var o={};r.r(o),r.d(o,"divTagName",(function(){return Pt})),r.d(o,"preTagName",(function(){return Ot})),r.d(o,"tableTagName",(function(){return At})),r.d(o,"trTagName",(function(){return xt})),r.d(o,"tdTagName",(function(){return jt})),r.d(o,"ccpTimestampHtmlCustomAttributeName",(function(){return Jt})),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",(function(){return Ft})),r.d(o,"ensureOneLFPerNewLine",(function(){return Nt})),r.d(o,"trimToLength",(function(){return zt})),r.d(o,"createTextHtmlFromTextPlain",(function(){return kt})),r.d(o,"createHtmlItemFromTextPlain",(function(){return Ht})),r.d(o,"createPlainTextFromHtml",(function(){return Vt})),r.d(o,"isContainsTimestampWrapper",(function(){return Kt})),r.d(o,"addClipboardWrapperForEdge",(function(){return Gt})),r.d(o,"getFragmentFromTextHtml",(function(){return Qt})),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return qt})),r.d(o,"getExternalSource",(function(){return Xt})),r.d(o,"encodeAngleBrackets",(function(){return Zt})),r.d(o,"wrapContentWithTagAndAttributes",(function(){return Yt}));var n,i=r(0);function s(){return n}function c(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}var l,d,u,g,p,f=r(2);function m(e,t){return h(e,[t])}function h(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(g||(g={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(p||(p={}));var b=function(e){function t(r,a,o){var n=this,c=t.augmentParameterValue(r);if((n=e.call(this,c)||this).name=t.augmentParameterValue(a),n.errorName=n.name,n.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+n.name+"': "+c):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+c),o){n.innerError=o;var l=n.innerError.message;l||(l=n.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+d)}return n.stack||(n.stack=(new Error).stack),n}return Object(f.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),S=function(e){function t(r,a,o){var n=this,i=b.augmentParameterValue(a),s=t.getDefaultMessage(i),c=b.augmentParameterValue(r);return 0===c.length&&(c=s),(n=e.call(this,c,"MissingArgumentError",o)||this).name=i,n}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(b),C=function(e){function t(r,a,o,n){var i=this,s=b.augmentParameterValue(a),c=o;c||(c="");var l=t.getDefaultMessage(s,c),d=b.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",n)||this).name=s,i.value=c,i}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(b),y=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(f.__extends)(t,e),t}(b),v=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return Object(f.__extends)(t,e),t}(b),E=function(e){function t(t,r,a,o,n){return e.call(this,t+". Data version: "+r+", Infra version: "+a+", blockMismatchDataVersion: "+o,"MismatchVersionError",n)||this}return Object(f.__extends)(t,e),t}(b),w=function(e){function t(t,r,a,o){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+a,"TTLClipboardDataError",o)||this}return Object(f.__extends)(t,e),t}(b),L=function(e){function t(t,r,a,o){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+a,"UserHashMismatchError",o)||this}return Object(f.__extends)(t,e),t}(b),T=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return Object(f.__extends)(t,e),t}(b);function _(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var I=function(e){function t(t,r,a,o,n){var i=e.call(this,r||"reason="+t,a,o)||this;return i.reason=t,n&&(i.errorName=n),i}return Object(f.__extends)(t,e),t}(b),P=function(e){function t(t,r,a){return e.call(this,t,r,"CopyError",a,_(t,u))||this}return Object(f.__extends)(t,e),t}(I),O=function(e){function t(t,r,a){return e.call(this,t,r,"PasteError",a,_(t,g))||this}return Object(f.__extends)(t,e),t}(I),A=function(e){function t(t,r,a){return e.call(this,t,r,"CancelError",a,_(t,p))||this}return Object(f.__extends)(t,e),t}(I),x=function(e){function t(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,_(t,d))||this}return Object(f.__extends)(t,e),t}(I),j=function(e){function t(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,_(t,d))||this}return Object(f.__extends)(t,e),t}(I);function D(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new y(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")})),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function W(){return M}var M={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:""},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:""}},U={};function R(){U={}}var J=new RegExp("(\\bTrident/| MSIE )"),F=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function N(){if(void 0===U.isIEProperty){U.isIEProperty=!1;var e=W();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(J);r&&2===r.length&&(U.isIEProperty=!0)}}}return U.isIEProperty}function z(){if(void 0===U.isEdgeProperty){U.isEdgeProperty=!1,U.isEdgeWithTextHtmlClipboardSupportProperty=!1,U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=W();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(F);if(r&&2===r.length){U.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=16.16299&&(U.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=17.17123&&(U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return U.isEdgeProperty}function k(){return z()&&U.isEdgeWithTextHtmlClipboardSupportProperty}function H(){return z()&&U.isEdgeVersionWithTextHtmlWrapperSupportProperty}function V(){return B}var B={postMessage:function(e,t,r,a){e.postMessage(t,r,a)}},K=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}};function G(){return{items:{}}}var Q,q,X,Z,Y=(Q={items:{}},{getData:function(){return Q},getItem:function(e){},setItem:function(e,t){throw new y("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":"")+"empty)")},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return se(void 0)}});function $(){return Y}function ee(e){return e&&e.items?Object.keys(e.items).length:0}function te(e){return ee(e&&e.getData())}function re(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return ae(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new C("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return se(t)}}}function ae(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new C("","clipboardItemsData.items");return e.items[t]}function oe(e,t){if(!e||0===e.length||!t||!t.trim())return"";var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||""}function ne(e){return oe(e,"text/plain")}function ie(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:"text/plain",data:""}),t}function se(e){var t=[];if(0===ee(e))return t;for(var r in e.items){var a=ae(e,r);a||(a="");var o={clipboardDataFormat:r,data:a,deferred:!1};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(q||(q={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(X||(X={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Z||(Z={}));var ce="sharedClipboardSettings",le=he(),de=!1,ue=2;function ge(){if(!de)throw new y("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return le}function pe(){de=!1,function(){if(!window||!(ce in window))return le=he(),void(de=!0);var e=window[ce];if(!e||"object"!=typeof e)return le=he(),void(de=!0);me(e)}()}function fe(e){de=!1,me(e)}function me(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");var t=he();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return le=t,void(de=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),le=t,void(de=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf("-");a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],le=t,void(de=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],le=t,void(de=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],le=t,void(de=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],le=t,void(de=!0)}t.whitelistOriginComponents=!0,le=t,de=!0}function he(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:ue,remoteLoggerPath:""}}function be(){var e="";return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=""):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var Se,Ce,ye=new RegExp("^\\d+$"),ve=!1;function Ee(e){if(!e)throw new S("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new C("Missing protocol","origin",e);if(1===r.length)throw new C("Missing domain","origin",e);if(r.length>2)throw new C("'://' should appear once","origin",e);var a=r[1];if(!a)throw new C("Missing domain","origin",e);if(t=r[0]+"://",!(r=(a=a.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new C("Missing domain","origin",e);if(r.length>2)throw new C("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new C("The last part of the origin should be the domain","origin",e);if(!(r=a.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new C("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new C("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=a=r[0].trim(),2===r.length){var o=r[1].trim(),n=ye.exec(o);if(!n||1!==n.length)throw new C("Invalid port number","origin",e);var c=Number(o);if(isNaN(c))throw new C("Invalid port number","origin",e);t+=":"+o}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+t+"'"),t}function we(e){Pe();var t=Ee(e),r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new C("Invalid origin","parentOrigin",e);var a=ge(),o="";if(a.whitelistOriginComponents){var n=r[0]+"://";if(!(r=r[1].split("."))||r.length<2||!r[0])throw new C("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),o=n+r.join(".")}else o=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '"+e+"'; Shared Clipboard iframe origin = '"+o+"' components="+JSON.stringify(r)),o}function Le(e){Pe();var t=Ee(e),r=Ee(be().origin);if(t===r)return t;if(!ge().whitelistOriginComponents)throw new y("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+r+"'");var a=Te(t),o=Te(r);if(a.protocol!==o.protocol)throw new y("validateRemoteWindowOrigin: Caller origin's protocol '"+a.protocol+"' doesn't match the current window origin's protocol '"+o.protocol+"'");if(a.environment!==o.environment)throw new y("validateRemoteWindowOrigin: Caller origin's environment '"+a.environment+"' doesn't match the current window origin's environment '"+o.environment+"'");return t}function Te(e){Pe();var t=e.split("://",2),r=t[0],a=_e(t[1]),o={protocol:r};if(o.environment=Ie(e,a,Ce),a.length<=o.environment.length+1)throw new C("Missing app component","origin",e);if("."!==a.charAt(o.environment.length))throw new C("Missing a domain separator after the environment component","origin",e);var n=a.substr(o.environment.length+".".length);if(o.app=Ie(e,n,Se),o.app.length<n.length&&"-"!==n.charAt(o.app.length))throw new C("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return o}function _e(e){if(!e)throw new S("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Ie(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");var a=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=a&&t.substr(0,o)===e}));if(o&&o.length>0)return _e(o[0]);throw new C("Invalid origin","validatedOrigin",e)}function Pe(){if(!ve){var e=ge();e.whitelistOriginComponents&&(Se=Oe(e.sharedClipboardHostingApps),Ce=Oe(e.sharedClipboardHostingEnvironments),ve=!0)}}function Oe(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[_e(e)]=e.length})),t):t}function Ae(e,t){return null==e||1===e||null==t||e!==t}function xe(){return We()}function je(){return We()}function De(e){if(!e)throw new S("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new C("","id");return t}function We(){return(Math.random()+1).toString(36).substring(7)}function Me(e,t,r,a,o){var n={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return Je(n),n}var Ue=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function Re(e){return"get"===e||"set"===e||"init"===e}var Je=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!Re(e.operationCode))throw new C("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new C("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function Fe(e,t,r,a,o){var n={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return Ne(n),n}var Ne=function(e){if(!e)throw new S("","clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new C("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new C("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new C("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new C("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new C("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new C("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new C("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function ze(e){if(!e||0===e.trim().length)throw new C("","className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new y(r(e))}}}()}var ke=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=ze(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)}),(function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new x(d.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new x(d.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set($(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new x(d.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),He=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Ve(e){var t=e;return t&&0!==t.trim().length||(t=xe()),new Qe(t)}function Be(){return He?window.performance.now():Date.now()}function Ke(e){return He?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Ge(e,t,r){if(!r)throw new S("","creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":Be()-r)+"ms"}var Qe=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=De(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Be(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+Ke(this.creationTimestamp)),this.promise=new Promise((function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+Ke(Be())),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Be(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+Ge(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+Ke(this.fulfillmentTimestamp)+". "+Ge(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();function qe(){return new Xe}var Xe=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=De(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=Ve(e);if(this.getDeferredPromise(t.id))throw new C("A deferred promise already exists in the cache for the specified id","id",t.id);var r=De(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=De(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}},e}();function Ze(e){if(!e)throw new S("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new C("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new C("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new C("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new C("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function Ye(e){if(!e)throw new S("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new C("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function $e(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");var t=Le(e.windowOrigin);return{window:e.window,windowOrigin:t}}var et=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=ze(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(D([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new y(t)}this.sender.postMessage(e)},e}();function tt(){return rt}var rt={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function at(e,t,r){return new nt(e,t,r)}function ot(e,t,r){return new nt(e,t,r)}var nt=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=ze("WindowRPCReceiverInternal"),this.remoteWindow=$e(r.remoteWindow),tt().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(tt().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(i.utils.getStringifiedError(e))}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}))}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function it(e,t){return new ct(e,t)}function st(e,t){return new ct(e,t)}var ct=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=ze("WindowRPCSenderInternal"),this.remoteWindow=$e(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new y("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new y("The remote window does not support postMessage");var t=this.serializer.serialize(e);V().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function lt(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function dt(e){return"OfficeOnlineCCP_Data_"+e}function ut(e){return"OfficeOnlineCCP_Metadata_"+e}function gt(e){return ut(e)+"_LocalStorageChangedFlag"}var pt,ft=function(){this.copyStatus=pt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},mt=function(){function e(){this.startTime=i.perfWatch.timeStamp()}return e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: "+e+", pasteId: "+this.id+", timeMS: "+t.toFixed()},e}();function ht(){return{}}function bt(e){var t=void 0;return e&&e.lastCopy&&(t=Object(f.__assign)({},e.lastCopy)),{lastCopy:t}}function St(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+q.LocalStorage+"'");var t=new Ct(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(pt||(pt={}));var Ct=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new x(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new x(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=q.LocalStorage,this.disposableImplementationExtension=ze("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='"+(e?e.id:"")+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve($());try{var r=JSON.parse(t);if(!r||0===ee(r))return Promise.resolve($());var a=re(r);return Promise.resolve(a)}catch(e){return Promise.resolve($())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+te(e)+"'; commandParameters.id='"+(t?t.id:"")+"'"),0===te(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=this.localStorageKey+"_LocalStorageChangedFlag",a=xe();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+a),localStorage.setItem(r,a),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function yt(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+l.LocalStorage+"' with localStorageKey: '"+e+"'"),(new vt).initialize(St(e))}var vt=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(f.__extends)(t,e),t}(ke),Et=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)}),(function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=Ve(),a=new Date,o=setInterval((function(){var n=(new Date).getTime()-a.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(o),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):n>e&&(clearInterval(o),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())}),200);return r.promise},e}(),wt="\n",Lt=new RegExp("(\n\r)|(\r\n)|(\r)","g"),Tt=new RegExp("(\t)","g"),_t=new RegExp("<","g"),It=new RegExp(">","g"),Pt="div",Ot="pre",At="table",xt="tr",jt="td",Dt="\x3c!--EndFragment--\x3e",Wt="\x3c!--StartFragment--\x3e".length,Mt=Dt.length,Ut="Version:0.9\nStartHTML:0000000100\nEndHTML:{EndHTML0}\nStartFragment:0000000134\nEndFragment:{EndFragm}\n<html>\n<body>\n\x3c!--StartFragment--\x3e\n",Rt="</html>".length,Jt="data-ccp-timestamp",Ft=0;function Nt(e){return e?e.replace(Lt,wt):e}function zt(e){return e?e.length<=10240?e:e.substr(0,10240):""}function kt(e){var t,r=Zt(e),a=function(e){return e?e.replace(Lt,"</"+jt+"></"+xt+"><"+xt+"><"+jt+">"):e}((t=r)?t.replace(Tt,"</"+jt+"><"+jt+">"):t);return"<"+At+"><"+xt+"><"+jt+">"+a+"</"+jt+"></"+xt+"></"+At+">"}function Ht(e,t,r){if(r!==Ft&&!r)throw new S("","timestamp");if(isNaN(r))throw new C("","timestamp",r.toString());return Gt(function(e,t,r){return"<"+e+" "+Jt+"='"+r+"'>"+t+"</"+e+">"}(e,kt(t),r))}function Vt(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=Bt(r[0]);t.push(a);for(var o=1;o<r.length;o+=1){t.push("\r"),t.push(wt);var n=Bt(r[o]);t.push(n)}}return t.join("")}function Bt(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push("\t"),t.push(r[a].innerText)}return t.join("")}function Kt(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Jt)}function Gt(e){if(!z()||H())return e;var t="0000000000".length,r=Ut.length+e.length+"\x3c!--EndFragment--\x3e\n</body>\n</html>".length,a=(r-"\x3c!--EndFragment--\x3e\n</body>\n</html>".length).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){var o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is "+a.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(d.UnexpectedClipboardTextHtmlContentLength,o)}var n=(r-Rt).toString();if(n.length<t&&(n="0000000000".substr(0,t-n.length)+n),n.length!==t){o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is "+n.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(d.UnexpectedClipboardTextHtmlContentLength,o)}var c=Ut.replace("{EndHTML0}",n).replace("{EndFragm}",a)+e+"\x3c!--EndFragment--\x3e\n</body>\n</html>";return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of "+c.length+" differs from the expected length of "+r),c}function Qt(e){if(!e)return"";if(!e.trim())return e;var t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf(Dt);if(t<0||r<0||t>r)return e;var a=t+Wt,o=r-a,n=e.indexOf("\x3c!--StartFragment--\x3e",a),i=e.indexOf(Dt,r+Mt);return n>=0||i>=0?e:e.substr(a,o)}function qt(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new S("","attributeName");var r=new RegExp(t+"=['\"](\\d+)['\"]","i").exec(e);if(!r||r.length<2)return;return r[1]}(e,Jt);if(t&&t.trim()){var r=Number(t);if((r||r===Ft)&&!isNaN(r))return r}}function Xt(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var a=t[r];if("ProgId"===a.getAttribute("name")){var o=a.getAttribute("content");if(null!==o){if(o.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(o.startsWith("Word"))return"Word Desktop";if(o.startsWith("Excel"))return"Excel Desktop";if(o.startsWith("PowerPoint"))return"PowerPoint Desktop";if(o.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}return}(t);if(void 0!==r)return r;var a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var a=t.classList[r];if(a.startsWith("SCXO"))return"OneNote Online";if(a.startsWith("SCXP"))return"PowerPoint Online";if(a.startsWith("SCXW"))return"Word Online"}return}(t);return void 0!==a?a:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];if(null!=r&&null!=r.id&&null!=r.id.startsWith&&r.id.startsWith("docs-internal-guid-"))return!0;return!1}(t)?"Google Docs":void 0}}function Zt(e){return e?e.replace(_t,"&lt;").replace(It,"&gt;"):""}function Yt(e,t,r){var a="";return r&&(a=Object.keys(r).reduce((function(e,t){return t?e+" "+t+"='"+r[t]+"'":e}),"")),"<"+t+a+">"+e+"</"+t+">"}r.d(t,"dc",(function(){return s})),r.d(t,"Db",(function(){return c})),r.d(t,"Fb",(function(){return m})),r.d(t,"Gb",(function(){return h})),r.d(t,"a",(function(){return b})),r.d(t,"B",(function(){return S})),r.d(t,"t",(function(){return C})),r.d(t,"u",(function(){return y})),r.d(t,"L",(function(){return v})),r.d(t,"A",(function(){return E})),r.d(t,"J",(function(){return w})),r.d(t,"M",(function(){return L})),r.d(t,"K",(function(){return T})),r.d(t,"b",(function(){return I})),r.d(t,"m",(function(){return P})),r.d(t,"G",(function(){return O})),r.d(t,"c",(function(){return A})),r.d(t,"e",(function(){return x})),r.d(t,"I",(function(){return j})),r.d(t,"Zb",(function(){return D})),r.d(t,"Cb",(function(){return R})),r.d(t,"Kb",(function(){return N})),r.d(t,"Hb",(function(){return z})),r.d(t,"Jb",(function(){return k})),r.d(t,"Ib",(function(){return H})),r.d(t,"zb",(function(){return V})),r.d(t,"ib",(function(){return""})),r.d(t,"Vb",(function(){return" "})),r.d(t,"Ub",(function(){return"."})),r.d(t,"Sb",(function(){return"1"})),r.d(t,"Tb",(function(){return"1"})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return"copy"})),r.d(t,"p",(function(){return"cut"})),r.d(t,"D",(function(){return"paste"})),r.d(t,"k",(function(){return"copy"})),r.d(t,"q",(function(){return"cut"})),r.d(t,"E",(function(){return"paste"})),r.d(t,"O",(function(){return K})),r.d(t,"gb",(function(){return"text/plain"})),r.d(t,"hb",(function(){return"Text"})),r.d(t,"cc",(function(){return"text/html"})),r.d(t,"Bb",(function(){return"image/png"})),r.d(t,"Qb",(function(){return"metadata/is-last-copy-was-external"})),r.d(t,"Rb",(function(){return"metadata/is-last-copy-was-external-XLO-source"})),r.d(t,"Nb",(function(){return"metadata/chrome-extension-id"})),r.d(t,"Pb",(function(){return"metadata/ccp-infra-version"})),r.d(t,"Ob",(function(){return"copyId"})),r.d(t,"pb",(function(){return G})),r.d(t,"rb",(function(){return $})),r.d(t,"nb",(function(){return ee})),r.d(t,"mb",(function(){return te})),r.d(t,"Q",(function(){return re})),r.d(t,"lb",(function(){return ae})),r.d(t,"kb",(function(){return oe})),r.d(t,"ob",(function(){return ne})),r.d(t,"sb",(function(){return ie})),r.d(t,"g",(function(){return q})),r.d(t,"r",(function(){return X})),r.d(t,"f",(function(){return d})),r.d(t,"n",(function(){return u})),r.d(t,"H",(function(){return g})),r.d(t,"d",(function(){return p})),r.d(t,"s",(function(){return Z})),r.d(t,"wb",(function(){return we})),r.d(t,"hc",(function(){return Le})),r.d(t,"C",(function(){return 1})),r.d(t,"bc",(function(){return Ae})),r.d(t,"ab",(function(){return xe})),r.d(t,"T",(function(){return je})),r.d(t,"jb",(function(){return De})),r.d(t,"R",(function(){return Me})),r.d(t,"z",(function(){return Ue})),r.d(t,"Mb",(function(){return Re})),r.d(t,"fc",(function(){return Je})),r.d(t,"S",(function(){return Fe})),r.d(t,"gc",(function(){return Ne})),r.d(t,"h",(function(){return ke})),r.d(t,"U",(function(){return Ve})),r.d(t,"V",(function(){return qe})),r.d(t,"W",(function(){return ze})),r.d(t,"Z",(function(){return Ze})),r.d(t,"bb",(function(){return Ye})),r.d(t,"Eb",(function(){return"initmessageid"})),r.d(t,"ec",(function(){return"unknownmessageid"})),r.d(t,"Wb",(function(){return"CreatorOrigin"})),r.d(t,"xb",(function(){return $e})),r.d(t,"N",(function(){return et})),r.d(t,"eb",(function(){return at})),r.d(t,"cb",(function(){return ot})),r.d(t,"fb",(function(){return it})),r.d(t,"db",(function(){return st})),r.d(t,"v",(function(){return"_LocalStorageChangedFlag"})),r.d(t,"Lb",(function(){return lt})),r.d(t,"tb",(function(){return dt})),r.d(t,"ub",(function(){return ut})),r.d(t,"vb",(function(){return gt})),r.d(t,"l",(function(){return ft})),r.d(t,"F",(function(){return mt})),r.d(t,"o",(function(){return pt})),r.d(t,"qb",(function(){return ht})),r.d(t,"P",(function(){return bt})),r.d(t,"yb",(function(){return be})),r.d(t,"Y",(function(){return yt})),r.d(t,"x",(function(){return vt})),r.d(t,"X",(function(){return St})),r.d(t,"w",(function(){return Ct})),r.d(t,"y",(function(){return Et})),r.d(t,"Xb",(function(){return"usid"})),r.d(t,"Yb",(function(){return"WacCluster"})),r.d(t,"Ab",(function(){return o})),r.d(t,"ac",(function(){return a}))},10:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,a){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var a={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var n={};return Object.keys(a).forEach((function(t){n[t]=e(a[t],r+1)})),n}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var a=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),a=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)a(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),a=function(a){var o=e[a];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)a(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var a=-1,o=null;if(void 0!==document.caretPositionFromPoint)null!==(n=document.caretPositionFromPoint(e,t))&&(a=n.offset,o=null!=n.offsetNode&&null!=n.offsetNode.parentElement&&"SPAN"===n.offsetNode.parentElement.nodeName?n.offsetNode.parentElement:n.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(n=document.caretRangeFromPoint(e,t))&&(a=n.startOffset,o=null!=n.startContainer&&null!=n.startContainer.parentElement&&"SPAN"===n.startContainer.parentElement.nodeName?n.startContainer.parentElement:n.startContainer)}else try{var n;o=document.elementFromPoint(e,t),(n=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(o),i.setEndPoint("EndToStart",n),a=i.text.length}catch(e){return a}if(r)for(var s=!1;null!=o;)null===o.previousSibling&&null!==o.parentNode&&null!==o.parentNode.parentNode&&o.parentNode.parentNode.childNodes.length>1&&!s?(o=o.parentNode,s=!0):null!=(o=o.previousSibling)&&null!=o.textContent&&(a+=o.textContent.length,s&&(a+=1));else for(;null!=o;)null!=(o=o.previousSibling)&&null!=o.textContent&&(a+=o.textContent.length);return a},t.getBoundingRectForText=function(e,t,r,a){function o(e,t,r){if(!e||!e.textContent)return t;if(a&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var n=e.childNodes,i=0;i<n.length&&t>=0;i+=1)t=o(n[i],t,r),a&&"DIV"===n[i].nodeName&&(t-=1);return t}void 0===a&&(a=!1);var n=document.createRange();return o(e,t,(function(e,t){return n.setStart(e,t)})),o(e,r,(function(e,t){return n.setEnd(e,t)})),n.getBoundingClientRect()}},11:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={};t.promises=function(){return void 0===a.promises&&(a.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),a.promises}},12:function(e,t,r){"use strict";function a(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=a(),r=e,n=t,i={},s=function(e,t,a){return function(e,t,r,a,n,i){o(e,"end",r);var s={sessionName:t,result:a?"success":"failure",message:i,marks:e},c=JSON.stringify(s);n(c)}(i,r,n,e,t,a)};return i.start=0,{mark:function(e){return function(e){return o(i,e,n)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=a},15:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return a},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");a=e}},16:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=function(){return self.performance.now()}),function(r){var o=a(),n=r;return{reset:function(e){null!=e&&(n=e),o=a()},stop:function(r){var i=a()-o,s=JSON.stringify({Target:n,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},17:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var a=!1,o=window.performance;try{o&&o.now&&o.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var n=0;n<e.length;n+=1){try{if(a){t.perfNow=!0;var i=Math.floor(100*o.now())%10;(i<0||i>9)&&(i=0);for(var s=0;s<i;s+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[n]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},18:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},2:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return n})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return l})),r.d(t,"__awaiter",(function(){return d})),r.d(t,"__generator",(function(){return u})),r.d(t,"__createBinding",(function(){return g})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return f})),r.d(t,"__read",(function(){return m})),r.d(t,"__spread",(function(){return h})),r.d(t,"__spreadArrays",(function(){return b})),r.d(t,"__await",(function(){return S})),r.d(t,"__asyncGenerator",(function(){return C})),r.d(t,"__asyncDelegator",(function(){return y})),r.d(t,"__asyncValues",(function(){return v})),r.d(t,"__makeTemplateObject",(function(){return E})),r.d(t,"__importStar",(function(){return w})),r.d(t,"__importDefault",(function(){return L})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return _}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,a){return new(r||(r=Promise))((function(o,n){function i(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))}function u(e,t){var r,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,a=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){i=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){i.label=n[1];break}if(6===n[0]&&i.label<o[1]){i.label=o[1],o=n;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(n);break}o[2]&&i.ops.pop(),i.trys.pop();continue}n=t.call(e,i)}catch(e){n=[6,e],a=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function g(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}function p(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function C(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),n=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){o[e]&&(a[e]=function(t){return new Promise((function(r,a){n.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(c,l):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),n.shift(),n.length&&s(n[0][0],n[0][1])}}function y(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:S(e[a](t)),done:"return"===a}:o?o(t):t}:o}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,o){(function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)})(a,o,(t=e[r](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function L(e){return e&&e.__esModule?e:{default:e}}function T(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},206:function(e,t,r){"use strict";r.r(t);var a,o=r(1),n=r(0);function i(e){Object(o.dc)().ULS.shipAssertTag(595944468,n.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),a=e}var s,c=r(2);var l,d={serializeMetadata:function(e){if(!e)return"{}";try{var t={},r=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed}}catch(e){return void Object(o.dc)().ULS.traceTag(595945243,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: "+n.utils.getStringifiedError(e))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(o.dc)().ULS.traceTag(595945242,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: "+n.utils.getStringifiedError(e)),"{}"}},deserializeMetadata:function(e){if(!e)return Object(o.qb)();try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new o.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t}catch(e){return void Object(o.dc)().ULS.traceTag(595945245,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: "+n.utils.getStringifiedError(e)+".")}}(t.copyContext)),r}catch(e){Object(o.dc)().ULS.traceTag(595945244,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: "+n.utils.getStringifiedError(e))}return Object(o.qb)()}};function u(e,t,r){return Object(o.dc)().ULS.shipAssertTag(595945246,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(o.dc)().ULS.shipAssertTag(595945247,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),l=e,g=function(e){return s=e,d}(t),(p=r)&&p.setOnMetadataChangedListener(S),b}var g,p,f,m=Object(o.qb)(),h={},b={getCachedMetadata:function(){return Object(o.dc)().ULS.traceTag(595730648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: "+E(m)),Object(o.P)(m)},updateMetadata:function(e){Object(o.dc)().ULS.traceTag(595730652,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : "+E(e));var t=Object(c.__assign)(Object(c.__assign)({},m),e),r=Object(o.Q)();r.setItem("metadata",g.serializeMetadata(t)),Object(o.dc)().ULS.traceTag(595730653,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: "+E(t)),y(r,t)},clear:function(){Object(o.dc)().ULS.traceTag(595730654,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.clear: start clear metadata");var e=Object(o.qb)();y(Object(o.Q)(),e)},addMetadataChangeListener:function(e,t){e||Object(o.dc)().ULS.traceTag(595936158,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");t||Object(o.dc)().ULS.traceTag(595936159,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define");h[e]&&Object(o.dc)().ULS.traceTag(595936160,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId("+e+" already exist.");h[e]=t},removeMetadataChangeListener:function(e){e||Object(o.dc)().ULS.traceTag(595936161,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");h[e]?delete h[e]:Object(o.dc)().ULS.traceTag(595936162,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = "+e+".")},getMetadataSyncPromise:function(){if(!f||!Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete"))return Object(o.dc)().ULS.traceTag(595937173,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(o.P)(m));return Object(o.dc)().ULS.traceTag(595937174,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),f.deferredPromise.promise.then((function(e){return Object(o.dc)().ULS.traceTag(595937175,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e}))},isMetadataSync:function(){return!f}};function S(e){try{if(e&&0!==Object(o.mb)(e)){var t=e.getItem("metadata");m=g.deserializeMetadata(t),Object(o.dc)().ULS.traceTag(595730650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value "+E(m))}else Object(o.dc)().ULS.traceTag(595730649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),m=Object(o.qb)()}catch(e){Object(o.dc)().ULS.traceTag(595945248,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: "+n.utils.getStringifiedError(e)),m=Object(o.qb)()}C(Object(o.P)(m))}function C(e){for(var t in Object(o.dc)().ULS.traceTag(595730651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : "+E(e)),h){var r=h[t];r&&r(e)}}function y(e,t){var r=Object(o.ab)();f?f.metadataSyncMessageId=r:(f={metadataSyncMessageId:r,deferredPromise:Object(o.U)()},Object(o.dc)().ULS.traceTag(595937176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. "+f.metadataSyncMessageId)),Object(o.dc)().ULS.traceTag(595937177,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id "+r+"."),setTimeout((function(){l.set(e,{}).then((function(){m=t,Object(o.dc)().ULS.traceTag(595937178,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId="+r+". _syncMetadata.metadataSyncMessageId = "+(f&&f.metadataSyncMessageId)+". newMetadata = "+E(t)),v(r)}),(function(e){Object(o.dc)().ULS.traceTag(595945250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: "+n.utils.getStringifiedError(e)),v(r)}))}),0)}function v(e){if(Object(o.dc)().ULS.traceTag(595730655,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: "+e),f&&f.metadataSyncMessageId===e){var t=f;f=void 0;var r=Object(o.P)(m);Object(o.dc)().ULS.traceTag(595730656,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: "+E(r)),C(r),t.deferredPromise.resolve(r)}}function E(e){return e?e.lastCopy?"copyContext.id="+e.lastCopy.id:"copy context is null":"metadata is null"}var w=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=n.utils.calcHashCode(e):(this.userHash=1565411791,Object(o.dc)().ULS.traceTag(595903939,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,t,r,a){void 0===a&&(a="null");var n={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};return n[o.Ab.ccpTimestampHtmlCustomAttributeName]=r,o.Ab.wrapContentWithTagAndAttributes(e,t,n)},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==Object(o.mb)(e)){var t=Object(o.sb)(e),r=Object(o.kb)(t,o.cc),a=Object(o.kb)(t,o.Ob);if(r){if(void 0!==this.getRegExIntValue(r,"ccp_infra_version=['|\"](\\d+)['|\"]"))return;e.setItem(o.cc,this.wrapTextWithDataSignature(r,o.Ab.divTagName,Date.now(),a))}else{var n=Object(o.ob)(t),i=o.Ab.createTextHtmlFromTextPlain(n),s=this.wrapTextWithDataSignature(i,o.Ab.preTagName,Date.now(),a);e.setItem(o.cc,o.Ab.addClipboardWrapperForEdge(s))}}},e.prototype.extractSignatureData=function(e){if(Object(o.nb)(e)>0){var t=Object(o.lb)(e,o.cc),r=this.getRegExIntValue(t,"ccp_infra_version=['|\"](\\d+)['|\"]");if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw Object(o.dc)().ULS.traceTag(595902983,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = "+r+", CCPInfraVersion = 3"),new o.A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(Object(o.dc)().ULS.traceTag(595902986,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = "+r+", CCPInfraVersion = 3. Converting to the data"),this.parseOldSignatureData(t)):(r>3&&Object(o.dc)().ULS.traceTag(595900176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = "+r+", CCPInfraVersion = 3. ( It's OK - Should be forward compatibility)"),this.parseCurrentVersionSignatureData(t))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){var a=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return a&&Object(o.dc)().ULS.traceTag(595183181,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : "+a),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:a||""}}Object(o.dc)().ULS.traceTag(595902985,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: "+e)},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=o.Ab.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(o.dc)().ULS.traceTag(595723668,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp="+t),t){if(this.blockMismatchDataVersion)throw Object(o.dc)().ULS.traceTag(595899270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new o.A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);var r={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(o.dc)().ULS.traceTag(595723669,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData"),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(o.dc)().ULS.traceTag(595899858,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Time elapsed ("+t+" ms) from setting Clipboard ("+e.ccp_infra_timestamp+") is greater then TTL ("+this.ttlInMs+" ms) - return error"),new o.J("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(o.dc)().ULS.traceTag(595723670,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new o.M("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==Object(o.mb)(e)){var t={ccp_infra_version:3};e.setItem(o.Pb,JSON.stringify(t))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&Object(o.mb)(e)>0){var t=Object(o.lb)(e.getData(),o.Pb),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(o.dc)().ULS.traceTag(595899272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = "+e),new o.K("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = "+t)}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw Object(o.dc)().ULS.traceTag(595899203,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = "+r.ccp_infra_version+", CCPInfraVersion = 3"),new o.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;Object(o.dc)().ULS.traceTag(595723671,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash="+e);return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(Object(o.dc)().ULS.traceTag(595723672,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash="+e),r){var a=t.extractSignatureData(r.getData());Object(o.dc)().ULS.traceTag(595723673,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash="+e),a&&r.setItem(o.Ob,a.ccp_infra_copy_id),t.validateTTL(a),e&&(Object(o.dc)().ULS.traceTag(595723674,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash="+e),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;Object(o.dc)().ULS.traceTag(595723675,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called.");return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){Object(o.dc)().ULS.traceTag(595723676,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[o.Ob]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]},e.prototype.getRegExIntValue=function(e,t){var r=this.getRegExStringValue(e,t);if(r){var a=Number(r);return isNaN(a)?void 0:a}},e}();var L=function(e){function t(t,r,a){var o=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return o.pushMessageListeners={},o}return Object(c.__extends)(t,e),t.prototype.init=function(e){return this.deferredResultMessagePromiseCache=Object(o.V)(),this.sender=Object(o.db)(this.serializer,this),this.receiver=Object(o.cb)(this.deserializer,this,this),this.postInitMessage(e).catch((function(e){return Object(o.dc)().ULS.traceTag(596129250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"Init failure or timeout. Error: "+n.utils.getStringifiedError(e)),Object(o.Fb)(e,o.f.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new o.e(o.f.IframeInitialization,"failed to init the Shared Clipboard",e))}))},t.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},t.prototype.postInitMessage=function(e){var t=Object(o.R)(o.Eb,"init",o.z.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.dc)().ULS.shipAssertTag(596121487,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout((function(){if(i&&!i.fulfilled()){var e=Date.now(),t="initialization started on "+new Date(s)+" and timed out on "+new Date(e)+" after "+(e-s)+" ms";Object(o.dc)().ULS.traceTag(596129251,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,t),i.reject(new o.e(o.f.IframeInitializationTimeout,t))}}),e),a},t.prototype.postMessage=function(t){try{if(!t)throw new o.B(o.ib,"outgoingMessage");if(Object(o.dc)().ULS.shipAssertTag(596452175,n.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(o.dc)().ULS.shipAssertTag(596121488,n.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.u(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new o.u("Unable to post message for operation '"+(t?t.operationCode:void 0)+"'",e))}},t.prototype.handleMessage=function(e){Object(o.dc)().ULS.traceTag(596452376,n.LogCategory.msoulscat_ES_EWAJS,e&&e.failed?n.TraceLevel.Warning:n.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.failed='"+(e&&e.failed)+"'; incomingMessage.error='"+(e&&e.error)+"'; incomingMessage.clipboardItems.length="+Object(o.nb)(e&&e.clipboardItemsData));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.dc)().ULS.shipAssertTag(596121489,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a="initresult"===e.operationCode?o.Eb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(o.dc)().ULS.traceTag(596452377,n.LogCategory.msoulscat_ES_EWAJS,"initresult"===e.operationCode?n.TraceLevel.Warning:n.TraceLevel.Error,a===e.id?"RPC Client - handleMessage: no deferred promise with id '"+e.id+"'; dropping this result.":"RPC Client - handleMessage: no deferred promise with id '"+a+"' for message id '"+e.id+"'; dropping this result."),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return Object(o.dc)().ULS.traceTag(596452379,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are "+(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0)+" deferred promise(s) in the cache. Error: "+n.utils.getStringifiedError(e)),Promise.resolve()},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Zb)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(o.N),T=[],_={initialized:!1,origin:o.ib,src:o.ib,deferredPromise:void 0},I=void 0;function P(){return _}function O(){var e=document.createElement("iframe");return e.style.display="none",e.id="clipboard",Object(o.dc)().ULS.shipAssertTag(595952726,n.LogCategory.msoulscat_ES_EWAJS,!I,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),x(),I=Object(o.O)(e,"load",(function(e){return function(e){Object(o.dc)().ULS.traceTag(595952727,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: Entering"),x();var t=P().deferredPromise;if(!t)return void Object(o.dc)().ULS.shipAssertTag(595952728,n.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{P().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '"+r+"'";return Object(o.dc)().ULS.shipAssertTag(595952729,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}if(!a.contentWindow){i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '"+r+"'";return Object(o.dc)().ULS.shipAssertTag(595952730,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}Object(o.dc)().ULS.traceTag(595952732,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '"+r+"' with the iframe"),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: ["+n.utils.getStringifiedError(e)+"]. Rejecting deferred promise id '"+r+"'";Object(o.dc)().ULS.traceTag(595952733,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),t.reject(new o.u(i,e))}}(e)})),e.src=P().src,e}function A(e){var t=P().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+="clipboard/shared.aspx",e&&(r+="?"+encodeURIComponent(o.Wb)+"="+encodeURIComponent(e));var i=[];T.forEach((function(e){Object(n.ewaUtils)().isChangeGateEnabled(e)||i.push({key:e,value:"1"})}));var s=function(){if(!a)throw new o.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return a}();s&&s.sessionId&&i.push({key:o.Xb,value:s.sessionId});var c=Object(n.getNewGuid)(),l=c[0],d=c[1];return Object(o.dc)().ULS.traceTag(595722560,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: "+l+" newGuidLogging: "+d),i.push({key:"corrid",value:l}),i.push({key:"NoAuth",value:"true"}),i.length>0&&i.forEach((function(e){r+=function(e){if(e.indexOf("?")>=0)return"&";return"?"}(r),r+=encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)})),r}function x(){if(I){try{I()}catch(e){}I=void 0}}var j=void 0;function D(){if(!j)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!P().initialized)throw new o.u("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(o.dc)().ULS.traceTag(595952723,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found "+e.length+" iframes");for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&"clipboard"===r.id)return r}Object(o.dc)().ULS.traceTag(595952724,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(o.dc)().ULS.traceTag(595952722,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(o.dc)().ULS.traceTag(596448770,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src "+(void 0!==e.src&&void 0!==j.src&&e.src.toLowerCase()===j.src.toLowerCase()?"===":"!==")+" src; deferredPromise "+(void 0===j.deferredPromise?"does not exist":"exists")+"; The iframe's content window "+(void 0===e.contentWindow?"does not exist":"exists")+"."),function(e){if(!e)throw new o.B(o.ib,"iframe");Object(o.dc)().ULS.traceTag(595952725,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),x(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=j.deferredPromise,r=t?t.id:o.ib;if(t){x(),j.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '"+r+"' and creating a new one";Object(o.dc)().ULS.shipAssertTag(596453587,n.LogCategory.msoulscat_ES_EWAJS,!1,a),t.reject(new o.u(a)),t=void 0}j.deferredPromise=Object(o.U)(Object(o.ab)()),r=(t=j.deferredPromise).id;try{e=O(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '"+r+"'";return Object(o.dc)().ULS.traceTag(596453588,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,a),j.deferredPromise=void 0,x(),Promise.reject(new o.u(a,e))}return t&&!t.fulfilled()?t.promise:(x(),e.contentWindow?(j.deferredPromise=void 0,Promise.resolve(e)):(Object(o.dc)().ULS.shipAssertTag(596453589,n.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"),Promise.reject(new o.u("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"))))}var W,M;function U(){if(M)return M.promise;M=Object(o.U)(Object(o.ab)());try{var e=function(e){return j||(j=P()),j.initialized||(j.origin=Object(o.wb)(e),j.src=A(e),j.initialized=!0),j.origin}(Object(o.yb)().origin);W=function(e,t){return new L(Object(o.bb)(o.fc),Object(o.Z)(o.gc),{window:t,windowOrigin:e})}(e,void 0),n.utils.retry((function(e,t){return function(e,t){if(!W){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(o.dc)().ULS.shipAssertTag(595947544,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=n.perfWatch.start("Iframe_initialize_"+e);n.perfWatch.mark(a,"start"),W.remoteWindow.window=void 0;var i=function(r){var i=Object(o.Fb)(r,o.f.IframeInitializationTimeout)?" due to a timeout of approx. "+t+" ms":o.ib;n.perfWatch.mark(a,"finish_error"),n.perfWatch.failure(a,(function(e){return Object(o.dc)().ULS.traceTag(596452419,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Attempt #"+e+" failed to initialize an iframe "+i+". "+(e<3?"Retrying...":"No more retries!")+". Error: "+n.utils.getStringifiedError(r))},s=Object(o.U)();return D().then((function(r){if(n.perfWatch.mark(a,"iframe_loaded"),n.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!W){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(o.dc)().ULS.shipAssertTag(595947545,n.LogCategory.msoulscat_ES_EWAJS,!1,s);var c=new o.u(s);return i(c),Promise.reject(c)}if(!r.contentWindow){s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(o.dc)().ULS.shipAssertTag(595903557,n.LogCategory.msoulscat_ES_EWAJS,!1,s);c=new o.u(s);return i(c),Promise.reject(c)}return W.remoteWindow.window=r.contentWindow,W.init(t).then((function(){return n.perfWatch.mark(a,"iframe_idb_init_complete"),n.perfWatch.mark(a,"finish"),n.perfWatch.success(a,(function(e){return Object(o.dc)().ULS.traceTag(596452418,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)}),"Attempt #"+e+" initialized iframe"),Promise.resolve()}))})).then((function(){s.resolve()}),(function(e){i(e),s.reject(e)})),s.promise}(e,2e4+(Object(o.Fb)(t,o.f.IframeInitializationTimeout)?5e3:0)*(e-1))}),3).then((function(){M.resolve(W)}),(function(e){M.reject(e)}))}catch(e){M.reject(e)}return M.promise}var R=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return U().then((function(t){return e.initialized=!0,e.windowRPCClient=t,e}))},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new o.e(o.f.IframeInitialization));var r=n.perfWatch.start("BaseIframeProxy_"+t);n.perfWatch.mark(r,"start");var a=function(e){return n.perfWatch.mark(r,"finish_error"),n.perfWatch.failure(r,(function(e){return Object(o.dc)().ULS.traceTag(596452188,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Failed in BaseIframeProxy.postMessage. Error: "+n.utils.getStringifiedError(e)),Promise.reject(new o.e(o.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(o.dc)().ULS.shipAssertTag(595944461,n.LogCategory.msoulscat_ES_EWAJS,!1,i),a(new o.u(i))}return this.windowRPCClient.postMessage(e).then((function(e){return Object(o.dc)().ULS.shipAssertTag(595944462,n.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new o.e(o.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: "+e.error)):(n.perfWatch.mark(r,"finish"),n.perfWatch.success(r,(function(e){return Object(o.dc)().ULS.traceTag(596452187,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),Promise.resolve(e)):Promise.reject(new o.e(o.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))})).catch((function(e){return a(e)}))},e}(),J=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new o.y(this.localStorageKey,e,(function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)})),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){Object(o.dc)().ULS.traceTag(595716297,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.dc)().ULS.shipAssertTag(595716298,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then((function(){r.registerPushMessageListener("getMetadata_longPollingresult",(function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(Object(o.Q)(e))}))}))},t.prototype.setOnMetadataChangedListener=function(e){Object(o.dc)().ULS.traceTag(595730647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.dc)().ULS.shipAssertTag(595944466,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},t}(R),N=function(e){function t(t){return e.call(this,o.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),z=!0;function k(){return z}function H(){z=!1}var V=!0;function B(){return V}function K(){V=!1}function G(){var e=void 0;try{e=window.clipboardData}catch(e){Object(o.dc)().ULS.traceTag(595985225,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: "+n.utils.getStringifiedError(e))}return e}function Q(){if(Object(o.dc)().ULS.shipAssertTag(596455701,n.LogCategory.msoulscat_ES_EWAJS,Object(o.Kb)(),"The browser must be IE"),!Object(o.Kb)())throw new o.u("The browser must be IE")}var q=void 0,X={};function Z(){if(void 0===q&&(q=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?q=!0:Object(o.dc)().ULS.traceTag(596455703,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(o.dc)().ULS.traceTag(596455704,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chrome.runtime is not available"))}return q}var Y=new RegExp("</"+o.Ab.divTagName+"><"+o.Ab.divTagName+">","g"),$="</"+o.Ab.divTagName+">\\n<"+o.Ab.divTagName+">";function ee(e){if(!Z())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));var t=Fe().getChromeExtensionIds();if(0===t.length)return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration));var r=o.ib;if(Object(o.nb)(e)>0){var a=Object(o.lb)(e,o.gb);if(a){a=o.Ab.encodeAngleBrackets(a);var i=Date.now(),s=Object(o.lb)(e,o.cc);if(Object(o.dc)().ULS.shipAssertTag(596444116,n.LogCategory.msoulscat_ES_EWAJS,!!s,"chromeSystemClipboard - 'copy': cannot find a text/html clipboard item"),s){var c=o.Ab.getCcpTimestampHtmlCustomAttributeFromWrappingTag(s);Object(o.dc)().ULS.shipAssertTag(596444117,n.LogCategory.msoulscat_ES_EWAJS,!!c,"chromeSystemClipboard - 'copy': cannot find the 'data-ccp-timestamp' HTML custom attribute in the text/html clipboard item"),c&&(i=c)}r=o.Ab.createHtmlItemFromTextPlain(o.Ab.preTagName,a,i)}}var l={command:"copy"};return l.object=r,t.reduce((function(e,t){return e.then((function(e){var r="chromeSystemClipboard: browser extension '"+t+"' will not be called since the previous extension was called successfully with command 'copy'";return Object(o.dc)().ULS.assertTag(596455705,n.LogCategory.msoulscat_ES_EWAJS,!e,r),Object(o.dc)().ULS.traceTag(595985886,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,r),!1}),(function(e){return Object(o.dc)().ULS.traceTag(596455706,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+t+"' will be called with command 'copy'"),Promise.resolve(!0)})).then((function(e){return e?function(e,t){return new Promise((function(r,a){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var n=window.chrome.runtime.lastError;if(n){var i=o.ib;"message"in n&&"string"==typeof n.message&&(i=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - 'copy': browser extension '"+e+"' is not available. Error: "+i))}else r(!1)}))}))}(t,l):Promise.resolve(!1)}))}),Promise.reject(void 0)).then((function(e){return e?Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions)):Promise.resolve()}))}function te(){if(!Z())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));if(Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:4307320_UseTheNewChromExtensionApi")){var e=function(){for(var e in X){if(X[e].includes("getClipboardData"))return e}return null}();if(!e)return Promise.reject(new o.e(o.f.NoBrowserExtensionWithGetClipboardDataCommand));var t={command:"getClipboardData"};return function(e,t){return new Promise((function(r,a){var i=!0;window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var n=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||n){i=!1;var s=o.ib;n&&"message"in n&&"string"==typeof n.message&&(s=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - 'getClipboardData': browser extension '"+e+"' is not available. Error: "+s))}else{i=!1;var c=t,l=c.html,d=c.img,u=c.text,g=function(e,t,r){var a=!!e,o=!!t,n=!!r,i=e.includes("<img src="),s=o&&a&&i;return o&&!n||s}(l,d,u);r({tryTheNextExtension:!1,text:u,html:g?d:l})}})),setTimeout((function(){i&&(Object(o.dc)().ULS.traceTag(589947076,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '"+X+"'"),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - 'getClipboardData': browser extension '"+e+"' is not available. Timeout after : 2000 ms")))}),2e3)}))}(e,t).then((function(t){if(!t)return Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions));Object(o.dc)().ULS.traceTag(589947075,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - paste by browser extension '"+e+"'");var r=Object(o.Q)();return r.setItem(o.gb,t.text),r.setItem(o.cc,t.html),r.setItem(o.Nb,e),r}))}var r=Fe().getChromeExtensionIds();if(0===r.length)return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration));var a={command:"paste"};return r.reduce((function(e,t){return e.then((function(e){var r="chromeSystemClipboard: browser extension '"+t+"' will not be called since the previous extension was called successfully with command 'paste'";return Object(o.dc)().ULS.assertTag(595985887,n.LogCategory.msoulscat_ES_EWAJS,!!e&&!e.tryTheNextExtension,r),Object(o.dc)().ULS.traceTag(596455707,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,r),e}),(function(e){return Object(o.dc)().ULS.traceTag(596455708,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+t+"' will be called with command 'paste'"),Promise.resolve({tryTheNextExtension:!0,text:o.ib,html:o.ib})})).then((function(e){return e.tryTheNextExtension?function(e,t){return new Promise((function(r,a){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var i=window.chrome.runtime.lastError;if(!t&&t!==o.ib||"string"!=typeof t||i){var s=o.ib;"message"in i&&"string"==typeof i.message&&(s=i.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - 'paste': browser extension '"+e+"' is not available. Error: "+s))}else{var c,l=t;c=function(e){if(!e)return e;try{return(new DOMParser).parseFromString(""+e,"text/html").documentElement.innerText}catch(e){return Object(o.dc)().ULS.traceTag(595633949,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"utils.stripHtml: DomParser.parseFromString throw exception."),""}}(l.replace(Y,$)),r({tryTheNextExtension:!1,text:c,html:l})}}))}))}(t,a):Promise.resolve(e)}))}),Promise.reject(void 0)).then((function(e){if(!e||!("tryTheNextExtension"in e)||e.tryTheNextExtension)return Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions));var t=Object(o.Q)();return t.setItem(o.gb,e.text),t.setItem(o.cc,e.html),t}))}function re(e){return!!(e&&e.setData&&e.getData)}function ae(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(o.dc)().ULS.traceTag(595985224,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: "+n.utils.getStringifiedError(e)),e}return t}Object(o.dc)().ULS.traceTag(596456320,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"A clipboard event parameter is missing")}function oe(e,t,r,a){var i=!1;try{var s=ae(r);if(!s||!re(s))return Object(o.dc)().ULS.traceTag(596456264,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - programmatic "+o.j+" and "+o.p+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;!1===(i=s.setData(e,t))&&Object(o.dc)().ULS.traceTag(596456265,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '"+e+"'.")}catch(t){Object(o.dc)().ULS.traceTag(596456266,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '"+e+"' threw an exception: "+n.utils.getStringifiedError(t))}return void 0===i&&(i=!0),i}function ne(e,t,r,a){if(Q(),!a&&!k()&&!B())return Object(o.dc)().ULS.traceTag(596456269,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData - programmatic "+o.j+" and "+o.p+" clipboard access is not supported. rawEvent is empty = "+!!r),!1;var i=G();if(!i||!re(i))return Object(o.dc)().ULS.traceTag(596456270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - "+o.j+" and "+o.p+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),a||(Object(o.dc)().ULS.shipAssertTag(596456271,n.LogCategory.msoulscat_ES_EWAJS,k()&&B(),"setData - programmatic "+o.j+" and "+o.p+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+k()+"'. isProgrammaticAccessSupported = '"+B()+"'. clipboardDataFormat = '"+e+"'"),H(),K()),!1;var s,c=e;c===o.gb&&(c=o.hb);try{!1===(s=i.setData(c,t))&&Object(o.dc)().ULS.traceTag(596456272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '"+c+"'.")}catch(e){Object(o.dc)().ULS.traceTag(596456273,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '"+c+"' threw an exception: "+e.message)}return!a&&k()&&(H(),!1===s&&K()),void 0===s&&(s=!0),s}function ie(){return k()&&ne(o.gb,o.ib,void 0,!1),!!B()||(Object(o.dc)().ULS.traceTag(596456274,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '"+o.j+"' and '"+o.p+"'."),!1)}var se={execCommandCopy:function(){var e;try{e=document.execCommand(o.j,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456262,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(o.p,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456263,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},setData:oe,browserExtensionCopy:function(e){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:o.gb},ce={execCommandCopy:function(){if(Q(),!ie())return!1;try{document.execCommand(o.j,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456267,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},execCommandCut:function(){if(Q(),!ie())return!1;try{document.execCommand(o.p,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456268,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},setData:ne,browserExtensionCopy:function(e){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:o.hb},le={execCommandCopy:function(){var e=!1;try{void 0===(e=document.execCommand(o.j,!1,null))&&(e=!0)}catch(e){Object(o.dc)().ULS.traceTag(596455647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},execCommandCut:function(){var e=!1;try{void 0===(e=document.execCommand(o.p,!1,null))&&(e=!0)}catch(e){Object(o.dc)().ULS.traceTag(596455648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},setData:function(e,t,r,a){var i=!1;try{var s=ae(r);if(!s||!re(s))return Object(o.dc)().ULS.traceTag(596455649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: setData - programmatic "+o.j+" and "+o.p+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;void 0===(i=s.setData(e,t))?i=!0:i||Object(o.dc)().ULS.traceTag(596455650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: setData returned false for '"+e+"'.")}catch(t){Object(o.dc)().ULS.traceTag(596455651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: setData with '"+e+"' threw an exception: "+n.utils.getStringifiedError(t))}return i},browserExtensionCopy:function(e){return ee(e)},defaultClipboardDataFormat:o.gb},de=void 0;function ue(e,t,r,a){return ge().setData(e,t,r,a)}function ge(){return void 0===de&&(de=Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:4327216_RemovingCutCopyByChromeExtension")?se:Z()?le:se),de}function pe(e){if(!e||!e.items)return Promise.reject(new o.G(o.H.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined="+!e+" clipboardData.items is undefined="+!e.items));for(var t=function(t){if("file"===e.items[t].kind){var r=n.perfWatch.start("ImageFile_Read_From_Clipboard"),a=e.items[t].getAsFile(),i=a?a.size:-1,s=Object(o.U)(),c=new FileReader;return c.onload=function(){c.result?(n.perfWatch.success(r,(function(e){return Object(o.dc)().ULS.traceTag(595911452,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,fe(e,i))})),s.resolve(c.result.toString())):(n.perfWatch.failure(r,(function(e){return Object(o.dc)().ULS.traceTag(595911453,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,fe(e,i))})),s.reject(new o.G(o.H.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},c.onerror=function(){n.perfWatch.failure(r,(function(e){return Object(o.dc)().ULS.traceTag(595911454,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,fe(e,i))})),s.reject(new o.G(o.H.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},n.perfWatch.mark(r,"Starting_readAsDataURL"),c.readAsDataURL(a),{value:s.promise}}},r=0;r<e.items.length;r+=1){var a=t(r);if("object"==typeof a)return a.value}return Promise.resolve(o.ib)}function fe(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function me(e,t,r){if(Q(),!r&&!k()&&!B())return Object(o.dc)().ULS.traceTag(596456327,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData - programmatic "+o.D+" clipboard access is not supported. rawEvent is empty = "+!!t),Promise.resolve(o.ib);var a=G();if(!a||!re(a))return Object(o.dc)().ULS.traceTag(596456328,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData - "+o.D+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),r||(Object(o.dc)().ULS.shipAssertTag(596456329,n.LogCategory.msoulscat_ES_EWAJS,k()&&B(),"getData - programmatic "+o.D+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+k()+"'. isProgrammaticAccessSupported = '"+B()+"'. clipboardDataFormat = '"+e+"'"),H(),K()),Promise.resolve(o.ib);var i=e;i===o.gb&&(i=o.hb);var s=o.ib;try{(s=a.getData(i))||(s=o.ib),Object(o.dc)().ULS.traceTag(596456330,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('"+i+"') returned "+s.length+" characters")}catch(e){Object(o.dc)().ULS.traceTag(596456331,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData with '"+i+"' threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}if(!r&&k()&&(H(),s===o.ib)){if(oe(e,o.Vb,void 0))return me(e,void 0,!1).then((function(t){return t===o.ib?K():oe(e,o.ib,void 0),Promise.resolve(s)}));K()}return Promise.resolve(s)}Object(o.Kb)()&&(de=ce);var he={init:function(){},execCommandPaste:function(){var e;try{e=document.execCommand(o.D,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456322,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=o.ib;try{var i=ae(t);if(!i||!re(i))return Promise.resolve(a);if(e===o.Bb)return pe(i);(a=i.getData(e))||(a=o.ib),Object(o.dc)().ULS.traceTag(596456323,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('"+e+"') returned "+a.length+" characters")}catch(t){Object(o.dc)().ULS.traceTag(596456324,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+n.utils.getStringifiedError(t))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},be={init:function(){},execCommandPaste:function(){if(Q(),k()&&me(o.gb,void 0,!1),!B())return Object(o.dc)().ULS.traceTag(596456325,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard '"+o.D+"' access is not allowed in this session."),!1;try{document.execCommand(o.D,!1,null)}catch(e){Object(o.dc)().ULS.traceTag(596456326,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},getData:me,browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},Se={init:function(){!function(){var e=Fe().getChromeExtensionIds();if(0!==e.length){var t={command:"getAvailableCommands"};e.forEach((function(e){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)X[e]=t;else{var a=o.ib;r&&"message"in r&&"string"==typeof r.message&&(a=r.message),Object(o.dc)().ULS.traceTag(589947074,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - 'getAvailableCommands': browser extension '"+e+"' is not available. Error: "+a)}}))}))}}()},execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(o.D,!1,null))&&(e=!0)}catch(e){Object(o.dc)().ULS.traceTag(596455698,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},getData:function(e,t,r){var a=o.ib;try{var i=ae(t);if(!i||!re(i))return Promise.resolve(a);if(e===o.Bb)return pe(i);(a=i.getData(e))||(a=o.ib),Object(o.dc)().ULS.traceTag(596455699,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: getData('"+e+"') returned "+a.length+" characters")}catch(t){Object(o.dc)().ULS.traceTag(596455700,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+n.utils.getStringifiedError(t))}return Promise.resolve(a)},browserExtensionPaste:function(){return te()}},Ce=void 0;function ye(){return void 0===Ce&&(Ce=Z()?Se:he),Ce}Object(o.Kb)()&&(Ce=be);function ve(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function Ee(e,t,r){void 0===r&&(r=void 0),Object(o.dc)().ULS.shipAssertTag(596444114,n.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===o.ib),"enableClipboardEvents: useTextHtmlContentCandidate = '"+t+"', textHtmlContentCandidate is "+(r||r===o.ib?o.ib:"not ")+"provided");var a=document.activeElement&&document.activeElement.id;a||Object(o.dc)().ULS.traceTag(595719625,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=Te();r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement("div");return function(e){e.id="ccpContentEditable",e.contentEditable="true",Pe()&&(e.contentEditable="false");e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(o.dc)().ULS.assertTag(595957699,n.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element 'ccpContentEditable'. it should be covered by other elements")}}(e),document.body.appendChild(e),e}());var a=t;e?a||(a=o.ib):a=Ie().outerHTML;return r.innerHTML=a,r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&we(!0),a}function we(e){if(Pe()){var t=Te();t&&(t.contentEditable=e?"true":"false")}}function Le(){var e=Te();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(o.dc)().ULS.traceTag(595957534,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: "+n.utils.getStringifiedError(e)),!1}}function Te(){return document.getElementById("ccpContentEditable")}function _e(){var e=Te();e&&(e.innerHTML=Ie().outerHTML)}function Ie(){var e=document.createElement("span");return e.innerText=o.Ub,e}function Pe(){return!Object(o.Kb)()}var Oe=function(){function e(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=o.g.SystemClipboard,this.disposableImplementationExtension=Object(o.W)("SystemClipboardStorage"),function(){if(Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:4307320_UseTheNewChromExtensionApi"))ye().init()}()}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.dc)().ULS.traceTag(596449096,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '"+e.isKeyboardEvent+"'"),e.skipSystemClipboardAccess){Object(o.dc)().ULS.traceTag(596124883,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(o.O)(document,o.E,(function(e){return t.skipSystemClipboardPasteHandler(e,r)}),!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(o.rb)())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '"+a.id+"', representing an active "+o.D+" event. Scheduling a rejection to execute after the current operation.";Object(o.dc)().ULS.traceTag(596455680,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),window.setTimeout((function(){a.reject(new o.e(o.f.RejectingPendingPastePromiseDueToNewPasteOperation,i))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(o.U)();this.lastDeferredPastePromise=s;var c=s.id,l=Object(o.O)(document,o.E,(function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,l)}),!0);this.removeLastPasteEventListenerCallback=l,this.selectedRangeToRestore=ve(),this.activeElementIdToRestore=Ee(!0,!1);try{var d=!1;if(e.isKeyboardEvent||(d=ye().execCommandPaste()),e.isKeyboardEvent);else if(!d)return this.clearPasteCallbackConfiguration(s,!0,!0),ye().browserExtensionPaste().then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"document.execCommand("+o.D+") failed in SystemClipboard.get. Deferred promise id = '"+c+"'",r))}))}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",e))}return s.promise.then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Object(o.Fb)(r,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",r))}))},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.dc)().ULS.traceTag(596449097,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '"+r.isKeyboardEvent+"'; cutCopyPasteFlags = '"+r.commandType+"'"),Object(o.dc)().ULS.shipAssertTag(595932513,n.LogCategory.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(o.Kb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&k())return Object(o.dc)().ULS.traceTag(596455681,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!k()&&!B())return Object(o.dc)().ULS.traceTag(596455682,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '"+i.id+"', representing an active "+o.p+"/"+o.j+" event. Scheduling a rejection to execute after the current operation.";Object(o.dc)().ULS.traceTag(596455683,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s),window.setTimeout((function(){i.reject(new o.e(r.isKeyboardEvent?o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:o.f.RejectingBlockedSyncCutCopyPromise,s))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var c=Object(o.U)();this.lastDeferredCutCopyPromise=c;var l,d=c.id;try{var u=Object(o.sb)(t),g=e.getClipboardCutCopyEventType(r.commandType),p=Object(o.O)(document,g,(function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,c,u,r.isKeyboardEvent,r.commandType,p)}));this.removeLastCutCopyEventListenerCallback=p;var f=o.ib;Object(o.Kb)()&&(f=Object(o.kb)(u,o.cc)),this.selectedRangeToRestore=ve(),this.activeElementIdToRestore=Ee(!1,!!f,f);var m=!1;if(Object(o.Kb)()&&r.isKeyboardEvent||(m=r.commandType===o.r.Cut?ge().execCommandCut():ge().execCommandCopy()),r.isKeyboardEvent);else if(!m)return this.clearCutCopyCallbackConfiguration(c,!0,!0),!Object(o.Kb)()||k()||B()?(l=t.getData(),ge().browserExtensionCopy(l)).then((function(){r.isTimestampStoredInSystemClipboard=!0,c.resolve()}),(function(e){return c.resolve(),r.silentClipboardAccessFailures?(Object(o.dc)().ULS.traceTag(596455685,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Failed to programmatically clear/set the clipboard via a browser extension. silentClipboardAccessFailures is on. Deferred promise id = '"+d+"'. Error: "+n.utils.getStringifiedError(e)),Promise.resolve()):Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"browserExtensionCopy for '"+(r.commandType===o.r.Cut?o.p:o.j)+"' failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))})):(Object(o.dc)().ULS.traceTag(596455684,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '"+d+"'"),c.resolve(),Promise.resolve())}catch(e){return this.clearCutCopyCallbackConfiguration(c,!0,!1),Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))}return c.promise.catch((function(e){return e&&Object(o.Gb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.cc,o.Bb]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var c=this;try{if(Object(o.dc)().ULS.traceTag(596449098,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'; bubbles = '"+e.bubbles+"'; eventPhase = '"+e.eventPhase+"'"),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(o.dc)().ULS.shipAssertTag(596455686,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'"),!t)return;if(Object(o.dc)().ULS.traceTag(596455687,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'; deferred promise id = '"+t.id+"'"),Object(o.dc)().ULS.shipAssertTag(596455688,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'"),t.fulfilled())return;var l=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},d=Object(o.kb)(r,o.cc);if(d&&Object(o.Kb)())window.setTimeout(l,0);else{d&&ue(o.cc,d,e,a);var u=Object(o.ob)(r);ue(ge().defaultClipboardDataFormat,u,e,a),e.preventDefault(),l()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(o.dc)().ULS.traceTag(596455689,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '"+(t?t.id:o.ib)+"' (fulfilled = '"+(t?t.fulfilled():o.ib)+"') failed with this exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA")),t&&t.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a){var i=this,s=!0;try{if(Object(o.dc)().ULS.traceTag(596449099,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; eventPhase='"+e.eventPhase+"'"),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(o.dc)().ULS.shipAssertTag(596455690,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+r+"'"),!t)return;if(Object(o.dc)().ULS.traceTag(596455691,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; deferred promise id = '"+t.id+"'"),Object(o.dc)().ULS.shipAssertTag(596455692,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+r+"'"),t.fulfilled())return;var c=Object(o.Q)(),l=this.getSupportedDataFormats(),d=this.readDataFormats(l,e,r,c);Promise.all(d).then((function(){e.stopPropagation(),s=!1,Object(o.Kb)()?window.setTimeout((function(){var e,r=document.getElementById("ccpContentEditable");if(r&&r.firstChild&&"IMG"===r.firstChild.nodeName){var a=r.firstChild;a&&a.src&&a.src.indexOf("base64")>-1?c.setItem(o.Bb,a.src):Object(o.dc)().ULS.traceTag(595907107,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else c.setItem(o.cc,(e=Te(),Object(o.dc)().ULS.shipAssertTag(596444113,n.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?e.innerHTML:o.ib)),o.Ab.isContainsTimestampWrapper(r)&&c.setItem(o.gb,o.Ab.createPlainTextFromHtml(r));Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3884146_FixForLayoutChangeAfterPaste")&&_e(),t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1)}),0):(e.preventDefault(),Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3884146_FixForLayoutChangeAfterPaste")&&_e(),t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3884146_FixForLayoutChangeAfterPaste")&&_e();try{s&&e.stopPropagation(),e.preventDefault()}catch(e){Object(o.dc)().ULS.traceTag(595985030,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: "+n.utils.getStringifiedError(e))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(o.dc)().ULS.traceTag(596455693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '"+(t?t.id:o.ib)+"' (fulfilled = '"+(t?t.fulfilled():o.ib)+"') failed with an exception: "+(r&&r.message?r.message:"NA")+". Call stack: "+(r.stack?r.stack:"NA")),t&&t.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(r&&r.message?r.message:"NA"),r))}},e.prototype.isFileFormat=function(e){return e===o.Bb},e.prototype.isPlainTextEmpty=function(e){var t=e.getItem("text/plain");return!t||0===t.length},e.prototype.readDataFormats=function(e,t,r,a){var i=this;if(!this.skipFilesIfPlainTextExists)return this.readDataFormatsInternal(e,t,r,a);var s=e.filter((function(e){return i.isFileFormat(e)}));if(0===s.length)return this.readDataFormatsInternal(e,t,r,a);var c=e.filter((function(e){return!i.isFileFormat(e)})),l=this.readDataFormatsInternal(c,t,r,a);return[Promise.all(l).then((function(){if(!i.isPlainTextEmpty(a))return Object(o.dc)().ULS.traceTag(595653317,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();var e=i.readDataFormatsInternal(s,t,r,a);return Promise.all(e)}))]},e.prototype.readDataFormatsInternal=function(e,t,r,a){var i=[];return e.forEach((function(e){i.push(function(e,t,r){return ye().getData(e,t,r)}(e,t,r).then((function(t){a.setItem(e,t)})).catch((function(t){Object(o.dc)().ULS.traceTag(595653318,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type ["+e+"]. Error ["+n.utils.getStringifiedError(t)+"]")})))})),i},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(o.dc)().ULS.traceTag(595993058,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(o.gb)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Zb)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return o.k;if(e===o.r.Copy)return o.k;if(e===o.r.Cut)return o.q;throw new o.t(o.ib,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(o.dc)().ULS.shipAssertTag(595957697,n.LogCategory.msoulscat_ES_EWAJS,!Le(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(o.dc)().ULS.traceTag(596449290,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.set: the "+o.p+"/"+o.j+" event listener was not called. Calling removeLastCutCopyEventListenerCallback()"),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),we(!1),Object(o.dc)().ULS.shipAssertTag(595957698,n.LogCategory.msoulscat_ES_EWAJS,!Le(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(o.dc)().ULS.traceTag(596449291,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.get: the "+o.D+" event listener was not called. Calling removeLastPasteEventListenerCallback()"),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=Object(o.rb)(),t={isKeyboardEvent:!1,commandType:o.r.Copy};this.set(e,t).then((function(){Object(o.dc)().ULS.traceTag(595935906,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(function(){Object(o.dc)().ULS.traceTag(595935907,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))},e}(),Ae=function(e){function t(t){return e.call(this,o.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return Object(c.__extends)(t,e),t}(o.h),xe=function(){function e(){this.clipboardStorageType=o.g.InMemory,this.disposableImplementationExtension=Object(o.W)("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(o.rb)())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.cc,"data/shadow-workbook"]},e}(),je=function(e){function t(t){return e.call(this,o.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),De=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(o.W)(""+e)}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((function(e){return r.systemClipboardStrategy=e,t.then((function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)}))}))},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Object(o.S)(o.Ub,"setresult",!1),fullAccessClipboardOperationResult:Object(o.S)(o.Ub,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Gb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)})).then((function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return Object(o.dc)().ULS.traceTag(595933078,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '"+(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType)+"', Command Id: '"+(t.id?t.id:o.ib)+"', Error: "+n.utils.getStringifiedError(e)),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)})):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))})).then((function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new o.e(o.f.SetClipboardItems,o.ib))}return Promise.resolve()}))}catch(e){return Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(o.S)(o.Ub,"getresult",!1,void 0,Object(o.pb)()),fullAccessClipboardOperationResult:Object(o.S)(o.Ub,"getresult",!1,void 0,Object(o.pb)())};return this.systemClipboardStrategy.get(e).then((function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)})).catch((function(e){return r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Fb)(e,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.resolve(r)})).then((function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then((function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return Object(o.dc)().ULS.traceTag(595933079,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '"+(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType)+"', Command Id: '"+(e.id?e.id:o.ib)+"', Error: "+n.utils.getStringifiedError(a)),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)})):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))})).then((function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new o.e(o.f.GetClipboardItems,o.ib))}return 0===Object(o.nb)(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(o.Q)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(o.Hb)()&&!Object(o.Jb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)}))}catch(e){return Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(o.dc)().ULS.shipAssertTag(595882509,n.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))):Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new o.e(o.f.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Zb)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(o.dc)().ULS.traceTag(595719624,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard="+r+" ccpTimestampInFullAccessClipboard="+a),r?r>(a||0)?(We(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?(We(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){if(0===Object(o.nb)(e.systemClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData));if(0===Object(o.nb)(e.fullAccessClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData));var t=e.systemClipboardOperationResult.clipboardItemsData.items[o.gb],r=o.Ab.ensureOneLFPerNewLine(o.Ab.trimToLength(t)),a=e.fullAccessClipboardOperationResult.clipboardItemsData.items[o.gb];return r===o.Ab.ensureOneLFPerNewLine(o.Ab.trimToLength(a))?Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData)):r===Fe().getCopyToClipboardLatencyMessage()?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[o.Qb]=o.Sb,Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function We(e,t){e.items[o.Qb]=o.Sb,t&&(e.items[o.Rb]=o.Tb)}var Me=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(De),Ue=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},o.i.InMemory,t)||this}return Object(c.__extends)(t,e),t}(De),Re=function(e){function t(t){return e.call(this,o.g.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(function(e){function t(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new o.B(o.ib,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=Object(o.W)(r),a}return Object(c.__extends)(t,e),t.prototype.initialize=function(){var e=this;return this.innerInitialize().then((function(){return e}))},t.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.dc)().ULS.traceTag(595947538,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = "+e.isKeyboardEvent+"; silentClipboardAccessFailures = "+(e.silentClipboardAccessFailures||!1));var t=Object(o.R)(Object(o.ab)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((function(e){return e.clipboardItemsData?Promise.resolve(Object(o.Q)(e.clipboardItemsData)):Promise.resolve(Object(o.rb)())}))},t.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.dc)().ULS.traceTag(595947541,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = "+t.isKeyboardEvent+"; silentClipboardAccessFailures = "+(t.silentClipboardAccessFailures||!1)),r=Object(o.mb)(e)>0?Object(o.R)(Object(o.ab)(),"set",this.messageDestination,t.userHash,e.getData()):Object(o.R)(Object(o.ab)(),"set",this.messageDestination),this.postMessage(r,"set").then((function(){}))},t.prototype.clearClipboardNecessary=function(e,t){return Object(o.bc)(e,t)},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.cc,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(R));function Je(e,t,r,a,s){var c=function(e,t,r){return new w(e,t,r)}(r,a,s);return function(e,t,r){var a=o.s.NoError;return n.utils.chainFallbackPromises(e,(function(e){return function(e,t,r){Object(o.dc)().ULS.traceTag(595716231,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '"+e.clipboardStrategyType+"'");var a=function(){return function(){switch(e.clipboardStrategyType){case o.i.SystemClipboard:case o.i.SystemClipboardAndInMemory:return e;case o.i.SystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new o.K("createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for "+e.clipboardStrategyType)}}().skipFilesIfPlainTextExists},s=function(){switch(e.clipboardStrategyType){case o.i.LocalStorage:return e;case o.i.SystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new o.K("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for "+e.clipboardStrategyType)}},c=function(e){return r.createClipboardDataProcessor(e)},l=function(){return r.createClipboardMetaDataProcessor()},d=function(e){return r.createDualClipboardDataProcessor(e)},g=function(){return new F},p=function(e){return function(e){return new J(e)}(e)},f=function(){var e=s();return e.useSharedClipboardIframe?g():p(Object(o.vb)(e.sharedClipboardSchemaVersion))},m=function(){return(new N).initialize(Promise.resolve((e=a(),new Oe(e))));var e},h=function(e){return function(e){return new Ae(e)}(e).initialize(Promise.resolve(new xe))},b=function(e,t){var r,a,n=s();return n.useSharedClipboardIframe?(function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId);var r=e.sharedClipboardOverrideOrigin?1:0;o.ac.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),i(t)}(n),function(e){return new je(e)}(t).initialize((r=e?o.z.localStorageMetadata:o.z.localStorageData,new Re(r)).initialize())):function(e){return new o.x(e)}(t).initialize(Promise.resolve((a=e?Object(o.ub)(n.sharedClipboardSchemaVersion):Object(o.tb)(n.sharedClipboardSchemaVersion),new o.w(a))))},S=function(e,r,a){return Promise.all([e,r]).then((function(e){var r=e[0];return function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then((function(){return u(e,t,r)}))}(e[1],a).then((function(e){return{dataClipboardStrategy:r,metadataManager:e}}))}))};try{switch(e.clipboardStrategyType){case o.i.SystemClipboard:return S(m(),h(l()));case o.i.InMemory:return S(h(c(!1)),h(l()));case o.i.LocalStorage:return S(b(!1,c(!0)),b(!0,l()),f());case o.i.SystemClipboardAndLocalStorage:return S((C=d(!0),new Me(C)).initialize(m(),b(!1)),b(!0,l()),f());case o.i.SystemClipboardAndInMemory:return S(function(){return(e=d(!1),new Ue(e)).initialize(m(),h());var e}(),h(l()))}return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '"+e.clipboardStrategyType+"' is not supported"))}catch(t){return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '"+e.clipboardStrategyType+"' with error: "+n.utils.getStringifiedError(t)))}var C}(e,t,r).then((function(t){return Object(o.dc)().ULS.traceTag(595716294,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '"+e.clipboardStrategyType+"' was created."),t.infraInitializationError=a,t})).catch((function(t){if(t&&t.innerError&&"string"==typeof t.innerError)try{JSON.parse(t.innerError).reason===o.f.LocalStorageInitilizationInaccessible&&(a=o.s.LocalStorageInaccessible)}catch(e){}var r="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '"+e.clipboardStrategyType+"'. Error: "+n.utils.getStringifiedError(t);return Object(o.dc)().ULS.traceTag(595716230,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,r),Promise.reject(new o.e(o.f.SelectClipboardStrategy,r,t))}))}))}(e,t,c).then((function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:c,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}}))}function Fe(){return ke}var Ne;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(Ne||(Ne={}));var ze={initializationStatus:Ne.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:o.ac.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:o.s.NoError},ke={init:function(e,t,r,a,i,s,c,l,d,u,g,p,f,m,h,b,S,C){if(ze.lastClipboardPlatformEnvironmentInitializationInfo)return Promise.resolve(ze.lastClipboardPlatformEnvironmentInitializationInfo);e&&Object(n.initEwaUtils)(e);if(Object(o.Db)(t),!r||!Array.isArray(r))return Promise.reject(new o.B(o.ib,"chromeExtensionIds"));Object(o.dc)().ULS.traceTag(596455702,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '"+JSON.stringify(r)+"'"),ze.chromeExtensionIds=Be(r),g&&(ze.copyToClipboardLatencyMessage=g);"number"!=typeof u||isNaN(u)||(ze.clipboardPromiseTimeoutInMinutes=u);return ze.initializationStatus=Ne.StateReady,Je(m,f,h,b,S).then((function(e){return ze.clipboardDataManager=e.clipboardDataManager,ze.metadataManager=e.metadataManager,ze.clipboardStrategy=e.dataClipboardStrategy,ze.initializationError=e.infraInitializationError,ze.initializationStatus=Ne.InitializationSucceed,ze.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:m,dataClipboardCapabilities:ze.clipboardStrategy&&ze.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:ze.clipboardStrategy&&ze.clipboardStrategy.clipboardStrategyType,infraInitializationError:ze.initializationError},ze.lastClipboardPlatformEnvironmentInitializationInfo}))},getClipboardStrategy:function(){if(He(),!ze.clipboardStrategy)throw new o.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return ze.clipboardStrategy},getChromeExtensionIds:function(){return Ve(),ze.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return Ve(),ze.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return Ve(),ze.copyToClipboardLatencyMessage},getMetadataManager:function(){return He(),ze.metadataManager},getClipboardDataManager:function(){return He(),ze.clipboardDataManager},getInitializationError:function(){return He(),ze.initializationError}};function He(){if(ze.initializationStatus!==Ne.InitializationSucceed)throw new o.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function Ve(){if(ze.initializationStatus<Ne.StateReady)throw new o.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}function Be(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var o=a[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}r.d(t,"createClipboardItems",(function(){return o.Q})),r.d(t,"getClipboardPlatformEnvironment",(function(){return Fe}))},7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,o){return t.traceTag(e,r,a,o)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,o){return t.debugTraceTag(e,r,a,o)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,o){return t.assertTag(e,r,a,o)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,o){return t.shipAssertTag(e,r,a,o)}}}}};var a=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=a;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=o}});
//# sourceMappingURL=clipboardPlatform.min.js.map