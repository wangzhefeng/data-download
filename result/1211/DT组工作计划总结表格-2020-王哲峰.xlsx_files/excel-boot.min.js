var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=23)}({23:function(e,t,i){"use strict";i.r(t);var n,o,r,s=function(){function e(){}return e.prototype.u=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();(o=n||(n={}))[o.Error=10]="Error",o[o.Warning=15]="Warning",o[o.Info=50]="Info",o[o.Verbose=100]="Verbose",o[o.Spam=200]="Spam",function(e){e[e.h=0]="msoulscat_ES_EWAJS",e[e.v=1]="msoulscat_ES_EWAJSGrid",e[e.g=6]="msoulscat_ES_EWAJSChart",e[e.O=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=301]="msoulscat_Wac_WordViewer",e[e.A=306]="msoulscat_Wac_BrowserGeneral",e[e.P=320]="msoulscat_Wac_TaskPane",e[e.R=339]="msoulscat_Wac_OneNoteGeneral",e[e.U=340]="msoulscat_Wac_Ribbon",e[e.N=379]="msoulscat_Wac_WopiPendingApplication",e[e.F=383]="msoulscat_Wac_Telemetry",e[e.W=391]="msoulscat_Wac_WacCatchUpActivities",e[e.k=394]="msoulscat_Wac_Dictation",e[e.H=395]="msoulscat_Wac_OneNoteSync",e[e.B=700]="msoulscat_Wac_VisioApp",e[e.J=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.j=800]="msoulscat_Wac_PptAnimation",e[e.q=833]="msoulscat_Wac_PptLive",e[e.Z=834]="msoulscat_Wac_PptMWeb",e[e.$=815]="msoulscat_Wac_PptShape",e[e.X=817]="msoulscat_Wac_PptSession",e[e.K=830]="msoulscat_Wac_PptSlideshow",e[e.Y=2300]="msoulscat_Wac_VersionHistory",e[e.ee=302]="msoulscat_Wac_WordPresence",e[e.te=3005]="msoulscat_Wac_WordVersionHistory",e[e.ie=3006]="msoulscat_Wac_LivePersonaCard",e[e.ne=3012]="msoulscat_Wac_CatchUpFlyout",e[e.oe=3021]="msoulscat_Wac_ModernFontPicker"}(r||(r={}));var a;(function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,i,n){return"tag_"+e.tagIntToString(t)+" ["+r[i]+"] "+n},e.prototype.u=function(t,i,o,r){var s=this.logMessage;switch(o){case n.Error:s=this.logError;break;case n.Warning:s=this.logWarning;break;case n.Info:s=this.logInfo;break;case n.Verbose:s=this.logVerbose;break;case n.Spam:default:s=this.logMessage}try{s(e.getLogMessage(t,i,r))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,i,n,o){console.assert(n,e.getLogMessage(t,i,o))},e.prototype.debugAssertTag=function(e,t,i,n){this.shipAssertTag(e,t,i,n)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function e(){this.externalLogger=new s}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.u=function(e,t,i,n){this.externalLogger.u(e,t,i,n)},e.prototype.debugAssertTag=function(e,t,i,n){this.externalLogger.debugAssertTag(e,t,i,n)},e.prototype.shipAssertTag=function(e,t,i,n){this.externalLogger.shipAssertTag(e,t,i,n)},e}());function c(e,t,i){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}}function u(e,t,i,n){var o=e.map((function(e){return function(e,t){var i={};i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category;var n=1e3*e.type+e.level;return i.D=n,i}(e,n)})),r=function(e,t,i,n){var o={};return o.T=e,o.L=t,o.S=i,o.I=n,o.V=1,o}(n,o,t,i);return JSON.stringify(r)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(a||(a={}));!function(){function e(t,i){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,i){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,c(u(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,i),n.logCache=[],n.timestampBase=Date.now());t&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=i+"?usid="+t,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===n.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}();n.Info;var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};var h=function(){return(h=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var d;!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(function(e,t){function i(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(t,e)}(s);function l(){if(null!=navigator&&null!=navigator.userAgent){var e=navigator.userAgent;if(e.indexOf("Firefox")>-1)return d.Firefox;if(e.indexOf("Opera")>-1)return d.Opera;if(e.indexOf("Trident")>-1)return d.IE;if(e.indexOf("Edge")>-1)return d.Edge;if(e.indexOf("Chrome")>-1)return d.Chrome;if(e.indexOf("Safari")>-1)return d.Safari}return d.Unknown}function p(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function v(){try{return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&S()&&!(navigator.userAgent.indexOf("iPhone")>=0)||navigator.userAgent.indexOf("Android")>=0||S()}catch(e){return!1}}function m(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function w(){return l()===d.IE&&!function(){if(l()!==d.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function g(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function S(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.Unknown=6]="Unknown"}(d||(d={}));function I(e){return 8===e.toLowerCase().indexOf("ffc")}function b(e){return 8===e.toLowerCase().indexOf("ppc")}function y(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function C(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function O(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function _(e){return e+"RemoteUls.ashx"}function T(e,t,i){i&&(e[t.toLowerCase()]=i)}function A(e,t){var i=e.indexOf("&"+t+"=");if(-1===i&&(i=e.indexOf("?"+t+"=")),-1===i)return"";var n=i+(t.length+2),o=e.indexOf("&",n);return e.substring(n,-1===o?void 0:o)}function P(e,t,i,n){if(void 0===n&&(n=!1),!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,r);if("?"!==s&&c>=0){if(n){var u=o.indexOf("&",c);o=o.substring(0,c)+a+i+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,i)}function E(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function R(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),i=e.lastIndexOf("/",t);if(-1!==i&&i+1===e.indexOf("://")+"://".length)return"";i+=1;var n=e.indexOf("?");if(-1!==(n=n>=t?-1:n)&&i>n)return"";var o=-1===n?t:n;return i>=o?"":e.substring(i,o)}function U(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function N(e){return/[?&]new=1\b/i.test(e)}function F(e,t){return{shouldPreload:function(t){return e(t)},preload:function(e,i,o,s){t(e,i,s).forEach((function(e){!function(e,t,i,o,s){var a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=W,a.href=e,t){var c=i||R(e);t.ULS.u(592315601,r.N,n.Info,"Preloading resource: "+c);a.addEventListener("error",(function(){t.ULS.u(592479445,r.N,n.Error,"Resource failed to load: "+c)}))}a.setAttribute("as","script"),o&&a.setAttribute("integrity",o);document.head.appendChild(a),s&&a.addEventListener("load",s,{once:!0})}(e[0],o,void 0,e[1])}))}}}var x,W=(x=l())===d.Firefox||x===d.IE?"prefetch":"preload";var k,M={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(k||(k={}));var H,D=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function B(){return D?window.performance.now():Date.now()}function J(){if(!H){var e=window.performance;H=D&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return H()}var L,j,V=function(){function e(e){var t=this;this.re=3e4,this.se=30,this.ae=0,this.ce=[],this.ue=J(),this.fe="",this.he=0,this.flushOnClose=function(){t.le(!1,!1)},this.flush=function(){t.pe()},this.pe=function(){window.setTimeout((function(){return t.le(!0,!0)}),0)},this.le=function(e,i){var n=B();if(window.clearTimeout(t.ve),t.me){if(t.ce.length>0)t.ae+=1,c(u(t.ce.splice(0,e?t.se:t.ce.length),t.fe,t.ae,t.ue),t.me,i),t.ue=J();e&&(t.ve=window.setTimeout(t.pe,t.ce.length>t.se?1e3:t.re)),t.he+=B()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.he},e.prototype.addLoggingTime=function(e){this.he+=e},e.prototype.configure=function(e){var t=this,i=B();if(e.uploadCadenceInMs&&(this.re=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.se=e.uploadTriggerSize),e.sessionId&&(this.fe=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.me)throw new Error("Remote ULS endpoint is already set");this.me=e.remoteUlsEndpoint+"?usid="+this.fe,this.ue=J(),window.setTimeout((function(){return t.le(!0,!0)}),0)}this.he+=B()-i},e.prototype.handleTrace=function(e){var t=B();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.ce.push(e),(this.ce.length>this.se||e.level===n.Error)&&this.pe(),this.he+=B()-t},e}(),q=[];!function(e){e.we="BootstrapperMaxUlsHeartbeatTime",e.ge="BootstrapperNoCompleteWarning1Time",e.Se="BootstrapperNoCompleteWarning2Time",e.Ie="RemoteUlsETag",e.be="RemoteUlsSuppressions",e.ye="BootstrapperSettingsFetchPeriod",e.Ce="timestamp",e.Oe="BootstrapperUlsHeartbeatIntervalMs",e._e="BootstrapperUlsHeartBeatIsEnabled",e.Te="BootstrapperUlsUploadCadenceMs",e.Ae="WordConsumptionViewToEditRedirectIsEnabled"}(j||(j={}));var z;function G(e){var t=new V(e);function i(e,i,n,o){var r=B();if(!function(e){return 1===q[e]}(e)){var s={timestamp:J(),category:i,tag:e,level:n,type:a.Trace,message:o};t.addLoggingTime(B()-r),t.handleTrace(s)}}return{ULS:{u:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,o,r){o&&i(e,t,n.Error,r)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.Pe.getValue(j.be,""),n=e.Pe.getValue(j.Ie,""),L&&n===L||(q=[],L=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(q[t]=1)}))),t.configure({uploadCadenceInMs:e.Pe.getValue(j.Te,6e4)})},getTimeSpentLogging:function(){return t.getTimeSpentLogging()}}}!function(e){e.Ee="EnterpriseTemplates",e.Re="ExcelAdaptiveLayoutDownload",e.Ue="ExcelJsApiV2",e.Ne="ExcelJsApiV2NoWrapper",e.Fe="ExcelLandingPageOfflineTelemetry",e.xe="ExcelLandingPageObserverRetry",e.We="H2StaticContent",e.ke="HashedUrl",e.Me="ODCShareLinkPreload",e.He="OfficeComExcelJsApiV2",e.De="OfficeComUiHost",e.Be="OfficeComWordJsApiV2",e.Je="OfficeHwaUiHost",e.Le="WordJsApiV2",e.je="WordJsApiV2NoWrapper",e.Ve="WordViewToUnifiedRead"}(z||(z={}));var Z= "16.0.13607.31875";function $(){return Z}var X,K,Q;function Y(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}function ee(e,t){try{if(void 0===window.performance)return void t.ULS.u(595948609,r.N,n.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.u(595948610,r.N,n.Info,"No resources under performance");for(var o=new RegExp(e+"(-boot.min|(.(app|preview))?.boot).js","i"),s=i.length-1;s>=0;s-=1){var a=i[s],c=a.name.match(o);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void t.ULS.u(595948616,r.N,n.Info,u)}}t.ULS.u(595948484,r.N,n.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.u(595948617,r.N,n.Info,"Could not trace the resource timing: "+Y(e))}}function te(e){var t=h(h({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0}),i={};if(e.wdParams){var n=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){n[e]&&(i[e]=n[e])}))}var o=h({},e.rebootOverride);delete o.ackExpected,delete o["ui-language"],delete o.wdUserSession,delete o.rebootMode,delete o.documentUrl;var r=e.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",bootParams:e.bootParams,build:$(),host:t,intent:e.intent,jsApiVersion:"v2",rebootOverride:o,region:y(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,wdParams:i}}function ie(){var e={perfNowSupported:D,browser:d[l()],touchMode:v(),highContrast:m(),windows10x:g()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function ne(e,t,i){e.ULS.u(595957843,r.N,n.Info,"Page lifecycle: "+t+" fired"+(i?", flushing logger":"")),i&&e.ULS.flush()}function oe(e,t){X=function(){return ne(e,"OnBeforeUnload",t)},K=function(){return ne(e,"OnPageHide",t)},Q=function(){return ne(e,"VisibilityChange_"+document.visibilityState,t)},window.addEventListener("beforeunload",X,{capture:!0,once:!0}),window.addEventListener("pagehide",K,{capture:!0}),window.addEventListener("visibilitychange",Q,{capture:!0})}function re(){window.removeEventListener("beforeunload",X,{capture:!0}),window.removeEventListener("pagehide",K,{capture:!0}),window.removeEventListener("visibilitychange",Q,{capture:!0})}var se,ae;function ce(e,t,i,o){if(t.getValue(j._e,!1)){se=B();var s=e?3e3:5e3;ae=window.setInterval((function(){i.ULS.u(595724178,r.N,n.Info,"Boot_HeartBeat"),B()-se>t.getValue(j.we,3e5)&&(ue(),o&&o())}),t.getValue(j.Oe,s))}}function ue(){ae&&(window.clearInterval(ae),ae=void 0)}function fe(e,t){e.ULS.u(594901218,r.N,n.Warning,"Boot_NotComplete_"+(t||"Final")),e.ULS.flush()}function he(e){for(var t=0;t<e.length;t+=1)e[t]&&window.clearTimeout(e[t])}function de(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(!t)return;try{return t(e)}catch(e){i&&i.ULS.u(594883024,r.N,n.Error,"IsFeatureEnabled callback error: "+Y(e))}return}(i,e,t)}}}function le(e,t){var i={};if(Object.keys(z).forEach((function(t){var n=e.isFeatureEnabled(z[t]);void 0!==n&&(i[z[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[z.Ee]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}var pe,ve,me,we,ge,Se,Ie=function(){function e(){this.qe=[]}return e.prototype.add=function(e){e&&this.qe.push(e)},e.prototype.remove=function(e){if(e){var t=this.qe.indexOf(e);t>-1&&this.qe.splice(t,1)}},e.prototype.removeAll=function(){this.qe=[]},e.prototype.dispatch=function(e,t){this.qe.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),be=function(){function e(e,t){var i=this;this.ze=0,this.Ge=function(){if(i.Ze){var e=new XMLHttpRequest;e.open("GET",i.Ze),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.setSettingsOnIdle(e.response),i.ze=0):(i.$e.ULS.u(592836771,r.N,n.Error,"Fetch settings error. Status: "+e.status+", curErrors: "+i.ze),i.ze+=1),!(i.ze>7)){var t=i.getValue(j.ye,3e5);i.ze>3&&(t+=(i.ze-3+1)*(t/2)),i.Xe=window.setTimeout(i.Ge,t)}}}},this.Ke=e,this.Qe="Prod"+e+"Settings",this.$e=t,this.Ye=new Ie,this.getCurrentSettings()}return e.prototype.initializePeriodicFetch=function(e,t){this.Qe=(I(e)?"FF":"Prod")+this.Ke+"Settings",this.getCurrentSettings(),this.Ze=e+"AppSettingsHandler.ashx?app="+this.Ke+"&usid="+t+"&build="+$(),this.Xe||(this.Xe=window.setTimeout(this.Ge,3e4))},e.prototype.getValue=function(e,t){if(this.et||this.getCurrentSettings(),!this.et||!this.et.hasOwnProperty(e))return t;var i=this.et[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.Ye.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.Ye.remove(e)},e.prototype.dispose=function(){this.Xe&&window.clearTimeout(this.Xe),this.tt&&self.cancelIdleCallback(this.tt),this.Xe=void 0,this.tt=void 0,this.et=void 0,this.Ye.removeAll()},e.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(this.Qe);if(!e)return;var t=JSON.parse(e);this.updateCurrentSettings(t)}catch(e){this.$e.ULS.u(592836768,r.N,n.Warning,"Failed to get settings from localStorage: "+Y(e))}},e.prototype.updateCurrentSettings=function(e){var t=this;return!!this.isValidSettings(e)&&(this.et=e,this.Ye.dispatch({Pe:this},(function(e){t.$e.ULS.u(592836769,r.N,n.Error,"Settings listener error: "+Y(e))})),!0)},e.prototype.isValidSettings=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(j.Ce)&&!isNaN(e.timestamp))return!0;this.$e.ULS.u(592836770,r.N,n.Error,"Received invalid settings")}return!1},e.prototype.setSettingsOnIdle=function(e){var t=this;"requestIdleCallback"in window?(this.tt&&self.cancelIdleCallback(this.tt),this.tt=window.requestIdleCallback((function(){return t.setSettings(e)}),{timeout:1e4})):window.setTimeout((function(){return t.setSettings(e)}),0)},e.prototype.setSettings=function(e){if(this.updateCurrentSettings(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(this.Qe,t)}catch(e){this.$e.ULS.u(592836800,r.N,n.Warning,"Failed to set localStorage: "+Y(e))}}},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.handleBootState="handleBootState",e.postMessage="postMessage",e.rename="rename",e.setOverlayContent="setOverlayContent",e.switchMode="switchMode"}(pe||(pe={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.popState="popState",e.rename="rename",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.switchMode="switchMode"}(ve||(ve={})),function(e){e.nt="App_AccessibilityLoopComplete",e.ot="WacInitialize_Ready",e.rt="Wac_AppFailed",e.st="Wac_AppBootState",e.at="Wac_AppCompleted",e.ct="BrowserEvent",e.ut="UI_Close",e.ft="App_CloseTab",e.ht="UI_Conversation",e.dt="UI_CopyAndEdit",e.lt="App_CreateNewDocument",e.pt="Wac_AppDataSavedStatus",e.vt="UI_Download",e.wt="UI_Edit",e.gt="Error",e.St="UI_FileEmbed",e.It="UI_FileProperties",e.bt="File_Rename",e.yt="File_RenameFailed",e.Ct="UI_FileVersions",e.Ot="StateChanged",e._t="App_IsFrameTrusted",e.Tt="GetAccessToken",e.At="App_GetAuthToken",e.Pt="App_GetCustomAuthConfig",e.Et="App_WopiInfoFromUrl",e.Rt="App_LoadingStatus",e.Ut="App_SwitchMode",e.Nt="UI_OpenInBrowser",e.Ft="UI_OpenInClient",e.xt="PageChanged",e.Wt="App_PushCommentContext",e.kt="App_PushState",e.Mt="App_DocReboot",e.Ht="UI_RedeemForCommenting",e.Dt="App_RefreshSessionInfo",e.Bt="UI_ReplyWithChanges",e.Jt="UI_ReportAbuse",e.Lt="UI_SaveStatus",e.jt="WopiSession_Complete_Ack",e.Vt="SetOverlayContent",e.qt="UI_Sharing",e.zt="UI_ShareForm",e.Gt="UI_SignIn",e.Zt="App_Unloaded",e.$t="Wac_UnloadingApp",e.Xt="PageCount",e.Kt="UI_CheckUserAccessAndGrantPermissions",e.Qt="User_Activity",e.Yt="Edit_Notification",e.ei="UI_Workflow",e.ti="ZoomChanged"}(me||(me={})),function(e){e.ii="Ack",e.ni="WacInitialize_Ready_Ack",e.oi="Wac_BeforeUnloadApp",e.ri="Blur_Focus",e.si="Wac_AppFailed_Ack",e.ai="Wac_AppCompleted_Ack",e.ci="WopiStartSession_Complete",e.hi="WopiPendingSession_Complete",e.di="Host_AccessibilityLoopComplete",e._t="Host_IsFrameTrusted",e.li="Grab_Focus",e.pi="HostCacheDiagnostic",e.vi="JsApiDiagnostics",e.mi="PageChanged_Ack",e.wi="App_PopState",e.gi="Host_PostmessageReady",e.Si="File_Rename",e.Ii="PostAccessToken",e.bi="Host_SetAuthToken",e.yi="Host_SetCustomAuthConfig",e.Ci="App_PushCommentContext",e.Oi="CanEmbed",e._i="Host_RefreshSessionInfo",e.Ti="CheckUserAccessAndGrantPermissions_Result",e.Ai="Host_WopiInfoFromUrl",e.Pi="SetCurrentPage",e.Ei="SetZoomLevel",e.Ri="WopiPendingSession_Fail",e.Ui="SetOverlayContent",e.Ni="WopiPendingApplicationComplete_Received",e.Fi="Host_SwitchMode",e.xi="Host_Unload",e.Wi="PageCount_Ack",e.ki="ZoomChanged_Ack"}(we||(we={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.BootCompleted="BootCompleted",e.BrowserEvent="BrowserEvent",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Disposed="Disposed",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.ModeSwitched="ModeSwitched",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged"}(ge||(ge={}));var ye=((Se={})[ve.boot]={Mi:pe.boot},Se[ve.createNew]={Mi:pe.createNew},Se[ve.dispose]={Mi:pe.dispose},Se[ve.rename]={Mi:pe.rename},Se[ve.switchMode]={Mi:pe.switchMode},Se[me.st]={Mi:pe.handleBootState},Se[me.ft]={Mi:pe.closeTab},Se[me._t]={Mi:pe.frameTrust},Se[me.Mt]={Mi:pe.appReboot},Se[me.Vt]={Mi:pe.setOverlayContent},Se[ve.blurFocus]={Hi:we.ri},Se[ve.continueAccessibilityLoop]={Hi:we.di},Se[ve.grabFocus]={Hi:we.li},Se[ve.popState]={Hi:we.wi},Se[me.nt]={Di:ge.AccessibilityLoopCompleted},Se[me.ct]={Di:ge.BrowserEvent},Se[me.ut]={Di:ge.Close},Se[me.ht]={Di:ge.Conversation},Se[me.dt]={Di:ge.CopyAndEdit},Se[me.lt]={Di:ge.CreateNewDocument},Se[me.vt]={Di:ge.Download},Se[me.wt]={Di:ge.Edit},Se[me.gt]={Di:ge.Error},Se[me.It]={Di:ge.FileProperties},Se[me.bt]={Di:ge.FileRenamed},Se[me.Ct]={Di:ge.FileVersions},Se[me.Ot]={Di:ge.FrameStateChanged},Se[me.Ut]={Di:ge.ModeSwitched},Se[me.Nt]={Di:ge.OpenInBrowser},Se[me.Ft]={Di:ge.OpenInClient},Se[me.xt]={Di:ge.PageChanged},Se[me.kt]={Di:ge.PushState},Se[me.Ht]={Di:ge.RedeemForCommenting},Se[me.Bt]={Di:ge.ReplyWithChanges},Se[me.Jt]={Di:ge.ReportAbuse},Se[me.Lt]={Di:ge.SaveStatus},Se[me.qt]={Di:ge.Share},Se[me.zt]={Di:ge.ShareForm},Se[me.Gt]={Di:ge.SignIn},Se[me.Qt]={Di:ge.UserActivity},Se[me.Yt]={Di:ge.UserEditActivity},Se[me.ei]={Di:ge.Workflow},Se[me.ti]={Di:ge.ZoomChanged},Se[me.St]={Bi:{Di:ge.FileEmbed,Ji:ve.sendEmbeddedViewUrl,Li:we.Oi,ji:5e3}},Se[me.Tt]={Bi:{Di:ge.GetAccessToken,Ji:ve.sendAccessToken,Li:we.Ii}},Se[me.At]={Bi:{Di:ge.GetAuthToken,Ji:ve.sendAuthToken,Li:we.bi}},Se[me.Pt]={Bi:{Di:ge.GetCustomAuthConfig,Ji:ve.sendCustomAuthConfig,Li:we.yi,ji:5e3}},Se[me.Et]={Bi:{Di:ge.GetWopiInfoFromUrl,Ji:ve.sendWopiInfo,Li:we.Ai,ji:5e3}},Se[me.Dt]={Bi:{Di:ge.RefreshSessionInfo,Ji:ve.sendSessionInfo,Li:we._i,ji:5e3}},Se[me.Kt]={Bi:{Di:ge.UserAccessAndPermissions,Ji:ve.sendUserAccessAndPermissions,Li:we.Ti,ji:5e3}},Se);function Ce(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+Y(e))}}t.perfNow=D;for(var n=0;n<e.length;n+=1){try{if(D){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+Y(e))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}var Oe=function(){function e(e){var t=this;this.Vi=!1,this.qi=[],this.cancel=function(){t.Vi||(t.Vi=!0,t.qi.map((function(e){return e()})),t.qi=[])},window.setTimeout(this.cancel,e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.Vi},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){this.Vi?e():this.qi.push(e)},e}();function _e(e){return new Oe(e)}var Te=function(){function e(e,t,i,o,s,a,c){var u,f=this;this.pendingReboot=!1,this.skipWopiValidation=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.zi={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=f.zi[t];if(n&&n.length>0)f.Gi(t,i);else{var o=ye[t];if(o){var r=o.Mi,s=o.Di,a=o.Bi;r?f.Zi[r](t,i,f,f.$i[r]).catch((function(e){f.Xi(r,e)})):s?f.raiseEvent(s,i):a&&f.Ki(a,i)}}},this.Xi=function(e,t){f.logger.ULS.u(596459925,r.N,n.Error,e+" flow error: "+Y(t))},this.Gi=function(e,t){return f.zi[e].map((function(i){try{i(e,t)}catch(t){f.logger.ULS.u(596444186,r.N,n.Error,e+" action handler error: "+Y(t))}})),Promise.resolve({completion:"success"})},this.Qi=function(){var e=!1;return"Word"===f.appInfo.name?e=f.featureManager.isFeatureEnabled(z.je)||f.featureManager.isFeatureEnabled(z.Be):"Excel"===f.appInfo.name&&(e=f.featureManager.isFeatureEnabled(z.Ne)||f.featureManager.isFeatureEnabled(z.He)),e},this.Yi=function(e,t,i){f.Qi()?f.container&&f.container.postMessage(e,i):f.Zi[pe.postMessage](t,i,f,void 0)},this.Ki=function(e,t){var i=function(t,i){f.Yi(e.Li,e.Ji,i),n()},n=function(){f.removeActionHandler(e.Ji,i)};(f.addActionHandler(e.Ji,i),void 0!==e.ji)&&new Oe(e.ji).subscribe(n);f.raiseEvent(e.Di,t)},this.state=k.Unknown;var h=Ce(),d=h[0],l=h[1];this.logger=G(),this.logger.ULS.u(593506837,r.N,n.Info,JSON.stringify(l)),this.sessionId=d,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui,this.viewMode=e.viewMode,this.application=o,this.appInfo=t,this.session=s,this.featureManager=de(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.Pe=new be(t.name,this.logger),this.preloader=t.preloader,u=a(this.featureManager),this.Zi=u[0],this.$i=u[1],this.tn=c,this.Pe.addSettingsChangeListener(this.logger.settingsChangeHandler)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!0,configurable:!0}),e.prototype.raiseEvent=function(e,t){try{this.tn(e,t)}catch(e){this.logger.ULS.u(593506838,r.N,n.Error,"Event handler error: "+Y(e))}},e.prototype.addActionHandler=function(e,t){this.zi[e]||(this.zi[e]=[]),this.zi[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.zi[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var o=this,s=[],a=this.zi[e];if(a&&a.length>0)s.push(this.Gi(e,t));else{var c=ye[e];if(c){var u=c.Mi,f=c.Hi;if(u){var h=(0,this.Zi[u])(e,t,this,this.$i[u],i).catch((function(e){return o.Xi(u,e),{completion:"failure",error:e}}));s.push(h)}else f&&(this.Yi(f,e,t),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.u(593500189,r.N,n.Warning,"Unhandled command: "+e)}return Promise.race(s)},e.prototype.dispose=function(){if(this.Pe.dispose(),this.zi={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t&&e.splice(t,1)}},e}();var Ae,Pe=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(void 0===e)throw new TypeError("SessionInitParams");if(void 0===e.hostSessionId)throw new TypeError("HostSessionId")}(i);this.in=new Te(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.in.state=k.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.in.sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.in.diagnostics},enumerable:!0,configurable:!0}),e.prototype.run=function(e,t,i){return this.in.run(e,t,i)},e.prototype.boot=function(e,t){return this.in.run(ve.boot,e,t)},e.prototype.dispose=function(e){return this.in.run(ve.dispose,void 0,e)},e}(),Ee=function(){function e(e,t,i){var o=this;this.nn="",this.on="",this.rn=!1,this.sn=!1,this.an=!1,this.cn=function(e){var t=!1,i=!0,s="",a=!1;if(o.un&&(t=!0,i=e.source===o.un),e.origin&&(a=(s=O(e.origin,2).toLowerCase())===o.on),!o.rn&&(!o.sn||a&&i)||o.$e.ULS.u(593232850,r.N,n.Info,"Window: available["+t+"] valid["+i+"]; Origin: valid["+a+"] expected["+o.on+"] actual["+s+"]"),a&&(!o.an||i)){var c;try{c=JSON.parse(e.data)}catch(e){return void o.$e.ULS.u(593232851,r.N,n.Info,"Failed to parse event data: "+Y(e))}var u=c.MessageId;if(u)if(o.$e.ULS.u(593232854,r.N,n.Info,"Received message: "+u+", correlation: "+c.CorrelationId),u!==me.at&&u!==me.Rt||o.setTargetOrigin(e.origin),c.Values&&c.Values.ackExpected&&(o.$e.ULS.u(593232855,r.N,n.Info,"Sending Ack back"),o.postMessage(we.ii,void 0,c.CorrelationId)),o.fn){o.$e.ULS.u(593232856,r.N,n.Info,"Processing message: "+u);try{o.fn(c)}catch(e){o.$e.ULS.u(594556386,r.N,n.Error,"Message handler error: "+Y(e))}}else o.$e.ULS.u(591933923,r.N,n.Error,"No message handler");else(o.rn||o.sn)&&o.$e.ULS.u(593232853,r.N,n.Info,"Missing message id")}},this.$e=t,this.setTargetOrigin(e),i&&this.setMessageHandler(i),window.addEventListener("message",this.cn,!1)}return e.prototype.setTargetOrigin=function(e){var t=C(e).toLowerCase();this.nn&&this.nn!==t&&this.$e.ULS.u(593232847,r.N,n.Warning,"Updating origin: ["+this.nn+"]->["+t+"]"),this.nn=t,this.on=O(t,2),this.rn=I(t),this.sn=b(t)},e.prototype.setTargetWindow=function(e,t){void 0===t&&(t=!1),this.un=e,this.an=t},e.prototype.setMessageHandler=function(e){this.fn=e},e.prototype.removeMessageHandler=function(){this.fn=void 0},e.prototype.postMessage=function(e,t,i){if(this.un){this.$e.ULS.u(593232849,r.N,n.Info,"Sending message: "+e);var o={MessageId:e,SendTime:J(),CorrelationId:i,Values:t};this.un.postMessage(JSON.stringify(o),this.nn)}else this.$e.ULS.u(593232848,r.N,n.Info,"Missing target to send message")},e.prototype.dispose=function(){window.removeEventListener("message",this.cn,!1),this.fn=void 0},e}();!function(e){e.hn="access_token",e.dn="access_token_ttl",e.ln="bundleSrc",e.pn="bundleStaleness",e.vn="DocID",e.mn="ETag",e.wn="feature_status",e.gn="fileExtension",e.Sn="fileGetUrl",e.In="fileName",e.bn="fileSize",e.yn="forceSLR",e.Cn="frameHeightPx",e.On="frameWidthtPx",e._n="highContrast",e.Tn="highDpi",e.An="host_diagnostics",e.Pn="hostName",e.En="huictrls",e.Rn="owner_id",e.Un="sc",e.Nn="softBlockedBrowser",e.Fn="templateUrl",e.xn="touchMode",e.Wn="user_id"}(Ae||(Ae={}));function Re(e,t){var i=C(t);e.setAttribute("allow","microphone "+i+"; camera "+i+";")}function Ue(e,t){T(t,Ae.Cn,String(e.offsetHeight)),T(t,Ae.On,String(e.offsetWidth)),T(t,Ae.xn,String(v())),T(t,Ae._n,String(m())),T(t,Ae.yn,String(g()))}function Ne(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.u(591525084,r.N,n.Info,"Trust check error: "+Y(t)),!1}}var Fe,xe=function(){function e(e,t){var i=this;this.kn=null,this.Mn=function(e){var t=e.target;i.kn=t.contentWindow,i.kn?i.Hn.setTargetWindow(i.kn):i.$e.ULS.u(592524689,r.N,n.Error,"Content window not available")},function(e){if(void 0===e||void 0===e.appendChild)throw TypeError("Container")}(e),this.Dn=e,this.Bn=t,this.Jn=t+"_Form",this.Ln=Ne()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Dn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Bn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.Jn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Ln},enumerable:!0,configurable:!0}),e.prototype.boot=function(e,t,i){this.$e=i,this.Hn=new Ee(e,i,this.fn),this.jn&&this.kn?(Re(this.jn,e),this.Hn.setTargetWindow(this.kn),this.$e.ULS.u(588793045,r.N,n.Info,"Reuse iframe and content window")):(this.jn=function(e,t,i,n){var o=e.ownerDocument.createElement("iframe");return o.id=t,o.name=t,o.src="",o.title="Office on the web Frame",o.width="100%",o.height="100%",o.marginWidth="0",o.marginHeight="0",o.style.left="0",o.style.top="0",o.style.right="0",o.style.bottom="0",o.style.display="block",o.style.position="absolute",o.style.backgroundColor="transparent",o.style.border="none",o.frameBorder="0",o.setAttribute("allowfullscreen","true"),o.setAttribute("allowTransparency","true"),Re(o,i),n&&o.addEventListener("load",n,{once:!0}),e.appendChild(o),o}(this.Dn,this.Bn,e,this.Mn),this.$e.ULS.u(588793046,r.N,n.Info,"Wac frame created")),Ue(this.jn,t),this.Vn=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Dn,this.Bn,this.Jn,e,t),this.Vn.submit()},e.prototype.setMessageHandler=function(e){this.fn=e,this.Hn&&this.Hn.setMessageHandler(e)},e.prototype.removeMessageHandler=function(){this.fn=void 0,this.Hn&&this.Hn.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Hn&&this.Hn.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.Vn&&(i.Dn.removeChild(i.Vn),i.Vn=void 0),i.Hn&&(i.Hn.dispose(),i.Hn=void 0,i.fn=void 0),i.$e=void 0,i.jn&&!e){var o=function(){i.Dn.removeChild(i.jn),i.jn=void 0,n()};t?o():(i.jn.src="about:blank",window.setTimeout(o,0))}else n()}))},e}(),We=function(){function e(e,t,i){var n=this;this.sessions=[],this.containers=[],this.qn=function(e){n.zn.dispatch(e)},function(e){if(void 0===e)throw new TypeError("ApplicationInitParams");var t=e.host;if(void 0===t||void 0===t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(void 0===i||void 0===i.id)throw new TypeError("UserInfo")}(e),this.Gn=e,this.Zn=t,this.$n=i,this.zn=new Ie,p()}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Zn.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return $()},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e){this.zn.add(e)},e.prototype.removeEventListener=function(e){this.zn.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_"+this.Zn.name+"_"+this.containers.length,i=new xe(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Pe(this.Gn,this.Zn,e,this,this.qn,this.$n);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.zn.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();!function(e){e.Unknown="Unknown",e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.CannotLoadScript="CannotLoadScript",e.PageChangeError="PageChangeError",e.ZoomChangeError="ZoomChangeError",e.CannotLoadBundleItem="CannotLoadBundleItem",e.InvalidPageIndex="InvalidPageIndex",e.UnsupportedBundleVersion="UnsupportedBundleVersion",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Fe||(Fe={}));function ke(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function Me(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(i){return e[i]=t.Diagnostics[i]}))}function He(e,t,i){t.ULS.u(596459999,r.N,i,"SessionTraces: "+JSON.stringify(e))}function De(e,t){t.Stop();var i=t.GetVisibilityChangeEvents();null!=i&&i.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),t.Dispose()}function Be(e,t,i){try{var o=function(e,t){var i=h({},t);delete i.UserId,delete i.OwnerId,delete i.WdParams;var n=i,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};return n.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){o[e]&&(n.WdParams[e]=o[e])})),n.UiEmbedMode=e.toLowerCase().indexOf("uiembed=1")>=0,n.UiHostName=A(e,"uih")||"N/A",n.HostDomain=location?location.hostname:"",n}(t.applicationUrl,t.sessionInformation);o.Build=$(),o.Region=y(t.applicationUrl);var s=h({},t.rebootOverrideData);delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl,o.RebootOverride=s,t.diagnostics.HostInitDiagnostics&&(e.ULS.u(596444238,r.N,n.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),o.SessionOrigin=t.diagnostics.HostInitDiagnostics.entryPoint),i&&e.ULS.u(595937313,r.N,n.Info,JSON.stringify(i)),e.ULS.u(595632928,r.N,n.Info,function(){if(window&&window.navigator){var e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());var a=t.wopiInfo;a&&a.AccessToken&&a.AccessTokenExpiry||e.ULS.u(595894553,r.N,n.Warning,"There are some missing parameters"),a&&(a.AccessToken&&(o.AccessTokenLength=a.AccessToken.length),o.AccessTokenExpiry=a.AccessTokenExpiry);var c=z.Ue;o.JsApiVersion=t.featureManager.isFeatureEnabled(c)?"v1Wrapper":"v1",e.ULS.u(596444237,r.N,n.Info,JSON.stringify({session:o,client:ie()}))}catch(t){e.ULS.u(590915460,r.N,n.Error,"Failed to log initialization info: "+Y(t))}}function Je(e){if("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&window===top)return navigator.virtualKeyboard.overlaysContent=e}var Le,je=function(e,t,i,n,o){return new Promise((function(e){Je(t.overlayContent),i.container&&i.container.postMessage(we.Ui,void 0),e({completion:"success"})}))};function Ve(e,t,i){void 0===i&&(i=!1);var n=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&n.replace("unified=1","edit=1&new=1");var o={jsApi:"1"},r=z.Ue;if(o.jsapiver=e.featureManager.isFeatureEnabled(r)?"v1Wrapper":"v1",i&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){var s=e.sessionInformation.SupportsDocReboot;o.sdr=!0===s?"1":s.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),e.sessionInformation.HideHeader&&(o.hhdr="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),(e.wopiPrecheckInfo.ReadOnly||t.bootFlowType===Le.wordViewToUnifiedReadRedirect)&&(o.readOnly="1"),t.bootFlowType===Le.wordViewToUnifiedReadRedirect&&(o.cons="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===Le.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(C(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);var a=e.wopiPrecheckInfo.FileSize;return a&&a>=52428800&&a<=104857600&&(o.ilf="1"),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o=h(h({},e.applicationCustomSettings.additionalApplicationParameters),o)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o=h(h({},o),e.rebootOverrideData.queryOverrides)),function(e,t,i,n,o){var r=E(e);"teams"!==r.uih&&"owa"!==r.uih||(r.hhdr="1");var s=e.indexOf("?"),a=-1===s?e.concat("?"):e.substring(0,s+1);t.UiLocale&&(r.ui=encodeURIComponent(t.UiLocale));t.DataLocale&&(r.rs=encodeURIComponent(t.DataLocale));t.HostSessionId&&(r.hid=encodeURIComponent(t.HostSessionId));t.DisableChat&&(r.dchat="1");t.SessionContext&&(r.sc=encodeURIComponent(t.SessionContext));i&&i.WopiSrc&&(r.wopisrc=encodeURIComponent(i.WopiSrc));t.CookieCompliant&&(r.mscc="1");n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString()));r=h(h(h({},r),t.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var f=[];for(var u in c)c[u]&&f.push(u.concat("=",c[u]));return a.concat(f.join("&"))}(n,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function qe(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(Le||(Le={}));var ze,Ge,Ze,$e,Xe,Ke,Qe,Ye,et,tt,it=["xlviewerinternal.aspx","xlembed.aspx"];function nt(e,t,i,o){Ke=e,Qe=t,Ye=void 0,et=i,tt=o,ze=!1,Ge=!1,Ze=0,at(),setTimeout((function(){Ke.ULS.u(593589517,r.N,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function e(){if(Ze>=3)return void Ke.ULS.u(595350870,r.N,n.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(at(),ze)setTimeout((function(){(!Ge||Ze>0)&&Ke.ULS.u(595350872,r.N,n.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+Ge+" after first flush retry attempt: "+Ze)}),Xe);else{if(Ze+=1,Ke.ULS.u(595350871,r.N,n.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+Ze),et.isFeatureEnabled(z.xe)&&1===Ze)document.getElementById(Qe).submit();setTimeout((function(){e()}),$e)}}()}),$e),et.isFeatureEnabled(z.Fe)&&(window.localStorage?window.addEventListener("offline",ct):Ke.ULS.u(593589518,r.N,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),Ke.ULS.u(594622165,r.N,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+et.isFeatureEnabled(z.Fe))}function ot(e){"PageLoadSkeleton Presented"===e?ze=!0:"BootstapContext Recieved"===e&&(Ge=!0)}function rt(){if(et.isFeatureEnabled(z.Fe))if(window.localStorage)for(var e=0;e<localStorage.length;e+=1)try{var t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){var i=localStorage.getItem(t);Ke.ULS.u(593589520,r.N,n.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+i),localStorage.removeItem(t)}}catch(e){Ke.ULS.u(593589521,r.N,n.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+Y(e))}else Ke.ULS.u(593589519,r.N,n.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function st(e){return it.some((function(t){return-1!==e.indexOf(t)}))}function at(){$e=3750,Xe=6e3;var e=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}}();if(void 0!==e)switch(void 0!==Ye&&Ye!==e&&Ke.ULS.u(595350873,r.N,n.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+Ye+" currentConnection: "+e+" First Flush: "+ze+" Second Flush:"+Ge),Ye=e,e){case"4g":$e=3750,Xe=6e3;break;case"3g":$e=5e3,Xe=8e3;break;case"2g":$e=1e4,Xe=24e3;break;case"slow-2g":$e=2e4,Xe=4e4}}function ct(){try{var e=J(),t="OfflineMode_"+tt+"_"+e,i={"Sessionid:":tt,OfflineTime:e};localStorage.setItem(t,JSON.stringify(i))}catch(e){Ke.ULS.u(593589522,r.N,n.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+Y(e))}}function ut(e,t,i,n,o,r,s){var a=function(e,t,i,n){var o=e.ownerDocument.createElement("iframe");o.name=i||"WebApplicationFrame",o.id="WebApplicationFrame",o.src="",o.title="Office Online Frame",o.width="100%",o.height="100%",o.marginWidth="0",o.marginHeight="0",o.style.left="0",o.style.top="0",o.style.right="0",o.style.bottom="0",o.style.display="block",o.style.position="absolute",o.style.backgroundColor="transparent",o.style.border="none",o.frameBorder="0",o.setAttribute("allowfullscreen","true"),o.setAttribute("allowTransparency","true");var r=C(t);return o.setAttribute("allow","microphone "+r+"; camera "+r+";"),n&&(o.onload=n),e.appendChild(o),o}(e,t,o);return st(t)&&nt(r,"office_form",n,s),function(e,t,i,n){Ue(e,n);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=i,r.target=e.name,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return t.appendChild(r),r.submit(),e}(a,e,t,i)}var ft=function(){function e(e,t,i,n,o,r){var s=this;if(this.Xn=!1,this.Kn=[],this.logWarningOnNoAppComplete=function(e){s.Xn||fe(s.$e,e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.Qn=e,this.Yn=t,this.$e=i,this.eo=n,this.to=o,this.io=r,this.no=e.diagnostics.AppInitDiagnostics,this.oo=e.diagnostics.SessionTraces,this.oo.wopiInitializeTime=J()}return e.prototype.Boot=function(){var e=this;this.$e.ULS.u(596444241,r.N,n.Info,"Initializing WAC frame");var t=Ve(this.Qn,this.Yn,!0),i=function(e,t){var i={};if(e.wopiInfo&&(i[Ae.hn]=e.wopiInfo.AccessToken,i[Ae.dn]=qe(e.wopiInfo)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[Ae.ln]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var o=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.u(593503580,r.N,n.Info,"Content bundle staleness - "+o),i[Ae.pn]=o}else t.ULS.u(593503581,r.N,n.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(i[Ae.Sn]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.FileName){var s=e.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==s){var a=e.wopiPrecheckInfo.FileName.substring(s+1);a&&(i[Ae.gn]=a)}i[Ae.In]=e.wopiPrecheckInfo.FileName}return e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?i[Ae.bn]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(i[Ae.bn]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(i[Ae.Wn]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(i[Ae.Rn]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(i[Ae.Un]=e.sessionInformation.SessionContext),e.diagnostics.HostInitDiagnostics&&(i[Ae.An]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics})),i[Ae.wn]=le(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(i[Ae.En]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),i[Ae.Tn]=String(window.devicePixelRatio>1.24),i[Ae.Nn]=String(w()),i[Ae.Pn]=e.sessionInformation.HostName,e.newFileTemplateSource&&(i[Ae.Fn]=e.newFileTemplateSource.FileGetUrl),e.newFileTemplateSource&&e.newFileTemplateSource.DocUniqueId?i[Ae.vn]=e.newFileTemplateSource.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(i[Ae.vn]=e.wopiPrecheckInfo.DocUniqueId),e.newFileTemplateSource&&e.newFileTemplateSource.ETag?i[Ae.mn]=e.newFileTemplateSource.ETag:e.wopiPrecheckInfo.ETag&&(i[Ae.mn]=e.wopiPrecheckInfo.ETag),i}(this.Qn,this.$e);if(ce(I(t),this.Qn.Pe,this.$e,this.logWarningOnNoAppComplete),this.eo.registerMessagePayloadHandler(me.st,(function(t){e.handleWacAppBootState(t)})),this.eo.registerMessagePayloadHandler(me.ft,(function(){e.handleCloseTab()})),this.eo.registerMessagePayloadHandler(me._t,(function(t){e.handleTrustFrameRequest(t)})),this.eo.registerMessagePayloadHandler(me.Vt,(function(t){e.handleSetOverlayContent(t)})),this.Yn.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(t,i),this.Yn.ignoreWacFramePostMessages){var o=this.getApplicationState();this.to(o)}return this.$e.ULS.u(595661019,r.N,n.Info,"Created Wac Frame"),this.so},e.prototype.bootWacFrame=function(e,t){this.no.officeFrameCreateTime=J(),this.oo.frameCreateStartTime=this.no.officeFrameCreateTime;var i=this.Qn.applicationCustomSettings&&this.Qn.applicationCustomSettings.appFrameName;this.so=ut(this.Qn.container,e,t,this.Qn.featureManager,i,this.$e,this.Qn.sessionId),this.eo.activate(this.so)},e.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var e=this;this.eo.registerMessagePayloadHandler(me.at,(function(t){e.handleWacCompleteMessage(t)})),this.eo.registerMessagePayloadHandler(me.rt,(function(t){e.handleWacFailureMessage(t)})),this.Kn.push(window.setTimeout((function(){return e.timeoutWacAppCompleteOrFail()}),15e3)),this.Kn.push(window.setTimeout((function(){return e.logWarningOnNoAppComplete(1)}),this.Qn.Pe.getValue(j.ge,6e4))),this.Kn.push(window.setTimeout((function(){return e.logWarningOnNoAppComplete(2)}),this.Qn.Pe.getValue(j.Se,18e4)))},e.prototype.handleWacAppBootState=function(e){var t=e&&e.state?e.state:"unknown";this.$e.ULS.u(595714271,r.N,n.Info,"WAC Boot App state:["+t+"]"),ot(t)},e.prototype.handleTrustFrameRequest=function(e){var t=Ne(this.$e);this.$e.ULS.u(595653903,r.N,n.Info,"Top frame is trusted: "+t),this.eo.sendPostMessage(this.so.contentWindow,we._t,{isTopFrameTrusted:t})},e.prototype.handleSetOverlayContent=function(e){var t=Je(e&&e.overlayContent);this.$e.ULS.u(587487432,r.N,n.Info,"Overlay content: "+t),this.eo.sendPostMessage(this.so.contentWindow,we.Ui,void 0)},e.prototype.handleWacCompleteMessage=function(e){if(this.$e.ULS.u(595986314,r.N,n.Info,"Received wac complete message"),this.$e.ULS.flush(),ue(),this.clearLogTimers(),rt(),this.Xn)this.$e.ULS.u(596444234,r.N,n.Info,"Received multiple wac complete or failure messages");else{this.Xn=!0,this.sendWacPostMessage(we.ai,{}),Me(this.no,e);var t=this.getApplicationState();this.to(t),this.sendJsApiDiagnosticsToWacFrame(this.Qn.diagnostics)}},e.prototype.handleCloseTab=function(){this.$e.ULS.u(579342464,r.N,n.Info,"Received close tab message");try{window.close()}catch(e){this.$e.ULS.u(579213188,r.N,n.Warning,"Failed to close the browser tab")}},e.prototype.getApplicationState=function(){return{innerApplicationFrame:this.so}},e.prototype.handleWacFailureMessage=function(e){if(this.$e.ULS.u(595986315,r.N,n.Error,"Received wac failed message"),this.$e.ULS.flush(),ue(),this.clearLogTimers(),this.Xn)this.$e.ULS.u(596444235,r.N,n.Info,"Received multiple wac complete or failure messages");else{this.Xn=!0,this.sendWacPostMessage(we.si,{});var t={errorType:Fe.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,this.oo.error=t),this.io(t)}},e.prototype.timeoutWacAppCompleteOrFail=function(){this.Xn||this.$e.ULS.u(596444236,r.N,n.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.oo))},e.prototype.clearLogTimers=function(){he(this.Kn),this.Kn=[]},e.prototype.sendJsApiDiagnosticsToWacFrame=function(e){this.sendWacPostMessage(we.vi,{HostInitializeDiagnostics:e.HostInitDiagnostics})},e.prototype.sendWacPostMessage=function(e,t){this.so&&this.so.contentWindow?this.eo.sendPostMessage(this.so.contentWindow,e,t):this.$e.ULS.u(595955718,r.N,n.Info,"Attempted to send postmessage: "+e)},e}(),ht=!1,dt=!1;function lt(){ht=!1}function pt(e,t,i,o,s,a,c){if(t.ULS.u(595714433,r.N,n.Info,"Starting disposing the application. unloadApp:"+e+"; disposed:"+ht+"; unloading:"+dt),ht||dt&&e)t.ULS.u(595714908,r.N,n.Info,"Application is already disposed or unloading");else{var u,f={logger:t,postMessenger:i,innerApplicationFrame:o,onDisposed:s,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:J(),appUnloadTimedOut:!1};if(e&&o)return dt=!0,f.forceAppUnload=!0,(u=f).forceAppUnloadStartTime=J(),u.logger.ULS.u(595855490,r.N,n.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(me.Zt,(function(e){return function(e,t){e.forceAppUnloadEndTime=J(),e.appUnloadedMessageValues=t,e.logger.ULS.u(595855491,r.N,n.Info,"AppUnloaded received from app"),vt(e)}(u,e)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame.contentWindow,we.xi,{}),void window.setTimeout((function(){return function(e){!dt&&ht||(e.appUnloadTimedOut=!0,e.logger.ULS.u(595855492,r.N,n.Info,"ApplicationUnload timed out, forcing dispose"),vt(e))}(u)}),u.unloadTimeoutInMs);vt(f)}}function vt(e){if(!ht)try{ht=!0,dt=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:J(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,o=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(o)&&(t.hostToAppPostMessageLatency=o-e.forceAppUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var f in u)t["st-"+f.toString()]=u[f]}}e.logger.ULS.u(595855436,r.N,n.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.u(595714434,r.N,n.Error,"Error disposing: "+Y(t))}}var mt,wt=function(){function e(e,t,i,n,o,r,s){var a=this;this.ao=!1,this.co=!1,this.uo=!1,this.fo=null,this.ho=!0,this.do=!1,this.lo=!1,this.Qn=e,this.Yn=t,this.no=e.diagnostics.AppInitDiagnostics,this.$e=i,this.eo=n,this.to=r,this.io=s,this.oo=e.diagnostics.SessionTraces,this.oo.wopiPendingInitializeTime=J(),this.po=o,lt(),window.setTimeout((function(){return a.timeoutCompleteOrFail()}),5e3)}return e.prototype.Complete=function(e,t){if(this.uo)this.$e.ULS.u(596444184,r.N,n.Warning,"Complete called after Complete/Fail already called");else{this.$e.ULS.u(596444185,r.N,n.Info,"Complete called."),this.uo=!0,this.vo=e,this.oo.wopiPendingCompleteTime=J();try{this.Yn.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.ao&&this.sendWacPostMessage(we.Ni,{}),this.updateBrowserHistoryForCreateNew(t)}catch(e){this.$e.ULS.u(596444186,r.N,n.Error,"Unexpected script error: "+Y(e))}finally{this.$e.ULS.flush()}}},e.prototype.Fail=function(e){this.uo?this.$e.ULS.u(596444187,r.N,n.Warning,"Fail called after Complete/Fail already called"):(this.$e.ULS.u(596444188,r.N,n.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.uo=!0,this.Yn.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(e),this.$e.ULS.flush())},e.prototype.Dispose=function(e,t,i){var n=this;pt(e||!1,this.$e,this.eo,this.so,(function(){delete n.so,t&&t(),n.po(),n.eo.dispose()}),void 0,i)},e.prototype.Boot=function(){this.Yn.isSingleStepBoot||this.bootTwoStepFlow(),this.$e.ULS.flush()},e.prototype.bootTwoStepFlow=function(){var e=this;this.$e.ULS.u(596444231,r.N,n.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return e.timeoutWacReadyMessage()}),5e3),this.eo.registerMessagePayloadHandler(me.ot,(function(t){e.handleWacReadyMessage(t)})),this.eo.registerMessagePayloadHandler(me.jt,(function(t){e.handleWacFrameSessionCompleteAckMessage(t)}));var t=new ft(this.Qn,this.Yn,this.$e,this.eo,this.to,this.io);this.so=t.Boot()},e.prototype.completeTwoStepFlow=function(){var e={ParallelizeStartSession:this.ho,WacFrameIsLoaded:this.ao,WacAcceptsStartSessionComplete:this.do};this.$e.ULS.u(596444232,r.N,n.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!this.ho||this.ao&&!this.do?this.ao&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},e.prototype.completeSingleStepFlow=function(){this.$e.ULS.u(596444233,r.N,n.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.Qn.wopiInfo=this.vo;var e=new ft(this.Qn,this.Yn,this.$e,this.eo,this.to,this.io);this.so=e.Boot()},e.prototype.failTwoStepFlow=function(e){this.ao?(this.$e.ULS.u(595968481,r.N,n.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(e)):(this.$e.ULS.u(595968482,r.N,n.Warning,"Fail was called on the session prior to WacReady."),this.fo=e)},e.prototype.sendFailurePostMessageToWacFrame=function(e){this.$e.ULS.u(596444189,r.N,n.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(we.Ri,e)},e.prototype.failSingleStepFlow=function(){this.$e.ULS.u(596444190,r.N,n.Warning,"Fail called during single step boot, calling host failure callback..."),this.io({errorType:Fe.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},e.prototype.timeoutWacReadyMessage=function(){this.ao||(this.$e.ULS.u(596444191,r.N,n.Warning,"Timeout Wac Ready"),this.io({errorType:Fe.TimeoutWacReady,errorObject:void 0}))},e.prototype.timeoutCompleteOrFail=function(){this.uo||(this.oo.timeoutCompleteOrFail=J(),this.$e.ULS.u(596444192,r.N,n.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.oo)))},e.prototype.timeoutWacSessionCompletionMessageAck=function(e,t,i){this.lo||(this.$e.ULS.u(596444193,r.N,n.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(e,t,i+1))},e.prototype.handleWacReadyMessage=function(e){if(this.oo.readyMessageReceiveTime=J(),this.sendWacPostMessage(we.ni,{}),this.ao)this.$e.ULS.u(596444194,r.N,n.Info,"Received multiple ready messages - frame is already loaded.");else{this.ao=!0,this.do=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:this.do,ParallelizeStartSession:this.ho,StartSessionResponse:null!=this.mo,WopiInfo:null!=this.vo};this.$e.ULS.u(596444195,r.N,n.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),this.uo&&(this.fo?this.sendFailurePostMessageToWacFrame(this.fo):this.sendWacPostMessage(we.Ni,{})),this.ho&&this.do?this.mo&&this.startSessionCompleted():this.vo&&this.sendWopiInfoToWacFrame(),Me(this.no,e)}},e.prototype.handleWacFrameSessionCompleteAckMessage=function(e){this.lo=!0,this.oo.sessionCompleteAckReceivedTime=J()},e.prototype.sendWacPostMessage=function(e,t){this.so&&this.eo.sendPostMessage(this.so.contentWindow,e,t)},e.prototype.sendSessionCompletionMessageWithRetry=function(e,t){this.sendSessionCompletionMessageWithRetryHelper(e,t,1)},e.prototype.sendSessionCompletionMessageWithRetryHelper=function(e,t,i){var o=this;if(i>3)this.$e.ULS.u(596444224,r.N,n.Error,"Attempted to call complete, but received no ack from the frame. Time: "+J());else{this.$e.ULS.u(596444225,r.N,n.Info,"Sending completion message to frame. Attempt number: "+i+", Time: "+J());var s=J();1===i&&(this.mo&&this.mo.Diagnostics&&(this.mo.Diagnostics.completeMessageCreateTime=s),this.oo.completeMessageCreateTime=s),t.Diagnostics.completeMessageSendTime=s,this.oo.completeMessageSendTime=s,this.sendWacPostMessage(e,t),window.setTimeout((function(){return o.timeoutWacSessionCompletionMessageAck(e,t,i)}),1e3)}},e.prototype.makeStartSessionRequest=function(){var e=this;this.$e.ULS.u(596444226,r.N,n.Info,"Making parallelized startSession request.");var t=this.buildStartSessionUrl(this.vo),i={"Content-Type":"application/x-www-form-urlencoded"},o="access_token="+encodeURIComponent(this.vo.AccessToken)+"&access_token_ttl="+encodeURIComponent(qe(this.vo));this.oo.startSessionStartTime=J(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(t,o,i,(function(t){return e.onStartSessionRequestCompleted(t)}))},e.prototype.onStartSessionRequestCompleted=function(e){if(this.oo.startSessionCompleteTime=J(),this.oo.startSessionResponseStatus=e.status,this.mo={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:this.oo.wopiPendingInitializeTime,wopiPendingCompleteTime:this.oo.wopiPendingCompleteTime,startSessionStartTime:this.oo.startSessionStartTime,startSessionCompleteTime:this.oo.startSessionCompleteTime,readyMessageReceiveTime:this.oo.readyMessageReceiveTime}},this.$e.ULS.u(596444227,r.N,n.Info,"StartSession request completed with status code: "+this.mo.StartSessionResponse.RequestStatus+", Time: "+J()),this.ao&&this.do)this.startSessionCompleted();else{var t={WacFrameIsLoaded:this.ao,InitializeCompleted:this.co};this.$e.ULS.u(596444228,r.N,n.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},e.prototype.sendWopiInfoToWacFrame=function(){if(!this.co){this.co=!0,this.$e.ULS.u(596444229,r.N,n.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:this.vo.WopiSrc,AccessToken:this.vo.AccessToken,AccessTokenTtl:qe(this.vo)},Diagnostics:{wopiPendingInitializeTime:this.oo.wopiPendingInitializeTime,wopiPendingCompleteTime:this.oo.wopiPendingCompleteTime,readyMessageReceiveTime:this.oo.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(we.hi,e)}},e.prototype.startSessionCompleted=function(){200===this.mo.StartSessionResponse.RequestStatus?this.co||(this.co=!0,this.sendSessionCompletionMessageWithRetry(we.ci,this.mo)):this.sendWopiInfoToWacFrame()},e.prototype.buildStartSessionUrl=function(e){var t=this.Qn.applicationBasePath+"wordeditorstartsession.ashx",i=Ve(this.Qn,this.Yn,!1);return t=P(t+="?"+i.substring(i.indexOf("?")+1),"WOPISrc",encodeURIComponent(e.WopiSrc)),t=P(t,"build",encodeURIComponent($())),t=P(t,"WacUserType",encodeURIComponent("WOPI")),this.Qn.wopiPrecheckInfo.FileGetUrl&&(t=P(t,"fileGetUrlPresent","1")),t},e.prototype.updateBrowserHistoryForCreateNew=function(e){if(this.Qn.isCreateNew){if(!e||!e.NewFilePath)return void this.$e.ULS.u(596444230,r.N,n.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},e}(),gt=((mt={})[ve.blurFocus]=we.ri,mt[ve.continueAccessibilityLoop]=we.di,mt[ve.grabFocus]=we.li,mt[ve.popState]=we.wi,mt[ve.rename]=we.Si,mt[ve.sendAccessToken]=we.Ii,mt[ve.sendAuthToken]=we.bi,mt[ve.sendCustomAuthConfig]=we.yi,mt[ve.sendEmbeddedViewUrl]=we.Oi,mt[ve.sendSessionInfo]=we._i,mt[ve.sendUserAccessAndPermissions]=we.Ti,mt[ve.sendWopiInfo]=we.Ai,mt[ve.switchMode]=we.Fi,mt),St=function(){function e(e,t){var i=this;if(this.wo=!1,this.So=function(e){return i.handleWacFramePostMessage(e)},this.an=!1,this.rn=!1,this.sn=!1,this.Io={},!e)throw new Error("Missing origin for PostMessageHandler");this.rn=I(e),this.sn=b(e),this.$e=t,this.setOrigin(e)}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Io[e])throw new Error("Duplicate registration!");this.Io[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Io[e]},e.prototype.sendPostMessage=function(e,t,i){if(e){this.$e.ULS.u(596464334,r.N,n.Info,"Sending message: "+t);var o={MessageId:t,SendTime:J(),Values:i};this.sendPostMessageInternal(e,JSON.stringify(o),this.nn)}else this.$e.ULS.u(595948308,r.N,n.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){void 0===t&&(t=!1),this.so=e,this.an=t,this.wo||(window.addEventListener("message",this.So,!1),this.wo=!0)},e.prototype.postMessageForCommand=function(e,t,i){var o=gt[t];o?(this.$e.ULS.u(595702598,r.N,n.Info,"Sending message "+o+" for command "+t),this.sendPostMessage(e,o,i)):this.$e.ULS.u(595702599,r.N,n.Warning,"No mapping for command "+t)},e.prototype.dispose=function(){for(var e=0,t=Object.keys(this.Io);e<t.length;e++){var i=t[e];delete this.Io[i]}this.wo&&(window.removeEventListener("message",this.So,!1),this.wo=!1)},e.prototype.sendAckBack=function(e,t,i){if(e){var o={MessageId:we.ii,CorrelationId:i,SendTime:J()};this.$e.ULS.u(595732176,r.N,n.Info,"Sending Ack back"),e.postMessage(JSON.stringify(o),t)}else this.$e.ULS.u(595736136,r.N,n.Info,"Missing target to send Ack back")},e.prototype.handleWacFramePostMessage=function(e){var t=!1,i=!0,o="",s=!1;if(this.so&&this.so.contentWindow&&(t=!0,i=e.source===this.so.contentWindow),e.origin&&(s=(o=O(e.origin,2).toLowerCase())===this.on),!this.rn&&(!this.sn||s&&i)||this.$e.ULS.u(595730526,r.N,n.Info,"Window is available: "+t+", window is valid: "+i+", origin is valid: "+s+", expected origin: "+this.on+", actual origin: "+o),s&&(!this.an||i)){var a;try{a=JSON.parse(e.data)}catch(e){return void this.$e.ULS.u(596464282,r.N,n.Info,"Failed to parse event data: "+Y(e)+".")}var c=a.MessageId;if(c){this.$e.ULS.u(595714715,r.N,n.Info,"Received messageId: "+c+", correlation: "+a.CorrelationId),c!==me.at&&c!==me.Rt||this.setOrigin(e.origin),a.Values&&a.Values.ackExpected&&this.sendAckBack(e.source,e.origin,a.CorrelationId);var u=this.Io[c];if(u){this.$e.ULS.u(596464288,r.N,n.Info,"Processing message: "+c);try{u(a.Values||{})}catch(e){this.$e.ULS.u(593773704,r.N,n.Error,"Handler error: "+Y(e))}}else this.$e.ULS.u(596464289,r.N,n.Info,"No handler found for message id: "+c)}else(this.rn||this.sn)&&this.$e.ULS.u(595730520,r.N,n.Info,"Could not find message id")}},e.prototype.sendPostMessageInternal=function(e,t,i){e.postMessage(t,i)},e.prototype.setOrigin=function(e){var t=e.toLowerCase();this.nn&&this.nn!==t&&this.$e.ULS.u(596128131,r.N,n.Warning,"Updating origin:"+this.nn+"->"+t),this.nn=t,this.on=O(t,2),this.rn=I(t),this.sn=b(t)},e}(),It=function(){function e(){var e=this;if(this.bo=[],this.Io=[],this.yo=function(){return e.handleVisibilityChange()},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:J(),initialState:!0};this.bo.push(t)}document.addEventListener("visibilitychange",this.yo)}return e.prototype.RegisterEventHandler=function(e){this.Io.push(e)},e.prototype.RemoveEventHandler=function(e){if(e){var t=this.Io.indexOf(e);this.Io.splice(t,1)}},e.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.yo)},e.prototype.GetVisibilityChangeEvents=function(){return this.bo},e.prototype.Dispose=function(){this.Stop(),this.Io=[],this.bo=[]},e.prototype.handleVisibilityChange=function(){var e={visibility:document.visibilityState,time:J(),initialState:!1};this.bo.push(e);for(var t=0,i=this.Io;t<i.length;t++){var n=i[t];n&&n(e)}},e}();function bt(e,t,i,n,o,r){void 0===r&&(r=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var i=e.SessionInformation;i.WdParams||(i.WdParams={});if(i.WdParams.wd)return;t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(i.WdParams[t[0]]=t[1])}}));var n=e.RebootOverrideData;n&&n.previousSessionId&&(i.WdParams.wdprevioussession=n.previousSessionId)}(e,window.location.search);var s=o||new be("Excel",i);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:$(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:ke(e.ApplicationUrl),wopiInfo:e.WopiInfo,forceSingleStepBoot:r,isCreateNew:e.WopiPrecheckInfo.IsNewFile||N(e.ApplicationUrl),featureManager:n||de(e.FnIsFeatureEnabled,i),Pe:s,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData}}var yt=["excel-boot.min.js"];function Ct(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var t=0,i=window.performance.getEntriesByType("resource");t<i.length;t++){var o=i[t],s=R(o.name);if("about:blank"!==o.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file")&&-1!==yt.indexOf(s)){var a=JSON.stringify(o);a=a.replace(new RegExp(o.name,"g"),s),e.ULS.u(595736532,r.N,n.Info,a)}}window.performance.clearResourceTimings()}catch(t){e.ULS.u(595732049,r.N,n.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}}),{once:!0})}var Ot,_t=function(){function e(e,t){this.Co=e,this.Oo=t}return e.prototype.GetVersion=function(){return $()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var i=e.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),t.href=i;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,i,o,s,a){var c,u,f,h,d,l=!1;try{var v,m=J();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){var t,i=e.RebootOverrideData;if(i)if(i.queryOverrides||(i.queryOverrides={}),t=i.mode)"view"===(t=t.toLowerCase())?i.queryOverrides.wdforcedmode="View":"edit"===t&&(i.queryOverrides.wdforcedmode="Edit");else{var n=i.reason;n&&"saveas"===(n=n.toLowerCase())&&(i.queryOverrides.wdforcedmode="Edit")}}(e),i?f=i:(f=(c=Ce())[0],h=c[1]),u=t||G({remoteUlsEndpoint:ke(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:f}),d=bt(e,f,u,s,a,this.Oo.forceSingleStepBoot),a||(d.Pe.addSettingsChangeListener(u.settingsChangeHandler),d.Pe.initializePeriodicFetch(d.applicationBasePath,f)),d.diagnostics.HostInitDiagnostics&&(d.diagnostics.HostInitDiagnostics.hostInitializeCallTime=m),Be(u,d,h),l=!0,oe(u,!0);var w=e.BootstrapperUrl;w&&(v=this.periodicPrefetch(w,u));var g=function(){d.Pe.dispose(),re(),window.clearInterval(v)},S=C(e.ApplicationUrl),I=o||new St(S,u),b=new It,y=function(e,t){var i={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?Le.forceSingleStepBoot:Le.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot,i.isSingleStepBoot){var o={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};t.ULS.u(596444182,r.N,o.irmEnabled?n.Warning:n.Info,JSON.stringify(o))}else t.ULS.u(596444183,r.N,n.Info,"Received input valid for two step flow");return i}(d,u),O=function(e,t,i,o,s,a,c,u){return function(f){De(e,s),He(e.SessionTraces,o,n.Info);var h=At(e);o.ULS.u(596448985,r.N,n.Info,JSON.stringify(h));var d=u(t,o,i,a,f);try{c(d,h)}catch(e){o.ULS.u(595719171,r.N,n.Error,"Exception thrown from host's success callback: "+Y(e))}ee("excel",o),Tt(o)}}(d.diagnostics,d.sessionId,I,u,b,g,e.FnOnInitializeSuccess,this.Co),_=function(e,t,i,o){return function(s){De(e,i),He(e.SessionTraces,t,n.Warning);var a=At(e);void 0!==s&&"Js Boot Failed"!==s.errorObject.errorType&&t.ULS.u(575931487,r.N,n.Error,"Core JS failure recieved "+JSON.stringify(s)),t.ULS.u(596448986,r.N,n.Error,JSON.stringify({error:s,appInitDiagnostics:a}));try{o(s,a)}catch(e){t.ULS.u(595719172,r.N,n.Error,"Exception thrown from host's failure callback: "+Y(e))}ee("excel",t),Tt(t)}}(d.diagnostics,u,b,e.FnOnInitializeFailure);if(p(),e.FnOnAppModeSwitched&&I.registerMessagePayloadHandler(me.Ut,e.FnOnAppModeSwitched),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched,w&&this.Oo.preloader&&this.Oo.preloader.shouldPreload(d.applicationUrl))try{var T=w;Ct(u),d.featureManager.isFeatureEnabled(z.We)&&(u.ULS.u(595645891,r.N,n.Info,"HTTP2 preload enabled"),T=U(w));var P=d.sessionInformation.UiLocale;P||(P=decodeURIComponent(A(d.applicationUrl,"ui"))),this.Oo.preloader.preload(T,P,u,d.featureManager)}catch(e){u.ULS.u(595943884,r.N,n.Error,Y(e))}var E=new wt(d,y,u,I,g,O,_);return E.Boot(),E}catch(t){return u&&(u.ULS.u(596459925,r.N,n.Error,Fe.AppInitError+": "+Y(t)),l||Be(u,d||bt(e,f,u,s,a,this.Oo.forceSingleStepBoot),h),u.ULS.flushOnClose()),void e.FnOnInitializeFailure({errorType:Fe.AppInitError,errorObject:t},void 0)}},e.prototype.periodicPrefetch=function(e,t){var i=this;return window.setInterval((function(){i.Prefetch({BootstrapperUrl:e}),t.ULS.u(595895774,r.N,n.Info,"Prefetching "+R(e))}),36e5)},e}();function Tt(e){e.ULS.u(590914655,r.N,n.Info,"Time spent logging: "+e.getTimeSpentLogging())}function At(e){return h(h(h({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent"}(Ot||(Ot={}));var Pt=[me.St,me.Tt,me.Dt,me.Kt],Et=function(){function e(e,t,i,n,o){this.Io={},this._o=!1,this.To=!1,this.Ao=e,this.$e=t,this.so=o.innerApplicationFrame,this.eo=i,this.Po=n,this.registerPostMessageHandlers(),lt()}return e.prototype.GetApplicationType=function(){throw new Error("Not implemented")},e.prototype.GetVersion=function(){return $()},e.prototype.GetSessionId=function(){return this.Ao},e.prototype.RegisterEventHandler=function(e,t){if(this.To)throw new Error("RegisterEventHandler is not supposed to be called");this._o=!0,this.registerEventHandlerInternal(e,t)},e.prototype.RemoveEventHandler=function(e,t){if(this.To)throw new Error("RemoveEventHandler is not supposed to be called");switch(e){case Ot.Unloaded:case Ot.Disposed:case Ot.DocumentReboot:case Ot.WopiInfoFromUrl:case Ot.GetAuthToken:case Ot.GetCustomAuthConfig:case Ot.SetOverlayContent:if(this.Io[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Io[e];break;default:this.eo.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.RegisterAllEventsHandler=function(e){var t=this;if(this._o)throw new Error("RegisterAllEventsHandler is not supposed to be called");if(this.To)throw new Error("RegisterAllEventsHandler is supposed to be called only once");this.To=!0,Pt.forEach((function(i){t.registerEventHandlerInternal(i,(function(t){return e({MessageId:i,SendTime:void 0,CorrelationId:void 0,Values:t})}))})),Object.keys(ye).forEach((function(i){ye[i].Di&&t.registerEventHandlerInternal(i,(function(t){return e({MessageId:i,SendTime:void 0,CorrelationId:void 0,Values:t})}))})),this.registerEventHandlerInternal(Ot.WopiInfoFromUrl,(function(t){e({MessageId:me.Et,SendTime:void 0,CorrelationId:void 0,Values:t})})),this.registerEventHandlerInternal(Ot.GetAuthToken,(function(t){e({MessageId:me.At,SendTime:void 0,CorrelationId:void 0,Values:t})})),this.registerEventHandlerInternal(Ot.GetCustomAuthConfig,(function(t){e({MessageId:me.Pt,SendTime:void 0,CorrelationId:void 0,Values:t})})),this.registerEventHandlerInternal(Ot.DocumentReboot,(function(t){e({MessageId:me.Mt,SendTime:void 0,CorrelationId:void 0,Values:t})}))},e.prototype.PostCommand=function(e,t){this.eo.postMessageForCommand(this.so.contentWindow,e,t)},e.prototype.Dispose=function(e,t){var i=this;pt(e||!1,this.$e,this.eo,this.so,(function(){delete i.so,i.Po(),i.eo.dispose(),i.raiseEvent(Ot.Unloaded,{})}),(function(){try{i.raiseEvent(Ot.Disposed,{}),i.Io={}}catch(e){i.$e.ULS.u(589108815,r.N,n.Error,"onFrameRemoved error: "+Y(e))}}),t)},e.prototype.registerEventHandlerInternal=function(e,t){switch(e){case Ot.Unloaded:case Ot.Disposed:case Ot.DocumentReboot:case Ot.WopiInfoFromUrl:case Ot.GetAuthToken:case Ot.GetCustomAuthConfig:case Ot.SetOverlayContent:if(this.Io[e])throw new Error("Duplicate registration");this.Io[e]=t;break;default:this.eo.registerMessagePayloadHandler(e,t)}},e.prototype.registerPostMessageHandlers=function(){this.eo.registerMessagePayloadHandler(me.Mt,this.handleDocumentRebootMessage.bind(this)),this.eo.registerMessagePayloadHandler(me.Et,this.handleWopiInfoFromUrlRequest.bind(this)),this.eo.registerMessagePayloadHandler(me.At,this.handleAuthTokenRequest.bind(this)),this.eo.registerMessagePayloadHandler(me.Pt,this.handleCustomAuthConfigRequest.bind(this))},e.prototype.raiseEvent=function(e,t){var i=this.Io[e];if(i)try{i(t||{})}catch(e){this.$e.ULS.u(593773706,r.N,n.Error,"Handler error: "+Y(e))}},e.prototype.handleDocumentRebootMessage=function(e){e.previousSessionId=this.Ao,this.raiseEvent(Ot.DocumentReboot,e)},e.prototype.handleWopiInfoFromUrlRequest=function(e){this.raiseEvent(Ot.WopiInfoFromUrl,e)},e.prototype.handleAuthTokenRequest=function(e){this.raiseEvent(Ot.GetAuthToken,e)},e.prototype.handleCustomAuthConfigRequest=function(e){this.raiseEvent(Ot.GetCustomAuthConfig,e)},e}();var Rt="_layouts/xlviewerinternal.aspx";function Ut(e){return e.toLowerCase().indexOf(Rt.split("/")[1])>0}function Nt(e,t,i,o,s){var a={};if(s)a=s;else try{a=JSON.parse( "{\"ewa.js\": {\"UrlHash\": \"hA37B138822021B6C\", \"SriHash\": \"o3sTiCICG2wABefKZ3QZrP5wZS83vxDU6uHnQkjCqrA=\"}, \"aacorlib.min.js\": {\"UrlHash\": \"h6A0D5A441D484E3E\", \"SriHash\": \"ag1aRB1ITj4EkgY69VuGDmmpsLTq7JTQl1Z+qZGFjbo=\"}, \"ewa.strings.wac.js\": {\"UrlHash\": \"h6093CEFAD10EDECF\", \"SriHash\": \"YJPO+tEO3s9YE2aK+hotBWo5mS4G0BTXxBBE/NDvcHE=\"}, \"ewrdefault.css\": {\"UrlHash\": \"hD93BE317EC9355A7\", \"SriHash\": \"2TvjF+yTVac79m9fBhPfRHlaFJbS7v+dnUibiEGKYE4=\"}, \"excelframe.css\": {\"UrlHash\": \"hEF711F8E567376CF\", \"SriHash\": \"73EfjlZzds/Anx93sWa5qPwTj0FPREAbQ1e4Apvp/NY=\"}, \"cookiecompliance.js\": {\"UrlHash\": \"h910F1F3CE687CFDE\", \"SriHash\": \"kQ8fPOaHz94aEkFf5zpEZeei+FEXfDPKjp87XF+TxBw=\"}, \"gridrenderer.min.js\": {\"UrlHash\": \"h26A8CDC241FD58AB\", \"SriHash\": \"JqjNwkH9WKtjD8hhHigN/7j+rYs7zwEtBbQkqxRqfns=\"}}")}catch(e){o&&o.ULS.u(589178847,r.N,n.Info,"GetExcelResources failed to parse hash dictionary")}for(var c=C(e)+"/x/s/",u=function(e){var t=e?e.toLowerCase().split("-")[0]:"en";return M[t]}(null!=t?t:"en-US"),f=[],h=0,d=function(e){var t=[["App_Scripts/Ewa.js",!1],["App_Scripts/Aacorlib.min.js",!1],["App_Scripts/gridRenderer.min.js",!1]];e&&(t=t.concat([["App_Scripts/"+e+"/Ewa.Strings.Wac.js",!0],["Resources/"+e+"/EwrDefault.css",!0],["Resources/"+e+"/excelframe.css",!0]]));return t}(u);h<d.length;h++){var l=d[h],p=l[0],v=l[1],m=p.substring(p.lastIndexOf("/")+1);if(yt.push(m),!v||"1033"===u){var w=m.toLowerCase();if(console.log("lowerCaseFile"),a&&a[w]){var g=a[w].UrlHash,S=a[w].SriHash;if(g){var I=c+g+"__layouts/"+p;f.push([I,"sha256-"+S]),f.push([I,void 0]),o&&o.ULS.u(589178849,r.N,n.Info,"GetExcelResources adding hashed url for "+m)}}}}return f}var Ft=function(e,t,i,o,s){return new Promise((function(e){i.pendingReboot=!0;var o=void 0;if(t.queryOverrides)try{o=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.u(592217694,r.N,n.Error,"Failed to parse queryOverrides: "+o)}i.raiseEvent(ge.Reboot,h(h({},t),{previousSessionId:i.sessionId,queryOverrides:o})),e({completion:"success"})}))},xt=function(e,t,i){return new Promise((function(t){i.logger.ULS.u(590111070,r.N,n.Error,"Unsupported flow: "+e),t({completion:"failure"})}))};function Wt(e,t){if(void 0===e)throw new TypeError("SessionBootParams");var i=e.appUrl,n=e.appBaseUrl;if(void 0===i&&void 0===n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(void 0!==i&&"string"!=typeof i)throw new TypeError("AppUrl");if(void 0!==n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=e.file;if(void 0===o||void 0===o.name)throw new TypeError("FileInfo");var r,s=e.container;if(void 0===s||!(s instanceof xe)&&void 0===s.appendChild)throw new TypeError("Container");if(!t&&(!((r=e.wopi)&&r.source&&r.accessToken)||!r.expiry&&0!==r.expiry))throw new TypeError("WopiInfo")}function kt(e,t,i,o,s,a){return e!==ve.boot?Promise.reject("Wrong flow"):new Promise((function(e){var c,u;Wt(o,t.skipWopiValidation),t.state=k.Booting,t.pendingReboot=!1,t.appBaseUrl=o.appBaseUrl?o.appBaseUrl.toLowerCase():C(o.appUrl).toLowerCase(),t.appUrl=o.appUrl||"",t.bootParams=o.bootParams||{},t.appUrl&&N(t.appUrl)&&(t.bootParams.isNewFile=!0),t.rebootOverride=o.rebootOverride,t.appBasePath=s.buildAppBasePath(t),t.intent=o.intent,t.file=o.file,t.wopi=o.wopi,t.contentBundle=o.contentBundle,t.newFileTemplate=o.newFileTemplate,t.ownerId=o.ownerId,t.sessionContext=o.sessionContext,t.actNavId=o.actNavId,t.wdParams=o.wdParams,t.preseededSession=o.preseededSession,t.throttling=o.throttling,t.hostInitDiagnostics=o.diagnostics,t.appInitDiagnostics={},o.rebootOverride&&(c=Ce(),t.sessionId=c[0],u=c[1],t.Pe.addSettingsChangeListener(t.logger.settingsChangeHandler)),t.logger.configure({remoteUlsEndpoint:_(t.appBasePath),sessionId:t.sessionId}),t.Pe.initializePeriodicFetch(t.appBasePath,t.sessionId),u&&t.logger.ULS.u(589842332,r.N,n.Info,JSON.stringify(u));var f=function(n,o){i.error=n,i.appInitDiagnostics=o,t.appInitDiagnostics=o;var r={completion:"failure",error:n};t.raiseEvent(ge.BootCompleted,r),t.state=k.Failed,e(r)};a&&a.subscribe((function(){f({errorType:"Cancelled",errorObject:void 0})}));var h=function(e,t,i,n){var o=e.appBasePath+Rt+"?";if(e.appUrl){var r=E(e.appUrl);Object.keys(r).forEach((function(e){o+=e+"="+r[e]+"&"}))}var s=e.ui;s&&s.uiEmbed&&(o=P(o,"uiembed","1"));var a=e.host;a.uiHostName&&(o=P(o,"uih",a.uiHostName));var c=e.user;c.isLicensed&&(o=P(o,"islicenseduser","1"));t.actNavId&&(o=P(o,"actnavid",t.actNavId));var u=t.container,f=u instanceof xe?u.element:u,h=t.bootParams,d=e.viewMode,l=a.capabilities,p=t.file,v=t.contentBundle,m=t.preseededSession,w=t.throttling,g=t.wopi,S=t.newFileTemplate;return{BootstrapperUrl:e.bootstrapperUrl,Container:f,SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UserId:c.id,OwnerId:t.ownerId,UiLocale:s&&s.language,DataLocale:h&&h.dataLanguage,DisableChat:h&&h.disableChat,CookieCompliant:h&&h.cookieCompliant,WdParams:t.wdParams,SessionContext:t.sessionContext,DisableFocusOnBoot:d&&d.disableFocusOnBoot,HighContrastMode:s?s.highContrast:void 0,HideViewerToolbar:d&&d.hideToolbar,SupportsAccessibilityLoop:l&&l.accessibilityLoop,SupportsAtMentions:l&&l.atMentions,SupportsDocReboot:l&&l.rebootDoc,SupportsCreateNewDocument:l&&l.createNewDoc,SupportsAuthToken:l&&l.authToken,SupportsCustomAuthConfig:l&&l.customAuthConfig,SupportsMoveToFolder:l&&l.moveToFolder,SupportsExcelExternalLinks:l&&l.excelExternalLinks,SupportsRefreshAccessToken:l&&l.refreshAccessToken,HideHeader:s&&s.hideHeader,HideBreadCrumbInViewer:d&&d.hideBreadCrumb,HideTitleInViewer:d&&d.hideTitle,HideWACOneDriveFileLocationPicker:s&&s.hideFileLocationPicker,UiHostIntegrationType:a&&a.uiHostIntegrationType,MetaUiHostVersion:a&&a.metaUiHostVersion},ApplicationUrl:o,WopiPrecheckInfo:{FileName:p.name,FileGetUrl:p.getUrl,FileSize:p.size,BundleInfo:v?{MajorVersion:v.majorVersion,Url:v.url,BundleStaleness:v.staleness}:void 0,IsNewFile:h&&h.isNewFile,IsNewFileFromHostTemplate:h&&h.isFromHostTemplate,ReadOnly:h&&h.readOnly,IrmEnabled:h&&h.irmEnabled,ETag:p.eTag,PreseededSessionKey:m&&m.key,PreseededWacSessionId:m&&m.id,DocUniqueId:p.uniqueId,ClientThrottlingProtection:w&&w.protection,RequestedCallThrottling:w&&w.request},ApplicationCustomSettings:{HostUIControls:s&&s.controls},Diagnostics:t.diagnostics,WopiInfo:{WopiSrc:g.source,AccessToken:g.accessToken,AccessTokenExpiry:new Date(g.expiry)},FnOnInitializeSuccess:i,FnOnInitializeFailure:n,NewFileTemplateSource:S?{FileGetUrl:S.getUrl,FileSize:S.size,ETag:S.eTag,DocUniqueId:S.uniqueId}:void 0,RebootOverrideData:t.rebootOverride}}(t,o,(function(n,o){if(!a||!a.isCancelled){i.application=n,i.appInitDiagnostics=o,t.appInitDiagnostics=o,n.RegisterAllEventsHandler((function(e){t.onMessage(e)}));var r={completion:"success"};t.raiseEvent(ge.BootCompleted,r),t.state=k.Booted,e(r)}}),f),d=i.bootstrapper.InitializeWopiPending(h,t.logger,t.sessionId,void 0,t.featureManager,t.Pe);d&&d.Complete(h.WopiInfo),i.pendingApplication=d}))}function Mt(e){return e.appBaseUrl+"/x/"}var Ht=function(){var e,t,i={bootstrapper:ei};return[(e={},e[pe.appReboot]=Ft,e[pe.boot]=function(e,t,n,o,r){return kt(e,n,i,t,o,r)},e[pe.closeTab]=xt,e[pe.createNew]=xt,e[pe.dispose]=function(e,t,n,o,r){return function(e,t,i,n){return e!==ve.dispose?Promise.reject("Wrong flow"):new Promise((function(e){t.state=k.Disposing;var o=!!t.host.requireExplicitUnload,r=function(){var i={completion:"success"};t.raiseEvent(ge.Disposed,i),t.state=k.Disposed,e(i)};if(n&&n.subscribe((function(){e({completion:"cancelled"})})),i.application){var s=i.application;o&&s.registerEventHandlerInternal(Ot.Disposed,r),s.Dispose(o),o||r()}else i.pendingApplication?i.pendingApplication.Dispose(o,r):r()}))}(e,n,i,r)},e[pe.frameTrust]=xt,e[pe.handleBootState]=xt,e[pe.postMessage]=function(e,t,n,o,r){return function(e,t,i,n,o){return i.application.PostCommand(e,n),Promise.resolve({completion:"success"})}(e,0,i,t)},e[pe.rename]=function(e,t,n,o,r){return function(e,t,i,n,o){return new Promise((function(r){var s=function(e,t){var i={completion:t.NewName===n.NewName?"success":"failure"};c(i)},a=function(e,t){c({completion:"failure"})},c=function(e){t.removeActionHandler(me.bt,s),t.removeActionHandler(me.yt,a),r(e)};t.addActionHandler(me.bt,s),t.addActionHandler(me.yt,a),(o||new Oe(5e3)).subscribe((function(){c({completion:"cancelled"})})),i.application&&i.application.PostCommand(e,n)}))}(e,n,i,t,r)},e[pe.setOverlayContent]=xt,e[pe.switchMode]=function(e,t,n,o,r){return function(e,t,i,n,o){return new Promise((function(r){var s=function(e,t){a({completion:"success"})},a=function(e){t.removeActionHandler(me.Ut,s),r(e)};t.addActionHandler(me.Ut,s),(o||new Oe(5e3)).subscribe((function(){a({completion:"cancelled"})})),i.application&&i.application.PostCommand(e,n)}))}(e,n,i,t,r)},e),(t={},t[pe.boot]={buildAppBasePath:Mt,buildBootRequestParams:function(){return{appPageName:"",queryParamsOverrides:{},postDataOverrides:{}}}},t)]};function Dt(e,t,i){var n=h(h(h({},E(e.appUrl)),function(e){var t={};T(t,"jsapi","1"),T(t,"jsapiver","v2"),T(t,"corrid",e.sessionId),T(t,"usid",e.sessionId),T(t,"newsession","1"),T(t,"sftc","1"),e.hostSessionId&&T(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&T(t,"uih",i.uiHostName),i.uiHostIntegrationType&&T(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&T(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&T(t,"accloop","1"),n.rebootDoc&&T(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&T(t,"scnd","1"),n.authToken&&T(t,"sat","1"),n.customAuthConfig&&T(t,"cac","1"),n.excelExternalLinks&&T(t,"xlel","1"),n.refreshAccessToken&&T(t,"rat","1"),n.atMentions&&T(t,"sams","1"),n.moveToFolder&&T(t,"mtf","1"));var o=e.ui;o&&(o.language&&T(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&T(t,"uiembed","1"),o.hideHeader&&T(t,"hhdr","1"),o.highContrast&&T(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&T(t,"hodflp","1"));var r=e.wopi;r&&r.source&&T(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&T(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&T(t,"readonly","1"),s.disableChat&&T(t,"dchat","1"),s.cookieCompliant&&T(t,"mscc","1"),s.isNewFile&&(T(t,"new","1"),s.isFromHostTemplate&&T(t,"wdtpl","fromhost"))),e.user.isLicensed&&T(t,"islicenseduser","1"),e.actNavId&&T(t,"actnavid",e.actNavId),e.sessionContext&&T(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)T(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&T(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&T(t,"preseededwacsessionid",encodeURIComponent(u.id)));var f=e.throttling;f&&(f.protection&&T(t,"ctp",f.protection),f.request&&T(t,"rct",f.request));var h=e.hostInitDiagnostics;h&&(h.entryPoint&&T(t,"wdorigin",encodeURI(h.entryPoint)),h.userClickTime&&T(t,"wdhostclicktime",h.userClickTime.toString()));var d=e.rebootOverride;return d&&d.previousSessionId&&T(t,"wdprevioussession",d.previousSessionId),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=h(h({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function Bt(e,t){var i=function(e){var t={};T(t,Ae.Tn,String(window.devicePixelRatio>1.24)),T(t,Ae.Nn,String(w())),T(t,Ae.Pn,e.hostName),T(t,Ae.wn,le(e.featureManager,e.wdParams));var i=e.wopi;i&&(T(t,Ae.hn,i.accessToken),T(t,Ae.dn,i.expiry.toString()));var o=e.contentBundle;if(o&&o.url&&o.url.length>0){T(t,Ae.ln,o.url);var s=o.staleness,a=null!=s;a&&T(t,Ae.pn,s.toString()),e.logger.ULS.u(577783775,r.N,n.Info,"Content bundle staleness: "+(a?s:"N/A"))}var c=e.file,u=c.name;if(u){T(t,Ae.In,u);var f=u.lastIndexOf(".");if(-1!==f){var h=u.substring(f+1);h&&T(t,Ae.gn,h)}}c.getUrl&&T(t,Ae.Sn,c.getUrl),c.size&&T(t,Ae.bn,c.size.toString()),c.eTag&&T(t,Ae.mn,c.eTag),c.uniqueId&&T(t,Ae.vn,c.uniqueId);var d=e.newFileTemplate;d&&(T(t,Ae.Fn,d.getUrl),d.size&&T(t,Ae.bn,d.size.toString()),d.eTag&&T(t,Ae.mn,d.eTag),d.uniqueId&&T(t,Ae.vn,d.uniqueId)),e.user.id&&T(t,Ae.Wn,e.user.id),e.ownerId&&T(t,Ae.Rn,e.ownerId),e.sessionContext&&T(t,Ae.Un,e.sessionContext);var l=e.ui;return l&&l.controls&&T(t,Ae.En,JSON.stringify(l.controls)),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var Jt=[],Lt=function(e,t,i,o,s){return new Promise((function(e){var a,c=J();Wt(t,i.skipWopiValidation),i.state=k.Booting,i.pendingReboot=!1,oe(i.logger,!0);var u,f=!1,d=function(e,t){var s,a;f||(i.container.postMessage(we.ai,void 0),s=i.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach((function(e){s[e]=a[e]}))),o.onBootSuccess&&o.onBootSuccess(i),i.logger.ULS.u(596448985,r.N,n.Info,JSON.stringify(i.diagnostics)),i.logger.ULS.flush(),i.container.postMessage(we.vi,{HostInitializeDiagnostics:i.hostInitDiagnostics}),i.state=k.Booted;var c={completion:"success"};i.raiseEvent(ge.BootCompleted,c),p(c),ee(i.appInfo.name,i.logger)},l=function(e,t){i.logger.ULS.u(596448986,r.N,n.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),i.logger.ULS.flush(),i.state=k.Failed;var o={completion:"failure"};i.raiseEvent(ge.BootCompleted,o),p(o),ee(i.appInfo.name,i.logger)},p=function(t){f||(ue(),he(Jt),Jt=[],i.removeActionHandler(me.at,d),i.removeActionHandler(me.rt,l)),e(t)};if((s||new Oe(3e5)).subscribe((function(){p({completion:"cancelled"})})),i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():C(t.appUrl).toLowerCase(),i.appUrl=t.appUrl||"",i.bootParams=t.bootParams||{},i.appUrl&&N(i.appUrl)&&(i.bootParams.isNewFile=!0),i.rebootOverride=t.rebootOverride,i.appBasePath=o.buildAppBasePath(i),i.intent=t.intent,i.file=t.file,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.hostInitDiagnostics=h(h({},t.diagnostics),{hostInitializeCallTime:c}),i.wdParams=t.wdParams||{},window.location.search.substring(1).split("&").forEach((function(e){if(/^wd\w+=\w+/.test(e)){var t=e.split("=");i.wdParams[t[0]]=t[1]}})),t.rebootOverride&&(a=Ce(),i.sessionId=a[0],u=a[1],i.Pe.addSettingsChangeListener(i.logger.settingsChangeHandler)),i.logger.configure({remoteUlsEndpoint:_(i.appBasePath),sessionId:i.sessionId}),i.Pe.initializePeriodicFetch(i.appBasePath,i.sessionId),u&&i.logger.ULS.u(590966790,r.N,n.Info,JSON.stringify(u)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.u(590447446,r.N,n.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.u(596444237,r.N,n.Info,JSON.stringify({session:te(e),client:ie()}))}catch(t){e.logger.ULS.u(590447447,r.N,n.Error,"Failed to log init info: "+Y(t))}}(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:$(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var v=t.container;i.container=v instanceof xe?v:i.application.createContainer(v)}i.container.setMessageHandler(i.onMessage),(f=!!o.ignoreCompletionMessage&&o.ignoreCompletionMessage(i))||(i.addActionHandler(me.at,d),i.addActionHandler(me.rt,l));var m=o.buildBootRequestParams(i),w=Dt(i,m.appPageName,m.queryParamsOverrides);if(i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(w))try{o.beforePreload&&o.beforePreload(i);var g=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(z.We)&&(i.logger.ULS.u(590966791,r.N,n.Info,"HTTP2 preload enabled"),g=U(g));var S=void 0;i.ui&&(S=i.ui.language),S||(S=decodeURIComponent(A(w,"ui"))),i.preloader.preload(g,S,i.logger,i.featureManager)}catch(e){i.logger.ULS.u(590966792,r.N,n.Error,Y(e))}var b=Bt(i,m.postDataOverrides);o.beforeContainerBoot&&o.beforeContainerBoot(i,w),i.appInitDiagnostics.officeFrameCreateTime=J(),i.container.boot(w,b,i.logger),f?d(me.at,{Diagnostics:{}}):(ce(I(i.appBaseUrl),i.Pe,i.logger,(function(){return fe(i.logger)})),Jt.push(window.setTimeout((function(){return fe(i.logger,1)}),i.Pe.getValue(j.ge,6e4))),Jt.push(window.setTimeout((function(){return fe(i.logger,2)}),i.Pe.getValue(j.Se,18e4))))}))},jt=function(e,t,i,o,s){return new Promise((function(e){i.logger.ULS.u(579342435,r.N,n.Info,"Received close tab message");try{window.close()}catch(e){i.logger.ULS.u(579213189,r.N,n.Warning,"Failed to close the browser tab")}e({completion:"success"})}))},Vt=function(e,t,i,o,s){return new Promise((function(e){var t=i.host.requireExplicitUnload,o={disposeStartTime:J(),forceAppUnload:t};i.state=k.Disposing;var a=function(){var t={completion:"success"};i.raiseEvent(ge.Disposed,t),i.state=k.Disposed,e(t)},c=function(e){i.dispose(),o.disposeEndTime=J(),function(e,t,i){if(i){var o=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(o)&&(t.hostToAppPostMessageLatency=o-t.appUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var f in u)t["st-"+f.toString()]=u[f]}}e.logger.ULS.u(592524822,r.N,n.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,o,e),re(),i.container?i.container.dispose(i.pendingReboot,t).then(a):a()};if(t){o.appUnloadStartTime=J();i.addActionHandler(me.Zt,(function(e,t){o.appUnloadEndTime=J(),c(t)})),(s||new Oe(5e3)).subscribe((function(){i.state===k.Disposing&&(o.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(we.xi,void 0)}else c()}))};var qt=function(e,t,i,o,s){return new Promise((function(e){var t=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.u(592445957,r.N,n.Info,"Top frame is trusted: "+t),i.container&&i.container.postMessage(we._t,{isTopFrameTrusted:t}),e({completion:"success"})}))},zt=function(e,t,i,o,s){return new Promise((function(e){var s=t&&t.state?t.state:"Unknown";i.logger.ULS.u(592839750,r.N,n.Info,"Boot state: ["+s+"]"),o&&o.beforeComplete&&o.beforeComplete(s),e({completion:"success"})}))},Gt=function(e,t,i,n,o){return new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(me.bt,n),i.removeActionHandler(me.yt,r),e(t)};i.addActionHandler(me.bt,n),i.addActionHandler(me.yt,r),(o||new Oe(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(we.Si,t)}))},Zt=function(e,t,i,n,o){return new Promise((function(e){var n=function(e,t){r({completion:"success"})},r=function(t){i.removeActionHandler(me.Ut,n),e(t)};i.addActionHandler(me.Ut,n),(o||new Oe(5e3)).subscribe((function(){r({completion:"cancelled"})})),i.container&&i.container.postMessage(we.Fi,t)}))};function $t(e){Ct(e.logger)}function Xt(e){var t,i,n=e.appUrl.toLowerCase().indexOf("_layouts/xlembed.aspx")>-1?"_layouts/xlembed.aspx":Rt,o={},r={};T(o,"wdredirectionreason","Force_SingleStepBoot");var s=e.bootParams;s&&s.isNewFile?(o["unified".toLowerCase()]="",T(o,"edit","1"),T(o,"new","1")):T(o,"instantedit","1"),e.hostInitDiagnostics&&T(r,Ae.An,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics}));var a=e.rebootOverride;if(a){var c=a.mode;c&&("view"===(c=c.toLowerCase())?T(o,"wdforcedmode","View"):"edit"===c&&T(o,"wdforcedmode","Edit"))}var u=null===(i=null===(t=e)||void 0===t?void 0:t.file)||void 0===i?void 0:i.size;return u&&u>=52428800&&u<=104857600&&T(o,"ilf","1"),{appPageName:n,queryParamsOverrides:o,postDataOverrides:r}}function Kt(e,t){st(t)&&nt(e.logger,e.container.formId,e.featureManager,e.sessionId)}var Qt,Yt=function(e){return e.isFeatureEnabled(z.Ne)||e.isFeatureEnabled(z.He)?[(t={},t[pe.appReboot]=Ft,t[pe.boot]=Lt,t[pe.closeTab]=jt,t[pe.createNew]=xt,t[pe.dispose]=Vt,t[pe.frameTrust]=qt,t[pe.handleBootState]=zt,t[pe.postMessage]=xt,t[pe.rename]=Gt,t[pe.setOverlayContent]=je,t[pe.switchMode]=Zt,t),(i={},i[pe.boot]={beforePreload:$t,buildAppBasePath:Mt,buildBootRequestParams:Xt,beforeContainerBoot:Kt,onBootSuccess:rt},i[pe.handleBootState]={beforeComplete:ot},i)]:Ht();var t,i};!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Qt||(Qt={})),i.d(t,"Application",(function(){return ei})),i.d(t,"createApplication",(function(){return ti})),i.d(t,"DocRebootSupportMode",(function(){return Qt})),i.d(t,"CommandIds",(function(){return ve})),i.d(t,"EventIds",(function(){return ge})),i.d(t,"createCancellationToken",(function(){return _e}));var ei=new _t((function(e,t,i,n,o){return new Et(e,t,i,n,o)}),{forceSingleStepBoot:!0,preloader:F(Ut,Nt)}),ti=function(e){var t={name:"Excel",preloader:F(Ut,Nt)};return new We(e,t,Yt)}}});

