var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);t.utils=n;var a=r(9);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(10);t.browserSupport=i;var o=r(11);t.perfWatch=o;var u=r(12);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var s=r(13);t.initStopwatchFactory=s.initStopwatchFactory;var c=r(14);t.getNewGuid=c.getNewGuid;var l=r(15);t.TextAreaVirtualKeyboardPolicy=l.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=l.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.mathpack=n;var a=r(19);t.dtr=a,r(3)._start()},function(e,t,r){"use strict";r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function o(e){return s(e)&&"WorkerError"===e.name&&"object"==typeof e.info}var u=function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.isWorkerError=o,t}(Error);function s(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function c(e){return s(e)?e:new Error("(non-Error object) "+e)}var l={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){return{name:e.name,message:e.message,stack:e.stack,info:o(e)?(t=e.info,a(a({},t),{error:t.error?d(t.error):void 0})):void 0};var t}function f(e){return s(e)?{isError:!0,value:d(e)}:{isError:!1,value:e}}function v(e){var t;if("WorkerError"===e.name)t=new u(e.message,function(e){return a(a({},e),{error:e.error?v(e.error):void 0})}(e.info));else{var r=l[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function h(e){return e.isError?v(e.value):e.value}var p;function m(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function g(e){if(p)throw new TypeError("setConfig has already been called");p=e}function S(){var e=null!=p?p:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?i(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function y(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function C(e,t){var r,n=null!=(r=t.stack)?r:t.message;console.warn(e+": "+n),o(t)&&console.warn("WorkerError info:",t.info)}function k(e){var t=y();if(void 0!==t){var r={kind:1,error:f(e)};t.postMessage(r)}else C("defaultOnWorkerError",e)}function b(e){var t,r;try{(null!=(r=null===(t=p)||void 0===t?void 0:t.onWorkerError)?r:k)(e)}catch(t){C("dispatchWorkerError",c(t)),C("dispatchWorkerError (original)",e)}}function E(e){var t=y();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function A(e){var t,r;try{(null!=(r=null===(t=p)||void 0===t?void 0:t.onCreateWorker)?r:E)(e)}catch(e){C("dispatchCreateWorker",c(e))}}var T=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return T.transfer.apply(T,i([e,void 0],t))};function N(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}T.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};function R(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function F(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function I(e,t){var r=F(),n=function(t,r){var n;return null!=(n=t[r])?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}var D=-1,w=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=F();var i=function(){var e,t;return null===(t=(e=a).onClose)||void 0===t?void 0:t.call(e)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r,n=e.funcNames;null===(r=(t=a).onImports)||void 0===r||r.call(t,I(a.createPostProxy.bind(a),n),I(a.createCallProxy.bind(a),n))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:"function"==typeof Proxy?void 0:function(e){for(var t=F();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new u("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,i=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var i=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new u("Exporting Endpoint received a "+i+" to unknown function "+n,o)}));r>=0?i.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):i.catch((function(e){return t.sendResult(r,n,!1,e)}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:f(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,c(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,i=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new u(i,o);a.isError?b(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return R(r,(function(){var n=a.takeCallbacks(e);if(n){var i={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new u("Importing Endpoint's call to "+t+" timed out",i))}}),n)},e.prototype.sendCall=function(e,t,r,n){var i=this;return new Promise((function(o,s){var l=D+=1,d={kind:0,callId:l,funcName:e,args:t};i.unresolvedCalls[l]=a(a({},i.setCallTimeout(l,e,r,{resolve:o,reject:s})),{funcName:e});try{i.port.postMessage(d,n)}catch(t){var f=i.takeCallbacks(l);if(f){var v=c(t),h={cause:"MessageError",idInfo:i.idInfo,error:v,callId:l,funcName:e};f.reject(new u("Importing Endpoint failed to send call to "+e,h))}}}))},e.prototype.sendPost=function(e,t,r){var n={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(n,r)}catch(t){var a=c(t),i={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};throw new u("Importing Endpoint failed to post to "+e,i)}},e.prototype.onSendInvokeFailed=function(e){var t,r,n=e.callId,a=e.funcName,i=n>=0?"call":"post",o={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:a},s=new u("Exporting Endpoint failed to deserialize "+i+" to "+a,o);(null!=(r=null===(t=n>=0?this.takeCallbacks(n):void 0)||void 0===t?void 0:t.reject)?r:b)(s)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var i=this.takeCallbacks(t);if(i)(n?i.resolve:i.reject)(h(a))}else if(!n){var o=a.isError?v(a.value):void 0,s={cause:"UnhandledError",idInfo:this.idInfo,error:o,callId:t,funcName:r};b(new u("Exporting Endpoint's "+r+" implementation threw or rejected",s))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,i([void 0],e))};return r.transfer=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];t.isClosed||t.sendPost(e,n,r)},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,i([void 0],e))};return r.transfer=function(n){for(var a,i,o,s,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];if(t.isClosed){var d={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new u(t.idInfo.side+" Endpoint's call."+e+" called after close",d))}var f=null!=(s=null!=(a=r.timeout)?a:null===(o=(i=t).getCallTimeout)||void 0===o?void 0:o.call(i))?s:1/0;return t.sendCall(e,c,f,n)},r.timeout=void 0,r},e}();var M,_=function(){function e(e,t,r){this.callTimeout=1/0,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new u(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,i,o,s=r.port,c=r.options,l=r.createMode,d={type:"Endpoint",side:t,id:null===(a=c)||void 0===a?void 0:a.id};try{i=new w(d,s),o=new e(d,i,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;i.getCallTimeout=function(){return o.callTimeout},i.onImports=function(e,t){Object.defineProperties(o,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},i.onClose=function(){return o.close("Force")};var s,l=function(e){var t,r,n,a;return null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createTimeout)?r:null===(n=p)||void 0===n?void 0:n.createTimeout)?a:3e5}(c),f=R(l,(function(){var e=new u(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:d,timeout:l});f.reject(e)}),{resolve:e,reject:r});o._closedDuringCreate=function(){f.resolve()};try{s=n(o)}catch(e){return f.reject(e)}null===(a=o._state)||void 0===a||a.setExports(s)})).then((function(){return o._closedDuringCreate=void 0,o}),(function(e){return o._closedDuringCreate=void 0,o.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new u(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:c(e)};b(new u(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r).then((function(){}))},e}(),O=function(){!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function o(e){return u(e)&&"WorkerError"===e.name&&"object"==typeof e.info}!function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}(function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.isWorkerError=o}(Error);function u(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError;function s(e){return{name:e.name,message:e.message,stack:e.stack,info:o(e)?(t=e.info,a(a({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError(e+" is not defined")}function l(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),a=0,i=n;a<i.length;a++){e=e[i[a]]}return null!=e?e:r(t)}catch(e){return r(t)}}var d=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return d.transfer.apply(d,i([e,void 0],t))};d.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var f="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function v(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:f()))}self.onmessage=function(e){var t,r=e.data,n=r.config,a=r.port,c=r.options,d=r.script,h=r.args;function p(){var e;if(t)return t;if(void 0===n.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(n.typedWorkersUrl),(t=l(self,null!=(e=n.typedWorkersName)?e:"typedWorkers")).setConfig(n),t}self.onmessage=null,self.__typed_workers_thread=!0;var m={status:"Pending",start:f()};function g(e,t){var r,n={kind:0,error:e?void 0:(r=function(e){return u(e)?e:new Error("(non-Error object) "+e)}(t),u(r)?{isError:!0,value:s(r)}:{isError:!1,value:r}),stopwatch:m};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw v(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=v(e,"Success"))?r:t}),r)}catch(e){r(e)}})(m,(function(){var e,t,r;return importScripts.apply(void 0,i(null!=(r=null!=(t=null===(e=c)||void 0===e?void 0:e.importScriptUrls)?t:n.importScriptUrls)?r:[],void 0!==d.scriptUrl?[d.scriptUrl]:[])),l(self,d.insideInitName).apply(void 0,i([{config:n,importTypedWorkers:p,connection:{port:a,options:c,createMode:"Thread"}}],h))})).then((function(){return g(!0)}),(function(e){return g(!1,e)}))}catch(e){g(!1,e)}}}])},x=-1;function L(){return void 0===M&&(M="("+O.toString()+")();"),M}var P=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:T(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(x+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[L()]:[n,"\n\n",L()];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,n=e.port,a=e.options,c={type:"Thread",side:"Outside",id:a.id},l=this.worker;return N(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var f={config:S(),port:n,options:a,script:r.script,args:r.args};l.postMessage(f,i([n],r.transferables)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(s(r.error)){if(o(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new u(t+" received an unhandled error",n)}if(null==r.message)return new u(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var a={cause:"UnhandledError",idInfo:e},i=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new u(t+" received an unhandled error: "+i,a)}(c,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):b(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(h(i.error));case 1:return b(h(i.error));case 2:return A(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function B(){return{status:"Pending",start:U()}}function G(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:U()))}function V(e,t){function r(t){throw G(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=G(e,"Success"))?r:t}),r)}catch(e){r(e)}}function H(e){return Math.round(1e3*e)/1e3}function W(e,t,r){return e<t?t:e>r?r:e}function j(e,t,r){var n,a,i,o,u,s,c=W(null!=(a=null===(n=e)||void 0===n?void 0:n.start)?a:1/0,t,r),l=W(null!=(o=null===(i=e)||void 0===i?void 0:i.end)?o:1/0,t,r);return{status:(s=null===(u=e)||void 0===u?void 0:u.status,null!=s?s:"Pending"),start:H(c-t),end:H(l-t),duration:H(l-c)}}var K=function(){return r(2)};function Y(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,s=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),V(r.createOutside=B(),(function(){return _.createOutside({port:s,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):s.close(),Promise.reject(e)}))}function q(e,t,r,n){return Y(e,"Local",t,(function(e){return function(e,t,r){var n="def"in r?r:T(r),a=n.def,o=n.args;if("function"!=typeof a){var s={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new u("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then((function(){return V(t.insideInit=B(),(function(){return a.apply(void 0,i([{config:S(),importTypedWorkers:K,connection:e}],o))}))}))}(e,t,r)}),n)}function J(e,t,r,n){var a;t.createThread=B();try{a=new P(r)}catch(e){return G(t.createThread,"Error"),Promise.reject(e)}return G(t.createThread,"Success"),Y(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function z(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n,a,i=null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createMode)?r:null===(n=p)||void 0===n?void 0:n.createMode)?a:"Thread";return"ThreadOrLocal"===i?m()?"Thread":"Local":i}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?q:J,o={id:e.id,createMode:n,createWorker:B()};return N(V(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,s=n.start,c=n.end;if("Pending"!==u&&void 0!==c)return{id:t,createMode:r,createWorker:{status:u,absStart:s,duration:H(c-s)},createThread:"Thread"===r?j(o,s,c):void 0,createOutside:j(i,s,c),insideInit:j(a,s,c)}}(o);e&&A(e)}))}r.d(t,"WorkerError",(function(){return u})),r.d(t,"isThreadingSupported",(function(){return m})),r.d(t,"setConfig",(function(){return g})),r.d(t,"paramInsideDef",(function(){return T})),r.d(t,"Endpoint",(function(){return _})),r.d(t,"createWorker",(function(){return z}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatScientific=t.Mathpack_FormatFixed=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_TenTo=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToDays=t.Dtr_Days=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_Write=t.Dtr_Rounding=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(16),a=r(17),i=r(18),o=new ArrayBuffer(8),u=new Int32Array(o),s=(new Float32Array(o),new Float64Array(o));function c(e){return u[e]}function l(e,t){u[e]=t}function d(){return s[0]}function f(e){s[0]=e}var v,h=new ArrayBuffer(65536),p=(v=new Uint8Array(h),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)v[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)v[e+n]=r[n]});p(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),p(1152,"sAsAAMgLAADACwAA0As="),p(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),p(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),p(1975,"oAQ="),p(1991,"yAc="),p(2007,"+go="),p(2022,"QJwO"),p(2038,"UMMR"),p(2054,"JPQU"),p(2069,"gJaYGA=="),p(2085,"ILy+Gw=="),p(2101,"KGvuHg=="),p(2117,"+QKVIg=="),p(2132,"QLdDuiU="),p(2148,"EKXU6Cg="),p(2164,"KueEkSw="),p(2179,"gPQg5rUv"),p(2195,"oDGpX+My"),p(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),p(3728,"ME8=");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),s=new e.Uint16Array(r),v=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,m=(e.Math.fround,e.Math.abs),g=e.Math.clz32,S=e.Math.min,y=(e.Math.max,e.Math.floor),C=e.Math.ceil,k=e.Math.sqrt,b=t.abort,E=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),A=t.Base_LocaleGetOrdinal,T=t.Base_LocaleDecimalSeparator,N=t.Math_log10,R=t.Math_log,F=(k=t.Math_sqrt,t.Math_sin),I=t.Math_cos,D=t.Math_tan,w=t.Math_atan,M=t.Math_exp,_=t.proc_exit,O=20112,x=0;function L(){}function P(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function U(e,t){var r,u,l=0,d=0,v=0,p=0;if(d=3680,O=r=O-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[460]=e,u=Y(e),h[460]=u,ye(u,r+40|0,r,15),s[r+42>>1]){l=(0|(l=de(t)<<16))<0?100:l>>16,f(+t),v=0|c(1),c(0),(p=-65536&v)&&(2146435072!=(2146435072&v)?l=(0|p)<1?0-l|0:l:i[922]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){d=3e3;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}Se(3100,3680,r)}e=h[d>>3]}return O=r+48|0,e}function B(e,t){var r,n=0,a=0,o=0;if(h[460]=e,f(+e),a=0|c(1),c(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[922]=1,a=0)),i[921]=2147483647&o,te(h[374]),n=-65536&(o=i[921]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return q(8),0}else i[922]=1;r=re(h[374],e),h[460]=re(h[372],r),ne(r),he();e:{t:{if((n=i[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[922]=1}if(t){if(i[920]=0,i[921]=0,!a)break e;return t=i[741],i[920]=i[740],i[921]=t,h[460]}if(n=i[747],i[920]=i[746],i[921]=n,t=n,1^a|n>>>0<65536)break e;return i[921]=-2147483648^t,h[460]}be(e),pe(),t&&(h[460]=re(h[373],h[460]))}return h[460]}function G(e,t,r,n){var u,c=0,l=0,d=0,f=0,v=0,h=0,m=0;if(c=i[e+4>>2],v=-2146827284,!((0|(u=(l=s[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|u)||((d=d+p(e,-12)<<16>>16)+-1&65535)>>>0>11|(!c|1900==(0|u)&2==(0|d)&29==(0|c)?!r:0))){if(h=(0|(e=(f=(0|(l=u+1e4|0))/4|0)<<2))%100|0,m=(0|e)%400|0,c=(((f=p(f,1461)+c|0)+((0|(c=e+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,l=(p(l-e|0,12)+d|0)-1|0)for(l=l+(e=m?h?0:12:0)|0;c=o[e+1072|0]+c|0,(0|l)!=(0|(e=e+1|0)););e:if(r||t){if(e=c+-4346385|0,!((0|u)>1900|(0|d)>=3))break e;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(i[n>>2]=e,v=0)}return v}function V(e,t,r){var n,u,s,c=0,l=0,d=0;l=d=Re(e,t,711573504,201),i[r+28>>2]=(l+1>>>0)%7,c=l+p(n=(l>>>0)/146097|0,-146097)|0,u=(p(c,100)+75>>>0)/3652425|0,c=((s=p(u,-36524)+c|0)>>>0)/1461|0,l=(((l+(((c=((p(u,100)+p(n,400)|0)+(c<<2)|0)+((p(s+p(c,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(c>>>2)|0)-((c>>>0)/400|0)|0)+p(c,-365)|0,d=Ne(d,x,-864e5,-1),e=Re(e,t,1e4,0)+d|0,d=!(((t=c+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=o[l+1568|0])<<1)|0:1536+((t=o[l+1168|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=c+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-p(t,1e3),i[r+8>>2]=1+(l-a[d>>1]|0)}function H(e,t){var r=0,n=0,o=0,u=0,s=0,c=0,l=0,d=0,f=0,v=0,h=0,m=0;return(0|(u=i[e+4>>2]))<1||(d=u+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(s=i[e+8>>2]))<1||(o=1536,((c=65535&r)>>>0)%400&&(o=3&r?1936:(c>>>0)%100|0?1536:1936),(f=i[e+24>>2])>>>0>999||(c=i[e+20>>2])>>>0>59||(v=i[e+16>>2])>>>0>59||(h=i[e+12>>2])>>>0>23||(s=s+-1|0)>>>0>=a[o+(u<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,u=p(n,365),n=((e=65535&n)>>>0)/400|0,m=(e>>>0)/100|0,((l=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((l>>>0)%100)|3&r)||(e=1536),l=1,r=(r=p(p(p(h,60)+v|0,60)+c|0,1e3)+f|0)+(n=Ne(e=a[(d<<1)+e>>1]+(n+((s+(u+o|0)|0)-m|0)|0)|0,e>>31,864e5,0))|0,e=x,i[t>>2]=Ne(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=x)),l}function W(e,t,r,n){var a,o=0,u=0,s=0,c=0;O=a=O-112|0,V(r,n,a+80|0);e:{if(i[e>>2]){if(!H(e,t))break e}else{if((0|(u=i[e+8>>2]))>5|!u)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!H(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,s=(0|u)<2,V(i[a+8>>2],i[a+12>>2],a+16|0),c=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[c+56>>2]=e}t:if(!s&&(r=e+7|0,i[a+56>>2]=r,o=1,H(a+48|0,a+8|0)))for(;;){if(V(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|u)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!H(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!H(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return O=a+112|0,o}function j(e,t,r){var n,o=0,u=0,c=0,l=0,d=0;if(O=n=O-16|0,r&&(c=r>>31,c^=c+r))for(r=(0|r)>0?1952:2448;(o=15&c)&&(u=a[(o=(o<<4)+r|0)+8>>1],d=K(h[e>>3],h[o>>3],n),t=t+u|0,a[n+14>>1]<=0?(o=s[n+6>>1],u=s[n+8>>1]):(u=i[n+4>>2],o=s[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,u=l<<1|u>>>31,i[n+8>>2]=u,t=t+-1|0),(65535&o|1&u|0!=(0|d))>>>0<32769||(u=(o=i[n+8>>2])+1|0,i[n+8>>2]=u,u>>>0>=o>>>0||(u=(o=i[n+12>>2])+1|0,i[n+12>>2]=u,u>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,c>>=4;);return O=n+16|0,t}function K(e,t,r){var n,i,o,u=0,s=0,l=0,d=0,v=0,h=0,m=0,g=0,S=0,y=0,C=0,k=0;return f(+t),d=0|c(1),v=65535&(s=0|c(0)),f(+e),y=0|c(1),u=0|c(0),l=y,i=p(g=65535&u,v),a[r>>1]=i,o=((65535&(C=p(S=u>>>16,v)))+(i>>>16)|0)+(65535&(m=p(s>>>=16,g)))|0,a[r+2>>1]=o,C=(((h=((65535&(u=p(n=65535&l,v)))+(C>>>16)|0)+(m>>>16)|0)+(65535&(m=p(s,S)))|0)+(65535&(k=p(y=65535&d,g)))|0)+(o>>>16)|0,a[r+4>>1]=C,m=(((((((65535&(h=p(d>>>=16,g)))+(u>>>16)|0)+(65535&(l=p(u=l>>>16,v)))|0)+(m>>>16)|0)+(k>>>16)|0)+(65535&(v=p(y,S)))|0)+(65535&(g=p(s,n)))|0)+(C>>>16)|0,a[r+6>>1]=m,S=((((((k=(l>>>16)+(h>>>16)|0)+(65535&(l=p(d,S)))|0)+(v>>>16)|0)+(g>>>16)|0)+(65535&(h=p(u,s)))|0)+(65535&(s=p(y,n)))|0)+(m>>>16)|0,a[r+8>>1]=S,h=((s=(((65535&(v=p(d,n)))+(l>>>16)|0)+(h>>>16)|0)+(s>>>16)|0)+(65535&(l=p(u,y)))|0)+(S>>>16)|0,a[r+10>>1]=h,u=(((65535&(d=p(u,d)))+(v>>>16)|0)+(l>>>16)|0)+(h>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(d>>>16),65535&(i|o|C)}function Y(e){var t,r,n=0,a=0,o=0,u=0,s=0,l=0;return O=t=O-16|0,h[t+8>>3]=e,f(+e),n=0|c(1),a=0|c(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=p(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=j(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(v[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=j(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(l=(s=i[t+12>>2])+1|0,i[t+12>>2]=l,l>>>0>=s>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=j(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),O=t+16|0,e}function q(e){var t;return t=i[922],i[922]=e,t}function J(){var e,t,r;return e=i[920],t=i[921],$(1048576),$(2146435072),a[1843]<0?(i[920]=e,i[921]=t,-2147483648):(r=le(),i[920]=e,i[921]=t,-2147483648^r)}function z(e){var t,r=0,n=0,a=0,i=0;if(f(+e),r=0|c(1),t=0|c(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+d();i&=n,l(0,0),l(1,0|i),a=+d()}return a}function Q(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[920]=0,i[921]=-2147483648,n=j(3680,1,e),r=i[920],e=i[921],3071&r&&(t=i[921],(e=i[920]+1024|0)>>>0<1024&&(t=t+1|0),i[920]=e,i[921]=t,r=e,e=t),i[920]=e<<21|r>>>11,void(i[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[922]=1),i[920]=0,i[921]=0}function X(e,t,r,n){var o=0,u=0,c=0;e:{t:{r:{n:{if(!n){if(s[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(s[(n<<1)+e>>1]<=52)break e;for(;;){if(c=s[(u=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[u>>1]=c,58!=(65535&c))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==s[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[920],t=-65536&(e=i[921])){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)<1)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||te(1)}function $(e){h[460]=ee(h[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=h[375]),e}function te(e){h[460]=re(h[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=h[375]),e}function ne(e){h[460]=ae(h[460],e)}function ae(e,t){var r,n=0,a=0,o=0;return f(+e*t),n=0|c(1),r=0|c(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[750]:r,n=a?i[751]:n,l(0,0|o),l(1,0|n),+d()):(i[922]=1,n=i[751],l(0,i[750]),l(1,0|n),+d())}function ie(e){h[460]=oe(h[460],e)}function oe(e,t){var r=0,n=0,a=0,o=0;if(f(+t),r=0|c(1),c(0),2146435072&r){if(n=1,f(+e/t),r=0|c(1),a=0|c(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[750]:a,r=n?i[751]:r,l(0,0|a),l(1,0|r),+d()}else n=4;return i[922]=n,r=i[751],l(0,i[750]),l(1,0|r),+d()}function ue(e){h[460]=e>>>0}function se(e){h[460]=0|e}function ce(){var e,t;e=+R(+h[460]),h[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function le(){return de(h[460])}function de(e){var t,r=0,n=0,a=0,i=0;return f(+e),i=1106247680==(0|(a=2146435072&(r=0|c(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|c(0))),l(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=m(e)>=1?e>0?~~S(y(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return ve(h[460])}function ve(e){var t=0,r=0;return f(+e),t=0|c(1),c(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=m(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function he(){var e,t;e=+k(+h[460]),h[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function pe(){var e,t;e=+w(+h[460]),h[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function me(){h[460]=z(h[460])}function ge(){var e,t;e=+M(+h[460]),h[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=1)}function Se(e,t,r){return function(e,t,r){var n=0,u=0,l=0,d=0;if(n=o[r+30|0]){for(u=r;d=10*d+ +(0|Ie[i[i[e>>2]+4>>2]](e,s[u>>1])),u=u+2|0,l=(0|n)>1,n=n+-1|0,l;);if(f(+d),n=0|c(1),e=0|c(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=j(t,(n>>>20&2047)-1022|0,((32767&s[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(u=i[t>>2])?(e=u+1024|0,i[t>>2]=e,u>>>0<4294966272||(l=(u=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<u>>>0)+n|0)):e=u,!((0|n)<=-1022))return(0|(u=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|u|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,o){!function(e,t,r,o){var u,l,d=0,v=0,m=0,g=0,S=0,y=0,C=0,k=0,b=0,E=0;O=u=O-16|0,h[u+8>>3]=e,l=t,f(+e),v=0|c(1),m=0|c(0),g=d=v;e:if(v=2146435072&d){if(v=p(S=(v>>>20)-1022|0,39457)>>17,a[r+32>>1]=v+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+v|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[u+8>>2]=m<<11,i[u+12>>2]=g<<11|m>>>21|-2147483648,(0|(d=j(u+8|0,S,-1^v)))>=1)for(m=r+32|0;v=s[m>>1],a[m>>1]=v+1&32767|32768&v,(0|(d=j(u+8|0,d,-1)))>0;);if(d?(v=(m=i[u+12>>2])>>>(g=0-d|0),i[u+12>>2]=v,d=m<<d+32|i[u+8>>2]>>>g,i[u+8>>2]=d):(d=i[u+8>>2],v=i[u+12>>2]),d=(m=v>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[u+8>>2]=d,d>>>0<m>>>0&&(v=v+1|0,i[u+12>>2]=v),(0|o)<1)m=r;else{for(y=d>>>16,C=s[u+14>>1],k=r+32|0,E=15==(0|o),m=r,g=1;;){S=o;t:{r:{for(;;){if(o=p(y,10)+(p(65535&d,10)>>>16)>>>16,b=p(C,10)+(o+p(65535&v,10)>>>16)>>>16|48,a[m>>1]=b,C=(v=o+p(v,10)|0)>>>16,y=(d=p(d,10))>>>16,1&(-1^g|48!=(0|b)))break r;if(o=s[k>>1],a[k>>1]=o+-1&32767|32768&o,!E)break}g=1;break t}m=m+2|0,g=0}if(o=S+-1|0,!((0|S)>1))break}i[u+12>>2]=v,i[u+8>>2]=d}d=(o=m-r|0)>>1;t:{if((0|o)<=29){if((0|v)<=-1){a[m>>1]=57,v=d+1|0;break t}a[m>>1]=48}for(;;){if(v=d,(0|d)<1)break t;if(d=v+-1|0,48!=s[(m=m+-2|0)>>1])break}}n[r+30|0]=v,a[t+2>>1]=v,t=(32767&s[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[l>>1]=t,O=u+16|0}(e,t,r,o)}function Ce(e){return re(h[460],e)}function ke(e){return oe(h[460],e)}function be(e){h[460]=oe(e,h[460])}function Ee(e,t){h[460]=oe(e,t)}function b(){_(1),b()}function Ae(e,t){var r,n;r=0|e,n=0|t,u[0]=r,u[1]=n}function Te(e,t,r,n){var a=0,i=0;return r=function(e,t,r,n){var a=0,i=0,o=0,u=0,s=0,c=0,l=0,d=0,f=0,v=0;e:{t:{r:{n:{a:{i:{o:{u:{s:{c:{if(o=t){if(!(a=r))break c;if(!(i=n))break s;if((a=g(i)-g(o)|0)>>>0<=31)break u;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ae(e-p(t=(e>>>0)/(r>>>0)|0,r)|0,0),x=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return Ae(e,o&i),e=o>>>(31&Fe(a)),x=0,e}if(!((i=a+-1|0)&a))break a;s=(g(a)+33|0)-g(o)|0,c=0-s|0;break r}s=a+1|0,c=63-a|0;break r}return Ae(0,o-p(e=(o>>>0)/(a>>>0)|0,a)|0),x=0,e}if((a=g(a)-g(o)|0)>>>0<31)break n;break t}if(Ae(e&i,0),1==(0|a))break e;return r=Fe(a),n=e,e=31&r,32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),x=a,e}s=a+1|0,c=63-a|0}if(i=t,f=e,o=31&(a=63&s),32<=(63&a)>>>0?(a=0,u=i>>>o):(a=i>>>o,u=((1<<o)-1&i)<<32-o|f>>>o),i=a,o=e,e=31&(a=63&c),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,s)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),c=a;a=i<<1|u>>>31,i=u<<1,f=a,a=(u=c-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,u=(d=i)-(i=r&(l=u>>31))|0,i=f-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=v|e<<1,t=0|a,d=0,v=l&=1,s=s+-1|0;);return Ae(u,i),x=(a=t<<1|e>>>31)|d,e=l|e<<1}Ae(e,t),e=0,t=0}return x=t,e}((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),x=((e=(t^=n)>>31)^x)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function Ne(e,t,r,n){return e=function(e,t,r,n){var a,i,o,u,s=0,c=0;return u=p(s=r>>>16,c=e>>>16),s=(65535&(c=((o=p(a=65535&r,i=65535&e))>>>16)+p(c,a)|0))+p(s,i)|0,e=(((p(t,r)+u|0)+p(e,n)|0)+(c>>>16)|0)+(s>>>16)|0,x=e,t=65535&o|s<<16}(e,t,r,n)}function Re(e,t,r,n){return e=Te(e,t,r,n)}function Fe(e){return e?31-g(e+-1^e)|0:32}var Ie=[null,function(e,t){return 0,0!=(0|E(0|(t|=0)))|0},function(e,t){return 0,0|A(0|(t|=0))},function(e){return 0,0|T()},function(e,t){return 0,(t|=0)+-48|0},L];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,u){return e=+e,t|=0,n|=0,u|=0,r=p(r|=0,20)+3616|0,a[r>>1]=0,t=function(e,t,r,n,u){var v=0,m=0,g=0,S=0,y=0,C=0,k=0,b=0,E=0;e:if(!s[e>>1]){if(h[460]=t,f(+t),v=0|c(1),g=0|c(0),C=v,E=-65536&v)if(2146435072!=(2146435072&v)){if(!((0|E)>=1))return-2147467259}else i[922]=1;y=i[770],k=i[771],S=-1;t:{if(!((0|v)<(0|(m=k))||(S=1,(0|v)>(0|m)))){if((0|y)==(0|(m=g)))break t;S=m>>>0<y>>>0?-1:1}if(m=-2147467259,1==(0|((C&k)>-1?S:0-S|0)))break e}t:{if(y=i[772],m=i[773],k=m,S=-1,!((0|v)<(0|m)||(S=1,(0|v)>(0|k)))){if((0|g)==(0|y))break t;S=g>>>0<y>>>0?-1:1}if(y=S,-1==(0|((m&C)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(u|!E))if(2146435072!=(2146435072&v)){if((0|E)<1)break r}else i[922]=1;$(h[i[1056+(r<<2)>>2]>>3]),b=h[460];break t}Z(),te(t),C=i[921],g=C,l(0,0|(v=i[920])),l(1,0|g),b=+d(),i[750]==(0|v)&&i[751]==(0|g)||(m=i[921])>>>0<65536||(i[921]=-2147483648^m,f(+(b=h[460])),g=0|c(1),v=0|c(0)),C=g,y=g,g=i[1056+(r<<2)>>2],k=i[g+4>>2],m=i[g>>2],S=-1;r:{if(!((0|y)<(0|(g=k))||(S=1,(0|y)>(0|g)))){if((0|v)==(0|m)){h[460]=t;break r}S=v>>>0<m>>>0?-1:1}if(y=S,h[460]=t,-1==(0|((C&k)>-1?y:0-y|0)))break t}te(h[374])}if(a[e+18>>1]=r,v=fe(),m=-2147467259,!q(0)){if(n){if((0|v)>2957003)break e;v=v+1462|0}else if(v+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((v+6|0)%7|0),!u|v)if(v){if((0|v)<=-1?(g=-4-((n=(-1^v)/1461|0)<<2)|0,m=1461+(p(n,1461)+v|0)|0):(g=(n=(v+-1|0)/1461|0)<<2,m=p(n,-1461)+v|0),!(u&&(0|g)<=199))if((0|(m=(((0|(n=g+-101|0))/100|0)-((0|n)/400|0)|0)+m|0))>=1462){v=3&(n=g+1900|0);t:if(u){if(v|(0|g)<200)break t;v=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else v||(v=!((0|n)%100)&0!=((0|n)%400|0));g=g+4|0,m=(12==(0|p(v,12))?-1460:-1461)+m|0}else(0|m)>0||(g=g+-4|0,m=m+1461|0);v=3&(n=g+1900|0);t:if(u){if(v|(0|g)<200)break t;v=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else v||(v=!((0|n)%100)&0!=((0|n)%400|0));for(C=p(v,12),v=C;u=v,v=v+1|0,(0|(m=(n=m)-o[u+1072|0]|0))>0;);u=((m=u)-((0|C)<(0|(u=u+-11|0))?C:u)>>>0)/12|0,a[e>>1]=1900+(u+g|0),a[e+2>>1]=(p(u,-12)+v|0)-C}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,h[460]=b,me(),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(b),ne(h[379]),t=h[460],n=le(),a[e+8>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[380]),t=h[460],n=le(),a[e+10>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[380]),!r)return r=le(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=h[460],n=le(),a[e+12>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[i[1152+(r<<2)>>2]>>3]),h[460]=Y(h[460]),a[e+16>>1]=le(),m=0}}return m}(r,e,t,0!=(0|n),0!=(0|u)),i[922]=0,0|t},Dtr_Yr:function(e){return a[p(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return a[p(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return i[p(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return a[p(e|=0,20)+3624>>1]},Dtr_Min:function(e){return a[p(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return a[p(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return a[p(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return a[p(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return a[p(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,o,u,s,c,l,d){e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,s|=0,c|=0,l|=0,d=p(d|=0,20),a[d+3634>>1]=l,a[d+3632>>1]=c,a[d+3630>>1]=s,a[d+3628>>1]=u,a[d+3626>>1]=o,a[d+3624>>1]=n,i[d+3620>>2]=r,a[d+3618>>1]=t,a[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[920]=0,i[921]=0,function(e,t,r){var n,o=0;O=n=O-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(se(a[e+16>>1]),o=ke(h[i[1152+(a[e+18>>1]<<2)>>2]>>3]),se(a[e+12>>1]),$(o)):se(a[e+12>>1]),o=ke(h[380]),se(a[e+10>>1]),$(o),o=ke(h[380]),se(a[e+8>>1]),$(o),o=ke(h[379]),!((0|G(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,q(8);break e}ue(e)}$(o)}O=n+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r)),+h[460]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[920]=0,i[921]=0,function(e,t,r,n,o){var u,c=0;O=u=O-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(se(a[e+16>>1]),ie(h[i[1152+(a[e+18>>1]<<2)>>2]>>3]),c=h[460],2==(0|o)){h[460]=n,$(c);break n}se(a[e+12>>1]),$(c)}else 2!=(0|o)?se(a[e+12>>1]):h[460]=n;if(ie(h[380]),c=h[460],1!=(0|o)?se(a[e+10>>1]):h[460]=n,$(c),ie(h[380]),c=h[460],o?se(a[e+8>>1]):h[460]=n,$(c),ie(h[379]),n=h[460],!((0|G(e,t,r,u+12|0))<0)){if(e=i[u+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,q(8);break e}ue(e)}$(n)}O=u+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|o),n),+h[460]},Dtr_Days:function(){return i[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(p(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){h[460]=e,$(h[i[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(h[380]);ne(h[380])}ne(h[379]),me()}(e=+e,t|=0,r|=0),+h[460]},Dtr_UtcToLocal:function(e,t,r,n,o,u,c,l){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,c|=0,l|=0,O=d=O-32|0,i[d+24>>2]=u,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?p(o,20)+3616|0:0,i[d+12>>2]=(0|r)>-1?p(r,20)+3616|0:0,e=function(e,t,r,n){var o,u=0;O=o=O-32|0,function(e,t,r){var n,o=0,u=0,c=0,l=0,d=0,f=0,v=0,h=0,m=0,g=0,S=0,y=0;if(O=n=O-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=p(a[t+16>>1],100);break e;case 1:o=p(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(H(n- -64|0,n+40|0)){if(c=Ne(c=p(i[e>>2],60),c>>31,1e7,0),d=x,(u=i[e+4>>2])&&(l=i[e+12>>2])){if(i[n+64>>2]=a[u>>1],i[n+68>>2]=a[u+2>>1],i[n+72>>2]=i[u+4>>2],i[n+76>>2]=a[u+8>>1],i[n+80>>2]=a[u+10>>1],i[n+84>>2]=a[u+12>>1],i[n+92>>2]=a[u+14>>1]+-1,(o=a[u+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[u+16>>1],100);break t;case 1:o=p(a[u+16>>1],10);break t;case 2:break r;default:break t}o=a[u+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[l>>1],i[n+12>>2]=a[l+2>>1],i[n+16>>2]=i[l+4>>2],i[n+20>>2]=a[l+8>>1],i[n+24>>2]=a[l+10>>1],i[n+28>>2]=a[l+12>>1],i[n+36>>2]=a[l+14>>1]+-1,(o=a[l+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[l+16>>1],100);break t;case 1:o=p(a[l+16>>1],10);break t;case 2:break r;default:break t}o=a[l+16>>1]}i[n+32>>2]=o}if(u=i[n+44>>2],l=u,o=i[n+40>>2],!W(n- -64|0,n+56|0,o,u))break e;if(!W(n+8|0,n+48|0,o,l))break e;m=i[n+40>>2],v=i[n+44>>2],g=c,S=e+16|0,y=e+8|0,h=(l=d)+i[n+52>>2]|0,(f=(o=c)+i[n+48>>2]|0)>>>0<o>>>0&&(h=h+1|0),u=f,o=p(i[e+8>>2],60),f=Ne(o,o>>31,1e7,0),o=x+h|0,h=u=u+f|0,f=o=u>>>0<f>>>0?o+1|0:o,u=d+i[n+60>>2]|0,(d=c+i[n+56>>2]|0)>>>0<c>>>0&&(u=u+1|0),e=p(i[e+16>>2],60),c=Ne(e,e>>31,1e7,0),e=x+u|0,e=(d=c+d|0)>>>0<c>>>0?e+1|0:e,c=d,e=Ne(e=p(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(h>>>0>=c>>>0)?((0|v)<(0|e)?1:(0|v)<=(0|e)?m>>>0>=c>>>0?0:1:0)&((0|v)>(0|f)?1:(0|v)>=(0|f)?m>>>0<h>>>0?0:1:0):((0|v)<(0|e)?1:(0|v)<=(0|e)?m>>>0>=c>>>0?0:1:0)|((0|v)>(0|f)?1:(0|v)>=(0|f)?m>>>0<h>>>0?0:1:0))?S:y)>>2],60),e>>31,1e7,0),o=x+l|0,d=o=(c=g+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<c>>>0)|0)|0,c=e-c|0,(0|(e=o))<0||(0|e)<=0&&!(c>>>0>=0)||(V(c,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=s[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return O=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|G(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,u=1);return O=o+32|0,u}(p(e,20)+3616|0,0!=(0|c),0!=(0|l),d+8|0),O=d+32|0,0|e},Mathpack_Zero:function(){return+h[375]},Mathpack_One:function(){return+h[374]},Mathpack_Pi:function(){return+h[370]},Mathpack_Div:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,u=0;h[460]=t,f(+t),r=0|c(1),c(0),o=r,i[921]=2147483647&r,t=h[460];e:{if(f(+Ce(h[371])),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)h[460]=e,he();else if(me(),f(+Ce(t)),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=le()))){if(h[460]=e,f(+e),n=0|c(1),c(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ne(t),ge();else if(!((0|n)>-1)){if(Ee(h[374],t),u=Y(h[460]),h[460]=u,me(),f(+Ce(u)),65535==(0|(n=0|c(1)))&c(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;h[460]=e,i[921]=2147483647&r,ce(),ne(t),ge(),(r=i[921])>>>0<65536||(i[921]=-2147483648^r)}}else h[460]=e,function(e){var t,r=0;if(!((t=a[1843])|e))return void(i[922]=4&i[922]?4:64);if(!((0|t)<1)&&10==(0|le())){if(r=h[460],me(),te(r),!s[1843])return void Q(e);h[460]=r}r=1;for(;1&e&&(r=ae(h[460],r)),e>>>=1;)ne(h[460]);h[460]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[922]))return i[920]=0,i[921]=0,i[922]=-2&o,h[460];be(h[374])}return h[460]}return i[922]=8,h[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|c(1),c(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,s=0;f(+(e=+e)),o=0|c(1),r=0|c(0),n=o,i=o,f(+t),a=0|c(1),o=0|c(0),s=-1;e:{if(!((0|n)<(0|(u=a))||(s=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;s=r>>>0<o>>>0?-1:1}o=s,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[922],i[922]=0,0|e},Mathpack_Trunc:function(e){return+z(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[460]=e,function(){var e=0,t=0,r=0;e:{if(r=i[920],e=i[921],t=-65536&e){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)>0)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||$(1)}(),+h[460]},Mathpack_Floor:function(e){return e=+e,h[460]=e,Z(),+h[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|c(1),t&=2147483647,l(0,0|(0|c(0))),l(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return f(+(e=+e)),n=-2147483648^(t=0|c(1)),l(0,0|(r=0|c(0))),l(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|ve(e=+e)},Mathpack_SFix:function(e){return e=+e,h[460]=e,0|J()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,u=0,l=0,d=0;O=r=O+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[460]=e,f(+e),o=0|c(1),c(0);e:if(u=-65536&o)if(2146435072!=(2146435072&o)){(0|u)>0||(d=32768,o>>>0<65536||(i[921]=-2147483648^o,e=h[460])),ye(e,r+56|0,r+16|0,15),s[r+58>>1]||(a[r+56>>1]=1),h[460]=t,o=(0|(o=J()))<0?100:o;t:{if(u=i[921],l=-65536&u)if(2146435072!=(2146435072&u)){if(!((0|l)>0)){if((o=i[921])>>>0>=65536&&(i[921]=-2147483648^o),(0|(o=J()))<=-1)break t;o=0-o|0}}else i[922]=1;u=a[r+56>>1],l=o+u|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=u,X(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,u=i[r+8>>2],a[r+56>>1]=u),n[r+46|0]=o,a[r+48>>1]=u+16384&32767|d,Se(3100,3680,r+16|0),e=h[460];break e}e=h[375]}else i[922]=1;return O=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;f(+e),r=0|c(1),c(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[922]=1);if(a=U(e,t),h[460]=e,h[460]=Y(e),te(a),(r=i[921])>>>0>=65536){if(2146435072==(2146435072&r))return i[922]=1,a;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|c(1),c(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[922]=1),(0|r)<=-309)return q(8),0;Q(0-r|0),(0|u)>-1||(r=i[921])>>>0<65536||(i[921]=-2147483648^r),$(a),a=h[460]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=U(e=+e,t=+t))),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return Q(e|=0),+h[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,s=0;O=r=O-16|0,h[r+8>>3]=e,h[r>>3]=t,f(+e),n=0|c(1),a=0|c(0),o=n,f(+t),n=0|c(1),u=0|c(0),s=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((s+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=Y(e),h[r+8>>3]=e,f(+e),n=0|c(1),c(0),o=n,e=Y(t),h[r>>3]=e,f(+e),n=0|c(1),c(0),s=n),n=1,o=i[(u=(a=(s&o)>-1)?r+8|0:r)+4>>2],s=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|s))break e;if((0|o)<(0|s)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return O=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return f(+(e=+e)),a=0|c(1),r=0|c(0),f(+t),n=0|c(1),0|(a=(0|r)==(0|c(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072==(2146435072&t)?(i[922]=1,-1):+Y(e)},Mathpack_Sqrt:function(e){return e=+e,h[460]=e,he(),+h[460]},Mathpack_Exp:function(e){return e=+e,h[460]=e,ge(),+h[460]},Mathpack_Ln:function(e){return e=+e,h[460]=e,ce(),+h[460]},Mathpack_Log:function(e){return e=+e,h[460]=e,function(){var e,t;e=+N(+h[460]),h[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}(),+h[460]},Mathpack_Sin:function(e){return e=+e,h[460]=e,function(){var e=0,t=0;f(+(t=h[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+F(+t),h[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+h[460]},Mathpack_Cos:function(e){return e=+e,h[460]=e,function(){var e=0,t=0;f(+(t=h[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+h[460]},Mathpack_Tan:function(e){return e=+e,h[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=h[460])),e=0|c(1),c(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+D(+t),h[460]=t,r=4,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=r)}(),+h[460]},Mathpack_Asin:function(e){return+B(e=+e,0)},Mathpack_Acos:function(e){return+B(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[460]=e,pe(),+h[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,s=0;h[460]=e;e:{if(f(+e),r=0|c(1),c(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[922]=1}h[460]=t;t:{if(f(+t),r=0|c(1),c(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[922]=1}return q(4),0}return se((0|n)<1?-1:1),ne(h[370]),ie(h[372]),h[460]}e:if((0|r)<=-1){f(+t),r=0|c(1),c(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[922]=1;a=h[370];break e}f(+(a=h[370])),r=0|c(1),n=0|c(0),o=-2147483648^r,l(0,0|n),l(1,0|o),u=+d(),s=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:s}else a=h[375];return Ee(t,e),pe(),$(a),h[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,u=0,l=0;return f(+(e=+e)),r=0|c(1),o=0|c(0),2146435072==(2146435072&r)?(i[922]=1,-1):(h[460]=e,u=3104,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(u=3104,(0|n)>0||(l>>>0>=65536&&(i[921]=-2147483648^l),u=3104,!o&-2147483648==(0|r)||(a[1552]=45,u=3106))):(i[922]=1,u=3104)),l=u,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;O=o=O-16|0,e=0|Ie[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else ye(h[460],o+8|0,t,15),t=function(e,t,r,n,o,u){var c,l,d,f=0,v=0,h=0,m=0,g=0;O=l=O-16|0,c=(t<<1)+e|0,d=l+12|0;t:{r:{n:{a:if(!(h=(0|r)<5&(v=o?n:1)+3>>>0<8)){i:if(!((0|v)>(0|r))){if((0|(n=r+v|0))>=3){if((0|r)<5|(0|v)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(v+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,v))&&(n=r-((0|v)<(0|r)?(0|v)<1?2-v|0:1:0)|0)}n:{if((0|n)<(0|o)){f=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(s[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(s[(n<<1)+e>>1]<=52)break i;for(;;){if(g=s[(f=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[f>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,f=v+1|0;break a}for(;(0|(o=n))>=2&&48==s[((n=o+-1|0)<<1)+e>>1];);f=v}if((-1^h)&(0|f)>(0|r)|m)break n;break r}if(f=v,!m)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=c>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&b(),P(e,r,o<<1),a[r>>1]=u),n>>>0<c>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=c>>>0?o=n:(o=n+2|0,(0|f)<=0?(a[n>>1]=45,f=1-f|0):(a[n>>1]=43,f=f+-1|0)),(0|f)<100|o>>>0>=c>>>0||(e=(f>>>0)/100|0,a[o>>1]=e+48,f=f-p(e,100)|0,o=o+2|0),o>>>0<c>>>0&&(a[o>>1]=48+((0|f)/10|0),o=o+2|0),o>>>0>=c>>>0)break t;a[o>>1]=48+((0|f)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|f))if(r=o-f|0,i[d>>2]=r,(0|f)>=1){if(!((r=(n=((h=(r=(v=(0|f)>(0|t)?t:f)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=c>>>0))for(;a[n>>1]=s[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=h>>>0;);(0|f)<(0|t)&&(a[h>>1]=u),o=h+(((0|(e=c-h>>1))>(0|(t=o-v|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(o<<1)|0)|0)>>>0>=c>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=s[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<c>>>0&&(a[e>>1]=u,e=e+2|0),n=c-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return O=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return O=o+16|0,t}(i[256],l,3614-l>>1,(0|t)>0?t:0),i[920]=0,i[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return i[924]},Mathpack_FormatGetSign:function(){return i[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,u=0;return O=n=O+-64|0,f(+(e=+e)),o=0|c(1),c(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),u=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+u|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[922]=1)):(o=0,i[n+12>>2]=0,t=0),i[924]=t,i[925]=s[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(b(),r=i[n+8>>2]),P(3104,n+16|0,o<<1)):(i[922]=1,r=-1),O=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,u=0,l=0;if(O=n=O+-64|0,f(+(e=+e)),u=0|c(1),c(0),2146435072!=(2146435072&u)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),l=a[n+56>>1],i[n+12>>2]=l,u=a[n+58>>1],i[n+8>>2]=u,(0|(o=t))>=2&&(o=(0|l)%(0|t)|0,o=((0|l)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|u))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(u=i[n+8>>2]))?o:u;u=o,(0|o)>=1&&48==s[(n+16|0)+((o=u+-1|0)<<1)>>1];);i[n+8>>2]=u,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|l)&&((((l=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|u)||(b(),u=i[n+8>>2]))}(0|u)<=-1&&(i[922]=1),i[924]=i[n+12>>2],i[925]=s[n+48>>1]>>>15^1,(o=u)>>>0>=256&&(b(),o=i[n+8>>2]),P(3104,n+16|0,u<<1)}else i[922]=1,o=-1;return O=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,O=o=O-48|0,n[o+39|0]=0,P(o+8|0,3104,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,Se(i[256],o,o+8|0)&&(i[922]=1),O=o+48|0,+h[o>>3]},_start:L,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,i[926]||(i[927]=t,i[926]=e)},stackSave:function(){return 0|O},stackAlloc:function(e){return O=e=O-(e|=0)&-16,0|e},stackRestore:function(e){O=e|=0},__growWasmMemory:function(e){return 0,0|b()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},h),g=m.memory;t.memory=g;var S=m.Base_StrBuf;t.Base_StrBuf=S;var y=m.Base_StrBufSize;t.Base_StrBufSize=y;var C=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=C;var k=m.Dtr_FromNum;t.Dtr_FromNum=k;var b=m.Dtr_Yr;t.Dtr_Yr=b;var E=m.Dtr_Mon;t.Dtr_Mon=E;var A=m.Dtr_DOM;t.Dtr_DOM=A;var T=m.Dtr_Hour;t.Dtr_Hour=T;var N=m.Dtr_Min;t.Dtr_Min=N;var R=m.Dtr_Sec;t.Dtr_Sec=R;var F=m.Dtr_Wdy;t.Dtr_Wdy=F;var I=m.Dtr_FracSec;t.Dtr_FracSec=I;var D=m.Dtr_Rounding;t.Dtr_Rounding=D;var w=m.Dtr_Write;t.Dtr_Write=w;var M=m.Dtr_ToNum;t.Dtr_ToNum=M;var _=m.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=_;var O=m.Dtr_Days;t.Dtr_Days=O;var x=m.Dtr_ToDays;t.Dtr_ToDays=x;var L=m.Dtr_ToTime;t.Dtr_ToTime=L;var P=m.Dtr_UtcToLocal;t.Dtr_UtcToLocal=P;var U=m.Mathpack_Zero;t.Mathpack_Zero=U;var B=m.Mathpack_One;t.Mathpack_One=B;var G=m.Mathpack_Pi;t.Mathpack_Pi=G;var V=m.Mathpack_Div;t.Mathpack_Div=V;var H=m.Mathpack_Mul;t.Mathpack_Mul=H;var W=m.Mathpack_Sub;t.Mathpack_Sub=W;var j=m.Mathpack_Add;t.Mathpack_Add=j;var K=m.Mathpack_Power;t.Mathpack_Power=K;var Y=m.Mathpack_Cond;t.Mathpack_Cond=Y;var q=m.Mathpack_Cond2;t.Mathpack_Cond2=q;var J=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=J;var z=m.Mathpack_Trunc;t.Mathpack_Trunc=z;var Q=m.Mathpack_Ceil;t.Mathpack_Ceil=Q;var X=m.Mathpack_Floor;t.Mathpack_Floor=X;var Z=m.Mathpack_Abs;t.Mathpack_Abs=Z;var $=m.Mathpack_Neg;t.Mathpack_Neg=$;var ee=m.Mathpack_Float;t.Mathpack_Float=ee;var te=m.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=m.Mathpack_Fix;t.Mathpack_Fix=re;var ne=m.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=m.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=m.Mathpack_Round;t.Mathpack_Round=ie;var oe=m.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var ue=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ue;var se=m.Mathpack_TenTo;t.Mathpack_TenTo=se;var ce=m.Mathpack_Compare;t.Mathpack_Compare=ce;var le=m.Mathpack_GetExp32;t.Mathpack_GetExp32=le;var de=m.Mathpack_Equal;t.Mathpack_Equal=de;var fe=m.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var ve=m.Mathpack_Sqrt;t.Mathpack_Sqrt=ve;var he=m.Mathpack_Exp;t.Mathpack_Exp=he;var pe=m.Mathpack_Ln;t.Mathpack_Ln=pe;var me=m.Mathpack_Log;t.Mathpack_Log=me;var ge=m.Mathpack_Sin;t.Mathpack_Sin=ge;var Se=m.Mathpack_Cos;t.Mathpack_Cos=Se;var ye=m.Mathpack_Tan;t.Mathpack_Tan=ye;var Ce=m.Mathpack_Asin;t.Mathpack_Asin=Ce;var ke=m.Mathpack_Acos;t.Mathpack_Acos=ke;var be=m.Mathpack_Atan;t.Mathpack_Atan=be;var Ee=m.Mathpack_Atan2;t.Mathpack_Atan2=Ee;var Ae=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Ae;var Te=m.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Te;var Ne=m.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ne;var Re=m.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Re;var Fe=m.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Fe;var Ie=m.Mathpack_Pack;t.Mathpack_Pack=Ie;var De=m._start;t._start=De;var we=m.__errno_location;t.__errno_location=we;var Me=m.setThrew;t.setThrew=Me;var _e=m.stackSave;t.stackSave=_e;var Oe=m.stackAlloc;t.stackAlloc=Oe;var xe=m.stackRestore;t.stackRestore=xe;var Le=m.__growWasmMemory;t.__growWasmMemory=Le},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(3),o=r(5);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var s=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function c(e){var t;return null!=(t=s[e])?t:u(e)}function l(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:c(n)}}function d(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:c(o)}}t.mathError=c,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=d(i.Mathpack_Round),t.roundUp=d(i.Mathpack_RoundUp),t.roundDown=d(i.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(a.Over);if(!isFinite(e))return c(a.Over);var t=i.Mathpack_TenTo(e),r=i.Mathpack_TakeMathError();return r===a.None?t:c(r)},t.compare=i.Mathpack_Compare,t.div=d(i.Mathpack_Div),t.mul=d(i.Mathpack_Mul),t.sub=d(i.Mathpack_Sub),t.add=d(i.Mathpack_Add),t.power=d(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:c(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=d(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?c(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.formatFixed=function(e,t,r){var n=i.Mathpack_FormatFixed(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.formatScientific=function(e,t,r){var n=i.Mathpack_FormatScientific(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var s=i.Mathpack_Pack(!!t,r,u),l=i.Mathpack_TakeMathError();return l!==a.None?c(l):isNaN(s)?c(a.Over):s}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)}},function(e,t,r){r(7),e.exports=r(20)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(a?a(v):S())},o="undefined"!=typeof window?window:void 0,u=o||{},s=u.MutationObserver||u.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(v,1)}}var f=new Array(1e3);function v(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var h,p,m,g,S=void 0;function y(e,t){var r=this,n=new this.constructor(b);void 0===n[k]&&M(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return D(a,n,o,r._result)}))}else F(r,n,e,t);return n}function C(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(b);return A(t,e),t}c?S=function(){return process.nextTick(v)}:s?(p=0,m=new s(v),g=document.createTextNode(""),m.observe(g,{characterData:!0}),S=function(){g.data=p=++p%2}):l?((h=new MessageChannel).port1.onmessage=v,S=function(){return h.port2.postMessage(0)}):S=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(v)}:d()}catch(e){return d()}}():d();var k=Math.random().toString(36).substring(2);function b(){}function E(t,r,n){r.constructor===t.constructor&&n===y&&r.constructor.resolve===C?function(e,t){1===t._state?N(e,t._result):2===t._state?R(e,t._result):F(t,void 0,(function(t){return A(e,t)}),(function(t){return R(e,t)}))}(t,r):void 0===n?N(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?A(e,r):N(e,r))}),(function(t){n||(n=!0,R(e,t))}),e._label);!n&&a&&(n=!0,R(e,a))}),e)}(t,r,n):N(t,r)}function A(e,t){if(e===t)R(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)N(e,t);else{var r=void 0;try{r=t.then}catch(t){return void R(e,t)}E(e,t,r)}var n,a}function T(e){e._onerror&&e._onerror(e._result),I(e)}function N(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(I,e))}function R(e,t){void 0===e._state&&(e._state=2,e._result=t,i(T,e))}function F(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?D(r,n,a,i):a(i);e._subscribers.length=0}}function D(t,r,n,a){var i=e(n),o=void 0,u=void 0,s=!0;if(i){try{o=n(a)}catch(e){s=!1,u=e}if(r===o)return void R(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&s?A(r,o):!1===s?R(r,u):1===t?N(r,o):2===t&&R(r,o))}var w=0;function M(e){e[k]=w++,e._state=void 0,e._result=void 0,e._subscribers=[]}var _=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(b),this.promise[k]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&N(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===C){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===y&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===O){var u=new r(b);o?R(u,i):E(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?R(n,r):this._result[t]=r),0===this._remaining&&N(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;F(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),O=function(){function t(e){this[k]=w++,this._result=this._state=void 0,this._subscribers=[],b!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){A(e,t)}),(function(t){R(e,t)}))}catch(t){R(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return O.prototype.then=y,O.all=function(e){return new _(this,e).promise},O.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},O.resolve=C,O.reject=function(e){var t=new this(b);return R(t,e),t},O._setScheduler=function(e){a=e},O._setAsap=function(e){i=e},O._asap=i,O.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=O},O.Promise=O,O.polyfill(),O},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,a=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(n=i.offset,a=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(n=i.startOffset,a=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;a=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var o=document.body.createTextRange();o.moveToElementText(a),o.setEndPoint("EndToStart",i),n=o.text.length}catch(e){return n}if(r)for(var u=!1;null!=a;)null===a.previousSibling&&null!==a.parentNode&&null!==a.parentNode.parentNode&&a.parentNode.parentNode.childNodes.length>1&&!u?(a=a.parentNode,u=!0):null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length,u&&(n+=1));else for(;null!=a;)null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function a(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,o=0;o<i.length&&t>=0;o+=1)t=a(i[o],t,r),n&&"DIV"===i[o].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var i=document.createRange();return a(e,t,(function(e,t){return i.setStart(e,t)})),a(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},s=JSON.stringify(u);i(s)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*a.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(5);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const s=Math.sin;t.Math_sin=s;const c=Math.cos;t.Math_cos=c;const l=Math.tan;t.Math_tan=l;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),a=r(4);function i(e,t,r,n,a,i,o,u,s){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u,rounding:s}}function o(e){return i(n.Dtr_Yr(e),n.Dtr_Mon(e),n.Dtr_DOM(e),n.Dtr_Hour(e),n.Dtr_Min(e),n.Dtr_Sec(e),n.Dtr_Wdy(e),n.Dtr_FracSec(e),n.Dtr_Rounding(e))}function u(e,t){n.Dtr_Write(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var i=t;return 0===n.Dtr_FromNum(e,i,0,r?1:0,a?1:0)&&o(0)},t.toNum=function(e,t,r){u(0,e);var i=n.Dtr_ToNum(0,t?1:0,r?1:0),o=n.Mathpack_TakeMathError();return o===a.MathErrorNum.None?i:a.mathError(o)},t.toNumWithDuration=function(e,t,r,i,o){u(0,e);var s=i,c=n.Dtr_ToNumWithDuration(0,t?1:0,r?1:0,s,o),l=n.Mathpack_TakeMathError();return l===a.MathErrorNum.None?c:a.mathError(l)},t.toDays=function(e,t,r){return u(0,e),0===n.Dtr_ToDays(0,t?1:0,r?1:0)&&n.Dtr_Days()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var i=t,o=r,u=n.Dtr_ToTime(e,i,o);return n.Mathpack_TakeMathError()===a.MathErrorNum.None&&u},t.utcToLocal=function(e,t,r,a){return u(0,e),null!=t.standardDate&&u(1,t.standardDate),null!=t.daylightDate&&u(2,t.daylightDate),0!==n.Dtr_UtcToLocal(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&o(0)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"SyntaxError",(function(){return jd})),r.d(n,"TypeError",(function(){return Kd})),r.d(n,"baseErrors",(function(){return qd})),r.d(n,"formatDiagnostic",(function(){return Jd}));var a={};r.r(a),r.d(a,"MachineCallKind",(function(){return wh})),r.d(a,"machineCall",(function(){return xh})),r.d(a,"isMachineCall",(function(){return Lh})),r.d(a,"ArrayMachine",(function(){return Ph})),r.d(a,"TransitionKind",(function(){return yh})),r.d(a,"nextTransition",(function(){return Rh})),r.d(a,"callMachineTransition",(function(){return Fh})),r.d(a,"nextOnSuccessReceiver",(function(){return Dh})),r.d(a,"MachineCycle",(function(){return Mh})),r.d(a,"MachineRuntime",(function(){return _h})),r.d(a,"AllMachine",(function(){return Oh}));var i=r(0);function o(e){return e}function u(e,t){if("string"==typeof t&&null!=c[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?d[r]:void 0;return void 0===n&&(n=l[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function s(e){try{return String(JSON.stringify(u(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: "+String(JSON.stringify(e))+">";var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error "+r+">":"<error "+t+": "+r+">"}}var c={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},l={boolean:o,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol "+String(e)+">"},undefined:o,null:o,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=u(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(u):"<unexpected>"}},d=Object.create(null);function f(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function v(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function h(e,t){return Array(t+1).join(e)}function p(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function m(e){if(null==e||"object"!=typeof e)return s(e);var t=e,r=String(t.name),n=String(t.message);if(null!=t.stack){var a=String(t.stack);return a.indexOf(n)>=0&&a.indexOf(r)>=0?a:r+": "+n+"\n"+a}return n.indexOf(r)>=0?n:r+": "+n}var g=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[]}return e.prototype.buffer=function(e){this.callBuffer.length<this.callBufferCapacity&&this.callBuffer.push(e)},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var t=this.callBuffer;this.callBuffer=[];var r="calc.common.DefaultLogger.invokeBufferedCalls: "+t.length+" calls before initLogger";S.ULS.traceTag(579736781,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r);for(var n=0,a=t;n<a.length;n++){var o=a[n];try{(e=S.ULS)[o.method].apply(e,o.args)}catch(e){}}}},e.prototype.shipAssertTag=function(e,t,r,n){if(this.buffer({method:"shipAssertTag",args:[e,t,r,n]}),!r)throw new Error("shipAssertTag "+e+" "+t+" "+n)},e.prototype.assertTag=function(e,t,r,n){if(this.buffer({method:"assertTag",args:[e,t,r,n]}),!r)throw new Error("assertTag "+e+" "+t+" "+n)},e.prototype.traceTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.buffer({method:"traceTag",args:e})},e.prototype.debugTraceTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.buffer({method:"debugTraceTag",args:e})},e}(),S={ULS:new g};function y(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+s(t);return S.ULS.assertTag(595980872,i.LogCategory.msoulscat_ES_EWAJS,!1,r)}function C(e){return S.ULS.assertTag(595980873,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}function k(e,t){t||C(e+": expected condition to be true")}function b(e,t){f(t)||C(e+": expected integer; given "+s(t))}function E(e,t){(!f(t)||t<0)&&C(e+": expected natural number; given "+s(t))}function A(e,t){(!f(t)||t<=0)&&C(e+": expected positive integer; given "+s(t))}function T(e,t,r){(!f(t)||t<0||t>=r)&&C(e+": expected natural number less than "+s(r)+"; given "+s(t))}function N(e,t,r){(!f(t)||t<=0||t>r)&&C(e+": expected positive integer at most "+s(r)+"; given "+s(t))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var R=function(e,t){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var F=function(){return(F=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function I(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function D(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}s((n=n.apply(e,t||[])).next())}))}function w(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function M(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}var _=r(2);function O(e,t){return{wrap:e,unwrap:t}}function x(e){return e}function L(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function P(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function U(e,t){for(var r={},n=0,a=P(e);n<a.length;n++){var i=a[n];r[i]=t(i)}return r}function B(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.push(a)}return e}function G(e,t){var r=[];B(r,e);for(var n=0,a=t;n<a.length;n++){B(r,a[n])}return r}function V(e){return null!=e}function H(e){return null==e}function W(e,t){return[e,t]}function j(e,t){return e<t?e:t}function K(e,t){return e<t?t:e}function Y(e){return e<0?-e:e}function q(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var J,z,Q,X,Z,$="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()},ee={ULS:new i.NulLogger},te=Object(i.initStopwatchFactory)((function(e){return ee.ULS.traceTag(595948114,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}));function re(e,t){return D(this,void 0,void 0,(function(){var r;return w(this,(function(n){switch(n.label){case 0:r=te(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}function ne(e,t,r,n,a,i,o){(E("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&C("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&C("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(J||(J={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(z||(z={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(X||(X={})),function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.FUN=640]="FUN",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISFUN=643]="ISFUN",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.TESTFUNCTIONBEGIN=649]="TESTFUNCTIONBEGIN",e[e.IMAGE=650]="IMAGE",e[e.GRF=651]="GRF",e[e.UNIT=652]="UNIT",e[e.RICHERROR=653]="RICHERROR",e[e.COUNTER=654]="COUNTER",e[e.BROKENRECORD=655]="BROKENRECORD",e[e.FORMULABYTES=656]="FORMULABYTES",e[e.FORMULACODE=657]="FORMULACODE",e[e.FORMULAHTML=658]="FORMULAHTML",e[e.STREAM=659]="STREAM",e[e.FORMATTEDNUMBER=660]="FORMATTEDNUMBER",e[e.LETREC=680]="LETREC",e[e.NESTEDRECORD=681]="NESTEDRECORD"}(Z||(Z={}));var ae,ie=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),oe=[],ue=[[1,oe,[57],oe,1,0,16],[1,[36,831,831],oe,oe,823,0,0],[1,[15],oe,oe,4,0,0],[1,[15],oe,oe,4,0,0],[1,oe,[305],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[0,[16],oe,oe,33,0,0],[0,[16],oe,oe,33,0,0],[0,oe,oe,oe,3,0,16],[2,[1],[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,[1,1],oe,oe,2,0,0],[1,[1,65,4],oe,oe,2,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[0,oe,oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[263,48,48],oe,oe,263,0,0],[2,[48,1,1,1],oe,oe,311,0,0],[2,[2,1],oe,oe,2,0,0],[3,[2,1,1],oe,oe,2,0,0],[1,[2],oe,oe,1,0,0],[1,[7],oe,oe,1,0,0],[0,oe,oe,oe,4,0,16],[0,oe,oe,oe,4,0,16],[1,oe,[52],oe,4,0,16],[1,oe,[52],oe,4,0,16],[1,[4],oe,oe,4,0,16],[2,[1,1],oe,oe,1,0,0],[3,[16,83,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[1,oe,[49],oe,1,0,16],[3,[16,19,18],oe,oe,1,0,0],[2,[7,2],oe,oe,2,0,0],[1,[48,112,84,84],oe,oe,32,0,0],[1,[48,112,112,84],oe,oe,32,0,0],[1,[48,112,84,84],oe,oe,32,0,0],[1,[48,112,112,84],oe,oe,32,0,0],[1,[16],oe,oe,512,0,2],[0,[4],oe,oe,512,0,2],[0,[575],oe,oe,512,0,2],[3,[1,1,1,1,1],oe,oe,1,0,0],[3,[1,1,1,1,1],oe,oe,1,0,0],[3,[1,1,1,1,1],oe,oe,1,0,0],[3,[1,1,1,1,1],oe,oe,1,0,0],[3,[1,1,1,1,1,1],oe,oe,1,0,0],[3,[48,1,1],oe,oe,1,0,16],[1,[48,1],oe,oe,1,0,0],[0,oe,oe,oe,1,16383,0],[2,[263,305,17],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[0,oe,oe,oe,1,16383,0],[1,[16],oe,oe,1,0,0],[1,[48],oe,oe,1,0,0],[1,[48],oe,oe,1,0,0],[3,[16,65,65,65,65],oe,oe,16,16383,0],[2,[2,16],oe,oe,16,0,2],[2,[16,16],oe,oe,2,0,2],[0,[66,81,16],oe,oe,4,0,2],[2,[2,2,1],oe,oe,1,0,0],[1,[39],oe,oe,32,0,0],[0,[1,24],oe,oe,4,0,2],[0,oe,oe,oe,4,0,2],[1,[303],oe,oe,1,0,0],[0,[4],oe,oe,4,0,2],[1,[2,63],oe,oe,4,0,2],[0,oe,oe,oe,50,0,2],[1,[16],oe,oe,47,0,2],[0,[65,66],oe,oe,32,0,2],[4,[87,117,117,1,117],oe,oe,4,0,0],[0,[1,66],oe,oe,32,0,2],[0,oe,oe,oe,16,0,2],[0,oe,oe,oe,16,0,2],[0,[1],oe,oe,4,0,2],[2,[1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[2,[33],[831],oe,823,0,0],[3,[263,49,49,4],oe,oe,295,0,0],[3,[263,49,49,4],oe,oe,295,0,0],[0,[66,65],oe,oe,32,0,2],[1,[2,65,66,67,65,65,2],oe,oe,575,0,2],[1,[63],oe,oe,4,0,0],[1,[18],oe,oe,2,0,2],[1,[2,4],oe,oe,6,0,2],[2,[16,47],oe,oe,4,0,2],[1,[1,1],oe,oe,1,0,0],[1,[2,1,4,4],oe,oe,7,0,2],[1,[1],oe,oe,2,0,0],[1,[2],oe,oe,2,0,0],[1,[2],oe,oe,2,0,0],[1,[2],oe,oe,2,0,0],[1,[2,9],oe,oe,2,0,0],[1,[2,9],oe,oe,2,0,0],[2,[2,2],oe,oe,4,0,0],[1,[2],oe,oe,2,0,0],[4,[2,1,1,2],oe,oe,2,0,0],[3,[2,2,2,2],oe,oe,2,0,0],[1,[2],oe,oe,1,0,0],[0,[66,65,66],oe,oe,32,0,2],[0,[2],oe,oe,2,0,2],[2,[2,2,1],oe,oe,1,0,0],[1,[2,16],oe,oe,303,16383,0],[1,[15],oe,oe,4,0,0],[1,[143],oe,oe,4,0,0],[1,[143],oe,oe,4,0,0],[1,[143],oe,oe,4,0,0],[1,[23],oe,oe,2,0,0],[1,[23],oe,oe,1,0,0],[1,[2,1],oe,oe,1,0,2],[1,[1],oe,oe,1,0,2],[1,[1],oe,oe,1,0,2],[1,[1],oe,oe,2,0,2],[2,[1,1],oe,oe,2,0,2],[2,[1,2],oe,oe,1,0,2],[2,[1,2],oe,oe,1,0,2],[1,[1,1],oe,oe,1,0,2],[1,[3],oe,oe,1,0,0],[1,[3],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[4,[1,1,1,1],oe,oe,1,0,0],[4,[1,1,1,1,1],oe,oe,1,0,0],[1,[2,66,65],oe,oe,2,0,2],[1,[16,4],oe,oe,2,0,2],[1,[2,4],oe,oe,16,0,2],[1,[2,4],oe,oe,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],oe,3,0,2],[1,[3],[127],oe,575,0,2],[0,[3],oe,oe,1,0,2],[2,[3,115,83,3],oe,oe,1,0,2],[3,[3,83,115,83,3],oe,oe,1,0,2],[4,[3,3,3,4,3],oe,oe,4,0,2],[4,[3,3,3,4,3],oe,oe,4,0,2],[4,[3,3,3,3,3],oe,oe,4,0,2],[0,[3],oe,oe,4,0,2],[2,[3,3,3],oe,oe,4,0,2],[3,[3,3,3,3],oe,oe,4,0,2],[1,[1,67,66],oe,oe,1,0,2],[1,[52],oe,oe,36,0,2],[1,[2],oe,oe,2,0,0],[1,[32],oe,oe,1,0,0],[1,[32],oe,oe,32,0,0],[2,[32,32],oe,oe,32,0,0],[0,[2,2],oe,oe,32,0,2],[4,[1,1,1,1,1,1],oe,oe,1,0,0],[4,[1,1,1,1,1,1],oe,oe,1,0,0],[1,oe,[121],oe,1,0,16],[0,[1,16],oe,oe,4,0,2],[3,[2,1,1,1],oe,oe,512,0,2],[1,[4],oe,oe,512,0,2],[0,oe,oe,oe,512,0,2],[0,oe,oe,oe,512,0,2],[2,[2,2],oe,oe,1,0,2],[2,[1,2],oe,oe,32,0,2],[3,[1,18,18],oe,oe,4,0,2],[2,[1,2],oe,oe,4,0,2],[1,[1],oe,oe,4,0,2],[0,[1],oe,oe,512,0,2],[0,[2],oe,oe,4,0,2],[0,[3,3,3,3],oe,oe,3,0,2],[1,oe,[113],oe,1,0,16],[1,[1],oe,oe,1,0,0],[1,[1,16],oe,oe,47,0,2],[1,[1],oe,oe,47,0,2],[1,[1,2],oe,oe,47,0,2],[1,[1,2],oe,oe,63,0,2],[3,[16,19,18],oe,oe,1,0,0],[1,[143],oe,oe,4,0,0],[0,[82,65,65],oe,oe,2,0,2],[0,[66,82,17,17],oe,oe,1,0,2],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[3,[16,19,18],oe,oe,1,0,0],[3,[16,19,18],oe,oe,1,0,0],[1,[1,1],oe,oe,1,0,0],[1,[143],oe,oe,4,0,0],[3,[16,83,18],oe,oe,1,0,0],[1,[3],oe,oe,4,0,2],[1,[3],oe,oe,4,0,2],void 0,void 0,[1,[1,1],oe,oe,2,0,0],[2,[2,2,1],oe,oe,1,0,0],[2,[2,2,1],oe,oe,1,0,0],[4,[2,1,1,2],oe,oe,2,0,0],[1,[2,9],oe,oe,2,0,0],[1,[2,9],oe,oe,2,0,0],[3,[2,1,1],oe,oe,2,0,0],[1,[2],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[1,[2],oe,oe,2,0,0],[1,[2],oe,oe,2,0,0],[2,[1,16,4],oe,oe,1,0,16],void 0,void 0,[2,[1,65,65,68,66],oe,oe,2,0,0],[2,[1,1,4],oe,oe,1,0,0],[0,oe,oe,oe,1,16383,0],[5,[1,1,1,1,1,1,4],oe,oe,1,0,0],[0,oe,oe,oe,512,0,2],[1,[12],oe,oe,512,0,2],[0,oe,oe,oe,512,0,2],[1,[2,82,84],oe,oe,512,0,2],[1,oe,[49],oe,1,0,16],[1,oe,[32],oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[16,19,18],oe,oe,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],oe,oe,2,0,2],[0,[4],oe,oe,4,0,2],[0,oe,oe,oe,16,0,2],[0,[2,2],oe,oe,4,0,2],[0,[2,2,2],oe,oe,4,0,2],[2,[2,23,23,23,23],oe,oe,2,0,2],[2,[2,1,1,2],oe,oe,1,0,2],[1,[2,66,65,65],oe,oe,1,0,2],[1,[2],oe,oe,3,16383,0],[0,oe,oe,oe,2,0,2],[1,[1,2,1,1,1],oe,oe,47,0,2],[4,[1,1,1,1,1],oe,oe,1,0,0],[0,[4],oe,oe,512,0,2],void 0,void 0,[0,[1],oe,oe,512,0,2],[2,[48,48],oe,oe,32,0,16],[0,[66,96],oe,oe,2,0,2],[1,[2],oe,oe,4,0,2],[1,[17],[127],oe,575,0,0],[1,[3],oe,oe,4,0,2],[1,[2],oe,oe,63,0,2],[1,[1,3],oe,oe,47,0,2],[1,[1,3,1],oe,oe,47,0,2],[1,[2,66,4],oe,oe,4,0,2],[1,[15],oe,oe,1,0,0],[0,[2],oe,oe,4,0,2],[0,[2],oe,oe,4,0,2],[0,[99,66],oe,oe,4,0,2],[3,[3,1,4],oe,oe,4,0,2],[3,[3,1,4],oe,oe,4,0,2],[2,[2,3,66],oe,oe,1,0,2],[1,[1,2],oe,oe,35,0,2],[1,oe,[49],oe,1,0,16],[3,[1,1,1,65,65],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[1,1,1,65,65],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[4,[1,1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[3,[1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[3,[1,32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[4,[32,32,1,1],oe,oe,1,0,0],[3,[32,32,1,65],oe,oe,1,0,0],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[2,[49,1,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[49,1,65],oe,oe,1,0,16],[1,oe,[32],oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[1,1],oe,oe,1,0,0],void 0,[3,[2,1,1,1],oe,oe,1,0,2],[2,[2,1,1],oe,oe,1,0,2],[1,oe,[2],oe,2,0,0],[2,[1,1],oe,oe,1,0,0],[2,[66,2,66,65,65,65,66,66,66],oe,oe,2,0,2],[1,[1,2],oe,oe,35,0,2],[1,[1,66,2],oe,oe,35,0,2],[1,[1,66,66,2],oe,oe,7,0,2],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[2,[1],[16],oe,1,0,0],[2,[16,15,16],oe,oe,1,0,0],[2,[16,15],oe,oe,1,0,0],[1,[16],oe,oe,1,0,0],[1,[1,2],oe,oe,19,0,2],[1,[33],oe,oe,33,0,2],[4,[1,1,1,1],oe,oe,1,0,0],[3,[1,1,2],oe,oe,1,0,0],[1,[1],oe,oe,2,0,0],[2,[1,1],oe,oe,2,0,0],[1,[1,5],oe,oe,2,0,0],[0,[66,66,66,65],oe,oe,6,0,2],[0,[66,66,66,66,65],oe,oe,6,0,2],[1,[1,2],oe,oe,19,0,2],[2,[18,18],[2,79],oe,15,0,0],[1,[2,39],oe,oe,39,0,0],[1,[16],oe,oe,2,0,0],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,[1],oe,oe,2,0,0],[1,[1],oe,oe,2,0,0],[1,[3],oe,oe,2,0,0],[1,[1],oe,oe,2,0,0],[1,[1],oe,oe,2,0,0],[1,[1],oe,oe,2,0,0],[1,[2],oe,oe,1,0,0],[1,[2],oe,oe,4,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,oe,[2],oe,2,0,0],[1,[2],[50],oe,15,0,0],[2,[2,50,2],oe,oe,10,0,0],[3,[2,2,2],oe,oe,15,0,0],[3,[2,2,1,2],oe,oe,10,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[95,95,95],oe,oe,9,0,0],[1,oe,[127],oe,9,0,0],[1,oe,[127],oe,9,0,0],[4,[95,95,95,127],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[1,[95,95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[127,127,95],oe,oe,9,0,0],[3,[95,127,127],oe,oe,9,0,0],[5,[95,95,95,95,95,95],oe,oe,9,0,0],[5,[95,95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[3,[95,95,95],oe,oe,9,0,0],[3,[95,95,95],oe,oe,9,0,0],[3,[95,95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,0,0],[2,[95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[3,[95,95,95,95],oe,oe,9,0,0],[5,[95,95,95,95,95,95],oe,oe,9,0,0],[5,[95,95,95,95,95,95],oe,oe,9,0,0],[7,[95,95,95,95,95,95,95,95],oe,oe,9,0,0],[7,[95,95,95,95,95,95,95,95],oe,oe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],oe,oe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],oe,oe,9,0,0],[2,[95,95],oe,oe,9,16383,0],[1,[95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95,95],oe,oe,9,0,0],[3,[95,95,95],oe,oe,9,0,0],[6,[95,95,95,95,95,95,95,95],oe,oe,9,0,0],[4,[95,95,95,95,95],oe,oe,9,0,0],[2,[95,95,127],oe,oe,9,0,0],[2,[95,95,127],oe,oe,9,0,0],[1,oe,[127],oe,9,0,0],[1,oe,[127],oe,9,0,0],[1,oe,[127],oe,9,0,0],[2,[95,127],oe,oe,9,0,0],[3,[2,2,1,2],oe,oe,10,0,0],[2,[2,50,2,1,2],oe,oe,10,0,0],[1,[2],oe,oe,9,0,0],[2,[47,575],oe,oe,303,0,0],[2,oe,[16,15],oe,1,0,0],[3,[16],[16,15],oe,1,0,0],[2,[16,15,16],oe,oe,1,0,0],[3,[16],[16,15],oe,1,0,0],[3,[1,1,48,17],[16],oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[2,[32,32],oe,oe,1,0,0],[3,[1,1,4],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,oe,[32],oe,32,0,16],[1,oe,[32],oe,1,0,16],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[2,[49,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[49,1,65],oe,oe,1,0,16],[2,[49,1,65],oe,oe,1,0,16],[3,[1,1,4],oe,oe,1,0,0],[2,[49,1],oe,oe,1,0,16],[2,[49,1],oe,oe,1,0,16],[2,[1,16,4],oe,oe,1,0,16],[2,[1,16,4],oe,oe,1,0,16],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[3,[1,1,4],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[1,oe,[49],oe,1,0,16],[1,oe,[49],oe,1,0,16],[4,[1,1,1,4],oe,oe,1,0,0],[2,[95,95,75,127],oe,oe,9,0,0],[2,[95,95,75,127],oe,oe,9,0,0],[2,[1,1],oe,oe,1,0,0],[1,[1,65],oe,oe,1,0,0],void 0,[4,[1,1,1,4,65,65],oe,oe,1,0,0],[3,[1,1,1,65,65],oe,oe,1,0,0],[3,[1,1,4],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[5,[1,1,1,1,4],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[4,[1,1,1,4],oe,oe,1,0,0],[2,[1,4],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[4,[32,32,1,1],oe,oe,1,0,0],[2,[49,1,1],oe,oe,1,0,16],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[1],oe,oe,1,0,0],[1,[1,65],oe,oe,1,0,0],[1,[1,65],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[2,[1,1],oe,oe,1,0,0],[1,oe,[52],oe,4,0,16],[3,[1,1,1],oe,oe,1,0,0],[2,[1,1,65],oe,oe,2,0,0],[2,[2,1],oe,oe,1,0,0],[2,[3,3],oe,oe,1,0,0],[3,[1,1,1,65],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,oe,[49],oe,1,0,16],[1,[1],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[3,[1,1,1],oe,oe,1,0,0],[1,[1],oe,oe,2,0,0],[1,[2],oe,oe,1,0,0],[1,[1],oe,oe,32,0,0],[1,[2],oe,oe,1,0,0],[1,[1],oe,oe,1,0,0],[1,[2,66,66],oe,oe,1,0,0],[0,[50],oe,oe,1,16383,16],[0,[48],oe,oe,1,16383,16],[1,[16],oe,oe,2,16383,0],[1,[16],oe,oe,4,0,0],[2,[47,575],oe,oe,303,0,0],[1,[1,65,65],oe,oe,1,0,0],[1,[1,65,65],oe,oe,1,0,0],[1,[95],oe,oe,9,0,0],[1,[95],oe,oe,9,0,0],[2,[2,2],oe,oe,47,0,0],[1,[2],oe,oe,10,0,0],[1,[2],oe,oe,10,0,0],[3,[1,48,48,65,65,65],oe,oe,1,0,0],[3,[1,48,48,65,65,65,65],oe,oe,1,0,0],[2,[48,48,65,65],oe,oe,1,0,0],[3,[1,32,32],oe,oe,1,0,0],[3,[48,48,1,65,65,65],oe,oe,1,0,0],[3,[16],[16,15],oe,1,0,0],[3,[16],[16,15],oe,1,0,0],[3,[114,68],[114],oe,2,0,16],[1,oe,[114],oe,2,0,16],[2,oe,[44,575],oe,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],oe,oe,1375,0,21],[2,oe,[113,113],oe,1,0,17],[1,[16],oe,oe,48,0,21],[2,[271,2,4],oe,oe,303,0,21],[2,[271,2],oe,oe,303,0,17],[2,[48,48,111],oe,oe,303,0,1],[1,[160,96,96,4],oe,oe,32,0,1],[1,[160,4,4],oe,oe,32,0,1],[2,[2,256],oe,oe,1,0,8],[3,[2,49,1],oe,oe,1,0,25],[3,[2,49,1],oe,oe,1,0,25],[2,[2],[49],oe,1,0,25],[2,[2,2,65,68,68],oe,oe,1,0,1],[1,[2,65,65],oe,oe,2,0,1],[2,[2,2,65,68],oe,oe,2,0,1],[2,[2,2,65,68],oe,oe,2,0,1],[2,[2,98,98,68],oe,oe,32,0,1],[1,[32,96,96,4],oe,oe,32,0,9],[2,[4,16],oe,oe,32,0,25],[2,[391,48,65,65],oe,oe,1,0,1],[3,[391,48,48,511,65,65],oe,oe,319,0,1],[2,[160],[160,65],oe,32,0,1],[0,[65,65,65,65,68],oe,oe,32,16383,1],[1,[65,65,65,65],oe,oe,32,0,1],[2,[258,1,65,65,68],[65],oe,32,0,17],[1,[48,65,65,65,65],oe,oe,48,0,1],[1,[48],[48],oe,32,0,1],[1,[48],[48],oe,32,0,1],[1,[48,33],[33],oe,32,0,1],[1,[48,33],[33],oe,32,0,1],[3,oe,[319,319],[319],319,0,1],[1,oe,[319],oe,319,0,1],[3,[1,1,319],oe,oe,32,0,1],[1,oe,[319],oe,319,0,1],[1,[319],oe,oe,4,0,1],[1,[319],oe,oe,9,0,1],[0,oe,oe,oe,319,0,1],[3,[15],[2,47],oe,303,0,17],[1,[399,1],oe,oe,2,0,1],[1,[32,1],oe,oe,2,0,1],[0,oe,oe,oe,1,0,1],[1,[2],oe,oe,258,0,1],[1,[287,2],oe,oe,288,0,17],[2,[15,2],oe,oe,271,0,17],[1,[1],oe,oe,10,0,17],[0,oe,oe,oe,1,0,1],[3,[47],[2,47],oe,47,0,17],[1,[16],oe,oe,2,16383,1],[1,[16],oe,oe,2,16383,1],[1,[16],oe,oe,2,16383,1],[0,[1],oe,oe,1,0,1],[2,[1,1],oe,oe,265,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,oe,[319,319],[319],319,0,1],[3,[15],[2,303],oe,303,0,17]].map((function(e){return void 0===e?void 0:ne.apply(void 0,e)})),se=ne(0,[],[z.All],[],z.All,Q.All,X.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(ae||(ae={}));var ce,le=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"],de=J.Number|J.String|J.Boolean|J.Blank,fe=J.Number|J.String|J.Boolean|J.Blank,ve=ne(2,[J.Number,J.Number],[],[],J.Number,Q.None,X.None),he=ne(1,[J.Number],[],[],J.Number,Q.None,X.None),pe=ne(1,[de],[],[],de,Q.None,X.None),me=ne(2,[J.String,J.String],[],[],J.String,Q.None,X.None),ge=ne(2,[fe,fe],[],[],J.Boolean,Q.None,X.None),Se=ne(2,[J.Range,J.Range],[],[],J.Range,Q.AllCells,X.None),ye=ne(2,[J.Range,J.Range],[],[],J.Range,Q.None,X.None),Ce=ne(2,[J.Boolean,J.Boolean],[],[],J.Boolean,Q.None,X.None),ke=[];function be(e){var t=ke[e];return null!=t?t:se}function Ee(e){var t=ue[e];return null!=t?t:se}function Ae(e,t){var r=ue[e];null!=r&&(r.staticPrecs=t)}function Te(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}ke[ae.Add]=ve,ke[ae.Sub]=ve,ke[ae.Mul]=ve,ke[ae.Div]=ve,ke[ae.Pow]=ve,ke[ae.Percent]=he,ke[ae.Neg]=he,ke[ae.At]=ue[Z.SINGLE],ke[ae.Pound]=ue[Z.ANCHORARRAY],ke[ae.Pos]=pe,ke[ae.Concat]=me,ke[ae.Eq]=ge,ke[ae.Ne]=ge,ke[ae.Lt]=ge,ke[ae.Le]=ge,ke[ae.Gt]=ge,ke[ae.Ge]=ge,ke[ae.Range]=Se,ke[ae.Isect]=ye,ke[ae.Union]=ye,ke[ae.And]=Ce,ke[ae.Or]=Ce,ke[ae.Xor]=Ce,ke[ae.Min]=ve,ke[ae.Max]=ve,Ae(Z.ROW,Q.OwnRow),Ae(Z.COLUMN,Q.OwnCol),Ae(Z.SHEET,Q.OwnDocSheets),Ae(Z.SHEETS,Q.OwnDocSheets),Ae(Z.OFFSET,Q.AllCells),Ae(Z.INDIRECT,Q.AllCells),Ae(Z.SUMIF,Q.AllCells),Ae(Z.AVERAGEIF,Q.AllCells),Ae(Z.LOOKUP,Q.AllCells),Ae(Z.ADDRESS,Q.RefStyle),Ae(Z.FORMULATEXT,Q.RefStyle),Ae(Z.NOW,Q.Time),Ae(Z.TODAY,Q.Time),Ae(Z.RAND,Q.Calc),Ae(Z.RANDBETWEEN,Q.Calc),Ae(Z.RANDARRAY,Q.Calc),Ae(Z.SUBTOTAL,Q.CellProps),Ae(Z.CELL,Q.CellProps|Q.AllCells),Ae(Z.INFO,Q.None),function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(ce||(ce={}));var Ne=function(e,t,r){var n;function a(e){n[e]|=ce.IdentStartClass}function i(e){n[e]|=ce.IdentContinueClass}function o(e,t){n[e]|=ce.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var s=K(e[e.length-1],K(t[t.length-1],r[r.length-1]));n=new Uint8Array(s),Te(e,a),Te(t,i),Te(r,o);for(var c=4969;c<4978;c+=1)o(c,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function Re(e,t){return{key:e,value:t}}var Fe,Ie,De=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Re(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var a=e[0],i=e[1];return r.push([a,i,t+n])})),r.sort((function(e,r){var n=e[0],a=e[2],i=r[0],o=r[2],u=t.keyCompare(n,i);return 0!==u?u:a-o}));for(var a=[],i=void 0,o=0;o<r.length;o+=1){var u=r[o],s=u[0],c=u[1];void 0===i||0!==this.keyCompare(s,i)?(a.push([s,c]),i=s):a[a.length-1]=[s,c]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var t=we;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=Me(t):r>0&&(t=_e(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(Me(t),r,n,i),e(_e(t),r,n+i+1,a-i-1)}(we,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var s=n[o[u]],c=s[0],l=s[1];a[u]=c,i[u]=l}return new e(this.keyCompare,a,i)},e}(),we=0;function Me(e){return 2*e+1}function _e(e){return 2*e+2}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(Ie||(Ie={}));var Oe;function xe(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function Le(e){return e?rt:nt}function Pe(e){return{kind:J.String,value:e}}function Ue(e){var t=ze[e];return void 0!==t?t:Je(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(Oe||(Oe={}));var Be=Je(Oe.NULL),Ge=Je(Oe.DIV0),Ve=Je(Oe.VALUE),He=Je(Oe.REF),We=Je(Oe.NAME),je=Je(Oe.NUM),Ke=Je(Oe.NA),Ye=Je(Oe.GETTING_DATA),qe=Je(Oe.FIELD);function Je(e){return{kind:J.Error,type:e}}var ze=p(((Fe={})[Oe.NULL]=Be,Fe[Oe.DIV0]=Ge,Fe[Oe.VALUE]=Ve,Fe[Oe.REF]=He,Fe[Oe.NAME]=We,Fe[Oe.NUM]=je,Fe[Oe.NA]=Ke,Fe[Oe.GETTING_DATA]=Ye,Fe[Oe.FIELD]=qe,Fe));function Qe(e,t,r){return E("calc.lang.arrayOper",e),E("calc.lang.arrayOper",t),r.length!==e?C("calc.lang.arrayOper: Inconsistent row number"):{kind:J.Array,rows:e,cols:t,opers:r}}function Xe(e,t){return A("calc.lang.rangeSeqOper",t.length),{kind:J.Range,sheets:e,ranges:t}}function Ze(e,t){return{kind:J.Range,sheets:e,ranges:[t]}}var $e,et={kind:J.Missing},tt={kind:J.Blank},rt={kind:J.Boolean,value:!0},nt={kind:J.Boolean,value:!1};function at(e){return{kind:$e.Cell,range:e}}function it(e){return{kind:$e.Range,range:e}}function ot(e,t){switch(e){case $e.Cell:return xt(t)?at(t):C("calc.lang.lexicalSourceGrid: expected cell");case $e.Range:return it(t)}}function ut(e){return{kind:$e.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}($e||($e={}));function st(e,t){return{path:e,name:t}}function ct(e,t,r){return{document:e,index:t,index2:r}}function lt(e,t){return ct(e,t,t)}function dt(e){return{document:e,index:void 0,index2:void 0}}function ft(e,t){return{sheets:e,position:t}}function vt(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function ht(e,t,r,n){return T("calc.lang.gridRange",e,1<<20),T("calc.lang.gridRange",t,16384),N("calc.lang.gridRange",r,(1<<20)-e),N("calc.lang.gridRange",n,16384-t),vt(e,t,r,n)}function pt(e,t){return T("calc.lang.gridCell",e,1<<20),T("calc.lang.gridCell",t,16384),vt(e,t,1,1)}function mt(e,t){return{sheet:e,range:t}}var gt,St,yt=mt,Ct=mt,kt=mt,bt=mt;function Et(e){return{document:e,index:void 0}}function At(e,t){return void 0===t?Et(e):lt(e,t)}function Tt(e,t){return{scope:e,name:t}}function Nt(e,t){return{document:e,id:t}}function Rt(e){return{kind:gt.Success,value:e}}function Ft(e){return{kind:gt.Failure,reason:e}}function It(e){return e.kind===gt.Success}function Dt(e){return{kind:St.JavaScriptError,error:e}}function wt(e){return e.index===e.index2}function Mt(e){return e.isWellFormed}function _t(e){return 1===e.rows&&1===e.cols}function Ot(e){return wt(e.sheet)}function xt(e){return _t(e.range)}function Lt(e,t){if(_t(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(pt(r+o,a+u),o,u))return!1;return!0}function Pt(e,t){return e===t||e.name===t.name&&e.path===t.path}function Ut(e,t){return Pt(e.document,t.document)&&e.index===t.index}function Bt(e,t){return e.row===t.row&&e.col===t.col}function Gt(e,t){return Ut(e.sheet,t.sheet)&&Bt(e.range,t.range)}function Vt(e){return _t(e)?e:vt(e.row,e.col,1,1)}function Ht(e){return xt(e)?e:kt(e.sheet,Vt(e.range))}function Wt(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return vt(j(r,a),j(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function jt(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case Nr.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],s=u.length-1;!a&&s>=0;s-=1){r(l=u[s])&&(n=l,a=!0)}break;case Nr.App:case Nr.Let:case Nr.Fun:var c=n.args;for(s=c.length-1;!a&&s>=0;s-=1){r(l=c[s])&&(n=l,a=!0)}break;case Nr.Paren:var l;r(l=n.node)&&(n=l,a=!0);break;case Nr.Bad:case Nr.Name:case Nr.CellRef:case Nr.StructRef:case Nr.Literal:break;case Nr.FieldRef:r(n.lhs)&&(n=n.lhs,a=!0);break;default:y("getSubExpressionFromPosition",n)}return n}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(gt||(gt={})),function(e){e.JavaScriptError="JavaScriptError"}(St||(St={}));var Kt=[];function Yt(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===Nr.Literal&&ir(t.oper))return 0}return e.args.length}(e)?Kt:e.args}function qt(e){return e.kind===Nr.Operator}function Jt(e){return e.kind===Nr.WSF}function zt(e){return e.kind===Nr.Name&&void 0===e.qualifier}function Qt(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(A("calc.runtime.getArgType: n",r),T("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return z.None;var o=(r-n.length)%a.length;return o>i.length?z.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function Xt(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function Zt(e,t){return t.length>0&&(e.kind===Nr.Literal&&tr(e.oper)||e.kind===Nr.Name)}function $t(e){return e.kind===J.Number}function er(e){return e.kind===J.String}function tr(e){return e.kind===J.Boolean}function rr(e){return e.kind===J.Error}function nr(e){return e.kind===J.Range}function ar(e){return e.kind===J.Array}function ir(e){return e.kind===J.Missing}function or(e){return e.kind===J.Blank}function ur(e){return e.kind===J.Rich}var sr=J.Number|J.String|J.Boolean;function cr(e){return 0!=(e.kind&sr)}var lr,dr=sr|J.Error|J.Array|J.Rich;function fr(e,t,r,n){if(r.kind!==t.kind)return!1;switch(r.kind){case J.Boolean:case J.String:return r.value===t.value;case J.Number:return 0===e.cond2(r,t);case J.Error:return r.type===t.type;case J.Rich:return n;case J.Array:var a=t;if(r.cols!==a.cols||r.rows!==a.rows)return!1;for(var i=0;i<r.rows;i+=1)for(var o=r.opers[i],u=a.opers[i],s=0;s<r.cols;s+=1)if(!fr(e,u[s],o[s],n))return!1;return!0;case J.Blank:return!0;default:return y("calc.lang.readOperEq",r)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(lr||(lr={}));var vr=F(F({},St),lr);function hr(e){return{kind:vr.NotImplemented,features:e}}function pr(e){return 0===e.length&&C("calc.lang.unavailable: expected nonempty array"),{kind:vr.Unavailable,objects:e}}function mr(e){return{kind:vr.Internal,message:e}}function gr(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t}var Sr="_xlfn.",yr="_xlws.";function Cr(e,t){var r=t;return r.length>Sr.length&&0===e.stringCompareCI(r.substr(0,Sr.length),Sr)&&(r=r.substr(Sr.length)).length>yr.length&&0===e.stringCompareCI(r.substr(0,yr.length),yr)&&(r=r.substr(yr.length)),e.getWorksheetFuncId(r)}var kr,br,Er,Ar,Tr,Nr,Rr,Fr,Ir,Dr,wr,Mr;function _r(e){return void 0===e&&(e=0),{kind:br.Error,isQuoted:!1,label:e}}function Or(e){return void 0===e&&(e=0),{kind:br.Relative,isQuoted:!1,label:e}}function xr(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:br.Document,isQuoted:r,label:n,document:e,path:t}}function Lr(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:br.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function Pr(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:br.Ident,isQuoted:t,label:r,name:e}}function Ur(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:br.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function Br(e,t){return{kind:e,index:t}}function Gr(e){return void 0===e&&(e=0),{kind:Er.Error,label:e}}function Vr(e,t,r){return void 0===r&&(r=0),{kind:Er.Single,label:r,row:e,col:t}}function Hr(e,t,r){return void 0===r&&(r=0),{kind:Er.Range,label:r,ref1:e,ref2:t}}function Wr(e,t,r){return void 0===r&&(r=0),{kind:Er.Row,label:r,row1:e,row2:t}}function jr(e,t,r){return void 0===r&&(r=0),{kind:Er.Col,label:r,col1:e,col2:t}}function Kr(e,t,r){return{node:e,spans:t,annotations:r}}function Yr(e,t,r,n){return E("calc.lang.formulaSpan",e),b("calc.lang.formulaSpan",t),t<e&&C("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function qr(e){return{kind:Tr.WorksheetFuncName,id:e}}function Jr(e){return{kind:Tr.LocalName,name:e}}function zr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Nr.Literal,label:r,oper:e,isClosed:t}}function Qr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Nr.Array,label:r,nodes:e,isClosed:t}}function Xr(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Nr.App,label:n,head:e,args:t,isClosed:r}}function Zr(e,t,r,n,a){void 0===n&&(n=!0),void 0===a&&(a=0),A("calc.lang.letNode",t.length),k("calc.lang.letNode",t.every((function(e){return zt(e[0])})));var i=G([],M(t,[[r]]));return{kind:Nr.Let,label:a,head:e,args:i,isClosed:n,vars:t,body:r}}function $r(e,t,r,n,a){void 0===n&&(n=!0),void 0===a&&(a=0),k("calc.lang.funNode",t.every(zt));var i=M(t,[r]);return{kind:Nr.Fun,label:a,head:e,args:i,isClosed:n,params:t,body:r}}function en(e,t){return void 0===t&&(t=0),{kind:Nr.Operator,label:t,id:e}}function tn(e,t,r){return void 0===r&&(r=0),{kind:Nr.WSF,label:r,id:e,whole:t}}function rn(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Nr.Paren,label:r,node:e,isClosed:t}}function nn(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,a="string"==typeof e?an(e):e;return{kind:Nr.Name,label:r,whole:n,parts:a,qualifier:t}}function an(e,t){return void 0===t&&(t=0),{kind:Rr.IdentNamePart,label:t,asWhole:e}}function on(e,t,r){return void 0===r&&(r=0),{kind:Rr.CellRefNamePart,label:r,asWhole:t,ref:e}}function un(e,t,r){return void 0===r&&(r=0),{kind:Rr.FieldRefNamePart,label:r,asWhole:e.asWhole+"."+t,lhs:e,rhs:t}}function sn(e,t,r){return void 0===r&&(r=0),{kind:Nr.CellRef,label:r,ref:e,qualifier:t}}function cn(e,t,r){return void 0===r&&(r=0),{kind:Nr.FieldRef,label:r,lhs:e,rhs:t}}function ln(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{label:n,field:e,isBracketed:t,isClosed:r}}function dn(e,t,r){return void 0===r&&(r=0),{kind:Nr.StructRef,label:r,lhs:e,rhs:t}}function fn(){C("calc.lang.structRef: unimplemented")}function vn(e,t,r){return void 0===r&&(r=0),{kind:Nr.Bad,label:r,type:e,contents:t}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(kr||(kr={})),function(e){e.Error="QualError",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(br||(br={})),function(e){e.Error="RefError",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(Er||(Er={})),function(e){e.Abs="Abs",e.Rel="Rel"}(Ar||(Ar={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(Tr||(Tr={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Fun="Fun",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF"}(Nr||(Nr={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(Rr||(Rr={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Operator="Operator",e.Sequence="Sequence",e.Literal="Literal"}(Fr||(Fr={})),function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(Ir||(Ir={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(Dr||(Dr={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.Unknown="Unknown",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(wr||(wr={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(Mr||(Mr={}));var hn,pn=r(1),mn=function(e,t,r,n,a){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}},gn=mn(0,void 0,0,void 0,0),Sn=pn.dtr.Rounding,yn=pn.dtr.dtr,Cn=pn.dtr.TimeDivision;!function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(hn||(hn={}));var kn={fromNum:function(e,t,r){return pn.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=pn.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):je},toNumWithDuration:function(e,t,r,n){var a=pn.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof a?e.mathpack.fromNumber(a):je},daysPerMonth:pn.dtr.daysPerMonth,toDays:function(e,t){return pn.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return pn.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return pn.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}};function bn(e){return{kind:J.Number,_valueXL:e}}var En=bn(pn.mathpack.zero()),An=bn(pn.mathpack.one()),Tn=bn(pn.mathpack.pi());function Nn(e){return 0!=(e.num&pn.mathpack.MathErrorNum.DivBy0)?Ge:je}function Rn(e){return function(t){return C("calc.runtime."+e+": error "+JSON.stringify(t))}}function Fn(e,t,r){return function(n){var a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function In(e,t,r){return function(n,a){var i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}var Dn=In((function(e,t){return pn.mathpack.equal(t,2)?pn.mathpack.mul(e,e):pn.mathpack.power(e,t)}),bn,Nn),wn=Fn((function(e){return pn.mathpack.div(e,100)}),bn,Rn("xlPercent"));var Mn=Fn(pn.mathpack.ceil,bn,Rn("xlCeil")),_n=Fn(pn.mathpack.floor,bn,Rn("xlFloor")),On=Fn(pn.mathpack.cond,x,Rn("xlCond")),xn=In(pn.mathpack.cond2,x,Rn("xlCond2"));var Ln=Fn(pn.mathpack.sfix,x,Rn("xlSfix")),Pn=Fn(pn.mathpack.viewRound,bn,Rn("xlViewRound"));var Un,Bn,Gn,Vn,Hn,Wn={zero:En,one:An,pi:Tn,add:In(pn.mathpack.add,bn,Nn),sub:In(pn.mathpack.sub,bn,Nn),mul:In(pn.mathpack.mul,bn,Nn),div:In(pn.mathpack.div,bn,Nn),power:Dn,percent:wn,neg:function(e){return 0!==On(e)?bn(pn.mathpack.neg(e._valueXL)):e},compare:function(e,t){return pn.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var n=t._valueXL,a=pn.mathpack.formatGeneral(e,n,r);return"string"!=typeof a?C("calc.runtime.xlFormatGeneral: error "+JSON.stringify(a)):a},formatFixed:function(e,t,r){var n=e._valueXL,a=pn.mathpack.formatFixed(n,t,r);return"object"!=typeof a?C("calc.runtime.xlFormatFixed: error "+JSON.stringify(a)):a},formatScientific:function(e,t,r){var n=e._valueXL,a=pn.mathpack.formatScientific(n,t,r);return"object"!=typeof a?C("calc.runtime.xlFormatScientific: error "+JSON.stringify(a)):a},parse:function(e,t,r,n){var a=pn.mathpack.pack(e,t,r,n);return"number"!=typeof a?C("calc.runtime.xlParse: error "+JSON.stringify(a)):bn(a)},trunc:function(e){return bn(pn.mathpack.trunc(e._valueXL))},ceil:Mn,floor:_n,abs:function(e){return bn(pn.mathpack.abs(e._valueXL))},cond:On,cond2:xn,fromNumber:function(e){return k("calc.runtime.xlFromNumber",isFinite(e)),bn(e)},toNumber:function(e){var t=e._valueXL;return k("calc.runtime.xlToNumber",isFinite(t)),t},sqrt:Fn(pn.mathpack.sqrt,bn,Nn),exp:Fn(pn.mathpack.exp,bn,Nn),ln:Fn(pn.mathpack.ln,bn,Nn),log:Fn(pn.mathpack.log,bn,Nn),sin:Fn(pn.mathpack.sin,bn,Nn),cos:Fn(pn.mathpack.cos,bn,Nn),tan:Fn(pn.mathpack.tan,bn,Nn),asin:Fn(pn.mathpack.asin,bn,Nn),acos:Fn(pn.mathpack.acos,bn,Nn),atan:Fn(pn.mathpack.atan,bn,Nn),atan2:In(pn.mathpack.atan2,bn,Nn),round:In(pn.mathpack.round,bn,Nn),roundUp:In(pn.mathpack.roundUp,bn,Nn),roundDown:In(pn.mathpack.roundDown,bn,Nn),tenTo:function(e){b("calc.lang.xlTenTo",e);var t=pn.mathpack.tenTo(e);return"number"==typeof t?bn(t):Nn(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,n=t._valueXL;return pn.mathpack.exp32(r)-pn.mathpack.exp32(n)>=52428800?En:t},fix:function(e){return pn.mathpack.fix(e._valueXL)},lfix:function(e){return pn.mathpack.lfix(e._valueXL)},sfix:Ln,viewRound:Pn};function jn(e,t,r,n,a,i,o){return void 0===t&&(t=kr.A1),void 0===r&&(r=Wn),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===i&&(i=gn),void 0===o&&(o=kn),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}}var Kn,Yn,qn,Jn,zn,Qn,Xn=!1,Zn=void 0,$n=/^(https)|(http)|(file):\/\//;function ea(e,t,r){if(Xn){S.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(function(e){var t=S.ULS;S.ULS=e,t instanceof g&&t.invokeBufferedCalls()}(e),function(e){ee.ULS=e}(e),"function"==typeof(n=t)&&(Ta=n),null!=r){if(!$n.test(r)){var a="calc.config.initCalc: calcAbsUrl is not absolute: "+r;S.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a)}_.setConfig({onWorkerError:function(e){var t,r=F(F({},e.info),{error:void 0}),n={error:e.message,info:r,innerError:null===(t=e.info.error)||void 0===t?void 0:t.message},a="calc.onWorkerError: "+JSON.stringify(n);S.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);S.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}})}Zn=r,Xn=!0;S.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc version 17.0.1 (production) initialized")}}function ta(){return Xn}function ra(){return Zn}function na(e,t,r,n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k){return aa(r,n,ia,oa,ua,(function(e){return e>0&&e%3==0}),sa,ca,s,c,l,d,f,v,h,p,m,g,S,y,C,k,",",Yn.USA,Kn.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,Ir.Paren,!0,!1,"$",2,Dr.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],da,fa,va,ha)}function aa(e,t,r,n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k,b,E,A,T,N,R,F,I,D,w,M,_,O,x,L,P,U,B,G,V,H,W,j,K,Y,q,J,z,Q,X,Z,$,ee,te,re,ne,ae,ie,oe,ue){return{getWorksheetFuncId:function(t){return e(t.toLocaleUpperCase())},getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:u,stringCompareCI:s,errorNames:c,trueName:l,falseName:d,rowLetter:f,columnLetter:v,leftBrace:h,rightBrace:p,leftBracket:m,rightBracket:g,decimalSeparator:S,listSeparator:y,columnSeparator:C,rowSeparator:k,thousandsSeparator:b,lcid:E,country:A,isThai:T,isEastAsia:N,isKorea:R,isJapan:F,isChinaT:I,isChinaS:D,isComplexScript:w,numberDecimals:M,isExpSepBySpace:_,fractionSeparator:O,isPercentSepBySpace:x,currencyFormat:L,isCurrencySymbolLead:P,isCurrencySepBySpace:U,currencySymbol:B,currencyDecimals:G,dateOrder:V,dateSeparator:H,dateAltSeparator:W,year4Digits:j,month2Digits:K,day2Digits:Y,longDateFormat:q,timeSeparator:J,timeAltSeparator:z,hour2Digits:Q,clock24Hour:X,isAMPMSepBySpace:Z,ampmSymbols:$,dayNameShort:ee,dayNameLong:te,monthNameShort:re,monthNameLong:ne,pictureSpecial:ae,pictureSingle:ie,pictureColor:oe,pictureDbnum:ue}}function ia(e){return 0!=(Ne(e)&ce.DigitClass)}function oa(e){var t=Ne(e);return 0==(t&ce.DigitClass)?C("calc.config.getOrdinal: expected numeral; given "+s(e)):t&ce.Ordinal}function ua(e){switch(k("calc.config.getNumberShape",ia(e)),2147483392&e){case 0:return wr.ASCII;case 1536:return e<1648?wr.ArabicIndic:wr.ExtendedArabicIndic;case 1792:return wr.Unknown;case 2304:return e<2416?wr.Devanagari:wr.Bengali;case 2560:return e<2672?wr.Gurmukhi:wr.Gujarati;case 2816:return e<2928?wr.Oriya:wr.Tamil;case 3072:return e<3184?wr.Telugu:wr.Kannada;case 3328:return e<3440?wr.Malayalam:wr.Unknown;case 3584:return e<3680?wr.Thai:wr.Lao;case 3840:return wr.Tibetan;case 4096:return e<4176?wr.Myanmar:wr.Unknown;case 4864:return wr.Ethiopic;case 5888:return wr.Khmer;case 6144:return wr.Mongolian;default:return wr.Unknown}}function sa(e){return 0!=(Ne(e)&ce.IdentStartClass)}function ca(e){return 0!=(Ne(e)&ce.IdentContinueClass)}!function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(Kn||(Kn={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(Yn||(Yn={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(qn||(qn={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(Jn||(Jn={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(zn||(zn={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(Qn||(Qn={}));var la=p(((Un={})[Oe.NULL]="#NULL!",Un[Oe.DIV0]="#DIV/0!",Un[Oe.VALUE]="#VALUE!",Un[Oe.REF]="#REF!",Un[Oe.NAME]="#NAME?",Un[Oe.NUM]="#NUM!",Un[Oe.NA]="#N/A",Un[Oe.GETTING_DATA]="#GETTING_DATA",Un[Oe.FIELD]="#FIELD!",Un)),da=p(((Bn={})[qn.AP1]="AM/PM",Bn[qn.AP2]="A/P",Bn[qn.AP3]="/",Bn[qn.General]="General",Bn[qn.Currency]="$",Bn)),fa=p(((Gn={})[Jn.Sep]=";",Gn[Jn.Hash]="#",Gn[Jn.Zero]="0",Gn[Jn.Decimal]=".",Gn[Jn.Percent]="%",Gn[Jn.Comma]=",",Gn[Jn.Colon]=":",Gn[Jn.DateSep]="/",Gn[Jn.Slash]="/",Gn[Jn.Space]=" ",Gn[Jn.Minus]="-",Gn[Jn.Plus]="+",Gn[Jn.OpenParen]="(",Gn[Jn.CloseParen]=")",Gn[Jn.Backslash]="\\",Gn[Jn.Star]="*",Gn[Jn.Year]="y",Gn[Jn.Month]="m",Gn[Jn.Day]="d",Gn[Jn.Hour]="h",Gn[Jn.Minute]="m",Gn[Jn.Second]="s",Gn[Jn.E]="E",Gn[Jn.APDelim]="/",Gn[Jn.Quote]='"',Gn[Jn.ColorStart]="[",Gn[Jn.ColorEnd]="]",Gn[Jn.Text]="@",Gn[Jn.Question]="?",Gn[Jn.Underscore]="_",Gn[Jn.Reign]="r",Gn[Jn.LocDay]="a",Gn[Jn.Era]="g",Gn[Jn.EraYear]="e",Gn[Jn.BidiDate]="B",Gn[Jn.BidiNum]="N",Gn[Jn.DayTh]="",Gn[Jn.MonthTh]="",Gn[Jn.YearTh]="",Gn[Jn.EngYearTh]="b",Gn[Jn.ThYear]="",Gn[Jn.HourTh]="",Gn[Jn.MinuteTh]="",Gn[Jn.SecondTh]="",Gn[Jn.ZeroTh]="",Gn)),va=p(((Vn={})[zn.Black]="Black",Vn[zn.White]="White",Vn[zn.Red]="Red",Vn[zn.Green]="Green",Vn[zn.Blue]="Blue",Vn[zn.Yellow]="Yellow",Vn[zn.Magenta]="Magenta",Vn[zn.Cyan]="Cyan",Vn[zn.Color]="Color",Vn)),ha=p(((Hn={})[Qn.DBNUM1]="DBNum1",Hn[Qn.DBNUM2]="DBNum2",Hn[Qn.DBNUM3]="DBNum3",Hn[Qn.DBNUM4]="DBNum4",Hn)),pa=void 0;function ma(e){var t=Ca()[e];return void 0===t?"wsf:"+e:t}function ga(e){if(e===ae.Isect)return" ";if(e===ae.Union)return",";var t=le[e];return void 0===t?"op:"+e:t}function Sa(e,t,r){return t===ae.Isect?r:t===ae.Union?e.listSeparator:le[t]}var ya=/_/g;function Ca(){if(null==pa){pa=[];for(var e=0,t=P(Z);e<t.length;e++){var r=t[e],n=ie[r],a=null!=n?n:Z[r].replace(ya,".");pa[r]=a}}return pa}function ka(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),De.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?C("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var ba,Ea=void 0;function Aa(){var e,t,r,n,a;return null==Ea&&(e=Ca(),t=q("en-US"),r=ka(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,Ea=aa(n,a,ia,oa,ua,(function(e){return e>0&&e%3==0}),sa,ca,t,la,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",",",Yn.USA,Kn.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,Ir.Paren,!0,!1,"$",2,Dr.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],da,fa,va,ha)),Ea}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcNumFmtFunctions="CalcNumFmtFunctions",e.CalcNumFmtPhaseOne="CalcNumFmtPhaseOne",e.CalcNumFmtPhaseTwo="CalcNumFmtPhaseTwo",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcDotOperator="CalcDotOperator",e.CalcStructuredReferences="CalcStructuredReferences",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcFunFunctions="CalcFunFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e["OfficeVSO:3852168_CalcCGTEXT"]="OfficeVSO:3852168_CalcCGTEXT",e["OfficeVSO:3852168_CalcCGFIXED"]="OfficeVSO:3852168_CalcCGFIXED",e["OfficeVSO:3852168_CalcCGDOLLAR"]="OfficeVSO:3852168_CalcCGDOLLAR",e["OfficeVSO:3852168_CalcCGVALUE"]="OfficeVSO:3852168_CalcCGVALUE",e["OfficeVSO:3852168_CalcCGDATEVALUE"]="OfficeVSO:3852168_CalcCGDATEVALUE",e["OfficeVSO:3852168_CalcCGTIMEVALUE"]="OfficeVSO:3852168_CalcCGTIMEVALUE"}(ba||(ba={}));var Ta=function(e){var t="calc.common.isFeatureEnabledCallback: called with "+e+" before initCalc";return S.ULS.traceTag(587207117,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),!1},Na={};function Ra(e){return void 0===Na[e]&&(Na[e]=Ta(e)),Na[e]}function Fa(e){return 55296==(64512&e)}function Ia(e){return 56320==(64512&e)}function Da(e){return 55296==(63488&e)}function wa(e,t){if(Fa(e)&&Ia(t))return 65536+((1023&e)<<10|1023&t)}function Ma(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}function _a(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;Fa(e.charCodeAt(n))&&n+1<e.length&&Ia(e.charCodeAt(n+1))?n+=2:n+=1}return n}function Oa(e,t,r){for(var n=0,a=t;a<r;n+=1){Fa(e.charCodeAt(a))&&a+1<r&&Ia(e.charCodeAt(a+1))?a+=2:a+=1}return n}function xa(e,t){var r=e.charCodeAt(t);if(!Da(r))return r;if(t+1>=e.length)return 65533;var n=wa(r,e.charCodeAt(t+1));return null!=n?n:65533}function La(e){return e>=65536?2:1}function Pa(e){return 32===e||10===e}function Ua(e,t,r,n){T("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;){var u=xa(r,i);if(!e.isNumeral(u))break;var s=e.getOrdinal(u);0===a&&0!==s&&(o=j(o,i+t)),a=10*a+s,i+=La(u)}return i===o&&i<r.length&&e.isNumeral(xa(r,i))?[0,n]:[a,i]}function Ba(e,t,r,n){var a=n,i=Ua(e,5,r,a),o=i[0],u=i[1];if(u===a)return!1;if(o>32767)return!1;if(!((a=u)<r.length&&47===r.charCodeAt(a)))return!1;var s=Ua(e,5,r,a+=1),c=s[0],l=s[1];if(l===a)return!1;if(c>32767)return!1;if(a=l,0===c)return[!1,0,a];var d=t.div(t.fromNumber(o),t.fromNumber(c));return k("calc.lang.tryTokenizeFrac",$t(d)),[d,c,a]}function Ga(e,t,r,n,a,i,o){var u,s,c,l=n,d=0,f="",h=!1,p=!1,m=wr.ASCII;if(v(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral(xa(r,n))){for(var g=function(){if((i||a&&r.indexOf("%",l)>=0)&&(d-=2,void 0!==u)){var n=t.div(u,t.fromNumber(100));k("calc.lang.parseNumberLiteral",$t(n)),u=n,c=Mr.Pct}if(Y(d)>=309)return{value:void 0,i:l,consumedThousands:h,consumedDecimal:p,numShape:m,format:c};var o=t.parse(e,!0,d,f);if(void 0!==u){var s=t.add(o,u);k("calc.lang.parseNumberLiteral",$t(s)),o=s}return{value:o,i:l,consumedThousands:h,consumedDecimal:p,numShape:m,format:c}};l<r.length;){var S=xa(r,l);if(!e.isNumeral(S))break;if(0!==e.getOrdinal(S))break;(s=e.getNumberShape(S))!==wr.ASCII&&(m=s),l+=La(S)}if(o)if(!1!==(E=Ba(e,t,r,l))){var y=E[0],C=E[1],b=E[2];return l=b,!1===y?{value:void 0,i:l,consumedThousands:h,consumedDecimal:p,numShape:m,format:c}:(c=C>=10?Mr.FractBond:Mr.Fract,u=y,g())}for(var E,A=l;l<r.length;){S=xa(r,l);if(e.isNumeral(S))d+=1,(s=e.getNumberShape(S))!==wr.ASCII&&(m=s),l+=La(S);else{if(!(a&&d>0&&v(r,e.thousandsSeparator,l)))break;h=!0,l+=e.thousandsSeparator.length}}if(f+=r.substring(A,l),h){var T=function(e,t,r){for(var n=r,a="",i=0;i<t.length;){var o=xa(t,i);if(e.isNumeral(o)){var u=La(o);a+=t.substring(i,i+u),i+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;i+=e.thousandsSeparator.length}}return a}(e,f,d);if(void 0===T)return;f=T}if(n<l&&l<r.length&&Pa(r.charCodeAt(l)))if(!1!==(E=Ba(e,t,r,l+1))){y=E[0],C=E[1],b=E[2];return l=b,!1===y?{value:void 0,i:l,consumedThousands:h,consumedDecimal:p,numShape:m,format:c}:(c=C>=10?Mr.FractBond:Mr.Fract,u=y,g())}var N=!1;if(v(r,e.decimalSeparator,l)&&(N=l===n,p=!0,l+=e.decimalSeparator.length),0===d)for(;l<r.length;){S=xa(r,l);if(!e.isNumeral(S))break;if(0!==e.getOrdinal(S))break;d-=1,(s=e.getNumberShape(S))!==wr.ASCII&&(m=s),l+=La(S)}for(A=l;l<r.length;){S=xa(r,l);if(!e.isNumeral(S))break;(s=e.getNumberShape(S))!==wr.ASCII&&(m=s),l+=La(S)}if(f+=r.substring(A,l),!(N&&l<=n+e.decimalSeparator.length)){var R=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(n+1<t.length&&"**"===t.substring(n,n+2)))return[0,r];n+=2}var a=!1;if(n<t.length){var i=xa(t,n);((a=45===i)||43===i)&&(n+=La(i))}if(n>=t.length||!e.isNumeral(xa(t,n)))return!1;var o=Ua(e,10,t,n),u=o[0],s=o[1];return s!==n&&(!(u>2147483647)&&[a?-u:u,s])}(e,r,l);if(!1!==R){var F=R[0];b=R[1];d+=F,b!==l&&(c=Mr.Exp),l=b}return!1===R?{value:void 0,i:l,consumedThousands:h,consumedDecimal:p,numShape:m,format:c}:g()}}}var Va=1<<20,Ha=Va.toString(10).length,Wa=16384,ja=Wa.toString(26).length,Ka=Wa.toString(10).length;function Ya(e){return e>=97&&e<=122||e>=65&&e<=90}function qa(e){return 1+(e>=97?e-97:e-65)}function Ja(e,t,r){return function(n,a,i,o){var u=function(e,t){return"$"===e[t]?[Ar.Abs,t+1]:[Ar.Rel,t]}(i,o),s=u[0],c=u[1],l=e(n,r,i,c),d=l[0],f=l[1];if(f>c){if(d<1||d>t)return;return[Br(s,(s===Ar.Rel?d-a:d)-1),!1,f]}return[void 0,!1,o]}}function za(e,t,r){return di(e,t,r)-e}function Qa(e,t,r,n){return function(a,i,o,u){var s=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(s,o[u]))return[void 0,!1,u];var c=u+1,l=Ua(a,n,o,c),d=l[0],f=l[1];if(f>c){if(d<1||d>r)return;return[Br(Ar.Abs,d-1),!1,f]}if(o[c]===a.leftBracket){if(o[c+=1]===a.rightBracket)return[Br(Ar.Rel,za(i,0,r)),!0,c+1];var v=1;"+"===o[c]?c+=1:"-"===o[c]&&(v=-1,c+=1);var h=Ua(a,n,o,c),p=h[0],m=h[1];if(m>c&&p<r&&o[m]===a.rightBracket)return[Br(Ar.Rel,za(i,p*v,r)),!0,m+1]}return[!1,!1,f]}}function Xa(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var s=u[0],c=u[1],l=u[2];if(l>o){var d=a(e,r,i,l);if(null==d)return c?[s,void 0,l]:[void 0,void 0,o];var f=d[0],v=d[2];return v>l?[s,f,v]:[s,void 0,l]}var h=a(e,r,i,o);if(null==h)return[void 0,void 0,o];var p=h[0],m=h[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var Za=Ja(Ua,Va,Ha),$a=Ja((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=j(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!Ya(o))break;n=26*n+qa(o)}return a===i&&Ya(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),Wa,ja),ei=Qa(!1,!0,Va,Ha),ti=Qa(!1,!1,Wa,Ka),ri=Qa(!0,!0,Va,Ha),ni=Qa(!0,!1,Wa,Ka);function ai(e,t){return"object"!=typeof e&&"object"!=typeof t}function ii(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===kr.A1){var s=Xa(e,o,u,$a,Za,n,a),c=s[0],l=s[1],d=s[2];if((null!=l&&null!=c||null!=l&&l.kind===Ar.Abs||null!=c&&c.kind===Ar.Abs||(null!=l||null!=c)&&(":"===n[a-1]||":"===n[d]))&&(d>=n.length||!e.isIdentContinue(n.charCodeAt(d))))return{refStyle:kr.A1,row:l,col:c,i:d}}var f=!1,v=Xa(e,u,o,ei,ti,n,a),h=v[0],p=v[1],m=v[2];if(null!=h||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(f=!0,h=(i=Xa(e,u,o,ri,ni,n,a))[0],p=i[1],m=i[2]),(null!=h||null!=p)&&(m>=n.length||!ai(h,p)||!e.isIdentContinue(n.charCodeAt(m))))return{refStyle:kr.R1C1,row:h,col:p,i:m,enLocale:f}}function oi(e,t){var r=Xa(e,0,0,$a,Za,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?pt(a.index,n.index):void 0}function ui(e,t){var r=Xa(e,0,0,$a,Za,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return pt(a.index,n.index);if(":"===t[i]){var o=Xa(e,0,0,$a,Za,t,i+1),u=o[0],s=o[1],c=o[2];if(void 0!==u&&void 0!==s&&c===t.length){var l=j(a.index,s.index),d=j(n.index,u.index);return ht(l,d,K(a.index,s.index)+1-l,K(n.index,u.index)+1-d)}}}}var si=Br(Ar.Abs,0),ci=Br(Ar.Abs,1048575);function li(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function di(e,t,r){return e+t&r-1}function fi(e,t,r,n){if(t.kind===Ar.Abs)return t.index;if(n)return di(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function vi(e,t,r,n,a,i){var o=fi(r,n,a,i);if(void 0!==o){if(n.kind===Ar.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function hi(e,t,r,n,a){return t===kr.A1?function(e,t,r){var n=fi(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===Ar.Abs?"$"+a:a}}(r,n,a):vi(e,e.rowLetter,r,n,1<<20,a)}function pi(e,t,r,n,a){return t===kr.A1?function(e,t,r){var n=fi(e,t,16384,r);if(void 0!==n){var a=li(n);return t.kind===Ar.Abs?"$"+a:a}}(r,n,a):vi(e,e.columnLetter,r,n,16384,a)}function mi(e,t,r,n){if(r.kind===Ar.Abs)return r;var a=fi(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:Br(Ar.Rel,i)}}mi.bind(void 0,1<<20),mi.bind(void 0,16384);function gi(e,t,r,n,a){var i=fi(e,t,n,a),o=fi(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function Si(e,t,r,n,a,i,o,u,s){var c=gi(i,o,u,r,s);if(void 0!==c){var l=c[0],d=c[1],f=c[2],v=c[3];if(void 0!==t&&0===f&&v===r-1&&o.kind===u.kind)return t(n,a,s);var h=e(n,a,i,l,s);if(void 0!==h){if(a===kr.R1C1&&l.kind===d.kind&&l.index===d.index)return h;var p=e(n,a,i,d,s);if(void 0!==p)return h+":"+p}}}var yi=Si.bind(void 0,hi,void 0,1<<20),Ci=Si.bind(void 0,pi,(function(e,t,r){return yi(e,t,0,si,ci,r)}),16384);function ki(e,t,r,n,a,i){var o=gi(r,n,a,t,i);if(void 0!==o){var u=o[0],s=o[1],c=o[2],l=o[3];if(void 0!==e&&0===c&&l===t-1&&n.kind===a.kind)return e;var d=mi(t,r,u,i),f=mi(t,r,s,i);if(void 0!==d&&void 0!==f)return[!1,d,f]}}ki.bind(void 0,void 0,1<<20),ki.bind(void 0,[!0,si,ci],16384);function bi(e,t,r,n,a,i){var o=hi(e,t,r.row,n,i),u=pi(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===kr.A1?u+o:o+u}function Ei(e,t,r,n,a,i,o,u){var s=gi(r.row,n,i,1<<20,u),c=gi(r.col,a,o,16384,u);if(void 0!==s&&void 0!==c){var l=s[0],d=s[1],f=s[2],v=s[3],h=c[0],p=c[1],m=c[2],g=c[3];if(0===m&&16383===g&&a.kind===o.kind)return yi(e,t,r.row,l,d,u);if(0===f&&1048575===v&&n.kind===i.kind)return Ci(e,t,r.col,h,p,u);var S=bi(e,t,r,l,h,u),y=bi(e,t,r,d,p,u);if(void 0!==S&&void 0!==y)return S+":"+y}}function Ai(e,t){return 46===t||e.isIdentContinue(t)}var Ti=/'/g;function Ni(e,t){if(0===t.length)return!1;if(!e.isIdentStart(t.charCodeAt(0)))return!1;for(var r=1;r<t.length;r+=1)if(!Ai(e,t.charCodeAt(r)))return!1;return!0}var Ri,Fi,Ii=pt(0,0);function Di(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=ii(e,t,Ii,r,0);if(void 0!==n)if(n.refStyle===kr.A1){var a=n.i;if(a>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}else if(!ai(n.row,n.col))return!0;return!Ni(e,r)&&(!function(e,t){var r=0;if(t.substring(r,r+e.leftBracket.length)!==e.leftBracket)return!1;if((r+=e.leftBracket.length)===t.length||!Ai(e,t.charCodeAt(r)))return!1;for(r+=1;;){if(t.substring(r,r+e.rightBracket.length)===e.rightBracket){r+=e.rightBracket.length;break}if(r===t.length||!Ai(e,t.charCodeAt(r)))return!1;r+=1}var n=t.indexOf(":",r);return n<0?Ni(e,t.substring(r)):Ni(e,t.substring(r,n))&&Ni(e,t.substring(n+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&Ni(e,t.substring(r,t.length-n))))}(e,r))}function wi(e,t,r){return Di(e,t,r)?"'"+r.replace(Ti,"''")+"'":r}function Mi(e,t,r){var n=1===t.cols&&1===t.rows?bi(e,kr.A1,pt(0,0),Br(Ar.Rel,t.row),Br(Ar.Rel,t.col),!1):Ei(e,kr.A1,pt(0,0),Br(Ar.Rel,t.row),Br(Ar.Rel,t.col),Br(Ar.Rel,t.row+t.rows-1),Br(Ar.Rel,t.col+t.cols-1),!1);return k("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:wi(e,kr.A1,r)+"!"+n}function _i(e){return{kind:Ri.NoOriginSheet,origin:e}}function Oi(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case vr.NotImplemented:case vr.Unavailable:case Ri.NoOriginSheet:return!0}return!1}function xi(e,t,r){return function(n,a){return void 0===a?t(n):Oi(a)?r(a,n):e(a)}}!function(e){e.NoOriginSheet="NoOriginSheet"}(Ri||(Ri={})),function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedDottedName="ResolvedDottedName"}(Fi||(Fi={}));var Li=function(e,t){return{kind:Fi.ResolvedName,node:e,resolution:t}},Pi=function(e,t){return{kind:Fi.ResolvedCellRef,node:e,resolution:t}},Ui=function(e,t){return{kind:Fi.ResolvedUserDefinedFunc,node:e,resolution:t}};function Bi(e,t){return{kind:Fi.ResolvedLocalName,node:e,resolution:t}}function Gi(e,t){return{kind:Fi.ResolvedDottedName,resolved:e,fields:t}}function Vi(e,t,r){var n=fi(e.row,t.row,1<<20,r),a=fi(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?pt(n,a):void 0}function Hi(e,t){if(t.kind!==Er.Error){var r=e.originGridCell;if(!It(r))return r.reason;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case Er.Single:return Vi(n,t,a);case Er.Range:var i=Vi(n,t.ref1,a),o=Vi(n,t.ref2,a);return void 0!==i&&void 0!==o?Wt(i,o):void 0;case Er.Row:var u=fi(n.row,t.row1,1<<20,a),s=fi(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==s?Wt(pt(u,0),pt(s,16383)):void 0;case Er.Col:var c=fi(n.col,t.col1,16384,a),l=fi(n.col,t.col2,16384,a);return void 0!==c&&void 0!==l?Wt(pt(0,c),pt(1048575,l)):void 0;default:return y("calc.runtime.resolverService.resolveGridRef",t)}}}function Wi(e){function t(t,r){var n;if(void 0===r){var a=t.originSheet;return It(a)?[r,a.value.document]:[r,a.reason]}var i=e.getDocumentLoc(r.path,r.document);if(!It(i))return[r,i.reason];var o=null==r.path?void 0:H(i.value)?r.path:i.value.path;return[xr(H(i.value)?r.document:i.value.name,o,r.isQuoted,r.label),(n=i.value,null!=n?n:void 0)]}function r(t,r){if(Oi(r))return[t,r];var n=e.getSheetIndex(r,t);if(!It(n))return[t,n.reason];if(null==n.value)return[t,void 0];var a=e.getSheetName(r,n.value);return It(a)?[a.value,lt(r,n.value)]:[t,a.reason]}function n(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),s=u[0],c=u[1];return[Lr(s,i,n.isQuoted,n.label),c]}function a(a,i){switch(i.kind){case br.Error:return[i,void 0];case br.Sheet:return n(a,i);case br.SheetRange:return function(n,a){var i,o=t(n,a.document),u=o[0],s=o[1],c=r(a.sheet1,s),l=c[0],d=c[1],f=r(a.sheet2,s),v=f[0],h=f[1],p=l,m=v;if(Oi(s))i=s;else if(Oi(d))i=d;else if(Oi(h))i=h;else{if(Ut(d,h))return[Lr(p,u,a.isQuoted,a.label),lt(s,d.index)];var g=e.getSheetRangeIndexes(d),S=e.getSheetRangeIndexes(h);It(g)?It(S)?S.value.position<g.value.position&&(p=v,m=l):i=S.reason:i=g.reason,i=ct(s,d.index,h.index)}return[Ur(p,m,u,a.isQuoted,a.label),i]}(a,i);default:return y("calc.runtime.resolverService.resolveCellRefQualifier",i)}}function i(e,t){var r,n,i,o,u=t.qualifier,s=t.ref,c=Hi(e,s);if(void 0===u||u.kind===br.Relative){n=u;var l=e.originSheet;if(It(l)){var d=l.value;i=void 0===d.index?_i(d):d}else i=l.reason}else n=(r=a(e,u))[0],i=r[1];return o=Oi(c)?c:Oi(i)?i:yt(i,c),Pi(sn(s,n,t.label),o)}function o(r,a){var i,o,u,s=a.qualifier,c=a.whole;if(void 0===s||s.kind===br.Relative){var l=r.originSheet;if(!It(l))return Li(a,l.reason);var d=l.value;if(void 0===d.index)return Li(a,_i(d));var f=e.getNameLoc(d,c);if(!It(f))return Li(a,f.reason);if(!H(f.value))return Li(nn(f.value.name,s,a.label),f.value);o=s,u=Et(d.document)}else o=(i=function(e,r){switch(r.kind){case br.Document:var a=t(e,r);return[c=a[0],Oi(l=a[1])?l:Et(l)];case br.Sheet:return n(e,r);case br.Ident:var i=n(e,Lr(r.name,void 0)),o=i[0],u=i[1];if(void 0!==u)return Oi(u)?[r,u]:[Pr(o.sheet,r.isQuoted,r.label),u];var s=t(e,xr(r.name)),c=s[0],l=s[1];return[Pr(c.document,r.isQuoted,r.label),Oi(l)?l:Et(l)];default:return y("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,s))[0],u=i[1];var v,h=c;if(Oi(u))v=u;else{var p=e.getNameLoc(u,c);It(p)?H(p.value)||(h=p.value.name,v=p.value):v=p.reason}return Li(nn(h,o,a.label),v)}function u(r,n){var a,i,o,u,s,c,l=n.qualifier,d=n.whole,f=null!=(o=null===(i=r.config)||void 0===i?void 0:i.localeInfo)?o:e.config.localeInfo;if(void 0===l){var v=r.originSheet;if(!It(v))return Ui(n,v.reason);u=l,s=v.value.document}else u=(a=function(e,r){switch(r.kind){case br.Document:return t(e,r);case br.Ident:var n=t(e,xr(r.name)),a=n[0],i=n[1];return[Pr(a.document,r.isQuoted,r.label),i];default:return y("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,l))[0],s=a[1];if(Oi(s))c=s;else{var h=function(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substr(0,"_xludf.".length),"_xludf.")&&(a=a.substr("_xludf.".length)),e.getUserDefinedFuncLoc(r,a)}(e,f,s,d);It(h)?0!==h.value.length&&(c=h.value):c=h.reason}return Ui(nn(d,u,n.label),c)}return{resolveName:o,resolveGridRef:Hi,resolveCellRef:i,resolveUserDefinedFunc:u,resolveDottedName:function(e,t,r,n){for(var a=t.qualifier,s=t.parts,c=[];;){if(!a){var l=n(nn(an(s.asWhole,s.label)));if(void 0!==l.resolution)return Gi(l,c.reverse())}var d=o(e,nn(s.asWhole,a));if(void 0!==d.resolution||s.kind===Rr.IdentNamePart)return Gi(d,c.reverse());if(r&&0===c.length&&(void 0===a||a.kind===br.Document||a.kind===br.Ident)){var f=u(e,t);if(void 0!==f.resolution)return Gi(f,c.reverse())}if(!Ra(ba.CalcDotOperator))return Gi(d,c.reverse());if(s.lhs.kind===Rr.CellRefNamePart)return null!=a&&a.kind===br.Document||null==a&&!e.allowUnqualifiedCell?Gi(d,c.reverse()):(c.push(s.rhs),Gi(i(e,sn(s.lhs.ref,null!=a&&a.kind===br.Ident?Lr(a.name):a)),c.reverse()));c.push(s.rhs),s=s.lhs}}}}function ji(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,Ki(e,t)}function Ki(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+String(t.level);var r;switch(t.level+=1,e.kind){case Nr.Literal:r=function(e,t){switch(e.kind){case J.Boolean:return t.visitBoolean(e);case J.Number:return t.visitNumber(e);case J.String:return t.visitString(e);case J.Missing:return t.visitMissing(e);case J.Error:return t.visitError(e);default:return y("calc.lang.dispatchLiteral",e)}}(e.oper,t.operVisitor);break;case Nr.Array:r=t.visitArray(e);break;case Nr.App:r=t.visitApp(e);break;case Nr.Let:r=t.visitLet(e);break;case Nr.Fun:r=t.visitFun(e);break;case Nr.Paren:r=t.visitParen(e);break;case Nr.Name:r=t.visitName(e);break;case Nr.CellRef:r=t.visitCellRef(e);break;case Nr.FieldRef:r=t.visitFieldRef(e);break;case Nr.StructRef:r=t.visitStructRef(e);break;case Nr.Bad:r=t.visitBad(e);break;case Nr.Operator:r=t.visitOperator(e);break;case Er.Error:r=t.visitRefError(e);break;case Er.Single:r=t.visitSingle(e);break;case Er.Range:r=t.visitRange(e);break;case Er.Row:r=t.visitRow(e);break;case Er.Col:r=t.visitCol(e);break;case br.Error:r=t.visitNameError(e);break;case br.Relative:r=t.visitRelative(e);break;case br.Document:r=t.visitDocument(e);break;case br.Sheet:r=t.visitSheet(e);break;case br.Ident:r=t.visitIdent(e);break;case br.SheetRange:r=t.visitSheetRange(e);break;default:y("calc.lang.dispatch",e)}return t.level-=1,r}function Yi(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitError:e}}function qi(e,t,r){var n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k,b,E,A;return{level:0,operVisitor:e,visitArray:(n=r.vArray,null!=n?n:t),visitApp:(a=r.vApp,null!=a?a:t),visitLet:(i=r.vLet,null!=i?i:t),visitFun:(o=r.vFun,null!=o?o:t),visitParen:(u=r.vParen,null!=u?u:t),visitName:(s=r.vName,null!=s?s:t),visitCellRef:(c=r.vCellRef,null!=c?c:t),visitFieldRef:(l=r.vFieldRef,null!=l?l:t),visitStructRef:(d=r.vStructRef,null!=d?d:t),visitBad:(f=r.vBad,null!=f?f:t),visitOperator:(v=r.vOperator,null!=v?v:t),visitRefError:(h=r.vRefError,null!=h?h:t),visitSingle:(p=r.vSingle,null!=p?p:t),visitRange:(m=r.vRange,null!=m?m:t),visitRow:(g=r.vRow,null!=g?g:t),visitCol:(S=r.vCol,null!=S?S:t),visitNameError:(y=r.vNameError,null!=y?y:t),visitRelative:(C=r.vRelative,null!=C?C:t),visitDocument:(k=r.vDocument,null!=k?k:t),visitSheet:(b=r.vSheet,null!=b?b:t),visitIdent:(E=r.vIdent,null!=E?E:t),visitSheetRange:(A=r.vSheetRange,null!=A?A:t)}}var Ji=function(e,t,r){return{sign:e,mantissa:t,exponent:r}};function zi(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}function Qi(e){return{kind:J.Number,_valueIEEE:e}}var Xi=Qi(0),Zi=Qi(1),$i=Qi(Math.PI);function eo(e){return isFinite(e)?Qi(e):je}function to(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function ro(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!v(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(48!==e.charCodeAt(t))return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}var no=["0","1","2","3","4","5","6","7","8","9"];function ao(e){var t=e._valueIEEE;return Qi(t<0?Math.ceil(t):Math.floor(t))}function io(e){var t=e._valueIEEE;return Qi(Math.floor(t))}function oo(e){return e.substring(0,1)+"."+e.substring(1)}var uo,so,co,lo,fo,vo,ho,po,mo,go,So,yo,Co,ko,bo,Eo,Ao={zero:Xi,one:Zi,pi:$i,add:function(e,t){return eo(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return eo(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return eo(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,n=t._valueIEEE;return 0===n?Ge:eo(r/n)},power:function(e,t){var r=e._valueIEEE,n=t._valueIEEE,a=Math.pow(r,n);return isFinite(a)?Qi(a):isNaN(a)?Ge:je},percent:function(e){return Qi(e._valueIEEE/100)},neg:function(e){return Qi(-e._valueIEEE)},compare:to,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=t._valueIEEE,i=String(a).replace("e","E");return"."!==n&&(i=i.replace(".",n)),i},formatFixed:function(e,t,r){var n,a=e._valueIEEE,i=ro(a),o=i.sign,u=i.mantissa,s=i.exponent,c=r+(s+t);if(0===c){var l=parseFloat("5e"+String(s-1));if(Math.abs(a)>=l)return Ji(o,"1",s+t+1)}if(c<1)return Ji(!0,"",0);c<=21&&(o=(n=ro(a,c-1)).sign,u=n.mantissa,c=r+((s=n.exponent)+t));var d=u.substring(0,c);return Ji(o,d,0===d.length?0:s+t)},formatScientific:function(e,t,r){var n,a=e._valueIEEE,i=ro(a),o=i.sign,u=i.mantissa,s=i.exponent,c=zi(s,t),l=c+r;if(k("calc.lang.ieeeFormatScientific",l>0),0===l){var d=parseFloat("5e"+String(s-1));if(Math.abs(a)>=d)return Ji(o,"",s+1)}if(l<1)return Ji(!0,"",0);l<=21&&(o=(n=ro(a,l-1)).sign,u=n.mantissa,l=(c=zi(s=n.exponent,t))+r);var f=u.substring(0,l);return Ji(o,f,0===f.length?0:s)},parse:function(e,t,r,n){return Qi(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0;a<t.length;a+=1)n+=no[r(t.charCodeAt(a))];return n}(e,n)+"E"+String(r)))},trunc:ao,ceil:function(e){var t=e._valueIEEE;return Qi(Math.ceil(t))},floor:io,abs:function(e){return Qi(Math.abs(e._valueIEEE))},cond:function(e){return to(e,Xi)},cond2:to,fromNumber:Qi,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return eo(Math.sqrt(e._valueIEEE))},exp:function(e){return eo(Math.exp(e._valueIEEE))},ln:function(e){return eo(Math.log(e._valueIEEE))},log:function(e){return eo(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return Qi(Math.sin(e._valueIEEE))},cos:function(e){return Qi(Math.cos(e._valueIEEE))},tan:function(e){return Qi(Math.tan(e._valueIEEE))},asin:function(e){return eo(Math.asin(e._valueIEEE))},acos:function(e){return eo(Math.acos(e._valueIEEE))},atan:function(e){return eo(Math.atan(e._valueIEEE))},atan2:function(e,t){return Qi(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return Xi;var n=ro(r).exponent,a=ao(t)._valueIEEE+n;if(0===a){var i=parseFloat("5e"+String(n-1));if(Math.abs(r)>=i)return eo((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?Xi:a>21?e:eo(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return Xi;var n=ro(r),a=n.sign,i=n.mantissa,o=n.exponent,u=ao(t)._valueIEEE+o;return u<1?eo(parseFloat((a?"":"-")+"10e"+String(o-1-u))):u>21?e:eo(parseFloat((a?"":"-")+function(e,t){if(e.length<=t)return oo(e);for(var r=e.substring(0,t),n=0,a=r.length-1;a>=0&&r.charCodeAt(a)-48==9;a-=1)n+=1;return n===r.length?"10":oo(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,u)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return Xi;var n=ro(r),a=n.sign,i=n.mantissa,o=n.exponent,u=ao(t)._valueIEEE+o;if(u<1)return Xi;if(u>21)return e;var s=i.substring(0,u);return eo(parseFloat((a?"":"-")+oo(s)+"e"+String(o-1)))},tenTo:function(e){return b("calc.lang.ieeeTenTo",e),eo(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=ao(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=io(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:x};(so=uo||(uo={})).LexicalKind=$e,so.sheetRows=1<<20,so.sheetCols=16384,so.lexicalSourceCell=at,so.lexicalSourceRange=it,so.lexicalSourceName=ut,so.documentLoc=st,so.sheetIndex=lt,so.sheetRange=ct,so.gridCell=pt,so.gridRange=ht,so.allSheetsRange=dt,so.sheetRangeIndexes=ft,so.sheetGridCell=kt,so.sheetGridRange=Ct,so.sheetGridCube=yt,so.originCell=bt,so.documentScope=Et,so.nameLoc=Tt,so.nameScope=At,so.userDefinedFuncLoc=Nt,(lo=co||(co={})).SpecialPrecs=Q,lo.PrecsBound=Ie,lo.OperKind=J,lo.trueOper=rt,lo.falseOper=nt,lo.ErrorType=Oe,lo.precedents=xe,lo.stringOper=Pe,lo.booleanOper=Le,lo.errorOper=Ue,lo.nullErrorOper=Be,lo.div0ErrorOper=Ge,lo.valueErrorOper=Ve,lo.refErrorOper=He,lo.nameErrorOper=We,lo.numErrorOper=je,lo.naErrorOper=Ke,lo.gettingDataErrorOper=Ye,lo.fieldErrorOper=qe,lo.arrayOper=Qe,lo.rangeSeqOper=Xe,lo.range3DOper=Ze,lo.missingOper=et,lo.blankOper=tt,(vo=fo||(fo={})).RefStyle=kr,vo.QualifierKind=br,vo.CellRefKind=Er,vo.PosKind=Ar,vo.NodeKind=Nr,vo.NamePartKind=Rr,vo.BadType=Fr,vo.errorQualifier=_r,vo.relativeQualifier=Or,vo.documentQualifier=xr,vo.sheetQualifier=Lr,vo.identQualifier=Pr,vo.sheetRangeQualifier=Ur,vo.pos=Br,vo.cellRefError=Gr,vo.cellRefSingle=Vr,vo.cellRefRange=Hr,vo.cellRefRow=Wr,vo.cellRefCol=jr,vo.formula=Kr,vo.formulaSpan=Yr,vo.literalNode=zr,vo.arrayNode=Qr,vo.appNode=Xr,vo.letNode=Zr,vo.funNode=$r,vo.operatorNode=en,vo.wsfNode=tn,vo.parenNode=rn,vo.nameNode=nn,vo.identNamePart=an,vo.cellRefNamePart=on,vo.fieldRefNamePart=un,vo.cellRefNode=sn,vo.fieldRefNode=cn,vo.fieldRef=ln,vo.structRefNode=dn,vo.structRef=fn,vo.badNode=vn,vo.AnnotationKind=Tr,vo.worksheetFuncNameAnnotation=qr,vo.localNameAnnotation=Jr,(po=ho||(ho={})).SignatureType=z,po.FunctionFlags=X,po.OperatorId=ae,po.WorksheetFuncId=Z,po.SpecialPrecs=Q,po.functionType=ne,po.unknownFunctionType=se,po.getOperatorType=be,po.getWorksheetFuncType=Ee,(go=mo||(mo={})).isSheetIndex=wt,go.isSheetGridRange=Ot,go.isGridCell=_t,go.isSheetGridCell=xt,go.isDocumentLocEqual=Pt,go.isSheetIndexEqual=Ut,go.isGridCellEqual=Bt,go.isSheetGridCellEqual=Gt,go.isWellFormed=Mt,go.isUnqualifiedNameNode=zt,go.isOperatorNode=qt,go.isWSFNode=Jt,go.gridRangeAnchor=Vt,go.sheetGridRangeAnchor=Ht,go.gridCellRange=Wt,go.getArguments=Yt,go.getArgType=Qt,go.shouldFieldRefBeBracketed=Zt,go.isValidArgsLength=Xt,go.isNumberOper=$t,go.isStringOper=er,go.isBooleanOper=tr,go.isErrorOper=rr,go.isRangeOper=nr,go.isArrayOper=ar,go.isMissingOper=ir,go.isBlankOper=or,go.isRichOper=ur,go.ResultKind=gt,go.success=Rt,go.failure=Ft,go.isSuccess=It,go.ReasonKind=vr,go.notImplemented=hr,go.unavailable=pr,go.internal=mr,go.javaScriptError=Dt,go.columnName=li,go.formatRow=hi,go.formatCol=pi,go.formatRowRange=yi,go.formatColRange=Ci,go.formatCellPos=bi,go.formatGridRangeA1=Mi,go.parseGridCellA1=oi,go.parseGridRangeA1=ui,go.getSubExpressionFromPosition=jt,go.ResolveReasonKind=Ri,go.noOriginSheet=_i,go.createResolver=Wi,go.createResolutionHandler=xi,go.ResolvedKind=Fi,go.resolvedName=Li,go.resolvedCellRef=Pi,go.resolvedUserDefinedFunc=Ui,go.resolvedLocalName=Bi,go.resolvedDottedName=Gi,go.defaultLiteralVisitor=Yi,go.defaultFormulaVisitor=qi,go.dispatch=Ki,go.startVisit=ji,(yo=So||(So={})).LogCategory=i.LogCategory,yo.TraceLevel=i.TraceLevel,yo.localeInfo=na,yo.localeInfo2=aa,yo.LCID=Yn,yo.Country=Kn,yo.PictureSpecial=qn,yo.PictureSingle=Jn,yo.PictureColor=zn,yo.PictureDbnum=Qn,yo.calcConfig=jn,yo.initCalc=ea,yo.getEnglishLocaleInfo=Aa,yo.createWorksheetFuncNameCallbacks=ka,yo.isCalcInit=ta,yo.getCalcAbsUrl=ra,yo.FeatureName=ba,(ko=Co||(Co={})).numberComponents=Ji,ko.ieeeMathpack=Ao,ko.xlMathpack=Wn,ko.formatScientificLeft=zi,(Eo=bo||(bo={})).TimeDivision=Cn,Eo.Rounding=Sn,Eo.tzData=mn,Eo.tzUTC=gn,Eo.dateTime=yn,Eo.TimeGranularity=hn,Eo.xlDatepack=kn;var To=/"/g,No=/'/g,Ro=kt(lt(st(void 0,"Book1"),0),pt(0,0)),Fo=function(e){return e.kind===Nr.Literal&&ir(e.oper)},Io=xi((function(){}),(function(){}),(function(e){if(e.kind!==Ri.NoOriginSheet)throw new wo(e)})),Do=function(){function e(e,t,r,n,a){var i,o,u,s,c,l,d=this;this.spans=r,this.annotations=n,this.anonymize=a,this.anon=function(e){return d.anonymize?Ho(e):e},this.level=0,this.operVisitor=this,this.locals=t,this.localeInfo=null!=(u=null===(o=null===(i=t)||void 0===i?void 0:i.config)||void 0===o?void 0:o.localeInfo)?u:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!=(l=null===(c=null===(s=t)||void 0===s?void 0:s.config)||void 0===c?void 0:c.refStyle)?l:e.config.refStyle,this.resolver=Wi(e)}return e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.pre)?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.post)?n:t},e.prototype.visitString=function(e){return'"'+this.anon(e.value).replace(To,'""')+'"'},e.prototype.visitBoolean=function(e){return e.value?this.localeInfo.trueName:this.localeInfo.falseName},e.prototype.visitNumber=function(e){return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21))},e.prototype.visitMissing=function(e){return""},e.prototype.visitError=function(e){var t=this.localeInfo.errorNames[e.type];if(void 0===t)throw new wo(mr("No locale data for error oper"));return t},e.prototype.visitArray=function(e){var t=this,r=e.nodes.map((function(e){return e.map((function(e){return Ki(e,t)})).join(t.localeInfo.columnSeparator)}));return this.localeInfo.leftBrace+r.join(this.localeInfo.rowSeparator)+(e.isClosed?this.localeInfo.rightBrace:"")},e.prototype.visitApp=function(e){var t=this;if(qt(e.head)){var r=Ki(e.head,this);if(1===e.args.length){var n=Ki(e.args[0],this);switch(e.head.id){case ae.Percent:return n+this.pre(e.head,"")+r;case ae.Pound:return n+r;default:return r+this.post(e.head,"")+n}}if(2===e.args.length){var a=Ki(e.args[0],this),i=Ki(e.args[1],this);return a+this.pre(e.head," ")+r+this.post(e.head,e.head.id===ae.Isect?"":" ")+i}C("calc.lang.printFormula: invalid number of operator args")}return this.visitApplication(e.head,e.args.map((function(e){return[e,Ki(e,t)]})),e.isClosed)},e.prototype.visitLet=function(e){var t=this,r=G([],M(e.vars.map((function(e){var r=e[0],n=e[1];return[[r,t.anon(r.whole)],[n,Ki(n,t)]]})),[[[e.body,Ki(e.body,this)]]]));return this.visitApplication(e.head,r,e.isClosed)},e.prototype.visitFun=function(e){var t=this,r=M(e.params.map((function(e){return[e,t.anon(e.whole)]})),[[e.body,Ki(e.body,this)]]);return this.visitApplication(e.head,r,e.isClosed)},e.prototype.visitParen=function(e){return"("+this.pre(e.node,"")+Ki(e.node,this)+this.post(e.node,"")+(e.isClosed?")":"")},e.prototype.visitName=function(e){return this.visitNameImpl(e,!1)},e.prototype.visitCellRef=function(e){var t=this.resolver.resolveCellRef(this.locals,e),r=t.node,n=t.resolution;return Io(void 0,n),this.visitCellRef2(r)},e.prototype.visitFieldRef=function(e){for(var t=e.lhs,r=e.rhs,n=this.pre(t,"")+Ki(t,this),a=Zt(t,this.pre(r,"")),i=r.isBracketed||a?this.localeInfo.leftBracket:"",o=r.isBracketed&&r.isClosed||a?this.localeInfo.rightBracket:"",u="",s=0;s<r.field.length;s+=1){var c=r.field[s];"'"!==c&&c!==this.localeInfo.leftBracket&&c!==this.localeInfo.rightBracket||(u+="'"),u+=c}var l;return n+=(Fo(t)||(l=t).kind===Nr.Literal&&$t(l.oper)?this.pre(r,""):"")+"."+i+this.anon(u)+o+this.post(r,"")},e.prototype.visitStructRef=function(e){throw new wo(hr(["printing structured references"]))},e.prototype.visitBad=function(e){var t=this;return e.type===Fr.Sequence?e.contents.map((function(e){return t.pre(e,"")+Ki(e,t)+t.post(e,"")})).join(""):this.pre(e,"")+this.anon(e.contents)+this.post(e,"")},e.prototype.visitOperator=function(e){var t=Sa(this.localeInfo,e.id,"");if(void 0===t)throw new wo(mr("Invalid operator"));return t},e.prototype.visitRefError=function(){var e=this.localeInfo.errorNames[Oe.REF];if(void 0===e)throw new wo(mr("No locale data for #REF"));return e},e.prototype.visitSingle=function(e){var t=bi(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRange=function(e){var t=Ei(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.ref1.row,e.ref1.col,e.ref2.row,e.ref2.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRow=function(e){var t=yi(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e.row1,e.row2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitCol=function(e){var t=Ci(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e.col1,e.col2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitNameError=function(e){var t=this.localeInfo.errorNames[Oe.REF];if(void 0===t)throw new wo(mr("No locale data for #REF"));return t.replace("!","")},e.prototype.visitRelative=function(e){return""},e.prototype.visitDocument=function(e){return wi(this.localeInfo,this.refStyle,this.anon(void 0!==e.path?e.path+"/"+e.document:e.document))},e.prototype.visitSheet=function(e){return wi(this.localeInfo,this.refStyle,this.anon(this.visitSheetDocument(e.document)+e.sheet))},e.prototype.visitIdent=function(e){return wi(this.localeInfo,this.refStyle,this.anon(e.name))},e.prototype.visitSheetRange=function(e){var t=this.anon(this.visitSheetDocument(e.document)+e.sheet1),r=this.anon(e.sheet2),n=t+":"+r;return Di(this.localeInfo,this.refStyle,t)||Di(this.localeInfo,this.refStyle,r)?"'"+n.replace(No,"''")+"'":n},e.prototype.visitAppFormulaHead=function(e){return Jt(e)?this.localeInfo.getWorksheetFuncName(e.id):e.kind===Nr.Name?this.visitNameImpl(e,!0):Ki(e,this)},e.prototype.visitNameImpl=function(e,t){var r,n=e.qualifier,a=e.whole,i=[],o=this.annotations;if(void 0!==o){var u=this.resolver.resolveDottedName(this.locals,e,t,(function(e){var t,r=o[e.parts.label];return(null===(t=r)||void 0===t?void 0:t.kind)===Tr.LocalName?Bi(nn(r.name,void 0),!0):Bi(e,void 0)}));if(Io(void 0,u.resolved.resolution),u.resolved.kind===Fi.ResolvedCellRef)return M([this.visitCellRef2(u.resolved.node)],u.fields.map(this.anon)).join(".");n=(r=u.resolved.node).qualifier,a=r.whole,i=u.fields}return(void 0!==n?Ki(n,this)+"!":"")+M([this.anon(a)],i.map(this.anon)).join(".")},e.prototype.visitCellRef2=function(e){var t=e.qualifier,r=e.ref;return(void 0!==t?Ki(t,this)+"!":"")+Ki(r,this)},e.prototype.visitSheetDocument=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.visitApplication=function(e,t,r){var n=this,a=t.map((function(e,t){var r=e[0],a=e[1];return n.pre(r,0===t||Fo(r)?"":" ")+a}));return this.visitAppFormulaHead(e)+"("+a.join(this.localeInfo.listSeparator)+(0===t.length?"":this.post(t[t.length-1][0],""))+(r?")":"")},e}(),wo=gr("PrintError"),Mo=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return Rt(st(e,t))},e.prototype.getSheetIndex=function(e,t){return Rt(t)},e.prototype.getSheetName=function(e,t){return Rt(t)},e.prototype.getNameLoc=function(e,t){return Rt(t.indexOf(".")>=0?void 0:Tt(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return Rt([Nt(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return Rt(ft([e.index],0))},e}();function _o(e){return new Mo(e)}function Oo(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:Rt(t.range),originSheet:Rt(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function xo(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:Rt(t.range),originSheet:Rt(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}function Lo(e,t,r,n){void 0===n&&(n=!1);try{var a=new Do(e,t,r.spans,r.annotations,n);return Rt("="+a.pre(r.node,"")+ji(r.node,a))}catch(e){if("string"==typeof e)return Ft(mr("calc.lang.printFormula: "+e));if(e instanceof wo)return Ft(e.reason);throw e}}function Po(e,t,r){try{var n=r.kind===$e.Cell||r.kind===$e.Range?Oo(r,Ht(r.range)):r.kind===$e.NameManager?xo(r,Ro):y("calc.lang.anonymizeFormula",r),a=Lo(_o(jn(Aa(),kr.A1,e.mathpack)),n,t,!0);if(a.kind===gt.Success)return a.value}catch(e){var o="calc.lang.anonymizeFormula: Format failed: "+m(e);S.ULS.traceTag(595964180,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,o)}return s(t)}var Uo,Bo=new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),Go=/[0-9]/g,Vo=/d/g;function Ho(e){return e.toLowerCase().replace(Vo,"w").replace(Go,"d").replace(Bo,"w")}function Wo(e){return{config:e}}function jo(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Rt(t)}}!function(e){e.NotFormulaString="NotFormulaString"}(Uo||(Uo={}));var Ko,Yo,qo,Jo,zo,Qo=F(F({},vr),Uo),Xo=Oo,Zo=xo;function $o(e){return{kind:Qo.NotFormulaString,message:e}}function eu(e){return e.kind===zo.BadNumber||e.kind===J.Number}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape"}(Ko||(Ko={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Yo||(Yo={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot"}(qo||(qo={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Jo||(Jo={})),function(e){e.BadNumber="BadNumber"}(zo||(zo={}));var tu={kind:zo.BadNumber};function ru(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}var nu=function(e){return ru(Ko.End,e,"",!1)},au=function(e,t){return ru(Ko.Spaces,e,t,!1)},iu=function(e,t){return ru(Ko.Unexpected,e,t,!1)},ou=function(e,t){return ru(Ko.Escape,e,t,!1)},uu=function(e,t){return ru(Ko.Ident,e,t,!0)};function su(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}var cu=function(e,t){return su(Ko.Left,e,t,Yo.Bracket)},lu=function(e,t){return su(Ko.Left,e,t,Yo.Brace)},du=function(e){return su(Ko.Right,e,")",Yo.Paren)},fu=function(e,t){return su(Ko.Right,e,t,Yo.Bracket)},vu=function(e,t){return su(Ko.Right,e,t,Yo.Brace)},hu=function(e){return su(Ko.Right,e,"'",Yo.SQuote)},pu=function(e,t){return su(Ko.Sep,e,t,qo.List)},mu=function(e,t){return su(Ko.Sep,e,t,qo.Col)},gu=function(e,t){return su(Ko.Sep,e,t,qo.Row)},Su=function(e){return su(Ko.Sep,e,"!",qo.Qual)},yu={"#ALL":function(e,t){return su(Ko.SpecialRef,e,t,Jo.All)},"#DATA":function(e,t){return su(Ko.SpecialRef,e,t,Jo.Data)},"#HEADERS":function(e,t){return su(Ko.SpecialRef,e,t,Jo.Headers)},"#TOTALS":function(e,t){return su(Ko.SpecialRef,e,t,Jo.Totals)},"#THIS ROW":function(e,t){return su(Ko.SpecialRef,e,t,Jo.ThisRow)}};function Cu(e,t,r,n,a,i,o){return{kind:Ko.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:a,refStyle:i,isBadLocale:o}}function ku(e,t,r,n){void 0===n&&(n=!0);var a=r.kind===J.Boolean||eu(r)&&function(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t]||"*"===e[t]||" "===e[t]||"/"===e[t])return!1;return!0}(t);return{kind:Ko.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:n}}function bu(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?ku(t,r,nt):0===e.stringCompareCI(e.trueName,r)?ku(t,r,rt):uu(t,r)}function Eu(e,t,r){return{kind:Ko.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function Au(e){var t=le[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return Eu(r,t,e)}}var Tu,Nu=Au(ae.Add),Ru=Au(ae.Sub),Fu=Au(ae.Mul),Iu=Au(ae.Div),Du=Au(ae.Pow),wu=Au(ae.Percent),Mu=Au(ae.Concat),_u=Au(ae.Eq),Ou=Au(ae.Lt),xu=Au(ae.Gt),Lu=Au(ae.Ne),Pu=Au(ae.Le),Uu=Au(ae.Ge),Bu=Au(ae.Range),Gu=Au(ae.At),Vu=Au(ae.Pound);function Hu(e,t,r){return r.push(t),t.start+e}function Wu(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return S.ULS.assertTag(595980821,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function ju(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function Ku(e,t,r,n,a){var i=e[t];return r(i)?1:i===n&&t+1<e.length&&a(e[t+1])?2:0}function Yu(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var s=Ku(e,u,r,n,a);if(0===s)break;2===s&&(o!==u&&i.push(e.substring(o,u)),o=u+1),u+=s}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}function qu(e){if(!Tu){Tu=L();for(var t=0,r=Object.getOwnPropertyNames(Ju);t<r.length;t++){var n=r[t];Tu[n]=!0}for(var a=0,i=Object.getOwnPropertyNames(zu);a<i.length;a++){var o=i[a];Tu[o[0]]=!0}}return!0===Tu[e]}var Ju={"+":Nu,"-":Ru,"*":Fu,"/":Iu,"^":Du,"%":wu,"&":Mu,"=":_u,"<":Ou,">":xu,":":Bu,".":function(e){return su(Ko.Sep,e,".",qo.Dot)},"@":Gu,"#":Vu},zu={"<>":Lu,"<=":Pu,">=":Uu};function Qu(e,t,r){if(t<e.length-1){var n=zu[e.substr(t,2)];if(null!=n)return Hu(2,n(t),r)}var a=Ju[e[t]];if(null!=a)return Hu(1,a(t),r);return S.ULS.assertTag(595980822,i.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Xu(e,t,r,n,a){var i=Ga(e,t,r,n,!1,!1,!1);if(void 0!==i){var o=i.value,u=i.i;return Hu(u-n,ku(n,r.substring(n,u),null!=o?o:tu,!0),a),u}}function Zu(e,t,r){var n=Yu(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?Hu(i+1-t,ku(t,o,Pe(a),!0),r):Hu(i-t,ku(t,o,Pe(a),!1),r)}function $u(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(void 0!==i){var o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return Hu(i.length,ku(r,o,Ue(a)),n)}}}var es=Object.getOwnPropertyNames(yu);function ts(e,t,r,n){for(var a=0;a<es.length;a+=1){var i=es[a],o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return Hu(i.length,yu[i](r,o),n)}}function rs(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function ns(e,t,r,n){var a=Hu(1,cu(r,t[r]),n);"#"===t[a]&&(null!=(c=ts(e,t,a,n))&&(a=c));for(var i=function(t){return rs(e,t)},o=function(t){return!rs(e,t)},u=Wu("calc.parse.tokenizeBracketedColRef",a);a<t.length;){u(a);var s=t[a];if(n.length>0&&n[n.length-1].kind===Ko.Escape&&o(s))a=Hu(1,uu(a,s),n);else if("'"!==s){if(s===e.rightBracket)return Hu(1,fu(a,s),n);if(i(s)){var c,l=ju(t,a,i),d=l[0];a=Hu((c=l[1])-a,uu(a,d),n)}else a=Hu(1,iu(a,s),n)}else a=Hu(1,ou(a,s),n)}return a}function as(e,t){return!Pa(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function is(e,t,r,n){var a=Hu(1,cu(r,t[r]),n);"#"===t[a]&&(null!=(d=ts(e,t,a,n))&&(a=d));for(var i=function(t){return as(e,t)},o=function(t){return!as(e,t)},u=Wu("calc.parse.tokenizeBracketedRef",a);a<t.length;){u(a);var s=t[a];if(n.length>0&&n[n.length-1].kind===Ko.Escape&&o(s))a=Hu(1,uu(a,s),n);else if("'"!==s){if(s===e.rightBracket)return Hu(1,fu(a,s),n);if(i(s)){var c=ju(t,a,i),l=c[0];a=Hu((d=c[1])-a,uu(a,l),n)}else if(Pa(s.charCodeAt(0))){var d,f=ju(t,a,(function(e){return Pa(e.charCodeAt(0))}));l=f[0];a=Hu((d=f[1])-a,au(a,l),n)}else a=":"!==s?s!==e.listSeparator?s!==e.leftBracket?Hu(1,iu(a,s),n):ns(e,t,a,n):Hu(1,pu(a,s),n):Hu(1,Bu(a),n)}else a=Hu(1,ou(a,s),n)}return a}function os(e,t,r,n){for(var a,i=Hu(1,(a=r,su(Ko.Left,a,"'",Yo.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},s=Wu("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){s(i);var c=t[i];if("'"===c&&"'"!==t[i+1])return Hu(1,hu(i),n);if(":"!==c)if(c!==e.leftBracket)if(Ku(t,i,o,"'",u)>0){var l=Yu(t,i,o,"'",u),d=l[0];i=Hu(l[1]-i,uu(i,d),n)}else i=Hu(1,iu(i,c),n);else i=is(e,t,i,n);else i=Hu(1,Bu(i),n)}return i}function us(e,t,r,n,a,i){var o,u,s,c,l=ii(e,t,r,n,a);if(null!=l){var d=l.i,f=n.substring(d,a);return Hu(d-a,l.refStyle===kr.A1?(o=a,u=f,s=l.row,c=l.col,Cu(o,u,!(null!=s&&s.kind!==Ar.Rel||null!=c&&c.kind!==Ar.Rel),s,c,kr.A1,!1)):function(e,t,r,n,a){return void 0===a&&(a=!1),Cu(e,t,!(!1!==r&&null!=r&&r.kind!==Ar.Abs||!1!==n&&null!=n&&n.kind!==Ar.Abs),r,n,kr.R1C1,a)}(a,f,l.row,l.col,l.enLocale),i)}}function ss(e,t,r){var n=r[r.length-1];return null==n||(n.kind!==Ko.Sep||n.value!==qo.Dot)&&(t===e.decimalSeparator?n.kind===Ko.Spaces&&null==(n=r[r.length-2])||n.kind!==Ko.Ident&&n.kind!==Ko.CellRef&&n.kind!==Ko.Right&&(n.kind!==Ko.Literal||eu(n.oper)):e.isNumeral(t.charCodeAt(0)))}function cs(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function ls(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],s=[],c=i,l=Wu("calc.parse.tokenize",c);c<a.length;){l(c);var d=us(e,r,n,a,c,u);if(null==d){var f=a[c];if(ss(e,f,u)){var v=Xu(e,t,a,c,u);if(null!=v){c=v;continue}}if('"'!==f)if(e.isIdentContinue(f.charCodeAt(0))){var h=ju(a,c,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),p=h[0];c=Hu(h[1]-c,bu(e,c,p),u)}else if("#"!==f)if(qu(f))c=Qu(a,c,u);else if(Pa(f.charCodeAt(0))){var m=ju(a,c,(function(e){return Pa(e.charCodeAt(0))}));p=m[0];c=Hu(m[1]-c,au(c,p),u)}else if("("!==f)if(")"!==f)if(f!==e.leftBrace)if(f!==e.rightBrace)if(f!==e.leftBracket)if(f!==e.rightBracket){if(s.length>0&&s[s.length-1]===Yo.Brace){if(f===e.columnSeparator){c=Hu(1,mu(c,f),u);continue}if(f===e.rowSeparator){c=Hu(1,gu(c,f),u);continue}}c=f!==e.listSeparator?"!"!==f?"'"!==f?Hu(1,iu(c,f),u):os(e,a,c,u):Hu(1,Su(c),u):Hu(1,pu(c,f),u)}else c=Hu(1,fu(c,f),u);else c=is(e,a,c,u);else s.length>0&&s[s.length-1]===Yo.Brace&&s.pop(),c=Hu(1,vu(c,f),u);else s.push(Yo.Brace),c=Hu(1,lu(c,f),u);else s.length>0&&s[s.length-1]===Yo.Paren&&s.pop(),c=Hu(1,du(c),u);else s.push(Yo.Paren),c=Hu(1,(o=c,su(Ko.Left,o,"(",Yo.Paren)),u);else{var g=$u(e,a,c,u);if(null!=g){c=g;continue}c=Qu(a,c,u)}else c=Zu(a,c,u)}else c=d}return u}(e,t,r,n,a,i),u=[],s=0;s<o.length;){var c=o[s];if(c.kind!==Ko.Unexpected)u.push(c),s+=1;else{var l=cs(o,s,Ko.Unexpected,(function(e,t){var r=e,n=t;return iu(r.start,r.chars+n.chars)})),d=l[0],f=l[1];u.push(d),s=f}}return u.push(nu(a.length)),u}function ds(e,t,r,n){var a;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=Rt({output:e,index:t})}),(function(){a=Ft(void 0)}))),null==a){var o="calc.parse.runParser: internal error: parser did not call resolve or reject on "+s(t);return S.ULS.assertTag(595980827,i.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}function fs(e){var t;return function(r,n,a,i,o){var u=null!=t?t:t=e();return function(){return u(r,n,a,i,o)}}}function vs(e){return function(t,r,n,a,i){return a(e,r)}}var hs,ps=function(e,t,r,n,a){return a};function ms(){return ps}function gs(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function Ss(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function ys(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function Cs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?ms():e.reduce(ys)}function ks(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function bs(e){return function(t,r,n,a,i){return e(t,r,n,(function(){return a(!0,r)}),i)}}function Es(e){return function(t,r,n,a,i){return e(t,r,n,i,(function(){return a(!0,r)}))}}function As(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var s=e(a,u);return null==s?o:i(s,n+t)}}function Ts(e){return As(e,1)}function Ns(e){return As(e,0)}function Rs(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var s=e(n,o,u);return null==s?i:a(s,r+1)}}function Fs(e,t){return r=e,n=function(e,t,r){return r.push(t),r},a=t,function(e,t,o,u,c){var l=a,d=t;function f(){return r(e,d,o,v,h)}function v(t,r){if(r<=d){var a=s(e),u="calc.parse.reduce: internal error: no progress made at index "+d+" on "+a;return S.ULS.assertTag(595980829,i.LogCategory.msoulscat_ES_EWAJS,!1,u)}return l=n(o,t,l),d=r,f}function h(){return u(l,d)}return f};var r,n,a}function Is(e){return function(t,r,n,a,i){return Fs(e,[])(t,r,n,a,i)}}function Ds(e,t){return void 0===t&&(t=e),gs(e,(function(e,r){return Fs(t,[r])}))}function ws(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return vs([]);if(1===e.length)return Ss(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,a,i,o){var u=n,s=[];function c(){return e[s.length](t,u,a,l,o)}function l(e,t){return u=t,s.push(e),s.length<r?c:i(s,u)}return c}}function Ms(e,t){return Ss(ws(e,t),(function(e,t){return t[0]}))}function _s(e,t){return Ss(ws(e,t),(function(e,t){return t[1]}))}function Os(e){return Ss(e,(function(e,t){return G([],t)}))}function xs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Os(ws.apply(void 0,e))}function Ls(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+s(t);return S.ULS.assertTag(595980824,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Ps(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=Yr(t,r,n,a),i}function Us(e,t,r){return function(n,a,i,o,u){var s=e(i);return r(n,a,i,(function(e,r){return t(i,s),o(e,r)}),(function(){return t(i,s),u}))}}function Bs(e,t){return Us((function(t){var r=t.delim;return t.delim=e,r}),(function(e,t){return e.delim=t}),t)}function Gs(e){return Us((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}function Vs(e){return e.kind===Ko.Sep&&e.value===qo.Dot}function Hs(e){return e.kind===Ko.Literal&&e.oper.kind===J.Error&&e.oper.type===Oe.REF}function Ws(e){return e.kind===Ko.Left&&e.value===Yo.Bracket}function js(e){return(e.kind===Ko.Left||e.kind===Ko.Right)&&e.value===Yo.Bracket}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(hs||(hs={}));var Ks=ks(Ts((function(e,t){return t.kind===Ko.Spaces?t.chars:void 0})),""),Ys=function(e,t,r,n,a){var o=e[t];if(null==o){var u="calc.parse.pStart: internal error: expected token at "+t+" in "+s(e);return S.ULS.assertTag(589825166,i.LogCategory.msoulscat_ES_EWAJS,!1,u)}return n(o.start,t)};function qs(e){return Ts((function(t,r){return r.kind===Ko.Sep&&r.value===e?r:void 0}))}function Js(e){return Ts((function(t,r){return r.kind===Ko.Left&&r.value===e?r:void 0}))}function zs(e){return Ts((function(t,r){return r.kind===Ko.Right&&r.value===e?r:void 0}))}var Qs,Xs,Zs=qs(qo.List),$s=qs(qo.Row),ec=qs(qo.Col),tc=qs(qo.Qual),rc=qs(qo.Dot),nc=Js(Yo.Paren),ac=zs(Yo.Paren),ic=Js(Yo.Brace),oc=zs(Yo.Brace),uc=Js(Yo.SQuote),sc=zs(Yo.SQuote),cc=Js(Yo.Bracket),lc=zs(Yo.Bracket),dc=Rs((function(e,t,r){return Vs(t)&&!Ws(r)?t:void 0})),fc=Ts((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Range?t:void 0})),vc=Ts((function(e,t){return t.kind===Ko.Escape?t:void 0})),hc=Ts((function(e,t){return t.kind===Ko.End?t:void 0})),pc=Ss(Ds(Ts((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:uu(r.start,t.map((function(e){return e.chars})).join(""))})),mc=Ts((function(e,t){return js(t)||t.kind===Ko.End?void 0:t})),gc=fs((function(){return Os(Is(Cs(Ds(mc),xs(ws(cc),gc,ks(ws(lc),[])))))})),Sc=Ss(ws(cc,gc,Ys,ks(lc,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],a=t[3];return r.push(nu(n)),[r,void 0!==a]}));function yc(e,t){return{kind:Xs.MaybeWSFTerm,node:e,whole:t}}function Cc(e){return e.kind!==Ko.Operator&&e.kind!==Ko.Sep&&e.kind!==Ko.End&&e.kind!==Ko.Spaces&&!(e.kind in Xs)}function kc(e,t){return Cc(t=t.kind===Xs.MaybeWSFTerm?t.node:t)?Ls(e,t).start:t.start}!function(e){e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(Xs||(Xs={}));var bc=ks(Ts((function(e,t){return t.kind===Ko.Spaces?t.chars:void 0})),""),Ec=function(e,t,r,n,a){var o=e[t];if(null==o){var u="calc.parse.pStart: internal error: expected term at "+t+" in "+s(e);return S.ULS.assertTag(589825160,i.LogCategory.msoulscat_ES_EWAJS,!1,u)}return n(kc(r,o),t)};function Ac(e){return Ss(ws(bc,Ec,Ts(e),Ec,bc),(function(e,t){var r=t[0],n=t[1];return en(t[2],Ps(e,n,t[3],r,t[4]))}))}function Tc(e){return Ss(ws(bc,Ec,Ts(e),Ec),(function(e,t){var r=t[0],n=t[1];return en(t[2],Ps(e,n,t[3],r,""))}))}function Nc(e){return Ss(ws(Ec,Ts(e),Ec,bc),(function(e,t){var r=t[0];return en(t[1],Ps(e,r,t[2],"",t[3]))}))}var Rc=Ac((function(e,t){return t.kind!==Ko.Operator||t.value!==ae.Add&&t.value!==ae.Sub?void 0:t.value})),Fc=Nc((function(e,t){if(t.kind===Ko.Operator){if(t.value===ae.Add)return ae.Pos;if(t.value===ae.Sub)return ae.Neg}})),Ic=Nc((function(e,t){return t.kind===Ko.Operator&&t.value===ae.At?t.value:void 0})),Dc=Tc((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Pound?t.value:void 0})),wc=Ac((function(e,t){return t.kind!==Ko.Operator||t.value!==ae.Mul&&t.value!==ae.Div?void 0:t.value})),Mc=Ac((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Pow?t.value:void 0})),_c=Tc((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Percent?t.value:void 0})),Oc=Ac((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Concat?t.value:void 0})),xc=Ac((function(e,t){return t.kind===Ko.Operator&&t.value>=ae.Eq&&t.value<=ae.Ge?t.value:void 0})),Lc=Ac((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Range?t.value:void 0})),Pc=Ac((function(e,t){return t.kind===Ko.Operator&&t.value===ae.Union?t.value:void 0})),Uc=Rs((function(e,t,r){if(t.kind===Ko.Spaces&&r.kind!==Ko.End&&(r.kind!==Ko.Operator||r.value===ae.At)&&!Vs(r)){var n=Ps(e,t.start,kc(e,r),t.chars,"");return en(ae.Isect,n)}})),Bc=Ts((function(e,t){return Vs(t)?t:void 0})),Gc=Ts((function(e,t){return t.kind===Xs.ArgsTerm?t:void 0})),Vc=Ts((function(e,t){return t.kind===Xs.ArgsTerm||t.kind===Xs.FieldRefTerm?t:void 0})),Hc=((Qs={})[Z.LET]=ba.CalcLetFunction,Qs[Z.LETREC]=ba.CalcLetRecFunction,Qs[Z.FUN]=ba.CalcFunFunctions,Qs),Wc=Ts((function(e,t){if(t.kind===Xs.MaybeWSFTerm&&void 0!==t.whole){var r=Cr(e.localeInfo,t.whole);if(void 0===r)return;var n=Hc[r];if(void 0!==n&&!Ra(n))return;return tn(r,t.whole,t.node.label)}})),jc=function(e,t,r){return t===r.length-1||t%2==1||zt(e)},Kc=function(e,t,r){return t===r.length-1||zt(e)},Yc=Ss(ws(Wc,Gc),(function(e,t){var r=t[0],n=t[1],a=n.nodes;switch(r.id){case Z.LET:case Z.LETREC:if(a.length>=3&&a.length%2==1&&a.every(jc)){r.id;for(var i=[],o=0;o+1<a.length;o+=2)i.push([a[o],a[o+1]]);var u=a[a.length-1],s=Ps(e,Ls(e,r).start,n.end,"","");return Zr(r,i,u,n.isClosed,s)}break;case Z.FUN:if(a.length>=1&&a.every(Kc)){r.id;var c=a.slice(0,a.length-1);u=a[a.length-1],s=Ps(e,Ls(e,r).start,n.end,"","");return $r(r,c,u,n.isClosed,s)}}return Qc(e,r,a,n.isClosed,n.end)}));function qc(e,t,r){return Ss(ws(Is(e),t),(function(e,t){var n=t[0],a=t[1];return n.reduceRight(r(e),a)}))}function Jc(e,t,r){return Ss(ws(e,Is(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function zc(e){return function(t,r){var n=r[0],a=r[1],i=Ls(e,t).start,o=Ls(e,a).end;return Xr(n,[t,a],!0,Ps(e,i,o,"",""))}}function Qc(e,t,r,n,a){return Xr(t,r,n,Ps(e,Ls(e,t).start,a,"",""))}function Xc(e){return function(t,r){return Qc(e,r,[t],!0,Ls(e,r).end)}}function Zc(e){var t=!0;return function(r,n){var a=Ls(e,n).start,i=Ls(e,r).end,o=Ps(e,a,i,"","");if((n.id===ae.Pos||n.id===ae.Neg)&&t&&(t=!1,r.kind===Nr.Literal&&$t(r.oper)&&""===Ls(e,n).post))return zr(n.id===ae.Pos?r.oper:e.mathpack.neg(r.oper),!0,o);return Xr(n,[r],!0,o)}}var $c=Ts((function(e,t){return t.kind===Xs.MaybeWSFTerm?t.node:Cc(t)?t:void 0})),el=Ss(ws(bc,Bc,Ec,bc),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return vn(Fr.Operator,n.chars,Ps(e,n.start,a,r,i))})),tl=Ss(Ic,(function(e,t){return vn(Fr.Operator,function(e,t){var r;return null!=(r=Sa(e.localeInfo,t,""))?r:"op:"+t}(e,t.id),t.label)})),rl=Ss(ws(Ec,Is(Cs($c,el,tl)),Ec),(function(e,t){var r=t[0],n=t[1],a=t[2];if(1===n.length)return n[0];var i=Ps(e,r,a,"","");return 0===n.length?zr(et,!0,i):vn(Fr.Sequence,n,i)})),nl=Jc(fs((function(){return Cs(Yc,_s(bs(Ic),ul),_s(bs(Fc),cl),rl)})),Dc,Xc),al=Jc(nl,ws(Lc,nl),zc),il=Jc(al,ws(Uc,al),zc),ol=Jc(il,Vc,(function(e){return function(t,r){if(r.kind===Xs.ArgsTerm)return Qc(e,t,r.nodes,r.isClosed,r.end);var n=Ls(e,t).start,a=Ps(e,n,r.end,"","");return cn(t,r.rhs,a)}})),ul=qc(Ic,ol,Zc),sl=Jc(ul,ws(Pc,ul),zc),cl=qc(Fc,sl,Zc),ll=Jc(cl,_c,Xc),dl=Jc(ll,ws(Mc,ll),zc),fl=Jc(dl,ws(wc,dl),zc),vl=Jc(fl,ws(Rc,fl),zc),hl=Jc(vl,ws(Oc,vl),zc),pl=Jc(hl,ws(xc,hl),zc);var ml=Ss(Ds(Ts((function(e,t){return t.isIdentContinue&&!function(e){return e.kind===Ko.Literal&&e.oper.kind===J.Boolean}(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),Ts((function(e,t){return t.isIdentContinue||Vs(t)?t.chars:void 0}))),(function(e,t){return t.join("")})),gl=Ts((function(e,t){return t.kind===Ko.Ident?t.chars:void 0})),Sl=/'/g;function yl(e,t,r,n){return null==t?[Pr(e,r,n),r?"'"+e.replace(Sl,"")+"'":e]:[Ur(e,t,void 0,r,n),r?"'"+e.replace(Sl,"")+":"+t.replace(Sl,"")+"'":e+":"+t]}var Cl=Ss(ws(Ys,ml,ks(_s(fc,ml),void 0),Ys),(function(e,t){var r=t[0];return yl(t[1],t[2],!1,Ps(e,r,t[3],"",""))})),kl=Ss(ws(uc,gl,ks(_s(fc,gl),void 0),sc,Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=(t[3],t[4]);return yl(n,a,!0,Ps(e,r.start,i,"",""))})),bl=Ss(ws(uc,Is(Ts((function(e,t){return t.kind===Ko.End||t.kind===Ko.Right&&t.value===Yo.SQuote?void 0:t.chars}))),ks(ws(sc,ks(Ms(tc,Ks),void 0)),[void 0,void 0]),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=a[0],o=a[1],u=t[3],s="'"+n.join("")+(void 0!==i?"'":"")+(void 0!==o?"!":""),c=Ps(e,r.start,u,"","");return[vn(Fr.Qualifier,s,c),s]})),El=Rs((function(e,t,r){if(Hs(t))return[_r(Ps(e,t.start,r.start,"","")),t.chars]})),Al=Ss(ws(Cs(Cl,kl,Ns((function(e,t){return[Or(Ps(e,t.start,t.start,"","")),""]}))),tc,Ks),(function(e,t){var r=t[0];return[r[0],r[1]+"!"]})),Tl=Cs(El,Al,bl);function Nl(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale}function Rl(e,t){return t.refStyle===kr.A1&&e.refStyle===kr.A1&&t.isIdentContinue||t.refStyle===kr.R1C1&&ai(t.row,t.col)}function Fl(e,t){return t.kind===Ko.CellRef&&Nl(e,t)&&function(e){return e.refStyle===kr.R1C1||"object"==typeof e.row&&"object"==typeof e.col}(t)}var Il=Br(Ar.Rel,0);function Dl(e){return!1===e?Il:e}function wl(e,t){if(null!=e.row&&null!=e.col)return Vr(Dl(e.row),Dl(e.col),t);if(null!=e.row){var r=Dl(e.row);return Wr(r,r,t)}if(null!=e.col){var n=Dl(e.col);return jr(n,n,t)}var a="calc.parse.cellRefToken2cellRef: bad token "+s(e);return S.ULS.assertTag(589825159,i.LogCategory.msoulscat_ES_EWAJS,!1,a)}var Ml,_l=Ts((function(e,t){return Fl(e,t)&&!Rl(e,t)||Hs(t)?t:void 0})),Ol=Ts((function(e,t){return Fl(e,t)&&Rl(e,t)?t:void 0})),xl=Ss(ws(Cs(_l,(Ml=function(e){return e.cellRefMustBeCellRefNode?Ol:Ms(Ol,Es(dc))},function(e,t,r,n,a){return Ml(r)(e,t,r,n,a)})),Ys),(function(e,t){var r=t[0],n=t[1],a=r.kind===Ko.CellRef?wl(r,Ps(e,r.start,n,"","")):Gr(Ps(e,r.start,n,"","")),i=r.kind===Ko.CellRef?r.chars:void 0;return yc(sn(a,void 0,Ps(e,r.start,n,"","")),i)}));var Ll=Rs((function(e,t,r){return t.kind===Ko.CellRef&&Nl(e,t)&&!function(e,t,r){return r.kind===Ko.Left&&r.value===Yo.Paren&&t.isIdentContinue&&null!=Cr(e.localeInfo,t.chars)}(e,t,r)?[t,r.start]:void 0})),Pl=Cs(gs(ws(Ll,Ks,fc,Ks,Ll),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],s=u[0],c=u[1],l=Ps(e,n.start,a,"",i),d=Ps(e,s.start,c,o,""),f=wl(n,l),v=wl(s,d),h=void 0;if(f.kind===Er.Single&&v.kind===Er.Single)h=Hr(f,v,p=Ps(e,n.start,c,"",""));else if(0===i.length&&0===o.length)if(f.kind===Er.Row&&v.kind===Er.Row){var p=Ps(e,n.start,c,"","");h=Wr(f.row1,v.row1,p)}else if(f.kind===Er.Col&&v.kind===Er.Col){p=Ps(e,n.start,c,"","");h=jr(f.col1,v.col1,p)}if(null==h)return ms();var m=yc(sn(h,void 0,Ps(e,n.start,c,"","")),void 0);return n.isIdentContinue&&s.isIdentContinue?Ns((function(e,t){return t.kind===Ko.Sep&&t.value===qo.Qual?void 0:m})):vs(m)})),xl);var Ul=Cs(Ts((function(e,t){return t.kind===Ko.Ident&&e.localeInfo.isIdentStart(t.chars.charCodeAt(0))||t.kind===Ko.CellRef&&function(e){return e.refStyle===kr.A1&&null==e.row&&"object"==typeof e.col&&e.col.kind===Ar.Rel}(t)?t:void 0})),Ms(Ts((function(e,t){return t.kind===Ko.CellRef&&Rl(e,t)||t.kind===Ko.Literal&&t.oper.kind===J.Boolean?t:void 0})),bs(dc))),Bl=Ns((function(e,t){return Ws(t)})),Gl=Ss(ws(Ul,Is(Cs(pc,dc)),Bl,Ys),(function(e,t){var r,n,a=t[0],i=t[1],o=t[2],u=t[3];if(o||function(e,t,r){if(0===r.length||t.kind===Ko.Literal||t.kind===Ko.CellRef&&!Nl(e,t))return!0;for(var n=0;n<r.length;){if(r[n].kind!==Ko.Sep)return!0;var a=r[n+=1];if(void 0===a||a.kind===Ko.Sep)return!0;n+=1}return!1}(e,a,i)){var s=nn(an(a.chars+i.map((function(e){return e.chars})).join(""),Ps(e,a.start,u,"","")),void 0,Ps(e,a.start,u,"",""));return yc(s,s.whole)}var c,l=Ps(e,a.start,i[0].start,"","");c=a.kind===Ko.CellRef?on(wl(a,Ps(e,a.start,i[0].start,"","")),a.chars,l):an(a.chars,l);for(var d=c,f=1;f<i.length;f+=2){var v=i[f],h=null!=(n=null===(r=i[f+1])||void 0===r?void 0:r.start)?n:u;d=un(d,v.chars,Ps(e,a.start,h,"",""))}d.kind===Rr.CellRefNamePart&&C("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var p=nn(d,void 0,Ps(e,a.start,u,"",""));return yc(p,p.whole)})),Vl=ks(Cs(Pl,Gl),{node:void 0}),Hl=gs(Tl,(function(e,t){var r=t[0],n=t[1];return Ss(r.kind===br.SheetRange?Gs(r.isQuoted?Vl:Pl):r.kind===br.Error?Gs(Vl):Vl,(function(e,t){var a=t.node;if(null==a)return r.kind===br.Error?zr(He,!0,r.label):r.kind===Nr.Bad?r:vn(Fr.Qualifier,n,r.label);var i=Ls(e,r).start,o=Ls(e,a).end;if(a.kind===Nr.Name){var u=Ps(e,i,o,"","");if(r.kind===Nr.Bad||r.kind===br.Error||r.kind===br.SheetRange){var s=r.kind===Nr.Bad?r:vn(Fr.Qualifier,n,r.label);return vn(Fr.Sequence,[s,a],u)}return nn(a.parts,r,u)}var c=Ps(e,i,o,"","");if(r.kind===Nr.Bad||r.kind===br.Document){s=r.kind===Nr.Bad?r:vn(Fr.Qualifier,n,r.label);return vn(Fr.Sequence,[s,a],c)}return r.kind===br.Ident&&(r=Lr(r.name,void 0,r.isQuoted,r.label)),sn(a.ref,r,c)}))})),Wl=Ss(Cs(Pl,Gl),(function(e,t){return t.node.kind===Nr.CellRef&&t.node.ref.kind===Er.Error?zr(He,!0,t.node.label):t})),jl=Cs(Hl,Wl);var Kl=Ss(ws(Cs(Ts((function(e,t){return t.kind===Ko.Literal&&t.oper.kind!==J.Boolean?t:t.kind===Ko.CellRef&&function(e){return e.refStyle===kr.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===Ar.Rel}(t)?ku(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),Ms(Ts((function(e,t){return t.kind===Ko.Literal&&t.oper.kind===J.Boolean?t:void 0})),Es(dc))),Ys),(function(e,t){var r=t[0],n=t[1],a=Ps(e,r.start,n,"","");if(r.oper.kind===zo.BadNumber)return vn(Fr.Literal,r.chars,a);if(er(r.oper)&&r.oper.value.length>32767)return vn(Fr.Literal,r.chars,a);var i=zr(r.oper,r.hasRight,a);return tr(r.oper)?yc(i,r.chars):i})),Yl=Ss(ws(Ds(Cs(Ts((function(e,t){return js(t)||t.kind===Ko.Unexpected||t.kind===Ko.Escape||t.kind===Ko.End?void 0:t.chars})),_s(vc,Ts((function(e,t){return t.kind!==Ko.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars}))))),hc),(function(e,t){var r=t[0];t[1];return r.join("")})),ql=gs(Sc,(function(e,t){var r=t[0],n=t[1],a=ds(Yl,r,0,e);return It(a)?vs([a.value.output,!0,n]):ms()})),Jl=gs(ws(Ys,Ks,rc,Cs(Ss(pc,(function(e,t){return[t.chars,!1,!0]})),ql),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=i[0],u=i[1],s=i[2],c=t[4],l=ln(o,u,s,Ps(e,a.start,c,n,""));return vs(function(e,t,r,n){return{kind:Xs.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}(n.length>0,l,r,c))})),zl=fs((function(){return Ra(ba.CalcDotOperator)?Jl:ms()})),Ql=gs(Sc,(function(e,t){t[0],t[1];return ms()})),Xl=fs((function(){return Ra(ba.CalcStructuredReferences)?Ql:ms()})),Zl=Ss(ws(Ks,fs((function(){return ld})),Ks),(function(e,t){var r=t[0],n=t[1],a=t[2],i=Ls(e,n);return i.pre=r,i.post=a,n})),$l=Ss(ws(nc,Bs({delimId:Yo.Paren,listSep:hs.Union},Zl),ks(ac,void 0),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return rn(n,void 0!==a,Ps(e,r.start,i,"",""))})),ed=Ds(Zl,_s(ec,Zl)),td=Ds(ed,_s($s,ed));function rd(e){return Rs((function(t,r,n){return e(r)?vn(Fr.Unexpected,r.chars,Ps(t,r.start,n.start,"","")):void 0}))}var nd=Cs(jl,Kl,$l,Ss(ws(ic,Bs({delimId:Yo.Brace,listSep:hs.Union},td),ks(oc,void 0),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Qr(n,void 0!==a,Ps(e,r.start,i,"",""))})),zl,Xl,Ss(ws(Ys,rd(Ws),Bs({delimId:Yo.Bracket,listSep:hs.Union},Zl),ks(rd((function(e){return e.kind===Ko.Right&&e.value===Yo.Bracket})),void 0),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=[n,a];return null!=i&&u.push(i),vn(Fr.Sequence,u,Ps(e,r,o,"",""))})),Rs((function(e,t,r){switch(t.kind){case Ko.End:case Ko.Operator:case Ko.Spaces:return;case Ko.Sep:if(t.value===qo.Dot||t.value!==qo.Qual&&(e.delim.delimId===Yo.Brace||t.value!==qo.Col&&t.value!==qo.Row))return;break;case Ko.Right:if(t.value===e.delim.delimId)return}return vn(t.kind===Ko.CellRef?Fr.CellRef:Fr.Unexpected,t.chars,Ps(e,t.start,r.start,"",""))}))),ad=Ss(ws(nc,Bs({delimId:Yo.Paren,listSep:hs.Arg},Ds(Zl,_s(Zs,Zl))),ks(ac,void 0),Ys),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return function(e,t,r,n){return{kind:Xs.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}}(n,void 0!==a,r.start,i)})),id=Ts((function(e,t){return t.kind!==Ko.Operator||t.value!==ae.Percent&&t.value!==ae.Pound?void 0:t}));var od=Ts((function(e,t){return t.kind===Ko.Operator||Vs(t)?t:function(e,t){return t.kind===Ko.Sep&&t.value===qo.List&&e.delim.listSep===hs.Union?Eu(t.start,e.localeInfo.listSeparator,ae.Union):void 0}(e,t)})),ud=Ts((function(e,t){return t.kind===Ko.Spaces?t:void 0})),sd=Cs(Ds(Cs(nd,id),Cs(ad,zl)),ws(od)),cd=Os(Ds(sd,xs(ks(ws(ud),[]),sd))),ld=Ss(ws(ks(cd,void 0),Ys),(function(e,t){var r=t[0],n=t[1];if(null==r){var a=Ps(e,n,n,"","");return zr(et,!0,a)}var o=r;return o.push(nu(n)),function(e,t){var r=t.length-1;if(1===r&&Cc(t[0]))return t[0];if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return S.ULS.assertTag(589825161,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[0].kind===Ko.Spaces){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces in "+s(t);return S.ULS.assertTag(589825162,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&t[r-1].kind===Ko.Spaces){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces in "+s(t);return S.ULS.assertTag(589825163,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[r].kind!==Ko.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in "+s(t);return S.ULS.assertTag(589825164,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}for(;;){var a=ds(pl,t,0,e);if(It(a)&&a.value.index>=r)return a.value.output;if(!It(a)||0===a.value.index||1===a.value.index&&Cc(t[0])){n="calc.parse.runTermParser: internal error: consumed "+(It(a)?a.value.index:0)+" out of "+r+" in "+s(t);return S.ULS.assertTag(589825165,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=(t=M([a.value.output],t.slice(a.value.index))).length-1}}(e,o)}));function dd(e,t,r,n,a,o){var u=o.length-1;if(u<0){var c="calc.parse.runTokenParser: internal error: expected at least 1 token";return S.ULS.assertTag(589825167,i.LogCategory.msoulscat_ES_EWAJS,!1,c)}if(o[u].kind!==Ko.End){c="calc.parse.runTokenParser: internal error: array[n] !== End in "+s(o);return S.ULS.assertTag(589825168,i.LogCategory.msoulscat_ES_EWAJS,!1,c)}var l=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:hs.Union},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}(e,t,r,n,a),d=ds(Zl,o,0,l);if(!It(d)||d.value.index<u){c="calc.parse.runTokenParser: internal error: consumed "+(It(d)?d.value.index:0)+" out of "+u+" in "+s(o);return S.ULS.assertTag(589825169,i.LogCategory.msoulscat_ES_EWAJS,!1,c)}return Kr(d.value.output,l.spans)}var fd={getDocumentLoc:function(){return Ft(pr(["defaultPrintGlobals getDocumentLoc"]))},getSheetIndex:function(){return Ft(pr(["defaultPrintGlobals getSheetIndex"]))},getSheetName:function(){return Ft(pr(["defaultPrintGlobals getSheetName"]))},getNameLoc:function(){return Ft(pr(["defaultPrintGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return Ft(pr(["defaultPrintGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return Ft(pr(["defaultPrintGlobals getSheetRangeIndexes"]))}};var vd,hd,pd={"=":1,"+":0,"-":0,"@":-1};function md(e,t,r){var n,a,i,o;try{var u=r[0],s=null!=u?pd[u]:void 0;if(null==s)return Ft($o("first character is not '=', '+', '-' or '@'"));if(s<0)return Ft(hr(["Lotus 1-2-3 syntax"]));var c=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,l=null!=(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)?o:e.config.refStyle,d=e.config.mathpack,f=ls(c,d,l,t.originGridCell.value,r,s);return Rt(dd(c,d,l,t.lexicalKind,t.originGridCell.value,f))}catch(e){return Ft(Dt(e))}}function gd(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return S.ULS.assertTag(595980825,i.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var o=t,u=r;return md(e,jo(n,Vt(function(e){return void 0===e.range}(u)?u:u.range),{refStyle:o}),a)}return md(e,t,r)},formatFormula:function(t,r){try{return Lo(function(e){var t,r,n,a,i,o,u,s,c,l,d,f;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:fd.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:fd.getSheetIndex),getSheetName:(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e),null!=o?o:fd.getSheetName),getNameLoc:(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e),null!=s?s:fd.getNameLoc),getUserDefinedFuncLoc:(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e),null!=l?l:fd.getUserDefinedFuncLoc),getSheetRangeIndexes:(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e),null!=f?f:fd.getSheetRangeIndexes)}}(e),t,r)}catch(e){return Ft(Dt(e))}}}}!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(vd||(vd={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(hd||(hd={}));var Sd=vd.Red,yd=vd.Black,Cd=hd.DoubleBlack,kd={c:yd,l:void 0,r:void 0},bd={c:Cd,l:void 0,r:void 0};function Ed(e){return void 0===e.l}function Ad(e){return e.c===Sd}function Td(e){return e.c===yd&&void 0!==e.l}function Nd(e){return e.c===yd&&void 0===e.l}var Rd=kd;function Fd(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function Id(e,t){return Fd(e,t.l,t.key,t.value,t.r)}function Dd(e){return Ed(e)?kd:Id(yd,e)}function wd(e,t,r){if(!Ed(r)){var n=e.keyCompare(t,r.key);return n<0?wd(e,t,r.l):n>0?wd(e,t,r.r):r}}function Md(e,t){return!!Ed(t)||!!Md(e,t.l)&&(!!e(t.key,t.value)&&Md(e,t.r))}function _d(e,t,r,n,a){if(e===yd){if(Ad(t)&&Ad(t.l))return Fd(Sd,Id(yd,t.l),t.key,t.value,Fd(yd,t.r,r,n,a));if(Ad(a)&&Ad(a.r))return Fd(Sd,Fd(yd,t,r,n,a.l),a.key,a.value,Id(yd,a.r));if(Ad(t)&&Ad(t.r))return Fd(Sd,Fd(yd,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,Fd(yd,t.r.r,r,n,a));if(Ad(a)&&Ad(a.l))return Fd(Sd,Fd(yd,t,r,n,a.l.l),a.l.key,a.l.value,Fd(yd,a.l.r,a.key,a.value,a.r))}if(e===Cd){if(Ad(a)&&Ad(a.l))return Fd(yd,Fd(yd,t,r,n,a.l.l),a.l.key,a.l.value,Fd(yd,a.l.r,a.key,a.value,a.r));if(Ad(t)&&Ad(t.r))return Fd(yd,Fd(yd,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,Fd(yd,t.r.r,r,n,a))}return Fd(e,t,r,n,a)}function Od(e,t,r,n,a){return e===Sd&&t.c===Cd&&Td(a)?_d(yd,Fd(Sd,Dd(t),r,n,a.l),a.key,a.value,a.r):e===Sd&&Td(t)&&a.c===Cd?_d(yd,t.l,t.key,t.value,Fd(Sd,t.r,r,n,Dd(a))):e===yd&&t.c===Cd&&Td(a)?_d(Cd,Fd(Sd,Dd(t),r,n,a.l),a.key,a.value,a.r):e===yd&&Td(t)&&a.c===Cd?_d(Cd,t.l,t.key,t.value,Fd(Sd,t.r,r,n,Dd(a))):e===yd&&t.c===Cd&&Ad(a)&&Td(a.l)?Fd(yd,_d(yd,Fd(Sd,Dd(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===yd&&Ad(t)&&Td(t.r)&&a.c===Cd?Fd(yd,t.l,t.key,t.value,_d(yd,t.r.l,t.r.key,t.r.value,Fd(Sd,t.r.r,r,n,Dd(a)))):(k("calc.common.rbTree.rotate: expected R|B",t.c!==Cd&&a.c!==Cd),Fd(e,t,r,n,a))}function xd(e,t,r,n){return function(e){return!Ad(e)||e.l.c!==Sd&&e.r.c!==Sd?e:Id(yd,e)}(function e(t,r,n,a){if(Ed(a))return Fd(Sd,kd,r,n,kd);var i=t.keyCompare(r,a.key);return i<0?_d(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?_d(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):Fd(a.c,a.l,r,n,a.r)}(e,t,r,n))}function Ld(e,t,r){if(Ed(r))return r;if(r.c===Sd&&Nd(r.l)&&Nd(r.r))return 0===e.keyCompare(t,r.key)?kd:r;if(r.c===yd&&Nd(r.l)&&Nd(r.r))return 0===e.keyCompare(t,r.key)?bd:r;if(r.c===yd&&Ad(r.l)&&Nd(r.l.l)&&Nd(r.l.r)&&Nd(r.r)){var n=e.keyCompare(t,r.key);return n<0?Fd(yd,Ld(e,t,r.l),r.key,r.value,kd):n>0?r:Fd(yd,kd,r.l.key,r.l.value,kd)}var a=e.keyCompare(t,r.key);if(a<0)return Od(r.c,Ld(e,t,r.l),r.key,r.value,r.r);if(a>0)return Od(r.c,r.l,r.key,r.value,Ld(e,t,r.r));k("calc.common.rbTree.rem: expected node",!Ed(r.r));var i=function e(t){if(t.c===Sd&&Nd(t.l)&&Nd(t.r))return[t.key,t.value,kd];if(t.c===yd&&Nd(t.l)&&Nd(t.r))return[t.key,t.value,bd];if(t.c===yd&&Nd(t.l)&&Ad(t.r))return[t.key,t.value,Id(yd,t.r)];k("calc.common.rbTree.remMin: expected node",!Ed(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,Od(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],s=i[2];return Od(r.c,r.l,o,u,s)}function Pd(e,t,r){var n=Ld(e,t,function(e){return Td(e)&&e.l.c===yd&&e.r.c===yd?Id(Sd,e):e}(r));return k("calc.common.rbTree.remove: expected R|B",n.c===Sd||n.c===yd),n}var Ud=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(Rd,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t;return null===(t=wd(this,e,this.root))||void 0===t?void 0:t.value},e.prototype.getEntry=function(e){return wd(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return Md(e,this.root)},e.prototype.setValue=function(t,r){return new e(xd(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(Pd(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(xd(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=Rd,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=xd(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}();function Bd(e,t){var r=e[t];return null==r?C("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function Gd(e,t,r,n,a){return void 0===a&&(a=!1),!!It(e)&&(function(e,t,r,n,a){if(null==e||null==n)return;var i={};null!=r?r.forEach((function(e){i[e]=!0})):i["*"]=!0;var o=0,u=[];u.push({formulaNode:e.node,letNamesSet:Ud.create(t.stringCompareCI)});var s=function(){var t=u.pop();if(null==t)return"continue";var r=t.formulaNode,i=t.letNamesSet;switch(r.kind){case Nr.Literal:l("literal")&&n("literal",{label:r.label,value:r});break;case Nr.Array:r.nodes.map((function(e){return e.map((function(e){u.push({formulaNode:e,letNamesSet:i})}))}));break;case Nr.App:case Nr.Let:case Nr.Fun:var s=r.head;switch(s.kind){case Nr.Operator:r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})})),l("operator")&&n("operator",{label:r.label,value:s.id});break;case Nr.WSF:case Nr.Name:if(a&&Jt(r.head)&&r.head.id===Z.LET){for(var c=i,f=i,v=0;v<r.args.length;v+=1){var h=r.args[v];v%2==0?(c=f,h.kind!==Nr.Name||h.qualifier?h.kind===Nr.Bad&&h.type===Fr.CellRef&&(f=f.setValue(h.contents,o)):f=f.setValue(h.whole,o),u.push({formulaNode:h,letNamesSet:f})):u.push({formulaNode:h,letNamesSet:c})}o+=1}else r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})}));l("function")&&n("function",{label:r.label,name:s.whole,isClosed:r.isClosed,args:r.args});break;default:u.push({formulaNode:s,letNamesSet:i}),r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})}))}break;case Nr.Paren:u.push({formulaNode:r.node,letNamesSet:i});break;case Nr.Name:if(a&&i.contains(r.whole)&&!r.qualifier&&l("letName"))n("letName",{label:r.label,name:r.whole.toLocaleLowerCase(),number:i.getValue(r.whole),qualifier:void 0});else if(l("namedRange")){var p=r.whole.split(".");n("namedRange",{label:r.label,name:p[0],names:p.slice(1),qualifier:d(r)})}break;case Nr.CellRef:l("range")&&function(t){if(null==e||null==n)return;switch(t.ref.kind){case Er.Error:break;case Er.Col:var r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:Bd(e.spans,r.label),qualifier:d(t)});break;case Er.Row:var a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Bd(e.spans,a.label),qualifier:d(t)});break;case Er.Single:var i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:Bd(e.spans,i.label),qualifier:d(t)});break;case Er.Range:var o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Bd(e.spans,o.ref1.label),bottomRightSpan:Bd(e.spans,o.ref2.label),qualifier:d(t)})}}(r);break;case Nr.FieldRef:u.push({formulaNode:r.lhs,letNamesSet:i});break;case Nr.StructRef:break;case Nr.Bad:r.type===Fr.CellRef&&i.contains(r.contents)&&l("letName")&&n("letName",{label:r.label,name:r.contents.toLocaleLowerCase(),number:i.getValue(r.contents),qualifier:void 0});break;default:return{value:y("calc.parse.traverseFormula",r)}}};for(;u.length>0;){var c=s();if("object"==typeof c)return c.value}function l(e){return i[e]||i["*"]}function d(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case br.Sheet:var r=e.qualifier;t.type=br.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case br.SheetRange:var n=e.qualifier;t.type=br.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case br.Ident:var a=e.qualifier;t.type=br.Ident,t.name=a.name;break;case br.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}}(e.value,null!=n?n:Aa(),t,r,a),!0)}var Vd,Hd,Wd,jd,Kd,Yd={isSuccess:It,traverse:Gd,extractReferences:function(e,t,r){if(void 0===r&&(r=!1),It(e)){var n=[];return Gd(e,["range","namedRange","letName"],(function(t,r){var a={kind:t,ref:r,span:Bd(e.value.spans,r.label)};n.push(a)}),t,r),n.sort((function(e,t){return e.span.start-t.span.start})),n}},extractLetVariables:function(e,t){if(It(e)){var r=e.value;if(void 0!==r){for(var n=[],a=r.node;void 0!==a&&(a.kind===Nr.App||a.kind===Nr.Let||a.kind===Nr.Fun);){for(var i=Jt(a.head)&&a.head.id===Z.LET,o=void 0,u=a.args,s=0;s<u.length;s+=1){var c=u[s],l=Bd(e.value.spans,c.label);if(i&&s%2==0&&s>=2&&u[s-2].kind===Nr.Name&&n.push(u[s-2].whole),l.start<=t&&l.end>=t){o=c;break}}a=o}return n}}}};(Hd=Vd||(Vd={})).createParseGlobals=Wo,Hd.ReasonKind=Qo,Hd.parseLocals=jo,Hd.formatLocalsGrid=Xo,Hd.formatLocalsName=Zo,Hd.notFormulaString=$o,Hd.createParser=gd,Hd.parseResultHelper=Yd,function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Invalid_literal="Invalid_literal",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_argument_for_operator",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_struct_ref="Unexpected_struct_ref",e.Unsupported_struct_ref="Unsupported_struct_ref",e.Unsupported_doc_qual="Unsupported_doc_qual"}(jd||(jd={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_arguments_for_operator",e.Excess_function_arguments="Excess_arguments_for_function",e.Insufficient_function_arguments="Insufficient_arguments_for_function"}(Kd||(Kd={}));var qd=((Wd={})[jd.Unclosed_application]={kind:jd.Unclosed_application},Wd[jd.Unclosed_paren]={kind:jd.Unclosed_paren},Wd[jd.Unclosed_bracket]={kind:jd.Unclosed_bracket},Wd[jd.Unclosed_array]={kind:jd.Unclosed_array},Wd[jd.Unclosed_literal]={kind:jd.Unclosed_literal},Wd[jd.Invalid_literal]={kind:jd.Invalid_literal},Wd[jd.Illegal_array_literal_element]={kind:jd.Illegal_array_literal_element},Wd[jd.Empty_array_literal]={kind:jd.Empty_array_literal},Wd[jd.Irregular_array_shape]={kind:jd.Irregular_array_shape},Wd[jd.Empty_parenthesis]={kind:jd.Empty_parenthesis},Wd[jd.Bad_node]={kind:jd.Bad_node},Wd[jd.Invalid_binder]={kind:jd.Invalid_binder},Wd[jd.Empty_formula]={kind:jd.Empty_formula},Wd[jd.Invalid_rel_sheet_qualifier_in_cell]={kind:jd.Invalid_rel_sheet_qualifier_in_cell},Wd[jd.Invalid_rel_sheet_qualifier_in_name]={kind:jd.Invalid_rel_sheet_qualifier_in_name},Wd[jd.Invalid_unqualified_cell]={kind:jd.Invalid_unqualified_cell},Wd[jd.Unexpected_closing_paren]={kind:jd.Unexpected_closing_paren},Wd[jd.Unexpected_closing_brace]={kind:jd.Unexpected_closing_brace},Wd[jd.Unexpected_closing_bracket]={kind:jd.Unexpected_closing_bracket},Wd[jd.Unexpected_field_ref]={kind:jd.Unexpected_field_ref},Wd[jd.Unexpected_struct_ref]={kind:jd.Unexpected_struct_ref},Wd[jd.Unsupported_struct_ref]={kind:jd.Unsupported_struct_ref},Wd[jd.Unsupported_doc_qual]={kind:jd.Unsupported_doc_qual},Wd[Kd.Types_not_related]={kind:Kd.Types_not_related},Wd[Kd.Unexpected_application_head]={kind:Kd.Unexpected_application_head},Wd[Kd.Unexpected_application_head_with_fix]={kind:Kd.Unexpected_application_head_with_fix},Wd);function Jd(e){switch(e.kind){case Kd.Insufficient_function_arguments:case Kd.Excess_function_arguments:return e.kind+": "+ma(e.funcId);case jd.Missing_operation_argument:case Kd.Incorrect_number_of_operator_arguments:return e.kind+": "+ga(e.opId);case jd.Unexpected_character:return e.kind+": "+Ho(e.text);default:return e.kind}}function zd(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=Jd(e);t[n]=(null!=(r=t[n])?r:0)+1}))})),t}}function Qd(e,t){return{config:e,getSheetName:t}}function Xd(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Rt(t.range),originSheet:Rt(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0}}function Zd(e,t){return{config:null!=t?t:void 0,lexicalKind:$e.NameManager,originGridCell:Rt(e.range),originSheet:Rt(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1}}var $d={};function ef(e,t){return{context:e,result:t}}function tf(e){return function(t){return t.kind===Nr.Literal&&e(t.oper)}}var rf=tf(ir),nf=tf($t),af=J.String|J.Boolean|J.Error,of=tf((function(e){return 0!=(e.kind&af)}));function uf(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function sf(e,t){return t!==J.Range||0!=(e&J.Range)}function cf(e,t){switch(t.type){case Fr.Sequence:if(i=e.localeInfo,2===(o=t.contents).length&&zt(o[0])&&Cf(i,o[1]))return uf(e,t,qd.Unsupported_struct_ref);if(null!=function(e,t){if(2!==t.length)return;var r=t[0],n=t[1];if(Cf(e,r))return function(e){return e.kind===Nr.Name&&null!=e.qualifier&&e.qualifier.kind===br.Ident}(n)?Nr.Name:function(e){return e.kind===Nr.CellRef&&null!=e.qualifier&&e.qualifier.kind===br.Sheet&&null==e.qualifier.document}(n)?Nr.CellRef:void 0;if(function(e,t){return t.kind===Nr.Bad&&t.type===Fr.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,r))return zt(n)?Nr.Name:function(e){return e.kind===Nr.CellRef&&null==e.qualifier}(n)?Nr.CellRef:void 0;return}(e.localeInfo,t.contents))return uf(e,t,qd.Unsupported_doc_qual);for(var r=0,n=t.contents;r<n.length;r++){var a=n[r];if(a.kind===Nr.Bad)return cf(e,a)}return uf(e,t,qd.Bad_node);case Fr.Unexpected:switch(t.contents){case")":return uf(e,t,qd.Unexpected_closing_paren);case e.localeInfo.rightBrace:return uf(e,t,qd.Unexpected_closing_brace);case e.localeInfo.rightBracket:return uf(e,t,qd.Unexpected_closing_bracket);default:return uf(e,t,{kind:jd.Unexpected_character,text:t.contents})}case Fr.Literal:return uf(e,t,qd.Invalid_literal);case Fr.CellRef:case Fr.Qualifier:case Fr.Operator:return uf(e,t,qd.Bad_node);default:y("calc.analyze.diagnoseBadNode",t)}var i,o}function lf(e,t){if(t.kind===Nr.Literal)switch(uf(e,t,qd.Unclosed_literal,t.isClosed),t.oper.kind){case J.Number:case J.Boolean:case J.String:case J.Error:return;default:return void uf(e,t,qd.Illegal_array_literal_element)}uf(e,t,qd.Illegal_array_literal_element)}function df(e,t,r){uf(e,t,qd.Types_not_related,sf(J.Array,r)),uf(e,t,qd.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(uf(e,t,qd.Empty_array_literal,n),!n)return ef(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;uf(e,t,qd.Irregular_array_shape,u===a);for(var s=0;s<u;s+=1)lf(e,o[s])}return ef(e,r)}function ff(e,t,r){if(e.earlyExit&&!e.isOk())throw $d;switch(t.kind){case Nr.Array:return df(e,t,r);case Nr.Paren:return uf(e,t,qd.Unclosed_paren,t.isClosed),uf(e,t,qd.Empty_parenthesis,!rf(t.node)),ff(e,t.node,r);case Nr.Bad:case Nr.Name:case Nr.CellRef:case Nr.FieldRef:case Nr.StructRef:case Nr.App:case Nr.Let:case Nr.Fun:case Nr.Literal:var n=mf(e,t);return uf(e,t,qd.Types_not_related,sf(n.result,r)),n.result=r,n;default:return y("calc.analyze.checker.check: unhandled formula case",t)}}function vf(e,t,r){return zt(r)?(uf(e,r,qd.Invalid_binder,!t.contains(r.whole)),t.setValue(r.whole,!0)):(uf(e,r,qd.Invalid_binder),t)}function hf(e,t,r){var n,a=Ee(t),i=a.minArgs,o=a.headTypes,u=a.restTypes,s=a.tailTypes,c=r.args,l=c.length,d=Yt(r),f=d.length;f<i&&uf(e,void 0===(n=c[l-1])?r:n,{kind:Kd.Insufficient_function_arguments,funcId:t});0===u.length&&f>o.length&&uf(e,void 0===(n=c[l-1])?r:n,{kind:Kd.Excess_function_arguments,funcId:t});u.length>1&&f>o.length&&((f-o.length)%u.length>s.length&&uf(e,void 0===(n=c[l-1])?r:n,{kind:Kd.Insufficient_function_arguments,funcId:t}));for(var v=0;v<f;v+=1)ff(e,d[v],Qt(a,v,f));return e.specialDependencies|=a.staticPrecs,function(e,t,r,n){switch(t){case Z.LET:case Z.LETREC:n.length>=3&&n.length%2!=1&&uf(e,n[n.length-1],{kind:Kd.Insufficient_function_arguments,funcId:t});for(var a=e.localeInfo,i=Ud.create(a.stringCompareCI),o=0;o+1<n.length;o+=2)i=vf(e,i,n[o]);return void k("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Nr.Let||!e.isOk());case Z.FUN:for(a=e.localeInfo,i=Ud.create(a.stringCompareCI),o=0;o<n.length-1;o+=1)i=vf(e,i,n[o]);k("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Nr.Fun||!e.isOk())}}(e,t,r,c),ef(e,a.returnType)}function pf(e,t){uf(e,t,qd.Unclosed_application,t.isClosed);var r=t.args;if(qt(t.head))return function(e,t,r){var n=be(t.id),a=r.length,i=a===n.minArgs;uf(e,t,{kind:Kd.Incorrect_number_of_operator_arguments,opId:t.id},i);for(var o=0;o<a;o+=1){var u=r[o];rf(u)&&(i=!1,uf(e,u,{kind:jd.Missing_operation_argument,opId:t.id})),ff(e,u,Qt(n,o,a))}return i?(e.specialDependencies|=n.staticPrecs,ef(e,n.returnType)):ef(e,z.All)}(e,t.head,r);if(Jt(t.head))return hf(e,t.head.id,t);for(var n=0;n<r.length;n+=1)ff(e,r[n],z.All);var a=t.head,i=mf(e,a);return sf(i.result,J.Range)||0!=(i.result&(J.Array|J.Rich))||uf(e,a,of(a)||a.kind===Nr.Array?qd.Unexpected_application_head:qd.Unexpected_application_head_with_fix),ef(e,z.All)}function mf(e,t){if(e.earlyExit&&!e.isOk())throw $d;switch(t.kind){case Nr.App:case Nr.Let:case Nr.Fun:return pf(e,t);case Nr.Array:return df(e,t,J.Array);case Nr.Bad:return cf(e,t),ef(e,z.All);case Nr.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==br.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?ef(e,J.Range):(uf(e,t,qd.Invalid_unqualified_cell),ef(e,z.All)):(uf(e,t,qd.Invalid_rel_sheet_qualifier_in_cell),ef(e,z.All));case Nr.Literal:return uf(e,t,qd.Unclosed_literal,t.isClosed),ef(e,t.oper.kind|(rr(t.oper)&&t.oper.type===Oe.REF?J.Range:0));case Nr.Name:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==br.Relative||uf(e,t,qd.Invalid_rel_sheet_qualifier_in_name),ef(e,z.All);case Nr.Paren:return uf(e,t,qd.Unclosed_paren,t.isClosed),uf(e,t,qd.Empty_parenthesis,!rf(t.node)),mf(e,t.node);case Nr.FieldRef:return uf(e,t,qd.Unclosed_bracket,t.rhs.isClosed),uf(e,t,qd.Unexpected_field_ref,!rf(t.lhs)&&!nf(t.lhs)),mf(e,t.lhs),ef(e,z.All);case Nr.StructRef:return uf(e,t,qd.Unclosed_bracket,t.rhs.isClosed),uf(e,t,qd.Unexpected_struct_ref,rf(t.lhs)||t.lhs.kind===Nr.Name&&t.lhs.parts.kind===Rr.IdentNamePart),uf(e,t,qd.Unsupported_struct_ref),mf(e,t.lhs),ef(e,z.All);default:return y("calc.analyze.checker.infer: unhandled formula case",t)}}var gf={ok:!0,isOk:x,collect:function(e,t,r){return!1}};function Sf(e,t,r,n){var a,i;void 0===n&&(n=!0);var o={globals:e,locals:t,localeInfo:(i=null===(a=t.config)||void 0===a?void 0:a.localeInfo,null!=i?i:e.config.localeInfo),reportError:r.collect,isOk:function(){return r.isOk(o.errorData)},earlyExit:n,specialDependencies:Q.None,errorData:r.ok};return o}function yf(e,t){try{return uf(e,t.node,qd.Empty_formula,!rf(t.node)),ff(e,t.node,z.All)}catch(t){if(t===$d)return ef(e,z.All);throw t}}function Cf(e,t){if(t.kind!==Nr.Bad||t.type!==Fr.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===Nr.Bad&&r.type===Fr.Unexpected&&r.contents===e.leftBracket&&(n.kind===Nr.Bad&&n.type===Fr.Unexpected&&n.contents===e.rightBracket)}var kf=qi(Yi((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=Ki(e,kf);t=K(t,r)}))})),1+t},vRange:function(e){return 1+K(Ki(e.ref1,kf),Ki(e.ref2,kf))},vBad:function(e){if(e.type===Fr.Sequence){var t=-1;return e.contents.forEach((function(e){var r=Ki(e,kf);t=K(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;void 0!==e.qualifier&&(t=K(t,Ki(e.qualifier,kf)));return 1+K(t,Ki(e.ref,kf))},vParen:function(e){return 1+Ki(e.node,kf)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=Ki(e,kf);t=K(t,r)})),1+t},vName:function(e){if(!Ra(ba.CalcDotOperator))return 1;for(var t=1,r=e.parts;r.kind===Rr.FieldRefNamePart;r=r.lhs,t+=1);return t}});var bf=[];function Ef(e,t,r){if(bf.length<10){var n=ji(r.node,kf,-1);bf.push(n)}else S.ULS.traceTag(595957962,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+bf.join("; ")),bf=[];try{return Rt(function(e,t,r){var n=yf(Sf(e,t,gf),r).context.errorData;return F(F({},r),{isWellFormed:n})}(e,t,r))}catch(e){return Ft(Dt(e))}}var Af={getSheetName:function(){return Ft(pr(["defaultCallbacks getSheetName"]))}};var Tf,Nf,Rf,Ff=gr("AutocorrectError"),If=function(){function e(e,t){this.seenUnclosed=!1,this.seenParen=!1,this.seenMissing=!1,this.globals=function(e){var t,r;return{getSheetName:(r=null===(t=e.getSheetName)||void 0===t?void 0:t.bind(e),null!=r?r:Af.getSheetName)}}(e),this.locals=t}return e.prototype.autocorrect=function(e,t){var r=this;if(t>100)return e;switch(e.kind){case Nr.Literal:return e.isClosed||(this.seenUnclosed=!0),t>=2&&ir(e.oper)&&(this.seenMissing=!0),e;case Nr.Name:case Nr.Bad:return e;case Nr.Array:var n=e.nodes.map((function(e){return e.map((function(e){return r.autocorrect(e,t+1)}))}));return e.isClosed||(this.seenUnclosed=!0),Qr(n,e.isClosed,e.label);case Nr.App:return Xr(qt(e.head)||Jt(e.head)?e.head:this.autocorrect(e.head,t+1),e.args.map((function(e){return r.autocorrect(e,t+1)})),this.appNodeBase(e,t),e.label);case Nr.Let:return Zr(e.head,e.vars.map((function(e){var n=e[0],a=e[1];return[n,r.autocorrect(a,t+1)]})),this.autocorrect(e.body,t+1),this.appNodeBase(e,t),e.label);case Nr.Fun:return $r(e.head,e.params,this.autocorrect(e.body,t+1),this.appNodeBase(e,t),e.label);case Nr.Paren:n=this.autocorrect(e.node,t+1);return e.isClosed||(this.seenUnclosed=!0),this.seenParen=!0,n===e.node?e:rn(n,e.isClosed,e.label);case Nr.CellRef:if(this.locals.allowUnqualifiedCell||void 0!==e.qualifier)return e;var a=this.qualifyCellRef();return void 0===a?e:sn(e.ref,a,e.label);case Nr.FieldRef:var i=this.autocorrect(e.lhs,t+1);return e.rhs.isClosed||(this.seenUnclosed=!0),i===e.lhs?e:cn(i,e.rhs,e.label);case Nr.StructRef:return e.rhs.isClosed||(this.seenUnclosed=!0),e;default:y("calc.analyze.Autocorrecter.autocorrect",e)}},e.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!It(e))throw new Ff(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!It(t))throw new Ff(t.reason);return Lr(t.value,void 0)}},e.prototype.appNodeBase=function(e,t){var r=e.isClosed;return qt(e.head)||e.isClosed||0!==t||this.seenParen||this.seenUnclosed||this.seenMissing||(r=!0),e.isClosed||(this.seenUnclosed=!0),qt(e.head)||(this.seenParen=!0),r},e}();function Df(e){return{checkFormula:function(t,r){return Ef(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return function(e,t,r){try{var n=yf(Sf(e,t,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(n=a[e.label],null!=n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;return Rt([F(F({},r),{isWellFormed:void 0===n}),n])}catch(e){return Ft(Dt(e))}}(e,t,r)},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.node;return Rt(Kr(i=new If(e,t).autocorrect(i,0),n,a))}catch(e){return Ft(e instanceof Ff?e.reason:Dt(e))}}(e,t,r)},findStaticPrecedents:function(e,t){return Rt(xe([],[],Q.All,Ie.Upper))}}}(Nf=Tf||(Tf={})).analyzeLocalsGrid=Xd,Nf.analyzeLocalsName=Zd,Nf.diagnostics=n,Nf.summarizeFormulaDiagnostics=zd,Nf.createAnalyzeGlobals=Qd,Nf.createAnalyzer=Df,function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.PreviousFormatFailure="PreviousFormatFailure"}(Rf||(Rf={}));var wf=F(F({},lr),Rf);function Mf(e){return{kind:wf.NotValueString,message:e}}function _f(e){return{kind:wf.NotFormatString,message:e}}var Of={kind:wf.NoFormatPart};function xf(e){return{kind:wf.TooWide,clip:e}}var Lf,Pf,Uf,Bf,Gf,Vf,Hf,Wf={kind:wf.DateOverflow},jf={kind:wf.FractionOverflow};function Kf(){return{kind:wf.PreviousFormatFailure}}function Yf(e,t,r,n,a){return{kind:Hf.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a}}function qf(e){return{kind:Hf.String,str:e}}function Jf(e){return{kind:Hf.Blank,str:e}}function zf(e){return{kind:Hf.Flexible,str:e}}function Qf(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function Xf(e,t){return Qf(e,t,Bf.Center,Vf.None)}!function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(Lf||(Lf={})),function(e){e.English="English",e.Lunar="Lunar"}(Pf||(Pf={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(Uf||(Uf={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(Bf||(Bf={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(Gf||(Gf={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(Vf||(Vf={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(Hf||(Hf={}));var Zf=Qf,$f=Qf;function ev(e){return!Array.isArray(e.units)}function tv(e,t){return{renderWidth:e,getTextWidth:t}}var rv,nv,av,iv={renderWidth:1/0,getTextWidth:function(e){return e.length}};function ov(e){for(var t="",r=0,n=e.units;r<n.length;r++){var a=n[r];switch(a.kind){case Hf.String:t+=a.str;break;case Hf.Blank:for(var i=0;i<a.str.length;i+=1)t+=" "}}return t}function uv(e){return{kind:rv.Formula,fmla:e}}function sv(e,t){return{kind:rv.String,value:e,tick:t}}function cv(e,t){return{kind:rv.Number,value:e,format:t}}function lv(e){return{kind:rv.Other,value:e}}function dv(e,t){var r=Ht(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:Rt(r.range),originSheet:Rt(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}!function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(rv||(rv={}));var fv,vv=((nv={})[wr.ArabicIndic]={zero:1632,one:1633},nv[wr.ExtendedArabicIndic]={zero:1776,one:1777},nv[wr.Devanagari]={zero:2406,one:2407},nv[wr.Bengali]={zero:2534,one:2535},nv[wr.Gurmukhi]={zero:2662,one:2663},nv[wr.Gujarati]={zero:2790,one:2791},nv[wr.Oriya]={zero:2918,one:2919},nv[wr.Tamil]={zero:48,one:3047},nv[wr.Telugu]={zero:3174,one:3175},nv[wr.Kannada]={zero:3302,one:3303},nv[wr.Malayalam]={zero:3430,one:3431},nv[wr.Thai]={zero:3664,one:3665},nv[wr.Lao]={zero:3792,one:3793},nv[wr.Tibetan]={zero:3872,one:3873},nv[wr.Myanmar]={zero:4160,one:4161},nv[wr.Ethiopic]={zero:48,one:4969},nv[wr.Khmer]={zero:6112,one:6113},nv[wr.Mongolian]={zero:6160,one:6161},nv),hv=((av={})[wr.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},av[wr.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},av[wr.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},av[wr.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},av[wr.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},av[wr.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},av[wr.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},av[wr.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},av[wr.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},av[wr.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},av[wr.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},av[wr.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},av[wr.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},av);function pv(e,t){if(t===wr.ASCII)return e;switch(t){case wr.ArabicIndic:case wr.ExtendedArabicIndic:case wr.Devanagari:case wr.Bengali:case wr.Gurmukhi:case wr.Gujarati:case wr.Oriya:case wr.Tamil:case wr.Telugu:case wr.Kannada:case wr.Malayalam:case wr.Thai:case wr.Lao:case wr.Tibetan:case wr.Myanmar:case wr.Ethiopic:case wr.Khmer:case wr.Mongolian:for(var r="",n=vv[t],a=0;a<e.length;a+=1){k("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=Ma(48===i?n.zero:n.one+(i-49))}return r;case wr.Unknown:return e;case wr.ChineseTrad1:case wr.ChineseTrad2:case wr.ChineseTrad3:case wr.ChineseSimp1:case wr.ChineseSimp2:case wr.ChineseSimp3:case wr.Japanese1:case wr.Japanese2:case wr.Japanese3:case wr.Korean1:case wr.Korean2:case wr.Korean3:case wr.Korean4:for(r="",n=hv[t],a=0;a<e.length;a+=1){var i;k("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=Ma(n.digits[i-48])}return r}}function mv(e,t,r){var n=e.decimalSeparator;if(r===wr.ASCII)return Rt(t);switch(r){case wr.ArabicIndic:case wr.ExtendedArabicIndic:case wr.Devanagari:case wr.Bengali:case wr.Gurmukhi:case wr.Gujarati:case wr.Oriya:case wr.Tamil:case wr.Telugu:case wr.Kannada:case wr.Malayalam:case wr.Thai:case wr.Lao:case wr.Tibetan:case wr.Myanmar:case wr.Ethiopic:case wr.Khmer:case wr.Mongolian:var a=t.indexOf(n);return Rt(pv(t.substring(0,a<0?void 0:a),r)+(a<0?"":n)+(a<0?"":pv(t.substring(a+n.length),r)));case wr.Unknown:return Rt(t);case wr.ChineseTrad1:case wr.ChineseTrad2:case wr.ChineseTrad3:case wr.ChineseSimp1:case wr.ChineseSimp2:case wr.ChineseSimp3:case wr.Japanese1:case wr.Japanese2:case wr.Japanese3:case wr.Korean1:case wr.Korean2:case wr.Korean3:case wr.Korean4:return Ft(hr(["convertNumberShape: ideographic"]))}}function gv(e,t,r){if(""===t)return"";for(var n=Oa(t,0,t.length),a="",i=0,o=0;i<t.length;){var u=La(xa(t,i));a+=t.substring(i,i+u),i+=u,o+=1,e.isThousandsPosition(r+(n-o))&&(a+=e.thousandsSeparator)}return a}function Sv(e,t){var r,n=null!=(r=e.pictureSpecial[t])?r:da[t];return k("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function yv(e,t){var r,n=null!=(r=e.pictureSingle[t])?r:fa[t];return k("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function Cv(e,t,r,n){var a="";if(r>1){var i=h(yv(e,Jn.Hash),r-1);a+=t?gv({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:yv(e,Jn.Comma)},i,1):i}return a+="0",n>0&&(a+=yv(e,Jn.Decimal),a+=h("0",n)),a}function kv(e,t){var r="";return r+="0",t>0&&(r+=yv(e,Jn.Decimal),r+=h("0",t)),e.isPercentSepBySpace&&(r+=yv(e,Jn.Space)),r+=yv(e,Jn.Percent)}function bv(e,t,r,n){var a="";return a+=Cv(e,!1,t,r),e.isExpSepBySpace&&(a+=yv(e,Jn.Space)),a+=yv(e,Jn.E),a+="+",a+=h("0",n)}function Ev(e,t){var r=yv(e,Jn.Quote);return r+t+r}function Av(e,t){var r="";r+=yv(e,Jn.Hash);var n=e.fractionSeparator;return r+=" "===n?yv(e,Jn.Space):Ev(e,n),r+=h(yv(e,Jn.Question),t),r+=yv(e,Jn.Slash),r+=h(yv(e,Jn.Question),t)}function Tv(e,t,r,n,a,i){for(var o=e.isCurrencySymbolLead,u=e.currencyFormat,s=e.isCurrencySepBySpace,c=a?3:1,l=Cv(e,!0,4,r),d="",f=function(c){0!==c&&(d+=yv(e,Jn.Sep)),1===c&&t&&(d+=yv(e,Jn.ColorStart)+function(e,t){var r,n=null!=(r=e.pictureColor[t])?r:va[t];return k("calc.numfmt.knownFormat: getColor",void 0!==n),n}(e,zn.Red)+yv(e,Jn.ColorEnd));var f=function(){return 2===c?function(e,t){var r="";return r+=Ev(e,"-"),t>0&&(r+=h(yv(e,Jn.Question),t)),r}(e,r):3===c?yv(e,Jn.Text):l},v=function(){return 3!==c?Nv(e,Jn.Star,Jn.Space):""},p=function(){return 1===c?yv(e,Jn.OpenParen):""},m=function(){return 3!==c||o?1===c?yv(e,Jn.CloseParen):Nv(e,Jn.Underscore,Jn.CloseParen):""},g=function(){var t="";if(1!==c)switch(u){case Ir.Intern:o||3===c||(t+=Nv(e,Jn.Underscore,Jn.Minus));break;case Ir.Lead:case Ir.Trail:if(u===Ir.Lead&&!a)break;t+=Nv(e,Jn.Underscore,Jn.Minus)}else t+=yv(e,Jn.Minus);return a&&!o&&u===Ir.Lead&&(t+=v()),t},S=function(){var t="";return n&&!o&&s&&(t+=yv(e,Jn.Space)),n&&(t+=null!=i?i:Sv(e,qn.Currency)),o&&s&&(t+=yv(e,Jn.Space)),t},y=function(){var e="";return 3!==c&&(o?(n&&(e+=S()),a&&(e+=v())):e+=S()),e};if(a&&(d+=function(){var t="";if(o)switch(u){case Ir.Paren:t+=Nv(e,Jn.Underscore,Jn.OpenParen);break;case Ir.Trail:t+=Nv(e,Jn.Underscore,Jn.Minus);break;case Ir.Intern:t+=Nv(e,Jn.Underscore,Jn.Space)}else{switch(u){case Ir.Trail:t+=Nv(e,Jn.Underscore,Jn.Minus);break;case Ir.Paren:case Ir.Intern:t+=Nv(e,Jn.Underscore,Jn.Space)}u!==Ir.Lead&&(t+=v())}return t}()),o)switch(u){case Ir.Paren:a||(d+=p()),d+=y(),a&&(d+=p()),d+=f(),d+=m();break;case Ir.Lead:d+=g(),d+=y(),d+=f();break;case Ir.Intern:d+=y(),d+=g(),d+=f();break;case Ir.Trail:d+=y(),d+=f(),d+=g()}else switch(u){case Ir.Paren:d+=p(),d+=f(),a&&(d+=m()),d+=y(),a||(d+=m());break;case Ir.Lead:d+=g(),d+=f(),d+=y();break;case Ir.Intern:d+=f(),d+=g(),d+=y();break;case Ir.Trail:d+=f(),d+=y(),d+=g()}a&&(d+=function(){if(o)switch(u){case Ir.Lead:return Nv(e,Jn.Underscore,Jn.Minus);case Ir.Intern:return Nv(e,Jn.Underscore,Jn.Space)}else switch(u){case Ir.Lead:return Nv(e,Jn.Underscore,Jn.Minus);case Ir.Paren:case Ir.Intern:return Nv(e,Jn.Underscore,Jn.Space)}return""}())},v=0;v<=c;v+=1)f(v);return d}function Nv(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:yv(e,t)})).join("")}var Rv=((fv={})[Dr.MDY]=[1,0,2],fv[Dr.DMY]=[0,1,2],fv[Dr.YMD]=[2,1,0],fv[Dr.MYD]=[1,2,0],fv[Dr.DYM]=[0,2,1],fv[Dr.YDM]=[2,0,1],fv);function Fv(e,t){return Nv(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?Jn.Hour:"",Jn.Hour,Jn.Colon,Jn.Minute,Jn.Minute)}function Iv(e,t){return Fv(e,t)+Nv(e,Jn.Colon,Jn.Second,Jn.Second)}function Dv(e){var t="";return e.isAMPMSepBySpace&&(t+=yv(e,Jn.Space)),t+=Sv(e,qn.AP1)}function wv(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,a=t||e.year4Digits,i=Nv(e,a?Jn.Year:"",a?Jn.Year:"",Jn.Year,Jn.Year),o=Nv(e,r?Jn.Month:"",Jn.Month),u=[Nv(e,n?Jn.Day:"",Jn.Day),o,i],s=Rv[e.dateOrder],c="",l=0;l<3;l+=1)c+=u[s[l]],l<2&&(c+=yv(e,Jn.DateSep));return c}function Mv(e,t,r){var n=e.day2Digits,a=e.country===Kn.GER,i="/"===e.dateSeparator&&" "!==e.dateAltSeparator,o="";return t&&(o+=Nv(e,n?Jn.Day:"",Jn.Day),i?o+=e.dateAltSeparator:(o+=yv(e,Jn.DateSep),a&&(o+=yv(e,Jn.Space)))),o+=Nv(e,Jn.Month,Jn.Month,Jn.Month),r&&(o+=i?e.dateAltSeparator:yv(e,a?Jn.Space:Jn.DateSep),o+=Nv(e,Jn.Year,Jn.Year)),o}function _v(e,t){switch(t){case Mr.General:return Sv(e,qn.General);case Mr.NoComFixed0:return Cv(e,!1,1,0);case Mr.NoComFixed:return Cv(e,!1,1,2);case Mr.Fixed0:return Cv(e,!0,4,0);case Mr.Fixed:return Cv(e,!0,4,2);case Mr.Currency:return Tv(e,!1,0,!0,!1);case Mr.CoCurrency:return Tv(e,!0,0,!0,!1);case Mr.CurrencyDec:return Tv(e,!1,2,!0,!1);case Mr.CoCurrencyDec:return Tv(e,!0,2,!0,!1);case Mr.Pct0:return kv(e,0);case Mr.Pct:return kv(e,2);case Mr.Exp:return bv(e,1,2,2);case Mr.Fract:return Av(e,1);case Mr.FractBond:return Av(e,2);case Mr.MMDDYY:return wv(e);case Mr.DDMMMYY:return Mv(e,!0,!0);case Mr.DDMMM:return Mv(e,!0,!1);case Mr.MMMYY:return Mv(e,!1,!0);case Mr.HHMMAP:return Fv(e,!0)+Dv(e);case Mr.HHMMSSAP:return Iv(e,!0)+Dv(e);case Mr.HHMM:return Fv(e,!1);case Mr.HHMMSS:return Iv(e,!1);case Mr.MDYHMS:return Nv(e,wv(e),Jn.Space,Fv(e,!1));case Mr.USCoCurrency:case Mr.USCoCurrencyDec:return Tv(F(F({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:Ir.Paren}),!0,t===Mr.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?Ev(e,"US$"):"$");case Mr.Currency2:return Tv(e,!1,0,!1,!1);case Mr.CoCurrency2:return Tv(e,!0,0,!1,!1);case Mr.CurrencyDec2:return Tv(e,!1,2,!1,!1);case Mr.CoCurrencyDec2:return Tv(e,!0,2,!1,!1);case Mr.Acct:return Tv(e,!1,0,!1,!0);case Mr.AcctDec:return Tv(e,!1,2,!1,!0);case Mr.AcctCur:return Tv(e,!1,0,!0,!0);case Mr.AcctDecCur:return Tv(e,!1,2,!0,!0);case Mr.MMSS:return Nv(e,Jn.Minute,Jn.Minute,Jn.Colon,Jn.Second,Jn.Second);case Mr.AbsHMMSS:return Nv(e,Jn.ColorStart,Jn.Hour,Jn.ColorEnd,Jn.Colon,Jn.Minute,Jn.Minute,Jn.Colon,Jn.Second,Jn.Second);case Mr.SS0:return Nv(e,Jn.Minute,Jn.Minute,Jn.Colon,Jn.Second,Jn.Second,Jn.Decimal,"0");case Mr.Eng:return bv(e,3,1,1);case Mr.Text:return yv(e,Jn.Text)}}function Ov(e,t){switch(e){case Mr.USCoCurrency:case Mr.USCoCurrencyDec:return t.isEastAsia;default:return!0}}var xv;Mr.General,Mr.NoComFixed0,Mr.NoComFixed,Mr.Fixed0,Mr.Fixed,Mr.Currency,Mr.CoCurrency,Mr.CurrencyDec,Mr.CoCurrencyDec,Mr.Pct0,Mr.Pct,Mr.Exp,Mr.Fract,Mr.FractBond,Mr.MMDDYY,Mr.DDMMMYY,Mr.DDMMM,Mr.MMMYY,Mr.HHMMAP,Mr.HHMMSSAP,Mr.HHMM,Mr.HHMMSS,Mr.MDYHMS,Mr.Currency2,Mr.CoCurrency2,Mr.CurrencyDec2,Mr.CoCurrencyDec2,Mr.Acct,Mr.AcctCur,Mr.AcctDec,Mr.AcctDecCur,Mr.MMSS,Mr.AbsHMMSS,Mr.SS0,Mr.Eng,Mr.Text;function Lv(e,t,r,n){if(" "!==t&&""!==t){var a="$"===t;if(e.isEastAsia){if(n<r.length&&36===r.charCodeAt(n)&&!a)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&n<r.length&&92===r.charCodeAt(n))return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function Pv(e,t,r,n,a,i){var o,u=0,s=!1,c=!1,l=!1,d=e.isCurrencySymbolLead,f=e.currencySymbol;0!==a&&(d=1===a,f="");for(var v=0;v<r.length;){if(void 0===o&&d)if(void 0!==(g=Lv(e,f,r,v))){o=g.currency,v=g.i;continue}switch(S=r.charCodeAt(v)){case 37:v+=1,u+=1;continue;case 32:v+=1;continue;case 40:case 45:case 43:if(v+=1,c)return Rt(void 0);c=!0,40===S&&(s=!0),l=43!==S;continue}break}var h=Ga(e,t,r,v,!0,u>0||n,i);if(void 0===h||void 0===h.value)return Rt(void 0);v=h.i;for(var p,m=l?t.neg(h.value):h.value;v<r.length;){var g,S;if(void 0===o&&!d)if(void 0!==(g=Lv(e,f,r,v))){o=g.currency,v=g.i;continue}switch(S=r.charCodeAt(v)){case 37:v+=1,u+=1;continue;case 32:v+=1;continue;case 41:if(v+=1,!s)return Rt(void 0);s=!1;continue}break}if(v!==r.length||s||u>1||void 0!==o&&u>0)return Rt(void 0);if(void 0!==h.format)p=h.format;else if(1===o)p=h.consumedDecimal?Mr.USCoCurrencyDec:Mr.USCoCurrency;else if(2===o){p=e.isChinaT?h.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':h.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(h.numShape!==wr.ASCII)return Ft(hr(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==o)switch(a){case 0:p=h.consumedDecimal?Mr.CoCurrencyDec:Mr.CoCurrency;break;case 1:p=Tv(F(F({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,h.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case 2:p=Tv(F(F({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,h.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else p=u>0?h.consumedDecimal?Mr.Pct:Mr.Pct0:h.consumedThousands?h.consumedDecimal?Mr.Fixed:Mr.Fixed0:Mr.General}return Rt({value:m,format:p})}function Uv(e,t,r,n,a,i){if(!a)return Pv(e,t,r,n,0,i);for(var o=0;o<=2;o+=1){var u=Pv(e,t,r,n,o,i);if(!It(u))return u;if(void 0!==u.value)return u;if(0===o&&r.indexOf("")<0)break}return Rt(void 0)}var Bv={getTime:function(){return Ft(pr(["default ParseDateGlobals getTime"]))}};function Gv(e){var t,r;return{config:e.config,getTime:(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e),null!=r?r:Bv.getTime)}}function Vv(e,t){return k("calc.numfmt.monthToken",ah(e,1,12)),{kind:0,value:e,bidiDate:t}}var Hv=M(new Array(12)).map((function(e,t){return Vv(t+1)})),Wv=function(e){return Hv[e]},jv=function(e){return Vv(e+1,Pf.English)},Kv=function(e){return Vv(e+1,Pf.Lunar)},Yv=[!0,!1].map((function(e){return{kind:1,am:e}})),qv=Yv[0],Jv=Yv[1],zv=function(e){return 0===e?qv:Jv};function Qv(e,t,r){return k("calc.numfmt.numberToken",f(e)&&ah(e,-9999,9999)&&ah(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var Xv=function(e){return 3===e||4===e},Zv=function(e,t){return e.lcid===Yn.Hungarian&&2===t},$v=function(e){return e<=1},eh=function(e){return e<=2},th=["",""],rh=((xv={})[Kn.FRN]=[["Jun",Vv(6)],["Jul",Vv(7)]],xv[Kn.DUT]=[["Mrt",Vv(3)]],xv[Kn.GER]=[["Mrz",Vv(3)]],xv),nh=["",""," "," "," "," ","","","",""," "," "];function ah(e,t,r){return e>=t&&e<=r}function ih(e,t){var r=e.getTime(hn.Year,t);if(!It(r))return r;var n=e.config,a=n.datepack.fromNum(n,r.value,Sn.RoundSec);return k("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),Rt(a.yr)}function oh(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function uh(e,t,r,n,a,i){for(var o=t.indexOf(" ",r),u=0;u<n.length;u+=1){var s=n[u],c=j(a,s.length);if(o>=0&&s.indexOf(" ")<0&&o-r>=c&&o-r<=s.length)if(oh(e,f=s.substring(0,o-r),t,r))return[i(u),r+f.length];for(var l=void 0,d=c;d<=s.length;d+=1){var f;if(!oh(e,f=s.substring(0,d),t,r))break;l=r+f.length}if(void 0!==l)return[i(u),l]}}function sh(e,t,r,n,a){for(var i=0;i<n.length;i+=1){var o=n[i];if(oh(e,o,t,r))return[a(i),r+o.length]}}function ch(e,t,r){var n,a=rh[e.country];if(void 0!==a)for(var i=0,o=a;i<o.length;i++){var u=o[i],s=u[0],c=u[1];if(oh(e,s,t,r))return[c,r+s.length]}if(e.isEastAsia){if(void 0!==(n=uh(e,t,r,Aa().monthNameLong,3,Wv)))return n}else if(e.isComplexScript){if(void 0!==(n=sh(e,t,r,e.monthNameLong,Wv)))return n;if(void 0!==(n=sh(e,t,r,e.monthNameShort,Wv)))return n;if(void 0!==(n=sh(e,t,r,Aa().monthNameLong,jv)))return n;if(void 0!==(n=sh(e,t,r,Aa().monthNameShort,jv)))return n}else if(void 0!==(n=uh(e,t,r,e.monthNameLong,3,Wv)))return n;return(e.lcid&Yn.LANG)==(Yn.Arabic&Yn.LANG)&&void 0!==(n=sh(e,t,r,nh,Kv))||void 0!==(n=uh(e,t,r,e.ampmSymbols,1,zv))||void 0!==(n=uh(e,t,r,Aa().ampmSymbols,1,zv))||(e.isChinaS||e.isChinaT)&&void 0!==(n=uh(e,t,r,th,1,zv))?n:[void 0,r]}function lh(e,t,r,n){var a,i,o,u,s,c=r,l=45===t.charCodeAt(c);if(l&&(c+=1),5===n){if(o=(a=Ua(e,4,c+4<t.length?t.substring(0,c+4):t,c))[0],k("calc.numfmt.parseDateInternal: 0 < digits <= 4",ah(s=(u=a[1])-c,1,4)),4===s){for(var d=void 0;u<t.length&&e.isNumeral(d=xa(t,u));)u+=La(d);o=Math.round(o/10),s=3}}else if(o=(i=Ua(e,4,t,c))[0],(s=(u=i[1])-c)>4||s>2&&o<100)return[void 0,r];if(0===s)return[void 0,r];var f=function(e,t){for(var r=wr.ASCII,n=0;n<t.length;){var a=xa(t,n),i=e.getNumberShape(a);i!==wr.ASCII&&(r=i),n+=La(a)}return r}(e,t.substring(c,u));return c=u,[Qv(l?-o:o,s,f),c]}function dh(e,t,r,n){var a=0,i=r;if(32===t.charCodeAt(i))for(a=1;32===t.charCodeAt(i);)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&v(t,e.timeAltSeparator,i)?(a=4,i+=e.timeAltSeparator.length):v(t,e.dateSeparator,i)?(a=2,i+=e.dateSeparator.length):v(t,e.timeSeparator,i)?(a=3,i+=e.timeSeparator.length):v(t,e.decimalSeparator,i)&&3===n?(a=5,i+=e.decimalSeparator.length):47===t.charCodeAt(i)||45===t.charCodeAt(i)?(a=2,i+=1):58===t.charCodeAt(i)?(a=3,i+=1):v(t,", ",i)&&(a=6,i+=2),1===a&&(" "===e.dateSeparator?a=2:" "===e.timeSeparator?a=3:" "===e.decimalSeparator&&3===n&&(a=5)),[a,i]}function fh(e,t,r,n){var a,i,o,u,s,c=e.config,l=c.localeInfo;if(!l.isEastAsia&&!function(e,t){for(var r=0;r<t.length;r+=1)if(e.isNumeral(t.charCodeAt(r)))return!0;return!1}(l,t))return Rt(void 0);if(l.isEastAsia)return Ft(hr(["parse East Asia date"]));if(l.isThai){var d=t.indexOf("b");if(d<0&&(d=t.indexOf("B")),d>=0&&d+1<t.length&&l.isNumeral(xa(t,d+1)))return Ft(hr(["parse Thai Buddhist date"]))}var f=function(e,t,r){for(var n,a,i=e.localeInfo,o=e.dateCompatibility,u=[],s=null===(n=r)||void 0===n?void 0:n.bidiDate,c=wr.ASCII,l=!1,d=!1,f=0;f<t.length;){if(u.length>=9)return Rt(void 0);var v=void 0;if(i.isNumeral(xa(t,f))||!o&&f+1<t.length&&45===t.charCodeAt(f)&&i.isNumeral(xa(t,f+1))){var h=lh(i,t,f,a),p=h[0],m=h[1];if(void 0===p)return Rt(void 0);f=m,p.numShape!==wr.ASCII&&(c=p.numShape),v=p}else{if(32===t.charCodeAt(f))return Ft(hr(["absurd date/time string with leading space"]));var g=ch(i,t,f),S=g[0],y=g[1];if(void 0===S)return Rt(void 0);if(f=y,0===S.kind){if(l)return Rt(void 0);l=!0,void 0!==S.bidiDate&&(s=S.bidiDate)}if(1===S.kind){if(d)return Rt(void 0);if(d=!0,0===u.length||1!==u[u.length-1].sep)return Rt(void 0);a=u[u.length-1].sep=3}v=S}var C=dh(i,t,f,a),b=C[0];for(f=C[1];f<t.length&&32===t.charCodeAt(f);)f+=1;u.push({tok:v,sep:b}),a=b}return k("calc.numfmt.parseDateInternal: > 0 tokens",0!==u.length),Rt({tokens:u,bidiDate:s,numShape:c})}(c,t,r);if(!It(f)||void 0===f.value)return f;var v=f.value,h=v.tokens,p=v.bidiDate,m=v.numShape;if(p===Pf.Lunar)return Ft(hr(["Lunar calendar"]));var g=function(e,t){for(var r,n,a,i,o,u,s,c=e.localeInfo,l=0;l<t.length;l+=1)if(Xv(t[l].sep)){r={start:l,end:l+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!Zv(c,t[r.start-1].sep))return Rt(void 0);for(;r.end<t.length&&Xv(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var d=t[r.end-1];if(2!==d.tok.kind)return Rt(void 0);d.tok;if(u=d,r.end<t.length&&Xv(t[r.end-1].sep)){if(r.end+=1,1!==(f=t[r.end-1]).tok.kind)return Ft(hr(["non-AM/PM after FracSec"]));f.tok;s=f}}else{var f;if(1===(f=t[r.end-1]).tok.kind){f.tok;s=f}}var v=r.end-r.start-(void 0!==u?1:0)-(void 0!==s?1:0);for(l=0;l<v;l+=1)if(2!==t[r.start+l].tok.kind)return Ft(hr(["non-number in H/M/S component"]));switch(v){case 0:return C("calc.numfmt.parseDateInternal: 0 time");case 1:k("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===u),a=t[r.start];break;case 2:void 0===u?(a=t[r.start],i=t[r.start+1]):(i=t[r.start],o=t[r.start+1]);break;case 3:a=t[r.start],i=t[r.start+1],o=t[r.start+2];break;default:return Rt(void 0)}for(l=r.end;l<t.length;l+=1)if(Xv(t[l].sep))return Rt(void 0);if(r.end===t.length){var h=t[r.end-1].sep;if(!($v(h)||void 0!==s&&5===h))return Ft(hr(["trailing sep after time"]))}else{var p=t[r.end-1].sep;if(!$v(p)&&6!==p)return Ft(hr(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return Ft(hr(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return Rt({time:r,date:n,hour:a,min:i,sec:o,fracSec:u,ampm:s})}(c,h);if(!It(g)||void 0===g.value)return g;var S=g.value,y=S.time,b=S.date,E=S.hour,A=S.min,T=S.sec,N=S.fracSec,R=S.ampm,F=function(e,t,r,n){var a,i,o,u=e.config,s=u.localeInfo,c=u.dateCompatibility,l=u.datepack,d=!1;if(void 0!==n){var f=n.end-n.start;if(f<2||f>3)return Rt(void 0);var v=r[n.start],h=v.tok,p=v.sep,m=r[n.start+1],g=m.tok,S=m.sep,y=r[n.end-1],C=y.tok,b=y.sep;if(k("calc.numfmt.parseDateInternal: all not AM/PM",1!==h.kind&&1!==g.kind&&1!==C.kind),!$v(b)&&!Zv(s,b))return Rt(void 0);var E=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(d=E,E)if(eh(p)&&eh(S))if(0===h.kind){if(f>2)return Rt(void 0);i=h,k("calc.numfmt.parseDateInternal: yr not Month",0!==C.kind),a=C}else{if(0!==g.kind)return Rt(void 0);o=h,i=g,3===f&&(k("calc.numfmt.parseDateInternal: yr not Month",0!==C.kind),a=C)}else{if(3!==f)return Rt(void 0);if($v(S))return Rt(void 0);var A=s.longDateFormat?h:g,T=s.longDateFormat?g:h;if(0!==A.kind)return Rt(void 0);k("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==T.kind&&0!==C.kind),o=T,i=A,a=C}else if(k("calc.numfmt.parseDateInternal: all not Month",0!==h.kind&&0!==g.kind&&0!==C.kind),2===f&&2===p)switch(d=!0,s.dateOrder){case Dr.MDY:i=h,a=C;break;case Dr.YMD:ah(h.value,1,12)?(i=h,o=C):(a=h,i=C);break;case Dr.DMY:ah(C.value,1,12)?(o=h,i=C):(i=h,a=C);break;default:return Ft(hr(["date parse date order"]))}else{if(f<3||2!==p||2!==S)return Rt(void 0);switch(h.value>999||!c&&h.value>99?Dr.YMD:s.dateOrder){case Dr.MDY:i=h,o=g,a=C;break;case Dr.YMD:a=h,i=g,o=C;break;case Dr.DMY:o=h,i=g,a=C;break;default:return Ft(hr(["date parse date order"]))}}}var N=!1;if(s.dateOrder!==Dr.DMY&&void 0===o&&void 0!==i&&ah(i.value,1,12)&&void 0!==a&&ah(a.value,1,31)){var R=ih(e,t);if(!It(R))return R;a.value<=l.daysPerMonth(i.value,R.value,c)&&(o=a,a=Qv(R.value,4,wr.ASCII),N=!0)}return Rt({yr:a,mon:i,dom:o,useMonthName:d,usingCurrentYear:N})}(e,n,h,b);if(!It(F)||void 0===F.value)return F;var I=F.value,D=I.yr,w=I.mon,M=I.dom,_=I.useMonthName,O=I.usingCurrentYear,x=function(e,t,r,n,a,i,o,u,s,c){var l,d,f,v,h,p=e.config,m=p.mathpack,g=p.datepack,S=p.dateCompatibility;if(void 0!==n||void 0!==a||void 0!==r){if(k("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),k("calc.numfmt.parseDateInternal: mon",void 0!==n),!ah(v=n.value,1,12))return Rt(void 0);if(void 0===r){var y=ih(e,t);if(!It(y))return y;f=y.value}else f=ah(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!ah(f,1900,9999))return Rt(void 0);if(!ah(h=null!=(d=null===(l=a)||void 0===l?void 0:l.value)?d:1,1,g.daysPerMonth(v,f,S)))return Rt(void 0)}else{var C=g.fromNum(p,m.zero,Sn.RoundSec);k("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==C),f=C.yr,v=C.mon,h=C.dom}var b,E=0,A=0,T=0,N=0,R=Sn.RoundSec,F=0;if(void 0!==i){if(i.value<0)return Ft(hr(["negative hour"]));if(i.value>23){if(void 0!==b)return Rt(void 0);F=i.value,b=Cn.Hour}else E=i.value}if(void 0!==o){if(o.value<0)return Ft(hr(["negative minute"]));if(o.value>59){if(void 0!==b)return Rt(void 0);F=o.value,b=Cn.Minute}else A=o.value}if(void 0!==u){if(u.value<0)return Ft(hr(["negative second"]));if(u.value>59){if(void 0!==b)return Rt(void 0);F=u.value,b=Cn.Second}else T=u.value}if(void 0!==s){if(s.value<0)return Ft(hr(["negative fractional second"]));k("calc.numfmt.parseDateInternal: fracSec.digits",s.digits>=1&&s.digits<=3),R=s.digits,k("calc.numfmt.parseDateInternal: fracSec.value",s.value<(3===R?1001:2===R?100:10)),N=s.value}if(void 0!==c){if(void 0!==b||E>12)return Rt(void 0);c.am?12===E&&(E=0):E<12&&(E+=12)}var I=yn(f,v,h,E,A,T,1,N,R),D=void 0!==b?g.toNumWithDuration(p,I,b,F):g.toNum(p,I);return rr(D)?Rt(void 0):Rt({value:D,duration:b})}(e,n,D,w,M,null===(a=E)||void 0===a?void 0:a.tok,null===(i=A)||void 0===i?void 0:i.tok,null===(o=T)||void 0===o?void 0:o.tok,null===(u=N)||void 0===u?void 0:u.tok,null===(s=R)||void 0===s?void 0:s.tok);if(!It(x)||void 0===x.value)return x;var L=x.value,P=L.value,U=function(e,t,r,n,a,i,o,u,s,c,l,d){var f;if(e!==wr.ASCII)return Ft(hr(["parseDateInternal ifmt for non-ASCII"]));if(o)return 4===(null===(f=u)||void 0===f?void 0:f.sep)?Ft(hr(["parseDateInternal ifmt for alternate time separator"])):void 0!==c?Rt(Mr.SS0):void 0!==d?d!==Cn.Hour||void 0!==l||t?Rt(Mr.General):Rt(Mr.AbsHMMSS):Rt(t?Mr.MDYHMS:void 0!==l?void 0!==s?Mr.HHMMSSAP:Mr.HHMMAP:void 0!==s?Mr.HHMMSS:Mr.HHMM);if(k("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!a)return Rt(Mr.MMDDYY);var v=void 0!==r&&!i;return Rt(void 0===n?Mr.MMMYY:v?Mr.DDMMMYY:Mr.DDMMM)}(m,void 0!==b,D,M,_,O,void 0!==y,A,T,N,R,L.duration);return It(U)?Rt({value:P,format:U.value}):U}function vh(e){var t=v(e,"'"),r=t?e.substring(1):e;return r.length>32767?Ft(Mf("cell text too long")):Rt(sv(Pe(r),t))}function hh(e,t,r){return fh(Gv(e),t,r,Gf.ValueCell)}function ph(e,t,r){var n=e.config,a=n.localeInfo,i=n.mathpack,o=a.isEastAsia&&r.valueType===Lf.Percentage&&!0,u=!1;switch(r.valueType){case Lf.Number:case Lf.Currency:case Lf.Percentage:case Lf.Fraction:case Lf.Scientific:case Lf.Accounting:u=!0}return Uv(a,i,t,o,!0,u)}function mh(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return rt;if(0===e.stringCompareCI(t,e.falseName))return nt;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return Ue(r)}}(e.config.localeInfo,t);if(void 0!==n)return Rt(lv(n));for(var a=0,i=r.valueType===Lf.Date||r.valueType===Lf.Time?[hh,ph]:[ph,hh];a<i.length;a++){var o=(0,i[a])(e,t,r);if(!It(o))return o;if(void 0!==o.value){var u=o.value;return Rt(cv(u.value,u.format))}}return Rt(void 0)}function gh(e,t){return e!==t&&(!!t.isBuiltIn&&(t.valueType===Lf.General||function(e,t){return e.valueType!==Lf.Number&&t.valueType!==Lf.Number&&e.valueType!==t.valueType}(e,t)))}var Sh=function(){function e(e,t,r){E("calc.common.StrictArray2D",e),E("calc.common.StrictArray2D",t);var n=r.length;n<e&&C("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&C("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return T("calc.common.StrictArray2D.get",e,this.rows),T("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new kh(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var yh,Ch=function(){function e(e,t,r,n,a,i){E("calc.common.StrictSparseArray2D",e),E("calc.common.StrictSparseArray2D",t),T("calc.common.StrictSparseArray2D",r,e+1),T("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&C("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var s=a[u].length;s<n&&C("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+s)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return T("calc.common.StrictSparseArray2D.get",e,this.rows),T("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new bh(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),kh=function(){function e(e,t,r){E("calc.common.NonstrictArray2D",e),E("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return T("calc.common.NonstrictArray2D.get",e,this.rows),T("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Eh(this.rows,this.cols,this.func);return new Sh(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),bh=function(){function e(e,t,r,n,a,i){E("calc.common.NonstrictSparseArray2D",e),E("calc.common.NonstrictSparseArray2D",t),T("calc.common.NonstrictSparseArray2D",r,e+1),T("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return T("calc.common.NonstrictSparseArray2D.get",e,this.rows),T("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Eh(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Ch(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Eh(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function Ah(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function Th(e,t,r){return new kh(e,t,(function(e,t){return r}))}function Nh(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(yh||(yh={}));var Rh=Nh(yh.Next,void 0,void 0);function Fh(e,t){return Nh(yh.CallMachine,e,t)}var Ih={receiveResult:function(e){return It(e)?Rh:e}};function Dh(){return Ih}var wh,Mh=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return function(e,t){function r(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(Error),_h=function(){function e(e){this.numSteps=0,this.stack=[],this.pushFrame(Fh(e,{receiveResult:function(e){return e}})),this.transition=Rh}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(n.isRunning)throw e.numCycles+=1,new Mh(n,r);n.isRunning=!0,this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case yh.Next:return void(this.transition=this.stack[this.stack.length-1].machine.next());case yh.CallMachine:return this.pushFrame(e),void(this.transition=e.machine.next());default:var t=this.stack.pop();return t?(t.machine.isRunning=!1,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=Ft(Dt(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=Ft(Dt(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),Oh=function(){function e(e){this.machines=e,this.isRunning=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?Fh(this.machines[this.values.length],this):Rt(this.values)},e.prototype.receiveResult=function(e){return It(e)?(this.values.push(e.value),this.next()):e},e}();function xh(e){return{kind:wh.MachineCall,machine:e}}function Lh(e){return e.kind===wh.MachineCall}!function(e){e.MachineCall="MachineCall"}(wh||(wh={}));var Ph=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.isRunning=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(Jh(this.context,this.toDeref,!0),Gh);k("calc.runtime.ArrayMachine.next",!ir(t)&&!nr(t)),ar(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return Rt(Qe(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return Lh(r)?Fh(r.machine,this):(this.toDeref=r,Rh)}catch(t){return null!=(e=this.context.handleEvaluationError(t))?e:Ft(Dt(t))}},e.prototype.receiveResult=function(e){return It(e)?(this.toDeref=e.value,this.next()):e},e}(),Uh=J.Number|J.String|J.Boolean|J.Error|J.Rich|J.Array,Bh=J.Number|J.String|J.Boolean|J.Error|J.Blank|J.Rich,Gh=Bh|J.Array;function Vh(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;S.ULS.traceTag(596120270,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,n)}function Hh(e,t,r){return Qe(e,t,ar(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return Ah(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var s=0;s<r;s+=1){u.push([]);for(var c=0;c<n;c+=1)u[s][c]=o(s,c)}return u}(r.rows,r.cols,e,t,r.opers,Ke):Ah(e,t,r))}function Wh(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=j(r,o),d=j(n,u);return vt(l,d,K(r+a,o+s)-l,K(n+i,u+c)-d)}function jh(e){return 0===e.length&&C("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Wh)}function Kh(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=K(r,o),d=K(n,u),f=j(r+a,o+s)-l,v=j(n+i,u+c)-d;if(!(f<=0||v<=0))return vt(l,d,f,v)}function Yh(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,s=a<=r&&r<a+o,c=i<=n&&n<i+u;return s&&c?pt(r,n):s&&1===u?pt(r,i):c&&1===o?pt(a,n):1===u&&1===o?pt(a,i):void 0}function qh(e){return e.rows*e.cols}function Jh(e,t,r){if(!nr(t))return t;if(!wt(t.sheets))return Ve;if(!r)return 1===t.ranges.length&&_t(t.ranges[0])?e.dereferenceOper(t,z.All&~J.Range):e.dereferenceOper(t,J.Array);var n=e.dereferenceOper(t,z.All&~(J.Range|J.Array));return ar(n)?Ke:n}function zh(e){var t=function(e){return e&~(J.Array|J.Range)};return ne(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function Qh(e,t,r,n,a){switch(n.kind){case J.Missing:case J.Blank:return Th(t,r,e.zero);case J.Array:return 0!=(a&J.Array)?Th(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Th(e,t,r.get(0,0)):1===r.rows?new kh(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new kh(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new kh(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new Sh(n.rows,n.cols,n.opers),Ke);case J.Range:default:return Th(t,r,n)}}function Xh(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];ar(u)&&0==(Qt(t,o,n.length)&J.Array)?(a=K(a,u.rows),i=K(i,u.cols)):(a=K(a,1),i=K(i,1))}var s=n.map((function(r,n,o){return Qh(e.mathpack,a,i,r,Qt(t,n,o.length))}));return xh(new Ph(e,a,i,(function(e,t){return r(s.map((function(r){return r.get(e,t)})))})))}function Zh(e){return function(t,r){return e(t)(r[0])}}function $h(e){return function(t,r){return e(t)(r[0],r[1])}}var ep=function(e){return $t(e)?e:C("calc.funcs.assertNumber")},tp=function(e){return er(e)?e:C("calc.funcs.assertString")},rp=Pe("");function np(e){return er(e)&&""===e.value}function ap(e,t){var r=Jh(e,t,!1),n=ur(r)?r.getFallback():r;switch(n.kind){case J.Number:return n;case J.Boolean:return Ve;case J.String:var a=e.coerceOper(n,J.Number);return $t(a)?a:Ve;case J.Error:return n;case J.Array:return Ve;case J.Missing:return Ke;case J.Blank:return e.mathpack.zero;default:return y("calc.funcs.chkNumOper",n)}}function ip(e,t){var r=ap(e,t);if(rr(r))return r;var n=e.mathpack;return n.cond(r)<0?je:op(e,r=n.floor(r))?(e.config.date1904&&!er(t)&&(r=n.add(n.fromNumber(1462),r)),r):je}function op(e,t){var r,n,a=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),a>=r&&a<=n}function up(e,t,r){var n=e.div(t,r);if(rr(n))return n;var a=e.mul(e.trunc(n),r);if(rr(a))return a;var i=e.sub(t,a);return!rr(i)&&e.cond(t)<0?e.abs(i):i}function sp(e,t){switch(e){case ae.Eq:return 0===t;case ae.Ne:return 0!==t;case ae.Lt:return t<0;case ae.Gt:return t>0;case ae.Le:return t<=0;case ae.Ge:return t>=0}}function cp(e,t,r){return sp(e,t.value-r.value)}function lp(e,t,r,n){return sp(t,e.stringCompareCI(r.value,n.value))}function dp(e,t,r,n){return sp(t,e.compare(r,n))}function fp(e,t,r){if(wt(t.sheets))if(wt(r.sheets))if(Pt(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return lt(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+s(t)+", range2 = "+s(r);Vh(e,Oe.VALUE,n)}else{var n="different document, range1 = "+s(t)+", range2 = "+s(r);Vh(e,Oe.VALUE,n)}else Vh(e,Oe.VALUE,"3D reference, range2 = "+s(r));else Vh(e,Oe.VALUE,"3D reference, range1 = "+s(t))}function vp(e,t,r,n){void 0===n&&(n=!1);var a,o,u,c=e.config.mathpack;if(1===r.length){var l=r[0];switch(t){case ae.Percent:return c.percent(l);case ae.Neg:return c.neg(l);case ae.Pos:return l;default:var d="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return S.ULS.assertTag(593372496,i.LogCategory.msoulscat_ES_EWAJS,!1,d)}}if(2===r.length){l=r[0];var f=r[1];switch(t){case ae.Add:var v=c.add(l,f);return n&&$t(v)?c.checkAlmostCancellation(l,v):v;case ae.Sub:v=c.sub(l,f);return n&&$t(v)?c.checkAlmostCancellation(l,v):v;case ae.Mul:return c.mul(l,f);case ae.Div:return c.div(l,f);case ae.Pow:return c.power(l,f);case ae.Concat:return Pe((l.value+f.value).substring(0,32767));case ae.Eq:case ae.Ne:case ae.Lt:case ae.Le:case ae.Gt:case ae.Ge:return Le(function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack;if(r.kind!==n.kind){if(or(r))switch(n.kind){case J.Number:return dp(o,t,o.zero,n);case J.String:return lp(i,t,rp,n);case J.Boolean:return cp(t,nt,n)}if(or(n))switch(r.kind){case J.Number:return dp(o,t,r,o.zero);case J.String:return lp(i,t,r,rp);case J.Boolean:return cp(t,r,nt)}return sp(t,r.kind-n.kind)}switch(r.kind){case J.Number:return dp(o,t,r,n);case J.String:return lp(i,t,r,n);case J.Boolean:return cp(t,r,n);case J.Blank:return sp(t,0);default:return!1}}(e,t,l,f));case ae.Range:return null==(u=fp("calc.runtime.applyRangeOp",a=l,o=f))?Ve:Xe(u,[Wh(jh(a.ranges),jh(o.ranges))]);case ae.Isect:return function(e,t){var r=fp("calc.runtime.applyIsectOp",e,t);if(null==r)return Ve;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=Kh(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+s(e)+", range2 = "+s(t);return Vh("calc.runtime.applyIsectOp",Oe.NULL,u),Be}return Xe(r,n)}(l,f);case ae.Union:return function(e,t){var r=fp("calc.runtime.applyUnionOp",e,t);return null==r?Ve:Xe(r,e.ranges.concat(t.ranges))}(l,f);case ae.And:return Le(l.value&&f.value);case ae.Or:return Le(l.value||f.value);case ae.Xor:return Le(l.value!==f.value);case ae.Min:return c.cond2(l,f)<=0?l:f;case ae.Max:return c.cond2(l,f)>=0?l:f;default:var h="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return S.ULS.assertTag(593372497,i.LogCategory.msoulscat_ES_EWAJS,!1,h)}}var p="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return S.ULS.assertTag(593372498,i.LogCategory.msoulscat_ES_EWAJS,!1,p)}var hp=function(e){return e.kind!==Hf.General},pp=function(e){return e.kind!==Hf.Flexible};function mp(e,t,r){return 0!=(t&Vf.MaxChars)&&r.length>255?Vf.MaxChars:0!=(t&Vf.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?Vf.CellWidth:void 0}function gp(e,t,r,n,a,i){var o=K(0,255-r.length-n.length),u=0===a.length?o:Math.floor(o/a.length);if(e.renderWidth!==1/0){var s=e.getTextWidth(a);s>0&&(u=j(u,K(Math.floor((e.renderWidth-e.getTextWidth(r+n))/s),0)))}var c,l=i(u);if(!1===l||void 0===(c=mp(e,t,r+l+n))){for(var d=l,f=u+1;f<u+50;f+=1){if(!1!==(h=i(f))){if(h===d)break;if(void 0!==(p=mp(e,t,r+h+n))){!1===d&&(d=p);break}d=h}}return k("calc.numfmt.renderValue: false after upwards search",!1!==d),d}var v=c;for(f=u-1;f>=0;f-=1){var h,p;if(!1===(h=i(f)))break;if(void 0===(p=mp(e,t,r+h+n)))return h;v=p}return v}var Sp,yp,Cp,kp,bp=gr("RenderHashesError"),Ep=gr("RenderError");function Ap(e,t,r){var n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"",i=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===i&&(i="0"),i.length>r)return Rt(!1);var o=i.indexOf("E");if(o>=0){var u=mv(t,i.substring(0,o),t.expNumberShape);if(!It(u))return u;var s=i.substring(o,o+2),c=pv(i.substring(o+2),t.expNumberShape);return k("calc.numfmt.render: formatGeneral ePart","E-"===s||"E+"===s),Rt(u.value+s+c)}var l=mv(t,i,t.numberShape);return It(l)?Rt(l.value):l}function Tp(e,t,r){try{return ev(t)?Rt(Xf(t.units,t.color)):Rt(function(e,t,r){var n,a,i=t.units,o=t.color,u=t.alignment,s=t.clip;if(i.every(hp))n=i;else if(r.renderWidth===1/0)n=i.map((function(t){if(t.kind!==Hf.General)return t;var r=Ap(e,t,11);if(!It(r))throw new Ep(r.reason);return k("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),qf(r.value)}));else{for(var c="",l="",d=void 0,f=void 0,v=0;v<i.length;v+=1){var p=i[v];switch(p.kind){case Hf.String:case Hf.Blank:void 0!==d?l+=p.str:c+=p.str;break;case Hf.General:k("calc.numfmt.renderValue: expected a single General unit",void 0===d),d=v,f=p;break;case Hf.Flexible:}}k("calc.numfmt.renderValue: genUnit",void 0!==d&&void 0!==f);var m=f,g=gp(r,s,c,l,"0",(function(t){var r=Ap(e,m,j(t,11));if(!It(r))throw new Ep(r.reason);return r.value}));if("number"==typeof g)throw new bp(xf(g));n=i.map((function(e){return e.kind===Hf.General?qf(g):e}))}if(n.every(pp))a=n;else if(r.renderWidth===1/0)a=n.filter(pp);else{c="",l="";var S,y=void 0;for(v=0;v<n.length;v+=1){var C=n[v];switch(C.kind){case Hf.String:case Hf.Blank:void 0!==S?l+=C.str:c+=C.str;break;case Hf.Flexible:S=v,y=C}}k("calc.numfmt.renderValue: lastFlexUnit",void 0!==S&&void 0!==y);var b=y,E=gp(r,Vf.All,c,l,y.str,(function(e){return h(b.str,e)}));if("number"==typeof E){if(0!=(E&s))throw new bp(xf(E));E=""}var A=E;a=n.map((function(e,t){return e.kind!==Hf.Flexible?e:qf(t===S?A:"")}))}if(s!==Vf.None){var T="";for(v=0;v<a.length;v+=1)T+=a[v].str;var N=mp(r,s,T);if(void 0!==N)throw new bp(xf(N))}return $f(a,o,u,s)}(e,t,r))}catch(e){return e instanceof bp?Rt(Xf(e.reason,t.color)):Ft(e instanceof Ep?e.reason:Dt(e))}}var Np={decimalSeparator:"NOTUSED"};function Rp(e,t,r,n){var a=e.formatFixed(t,0,0),i=a.mantissa,o=a.exponent;k("calc.numfmt.dtrInteger: mantissa len <= exponent",i.length<=o),k("calc.numfmt.dtrInteger: mantissa || !exponent",0!==i.length||0===o);var u=pv(o<r?h("0",r-o):"",n),s=mv(Np,i+h("0",o-i.length),n);if(!It(s))throw new tm(s.reason);return u+s.value}function Fp(e,t,r,n,a){var i=e.formatFixed(t,0,0),o=i.mantissa,u=i.exponent;return k("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=u),k("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===u),pv(((u<r?h("0",r-u):"")+o+h("0",u-o.length)).substring(0,n),a)}function Ip(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,a=r.exponent;return k("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=a),k("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===a),""===n?"0":n.length<a?n+h("0",a-n.length):n}function Dp(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case Hf.Blank:case Hf.String:for(var a=n.str;r+1<e.length;){var i=e[r+1];if(i.kind!==n.kind)break;a+=i.str,r+=1}t.push({kind:n.kind,str:a});break;case Hf.Flexible:case Hf.General:t.push(n)}}return t}var wp,Mp=[wr.ChineseTrad1,wr.ChineseTrad2,wr.ChineseTrad3],_p=[wr.ChineseSimp1,wr.ChineseSimp2,wr.ChineseSimp3],Op=[wr.Japanese1,wr.Japanese2,wr.Japanese3],xp=[wr.Korean1,wr.Korean2,wr.Korean3,wr.Korean4];function Lp(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(wp||(wp={}));var Pp,Up=p(((Sp={})[wp.Ne]="<>",Sp[wp.Le]="<=",Sp[wp.Ge]=">=",Sp[wp.Eq]="=",Sp[wp.Lt]="<",Sp[wp.Gt]=">",Sp)),Bp=((yp={})[wp.Ne]=ae.Ne,yp[wp.Le]=ae.Le,yp[wp.Ge]=ae.Ge,yp[wp.Eq]=ae.Eq,yp[wp.Lt]=ae.Lt,yp[wp.Gt]=ae.Gt,yp),Gp=((Cp={})[ae.Ne]=wp.Ne,Cp[ae.Le]=wp.Le,Cp[ae.Ge]=wp.Ge,Cp[ae.Eq]=wp.Eq,Cp[ae.Lt]=wp.Lt,Cp[ae.Gt]=wp.Gt,Cp);function Vp(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&!(n+i.length>r.length)){var o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}}function Hp(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&v(r,i,n))return Number(a)}return Vp(e,t,r,n)}function Wp(e,t){var r;return null!=(r=e[t])?r:""}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(Pp||(Pp={}));var jp=((kp={})[Jn.Hour]=Cn.Hour,kp[Jn.HourTh]=Cn.Hour,kp[Jn.Minute]=Cn.Minute,kp[Jn.MinuteTh]=Cn.Minute,kp[Jn.Second]=Cn.Second,kp[Jn.SecondTh]=Cn.Second,kp);function Kp(e){return 400===e.kind?e.formattedStr:void 0}var Yp={kind:Pp.General};function qp(e){return 1===e.length&&e[0].kind===Pp.General}var Jp={code:[Yp],color:void 0,dbnum:void 0,dtrRounding:Sn.RoundSec,currCode:void 0};function zp(e){return void 0===e.color&&void 0===e.dbnum&&void 0===e.currCode&&qp(e.code)}function Qp(e){return void 0===e.color&&void 0===e.dbnum&&void 0===e.currCode&&(1===(t=e.code).length&&t[0].kind===Jn.Text);var t}var Xp,Zp,$p={},em=gr("ApplyHashesError"),tm=gr("ApplyError"),rm=gr("InitError"),nm=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],void 0===t.old?(this.parseString(t.formatString),this.isBuiltIn=t.isBuiltIn):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.isBuiltIn=!1),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!0,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return Rt(this.applyImpl(e,t,r,n))}catch(e){return Ft(e instanceof tm?e.reason:Dt(e))}},e.prototype.applyImpl=function(e,t,r,n){var a,i,o=this.config,u=o.mathpack,s=o.localeInfo;if(this.formatString===Wp(s.pictureSpecial,qn.General)){var c=void 0;if(er(e))return Zf([qf(e.value)],c,t,r);if(!n&&0===u.cond(e))return Zf([],c,t,r);var l=Yf(u.toNumber(e),s.decimalSeparator,!0,wr.ASCII,wr.ASCII);return Zf([l],c,t,r)}for(var d=!1;;){var f=void 0;try{var v=void 0,h=!1,p=[];if(er(e))v=3;else{var m=u.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(v=(a=this.getPart(e)).partKind,h=a.forceNeg):v=m<0?1:m>0?0:2,m<0&&(this.onlyOneNumberPart||h)&&p.push(qf("-"))}c=(f=this.parts[v]).color;var g=f.dbnum,S=f.currCode,y=f.code,C=f.dtrRounding;if(!n&&2===v&&f===this.parts[0]&&!d)return Zf([],c,t,r);var b=this.getNumShape(g,S);this.applyPart({dtrRounding:C,currCode:S,dbnum:g,forceNeg:h,units:p,numShape:b},y,e,void 0);var E=r|(3!==v||zp(f)||Qp(f)?Vf.None:Vf.MaxChars);return Zf(Dp(p),c,t,E)}catch(t){if(t===$p){k("calc.numfmt.NumberFormatImpl: applyImpl restart",!er(e)&&0!==u.cond(e)),e=u.zero,d=!0;continue}if(t instanceof em)return Xf(t.reason,null===(i=f)||void 0===i?void 0:i.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var a,i,o,u,s,c=this,l=this.config,d=l.mathpack,f=l.datepack,v=l.localeInfo,p=function(){if(void 0!==s)return s;k("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!er(r));var t=c.config,n=t.date1904,a=t.dateCompatibility;if(!a&&d.cond(r)<0)throw new em(Wf);if(a&&!n&&d.cond(r)<0)throw new em(Wf);var i=f.fromNum(c.config,d.abs(r),e.dtrRounding);if(!1===i)throw new em(Wf);return k("calc.numfmt.NumberFormatImpl: components within range",i.yr>=0&&i.mon>=1&&i.mon<=12&&i.dom>=0&&i.dom<=31&&i.hour>=0&&i.hour<=23&&i.min>=0&&i.min<=59&&i.sec>=0&&i.sec<=59&&i.fracSec>=0&&i.wdy>=1&&i.wdy<=7),s=i},m=function(){if(void 0!==s)throw new tm(hr(["use of value after date component"]));return r},g=!1,S=e.numShape,C=e.units,b=0;b<t.length;b+=1){var E=t[b];switch(E.kind){case Pp.General:g=!0;var A=m();if(er(A))C.push(qf(A.value));else{var T=d.abs(A);if(d.cond(A)<0&&"0"===d.formatGeneral(v,T,1))throw new tm(hr(["potential LRestart in interval (-0.5,0)"]));var N=Yf(d.toNumber(T),v.decimalSeparator,!1,S,this.getNumShape(void 0,e.currCode));if(void 0!==e.dbnum){var R=Ap(d,N,255);if(!It(R))throw new tm(R.reason);k("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==R.value),C.push(qf(R.value));break}C.push(N)}break;case Jn.Text:var F=m();k("calc.numfmt.NumberFormatImpl: applyPart Text value",er(F)),C.push(qf(F.value));break;case Pp.Exp:case Jn.Slash:case 400:C.push(qf(E.formattedStr));break;case Jn.Star:C.push(zf(E.escaped));break;case Jn.Underscore:C.push(Jf(E.escaped));break;case Pp.StrLit:C.push(qf(E.escaped));break;case Jn.Percent:case Pp.Numeral:C.push(qf(E.formattedStr));break;case Pp.Currency:C.push(qf(v.currencySymbol));break;case Pp.CurrCode:void 0!==E.currCode.currencySymbol&&C.push(qf(E.currCode.currencySymbol));break;case 405:C.push(qf(v.dateSeparator));break;case 406:E.printAsTimeSep?C.push(qf(v.timeSeparator)):C.push(qf(E.formattedStr));break;case 403:var I=m();k("calc.numfmt.NumberFormatImpl: applyPart Num value",!er(I)),k("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var D=E.numDigLeft,w=E.numDigDec,M=2*(Y=E.numPercent)-3*(q=E.numThousands),_=d.formatFixed(I,M,w),O=_.mantissa,x=_.exponent;if(k("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==O.length||0===x),k("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",O.length<=x+w),d.cond(I)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===O.length)throw $p;this.applyPart(e,E.codeBefore,d.zero,void 0),this.applyPart(e,E.code,d.zero,{comma:E.comma,fractionDenom:!1,decimal:!1,digits:O,digitsExp:x,numDigLeft:D});break;case 402:var L=m();k("calc.numfmt.NumberFormatImpl: applyPart Exp value",!er(L)),k("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var P=E.numMantDigLeft,U=E.numMantDigDec,B=0===P&&0===U,G=d.formatScientific(L,P,U);O=G.mantissa,x=G.exponent;k("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==O.length||0===x||B);var V=zi(x,P);k("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",O.length<=V+U),this.applyPart(e,E.codeMant,d.zero,{comma:E.commaMant,fractionDenom:!1,decimal:!1,digits:O,digitsExp:V,numDigLeft:E.numMantDigLeft}),this.applyPart(e,E.codeBetween,d.zero,void 0);var H=""!==O||B?x-V:0;H<0?C.push(qf("-")):E.isNeg||C.push(qf("+"));var W=Ip(d,d.fromNumber(H));this.applyPart(e,E.codeExp,d.zero,{comma:E.commaMant,fractionDenom:!1,decimal:!1,digits:W,digitsExp:W.length,numDigLeft:E.numExpDigLeft});break;case 401:var K=m();k("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!er(K)),k("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var Y=E.numPercent,q=E.numThousands,J=E.numIntDigLeft,z=E.numNumerDig,Q=E.numDenomDig,X=E.commaInt,Z=E.denomValue,$=(M=2*Y-3*q,d.tenTo(M)),ee=rr($)?$:d.mul(d.abs(K),$);if(rr(ee))throw new tm(hr(["overflow on fraction exp adjust"]));var te=function(e){for(var t=e;t<C.length;t+=1){var r=C[t];r.kind===Hf.String&&(C[t]=Jf(r.str))}},re=E.anyZeroNumer,ne=void 0,ae=void 0,ie=void 0;if(void 0!==E.codeInt){var oe=d.trunc(ee),ue=d.sub(ee,oe);if(k("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",$t(ue)),ne=(a=this.formFraction(ue,Z,Q)).numer,ae=a.denom,k("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",d.cond2(ne,ae)<=0),0===d.cond2(ne,ae)){ne=d.zero;var se=d.add(oe,d.one);k("calc.numfmt.NumberFormatImpl: applyPart bumped error",$t(se)),oe=se}0!==d.cond(ne)&&(re=!0);var ce=Ip(d,oe),le={comma:X,fractionDenom:!1,decimal:!1,digits:ce,digitsExp:ce.length,numDigLeft:J},de=C.length;this.applyPart(e,E.codeInt,d.zero,le),ie=C.length,k("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==E.lastDigInt),0!==d.cond(oe)||!re||E.lastDigInt===Jn.Zero?this.applyPart(e,E.codeBetween1,d.zero,void 0):(E.lastDigInt!==Jn.Question&&(C.length=de),this.applyPart(e,E.codeBetween1,d.zero,void 0),te(de),E.firstDigNumer!==Jn.Question&&(C.length=de))}else{if(ne=(i=this.formFraction(ee,Z,Q)).numer,ae=i.denom,d.cond(K)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.cond(ne))throw $p;re=!0,ie=C.length}var fe=Ip(d,ne),ve={comma:!1,fractionDenom:!1,decimal:!1,digits:fe,digitsExp:fe.length,numDigLeft:z};this.applyPart(e,E.codeNumer,d.zero,ve),this.applyPart(e,E.codeBetween2,d.zero,void 0);var he=Ip(d,ae),pe={comma:!1,fractionDenom:!0,decimal:ve.decimal,digits:he,digitsExp:he.length,numDigLeft:Q};this.applyPart(e,E.codeDenom,d.zero,pe),re||(E.anyQuestionNumer||E.firstDigDenom===Jn.Question?te(ie):C.length=ie);break;case Jn.Decimal:k("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,C.push(qf(v.decimalSeparator));break;case Jn.Hash:case Jn.Zero:case Jn.Question:k("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var me=E.count;if(n.decimal||n.fractionDenom&&E.kind===Jn.Question){if(n.fractionDenom&&b!==t.length-1)throw new tm(hr(["left-align bug in denominator"]));if(n.digitsExp<0){var ge=pv(h("0",ye=j(me,-n.digitsExp)),S);C.push(qf(ge)),n.digitsExp+=ye,me-=ye}var Se=j(me,n.digits.length);ge=pv(n.digits.substring(0,Se),S);if(C.push(qf(ge)),n.digits=n.digits.substring(Se),me-=Se,E.kind!==Jn.Hash&&me>0){ge=pv(h("0",me),S);C.push(E.kind===Jn.Question?Jf(ge):qf(ge))}break}if(n.numDigLeft>n.digitsExp){var ye=j(me,n.numDigLeft-n.digitsExp);if(E.kind!==Jn.Hash){ge=pv(h("0",ye),S);n.comma&&(ge=gv(v,ge,n.numDigLeft-ye)),C.push(E.kind===Jn.Question?Jf(ge):qf(ge))}me-=ye,n.numDigLeft-=ye}else me+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,me);break;case Pp.PrefixDigTh:v.isThai&&(S=e.numShape=wr.Thai);break;case Pp.LatinDate:throw new tm(hr(["TokenKind.LatinDate"]));case Pp.BidiDate:throw new tm(hr(["TokenKind.BidiDate"]));case Jn.HourTh:throw new tm(hr(["PictureSingle.HourTh"]));case Jn.MinuteTh:throw new tm(hr(["PictureSingle.MinuteTh"]));case Jn.SecondTh:throw new tm(hr(["PictureSingle.SecondTh"]));case Jn.Hour:case Jn.Minute:case Jn.Second:if(E.isAbs){var Ce=m();k("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!er(Ce));var ke=f.toTime(this.config,d.abs(Ce),jp[E.kind],e.dtrRounding);if(!1===ke)throw new tm(hr(["absolute time overflow"]));C.push(qf(Rp(d,d.fromNumber(ke),E.count,S)))}else{var be=p(),Ee=void 0;E.kind===Jn.Minute?Ee=be.min:E.kind===Jn.Second?Ee=be.sec:(Ee=be.hour,E.isAMPM&&(Ee>12&&(Ee-=12),0===Ee&&(Ee=12))),C.push(qf(Rp(d,d.fromNumber(Ee),E.count,S)))}break;case Pp.AMPM:case Pp.AMPMFE:var Ae=p().hour<12;if((0===(null!=(u=null===(o=e.currCode)||void 0===o?void 0:o.culture)?u:0)||E.kind===Pp.AMPMFE)&&(E.kind===Pp.AMPMFE||v.isEastAsia||E.pictureKind===qn.AP2)){var Te=E.tokenStr.indexOf(Wp(v.pictureSingle,Jn.APDelim));Te<0&&(Te=E.tokenStr.length>>1),C.push(qf(Ae?E.tokenStr.substring(0,Te):E.tokenStr.substring(Te+1)));break}C.push(qf(v.ampmSymbols[Ae?0:1]));break;case 404:var Ne=p();k("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Ne.rounding>=E.rounding);var Re=Fp(d,d.fromNumber(Ne.fracSec),Ne.rounding,E.rounding,S);C.push(qf(v.decimalSeparator+Re));break;case Jn.Era:throw new tm(hr(["PictureSingle.Era"]));case Jn.EraYear:throw new tm(hr(["PictureSingle.EraYear"]));case Jn.YearTh:throw new tm(hr(["PictureSingle.YearTh"]));case Jn.EngYearTh:throw new tm(hr(["PictureSingle.EngYearTh"]));case Jn.ThYear:throw new tm(hr(["PictureSingle.ThYear"]));case Jn.MonthTh:throw new tm(hr(["PictureSingle.MonthTh"]));case Jn.DayTh:throw new tm(hr(["PictureSingle.DayTh"]));case Jn.Year:var Fe=p().yr;Ee=E.count>2?Fe:Fe%100;C.push(qf(Rp(d,d.fromNumber(Ee),E.count,S)));break;case Jn.Month:var Ie=p().mon;switch(E.count){case 1:case 2:C.push(qf(Rp(d,d.fromNumber(Ie),E.count,S)));break;case 3:C.push(qf(v.monthNameShort[Ie-1]));break;case 4:case 5:C.push(qf(v.monthNameLong[Ie-1].substring(0,5===E.count?1:void 0)))}break;case Jn.Day:case Jn.LocDay:if(E.count<3){var De=p().dom;C.push(qf(Rp(d,d.fromNumber(De),E.count,S)))}else{var we=p().wdy,Me=v.isEastAsia&&E.kind===Jn.Day?Aa():v;ge=3===E.count?Me.dayNameShort[we-1]:Me.dayNameLong[we-1];C.push(qf(ge))}break;default:return y("calc.numfmt.NumberFormatImpl: applyPart code",E)}}g&&m()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,a=e.units,i=e.numShape,o=r,u=j(o,t.digits.length),s=pv(t.digits.substring(0,u),i);if(t.comma&&(s=gv(n,s,t.numDigLeft-u)),a.push(qf(s)),t.digits=t.digits.substring(u),o-=u,t.digitsExp-=u,t.numDigLeft-=u,o>0){s=pv(h("0",o),i);t.comma&&(s=gv(n,s,t.numDigLeft-o)),a.push(qf(s)),t.digitsExp-=o,t.numDigLeft-=o}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var n=r,a=void 0;if(0===r){if(void 0===(a=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[0])throw new em(Of);if(0===this.parts[0].code.length)throw new tm(hr(['emulation of ";[COND]foo" bug']));if(void 0===(a=this.condNeg)){if(this.parts[2]===this.parts[0])return k("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===ae.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==a){var i=a.operator,o=a.operand;if(rr(t.sub(e,o)))throw new tm(hr(["overflow in condition check"]));if(sp(i,t.cond2(e,o)))switch(i){case ae.Eq:return{partKind:n,forceNeg:!1};case ae.Ne:case ae.Gt:case ae.Ge:return{partKind:n,forceNeg:!0};case ae.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case ae.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}}if(this.parts[2]===this.parts[0])throw new em(Of);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e,t){var r,n,a=null===(r=t)||void 0===r?void 0:r.numberShape;if(void 0!==a)return a;if(void 0===e)return wr.ASCII;switch(null===(n=t)||void 0===n?void 0:n.culture){case 2:a=xp[e];break;case 3:a=Op[e];break;case 4:a=Mp[e];break;case 5:a=_p[e]}return null!=a?a:wr.ASCII},e.prototype.formFraction=function(e,t,r){var n,a,i,o=this.config.mathpack;if(void 0!==t){var u=o.fromNumber(137438953472);if(rr(o.sub(e,u)))throw new tm(hr(["overflow in fraction threshold check"]));if(o.cond2(e,u)<0){var s=o.mul(e,o.fromNumber(1.0000000000000002));k("calc.numfmt.NumberFormatImpl: formFraction nudged error",$t(s)),e=s}var c=t,l=o.toNumber(c)<<1,d=o.mul(e,o.fromNumber(l));if(!$t(d))throw new tm(hr(["overflow in fraction denom mul"]));var f=o.lfix(d);if(f<0||f>=65535)throw new em(jf);return{numer:o.fromNumber(f+1>>1),denom:c}}switch(r){case 1:i=10;break;case 2:i=100;break;case 3:i=1e3;break;case 4:i=1e4;break;case 5:i=1e5;break;case 6:i=1e6;break;default:i=1e7}var v=o.fix(e);if(v>=2147483647)throw new em(jf);for(var h=e,p=1,m=1,g=0,S=0;;){var y=p*v;S+=y;var C=g*v;if(m+=C,y>2147483647||C>2147483647||m>=i){1===g&&2===v&&0===o.cond2(h,o.trunc(h))&&(p+=1);break}p=(n=[S,p])[0],S=n[1],g=(a=[m,g])[0],m=a[1];var b=o.sub(h,o.trunc(h));if(k("calc.numfmt.NumberFormatImpl: formFraction frac sub",$t(b)),0===o.cond(b))break;var E=o.div(o.one,b);if(rr(E))throw new tm(hr(["overflow in fraction inversion"]));if(h=E,(v=o.fix(h))>2147483647)break}return 0===g&&(g=p=1),{numer:o.fromNumber(p),denom:o.fromNumber(g)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=[],a=function(e){var a=i.parts[e];if((1===e||2===e)&&a===i.parts[0])return n.push(n[0]),"continue";if(3===e)return n.push(a===i.parts[0]?n[0]:a),"continue";var o=a.code,u=a.color,s=a.dbnum,c=a.dtrRounding,l=a.currCode,d={code:o.map((function(n){if(403===n.kind){var a=n.numDigLeft,i=n.numPercent,o=n.numThousands,u=n.comma,s=n.codeBefore;return{kind:403,numDigLeft:a,numDigDec:t,numPercent:i,numThousands:o,comma:u,code:r.adjustDecimals(e,n.numDigDec,n.code,t),codeBefore:s}}if(402===n.kind){var c=n.isNeg,l=n.numMantDigLeft,d=n.numExpDigLeft,f=n.commaMant,v=n.codeBetween,h=n.codeExp;return{kind:402,isNeg:c,numMantDigLeft:l,numMantDigDec:t,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,n.numMantDigDec,n.codeMant,t),codeBetween:v,codeExp:h}}return n})),color:u,dbnum:s,dtrRounding:c,currCode:l};n.push(d)},i=this,o=0;o<=3;o+=1)a(o);return new e(this.config,{old:this,synth:n})},e.prototype.adjustDecimals=function(e,t,r,n){var a;if(n===t)return r;for(var i=!1,o=void 0,u=void 0,s=void 0,c=0;c<r.length;c+=1){switch((S=r[c]).kind){case Jn.Decimal:void 0===s&&(s=c);break;case Jn.Hash:case Jn.Question:case Jn.Zero:void 0!==s?u=c:(o=c,S.kind===Jn.Question&&(i=!0))}}var l=function(e){return e===Jn.Percent||e===Pp.Currency||e===Pp.CurrCode||e===Jn.Star};if(0===n){if(void 0===s)return r;var d=0,f=0;void 0===o?void 0!==u&&(d=s+1,f=u+1):(d=s,f=(null!=u?u:s)+1);var v=r.slice(0,d);for(c=d;c<f;c+=1)l(r[c].kind)&&v.push(r[c]);return B(v,r.slice(f)),v}if(t>n){k("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==s);var h=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(h||(h={}));var p=h.AfterDigs,m=[],g=t-n;for(c=r.length-1;c>=0;c-=1){c<=s&&(p=h.Keeping);var S=r[c];if(p===h.AfterDigs&&(S.kind!==Jn.Hash&&S.kind!==Jn.Question&&S.kind!==Jn.Zero||(p=h.Dropping)),p===h.Keeping||p===h.AfterDigs||l(S.kind))m.push(S);else if(S.kind===Jn.Hash||S.kind===Jn.Question||S.kind===Jn.Zero){var y=j(g,S.count);y<S.count&&m.push({kind:S.kind,count:S.count-y}),0===(g-=y)&&(p=h.Keeping)}}return m.reverse(),m}if(2===e&&i&&void 0===u)return r;var C=n-t;if(void 0!==u){var b=r.slice();S=b[u];return b[u]={kind:S.kind,count:S.count+C},b}var E=r.slice(),A=null!=(a=null!=s?s:o)?a:E.length-1,T=[];return void 0===s&&T.push({kind:Jn.Decimal}),T.push({kind:Jn.Zero,count:C}),E.splice.apply(E,M([A+1,0],T)),E},e.prototype.parseString=function(e){if(e.length>80)throw new rm(hr(["long format string"]));for(var t=!1,r=!1,n=0,a=!1,i=0;i<=3&&!a;i+=1){var o=this.tokenize(e.substring(n)),u=o.cond,s=o.color,c=o.dbnum,l=this.convertTokToSun(o),d=l.dtrRounding,f=l.currCode,v=l.hasPercent,h=l.hasDate,p=l.hasTime,m=this.classifySunPartKind(l,3===i?3:0),g={code:this.convertSunToCode(l),color:s,dbnum:c,dtrRounding:d,currCode:f};if(n+=o.consumed,a=o.eos,v&&(this.hasPercent=!0),h&&(this.hasDate=!0),p&&(this.hasTime=!0),(3===m||0===i&&1===m)&&(t=!0,this.parts[3]=g,3===m)){if(void 0!==u)throw new rm(_f("condition in text part"));break}if(r=!0,this.parts[i]=g,this.onlyOneNumberPart=0===i,0===i)this.parts[1]=g,this.parts[2]=g,this.condPos=u;else if(1===i)this.condNeg=u;else if(void 0!==u)throw new rm(_f("condition in zero part"))}if(!a)throw new rm(_f("too many parts"));r||(this.parts[0]=Jp,this.parts[1]=Jp,this.parts[2]=Jp,this.posBeforeText=!1),t||(this.parts[3]=Jp),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!qp(this.parts[0].code)&&(this.parts[1]=Jp,this.onlyOneNumberPart=!1),k("calc.numfmt.NumberFormatImpl.parseString",this.parts.every((function(e){return void 0!==e})))},e.prototype.tokenize=function(e){for(var t,r,n=this.config.localeInfo,a={color:void 0,dbnum:void 0,cond:void 0,currCode:void 0,tokens:[],consumed:0,eos:!0};a.consumed<e.length&&a.eos;){var i=this.readToken(a,e,a.consumed),o=r;switch(r=i,a.consumed+=i.tokenStr.length,i.kind){case Jn.Sep:a.eos=!1;continue;case Pp.Color:if(void 0!==a.color)throw new rm(_f("more than one color"));if(0!==a.tokens.length)throw new rm(hr(["colour in middle of format"]));a.color=i.color;continue;case Pp.Dbnum:if(void 0!==a.dbnum)throw new rm(_f("more than one DBNUM"));if(0!==a.tokens.length)throw new rm(hr(["DBNUM in middle of format"]));a.dbnum=i.dbnum;continue;case Pp.Cond:if(void 0!==a.cond)throw new rm(_f("more than one condition"));if(0!==a.tokens.length)throw new rm(hr(["condition in middle of format"]));a.cond=i.cond;continue;case Pp.CurrCode:if(void 0!==a.currCode)throw new rm(_f("more than one currency code"));a.currCode=i.currCode;break;case Pp.AMPM:case Pp.AMPMFE:case Jn.Colon:case Jn.DateSep:case Pp.LatinDate:case Pp.BidiDate:case Jn.Year:case Jn.Month:case Jn.Day:case Jn.Hour:case Jn.Minute:case Jn.Second:case Jn.Reign:case Jn.LocDay:case Jn.Era:case Jn.EraYear:case Jn.EngYearTh:case Jn.DayTh:case Jn.MonthTh:case Jn.YearTh:case Jn.ThYear:case Jn.HourTh:case Jn.MinuteTh:case Jn.SecondTh:if((null===(t=o)||void 0===t?void 0:t.kind)===i.kind){o.count+=i.count;continue}}a.tokens.push(i)}return 4!==a.dbnum||n.isKorea||void 0===a.currCode&&!n.isThai||(a.dbnum=void 0),a},e.prototype.readToken=function(e,t,r){var n=this.config,a=n.mathpack,i=n.localeInfo,o=Vp(i,i.pictureSpecial,t,r);if(void 0!==o){var u=o,s=Wp(i.pictureSpecial,u);i.isJapan&&u===qn.GeneralOldMAC&&(u=qn.General);var c=t.substring(r,r+s.length);switch(u){case qn.AP1:case qn.AP2:return{kind:Pp.AMPM,tokenStr:c,count:1,pictureKind:u};case qn.AP3:return{kind:Pp.AMPMFE,tokenStr:c,count:1};case qn.General:return{kind:Pp.General,tokenStr:c};case qn.Currency:return{kind:Pp.Currency,tokenStr:c}}}var l,d=xa(t,r),f=La(d),h=t.substring(r,r+f),p=Hp(i,i.pictureSingle,t,r);if(void 0!==p){u=p;if((i.isJapan||i.isChinaT)&&(u===Jn.E||u===Jn.EraYear)){var m=void 0,g=void 0;u=!(r+f+1<t.length)||45!==(m=t.charCodeAt(r+f))&&43!==m||48!==(g=t.charCodeAt(r+f+1))&&35!==g&&46!==g?Jn.EraYear:Jn.E}if(u===Jn.BidiDate||u===Jn.EngYearTh){m=void 0;if(r+f<t.length&&(49===(m=t.charCodeAt(r+f))||50===m))return{kind:49===m?Pp.LatinDate:Pp.BidiDate,tokenStr:t.substring(r,r+f+1),count:1};u=Jn.EngYearTh}if(u===Jn.BidiNum)throw new rm(_f("bidi num not allowed"));switch(u){case Jn.Star:case Jn.Underscore:if(r+f>=t.length)throw new rm(_f("unterminated "+h));var S=La(m=xa(t,r+f)),C=Ma(m);return{kind:u,tokenStr:c=t.substring(r,r+f+S),escaped:C};case Jn.Backslash:return this.readToken_Backslash(t,r,f);case Jn.Quote:var k=t.indexOf(h,r+f);if(k<0)throw new rm(_f("unterminated quoted string"));var b=t.substring(r+f,k),E=(c=t.substring(r,k+f),Vp(i,i.pictureSpecial,b,0));return void 0!==E&&E===qn.Currency&&Wp(i.pictureSpecial,E).length===b.length?{kind:Pp.Currency,tokenStr:c}:{kind:Pp.StrLit,tokenStr:c,escaped:b};case Jn.E:if(i.isEastAsia){if(void 0!==e.dbnum)throw new rm(_f("invalid DBNUM with exp"));e.dbnum=1}if(r+f>=t.length)throw new rm(_f("unterminated exp"));if(43!==(m=t.charCodeAt(r+f))&&45!==m)throw new rm(_f("exp not followed by sign"));c=t.substring(r,r+f+1);return{kind:Pp.Exp,tokenStr:c,eStr:h,isNeg:45===m};case Jn.Hash:case Jn.Year:case Jn.Month:case Jn.Day:case Jn.Hour:case Jn.Minute:case Jn.Second:case Jn.YearTh:case Jn.MonthTh:case Jn.DayTh:case Jn.HourTh:case Jn.MinuteTh:case Jn.SecondTh:case Jn.EngYearTh:case Jn.ThYear:case Jn.Question:case Jn.Comma:case Jn.Reign:case Jn.LocDay:case Jn.Era:case Jn.EraYear:if(u===Jn.Reign&&!i.isJapan&&!i.isChinaT)break;for(var A=f,T=1;v(t,h,r+A)&&void 0===Vp(i,i.pictureSpecial,t,r+A);)A+=f,T+=1;if(u===Jn.LocDay&&T<3)break;return{kind:u,tokenStr:c=t.substring(r,r+A),count:T};case Jn.Sep:case Jn.Text:case Jn.Decimal:case Jn.Slash:case Jn.Minus:case Jn.Plus:return{kind:u,tokenStr:h};case Jn.Space:return{kind:Pp.Char,tokenStr:h,escaped:h};case Jn.Colon:return{kind:u,tokenStr:h,count:1};case Jn.Percent:if(i.isEastAsia){if(void 0!==e.dbnum)throw new rm(_f("invalid DBNUM with pct"));e.dbnum=1}return{kind:Jn.Percent,tokenStr:h};case Jn.DateSep:return h===Wp(i.pictureSingle,Jn.Slash)?{kind:Jn.Slash,tokenStr:h}:h===Wp(i.pictureSingle,Jn.Minus)?{kind:Jn.Minus,tokenStr:h}:{kind:Jn.DateSep,tokenStr:h,count:1};case Jn.ColorStart:var N=Wp(i.pictureSingle,Jn.ColorEnd),R=t.indexOf(N,r+f);if(R<0)throw new rm(_f("unterminated ["));var F=t.substring(r+f,R),I=(c=t.substring(r,R+N.length),Vp(i,Up,F,0));if(void 0!==I){for(var D=Wp(Up,I).length;D<F.length&&Pa(F.charCodeAt(D));)D+=1;var w=function(e,t,r,n,a){var i,o=n,u=!1;if(o<r.length){var s=r.charCodeAt(o);if((43===s||45===s)&&(u=45===s,o+=1,a))for(;o<r.length&&Pa(r.charCodeAt(o));)o+=1}var c=Ga(e,t,r,o,!1,!1,!1);return void 0===(null===(i=c)||void 0===i?void 0:i.value)?[t.zero,n]:(o=c.i,[u?t.neg(c.value):c.value,o])}(i,a,F,D,!1);if(w[1]===D)throw new rm(hr(["invalid number in condition"]));if(w[1]!==F.length)throw new rm(hr(["trailing junk after condition"]));return{kind:Pp.Cond,tokenStr:c,cond:{operator:Bp[I],operand:w[0]}}}var M=Vp(i,i.pictureColor,F,0);if(void 0!==M){var _=Wp(i.pictureColor,M);if(M!==zn.Color){if(_.length!==F.length)throw new rm(hr(["trailing junk after named color"]));return{kind:Pp.Color,tokenStr:c,color:(l=M,zn[l])}}if(M===zn.Color){for(var O=_.length;O<F.length&&Pa(F.charCodeAt(O));)O+=1;var x=Ua(i,4,F,O),L=x[0],P=x[1];if(P===O)throw new rm(_f("missing number for numbered color"));if(P!==F.length)throw new rm(hr(["trailing junk after numbered color"]));if(L<1||L>56)throw new rm(_f("out-of-range numbered color"));return{kind:Pp.Color,tokenStr:c,color:L+8}}}var U=Vp(i,i.pictureDbnum,F,0);if(void 0!==U){if(Wp(i.pictureDbnum,U).length!==F.length)throw new rm(hr(["trailing junk after DBNUM"]));return{kind:Pp.Dbnum,tokenStr:c,dbnum:Lp(U)}}return v(F,"$")?{kind:Pp.CurrCode,tokenStr:c,currCode:this.parseCurrCode(F.substring(1))}:{kind:u,tokenStr:h};case Jn.ColorEnd:return{kind:u,tokenStr:h};case Jn.OpenParen:case Jn.CloseParen:return{kind:u,tokenStr:h,escaped:h};case Jn.Extra:case Jn.APDelim:case Jn.Nen1:case Jn.Gatsu1:case Jn.Nichi1:case Jn.Nen2:case Jn.Gatsu2:case Jn.Nichi2:break;case Jn.Zero:case Jn.ZeroTh:break;default:return y("calc.numfmt.NumberFormatImpl: readToken single picKind",u)}}if(i.isNumeral(d)){if(i.getNumberShape(d)!==wr.ASCII)throw new rm(hr(["non-ASCII digits"]));var B=i.getOrdinal(d);if(0===B){var G=f;for(T=1;v(t,h,r+G);)G+=f,T+=1;c=t.substring(r,r+G);return{kind:Jn.Zero,tokenStr:c,count:T}}return{kind:Pp.Numeral,tokenStr:h,ordinal:B}}switch(d){case 40:return{kind:Jn.OpenParen,tokenStr:h,escaped:h};case 41:return{kind:Jn.CloseParen,tokenStr:h,escaped:h};case 92:return this.readToken_Backslash(t,r,f);case 116:if(i.isThai)return{kind:Pp.PrefixDigTh,tokenStr:h}}return{kind:Pp.Char,tokenStr:h,escaped:h}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new rm(_f("unterminated backslash"));var n=xa(e,t+r),a=La(n),i=Ma(n),o=e.substring(t,t+r+a);return 40===n||41===n?{kind:40===n?Jn.OpenParen:Jn.CloseParen,tokenStr:o,escaped:i}:{kind:Pp.Char,tokenStr:o,escaped:i}},e.prototype.convertTokToSun=function(e){var t,r,n,a,i,o,u,s,c=e.color,l=e.dbnum,d=e.cond,f=e.currCode,v=e.tokens,h=this.config.localeInfo,p={suns:[],dtrRounding:Sn.RoundSec,dbnum:l,currCode:f,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===d&&void 0===c&&void 0===l&&void 0===f}},m=0===h.stringCompareCI(Wp(h.pictureSingle,Jn.Month),Wp(h.pictureSingle,Jn.Minute)),g=!1,S=0,C=0,b=!1,E=!1,A=!1,T=!1,N=0;function R(e,t){var r=jp[e];if(t){if(E)throw new rm(_f("more than one absolute time"));if(void 0!==n&&r>=n)throw new rm(_f("absolute time must be largest division"));E=!0}else if(E&&r<=n)throw new rm(hr(["larger time division after absolute time"]));(void 0===n||r<n)&&(n=r)}function F(e,t,r){var a=n;if(R(e,t),e===Jn.Hour||e===Jn.HourTh)A=!0,o=r,u=void 0;else if(e===Jn.Second||e===Jn.SecondTh)if(void 0===u||E)void 0===a&&(A=!0);else{var i=u.code[0];k("calc.numfmt.NumberFormatImpl: onTime ambigCode",i.kind===Jn.Month);var s=Jn.Minute,c=i.count;k("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===c||2===c);R(s,!1),S-=1,C+=1,u.code=[{kind:s,count:c,isAbs:!1}],u=void 0}else A=!1}function I(e){var t=Wp(h.pictureSingle,e.kind);return{kind:406,printAsTimeSep:S>0||C>0,formattedStr:t}}function D(e){var t=Wp(h.pictureSingle,e.kind);return t===Wp(h.pictureSingle,Jn.DateSep)?{kind:405}:t===Wp(h.pictureSingle,Jn.Colon)?I(e):{kind:400,formattedStr:t}}for(var w=0;w<v.length;w+=1){var M=v[w];switch(M.kind){case Pp.AMPM:case Pp.AMPMFE:case Jn.Colon:case Jn.DateSep:case Jn.Year:case Jn.Month:case Jn.Day:case Jn.Hour:case Jn.Minute:case Jn.Second:case Jn.Reign:case Jn.LocDay:case Jn.Era:case Jn.EraYear:case Jn.EngYearTh:case Pp.LatinDate:case Pp.BidiDate:case Jn.DayTh:case Jn.MonthTh:case Jn.YearTh:case Jn.ThYear:case Jn.HourTh:case Jn.MinuteTh:case Jn.SecondTh:var _={kind:1,code:[]};switch(p.suns.push(_),b=!0,M.kind){case Pp.LatinDate:case Pp.BidiDate:if(0!==w)throw new rm(_f("bidi date must be first"));_.code.push(M);break;case Jn.DateSep:_.code.push({kind:405});break;case Jn.Colon:_.code.push(I(M));break;case Jn.Reign:S+=1,h.isJapan&&M.count>=2&&_.code.push({kind:Jn.Era,count:3}),_.code.push({kind:Jn.EraYear,count:h.isChinaT?1:2});break;case Jn.Era:S+=1,_.code.push({kind:Jn.Era,count:j(3,M.count)});break;case Jn.EraYear:S+=1,_.code.push({kind:Jn.EraYear,count:j(2,M.count)});break;case Jn.Year:case Jn.YearTh:case Jn.EngYearTh:case Jn.ThYear:u=void 0,S+=1,_.code.push({kind:M.kind,count:M.count<=2?2:4});break;case Jn.Month:if(m&&M.count<=2){if(A){F(X=Jn.Minute,O=!1,_),C+=1,_.code.push({kind:X,count:M.count,isAbs:O}),A=!1;break}u=_}else u=void 0;S+=1,_.code.push({kind:M.kind,count:j(5,M.count)});break;case Jn.MonthTh:S+=1,_.code.push({kind:M.kind,count:j(4,M.count)});break;case Jn.Day:case Jn.DayTh:u=void 0,S+=1,_.code.push({kind:M.kind,count:j(4,M.count)});break;case Jn.LocDay:u=void 0,S+=1,_.code.push({kind:Jn.LocDay,count:3===M.count?3:4});break;case Jn.Hour:case Jn.HourTh:case Jn.Minute:case Jn.MinuteTh:case Jn.Second:case Jn.SecondTh:var O=!1;F(M.kind,O,_),C+=1;var x=j(2,M.count);M.kind===Jn.Hour||M.kind===Jn.HourTh?_.code.push({kind:M.kind,count:x,isAbs:O,isAMPM:!1}):_.code.push({kind:M.kind,count:x,isAbs:O});break;case Pp.AMPM:case Pp.AMPMFE:if(E)throw new rm(_f("AM/PM after absolute time"));if(M.count>1)throw new rm(hr(["multiple AM/PM symbols"]));if(void 0!==o)(W=o.code[0]).isAMPM=!0,o=void 0;T=!0,_.code.push(M);break;default:return y("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",M)}break;case Jn.Decimal:case Pp.Numeral:case Jn.Hash:case Jn.Zero:case Jn.Question:case Jn.Comma:if(b){if(M.kind!==Jn.Decimal&&M.kind!==Jn.Comma)throw new rm(_f("number picture in date/time format"));var L={kind:1,code:[]};p.suns.push(L);var P=v[w+1];if(M.kind===Jn.Decimal&&(null===(t=P)||void 0===t?void 0:t.kind)===Jn.Zero){var U=P.count;if(U>3)throw new rm(_f("invalid number of fractional seconds"));w+=1,F(Jn.Second,!1,L),C+=1,L.code.push({kind:404,rounding:U}),p.dtrRounding=K(p.dtrRounding,U)}else L.code.push(D(M));break}if(M.kind===Jn.Comma){var B={kind:7,code:[{kind:400,formattedStr:Wp(h.pictureSingle,M.kind)}]};p.suns.push(B);break}_={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};p.suns.push(_),void 0===a&&(a=_),i=_;var G=void 0;for(w-=1;w+1<v.length;w+=1){var V=v[w+1],H=!0;switch(V.kind){case Jn.Decimal:g=_.decimal=!0,_.code.push(V),G=void 0;break;case Pp.Numeral:_.code.push({kind:V.kind,formattedStr:V.tokenStr,ordinal:V.ordinal}),_.numVal=_.nonZero=!0,G=void 0;break;case Jn.Hash:case Jn.Zero:case Jn.Question:if(_.decimal?_.numDigDec+=V.count:_.numDigLeft+=V.count,void 0===_.firstDig&&(_.firstDig=V.kind),_.lastDig=V.kind,V.kind===Jn.Hash?_.anyHash=!0:V.kind===Jn.Question?_.anyQuestion=!0:(_.anyZero=!0,_.numVal=!0),void 0!==G&&G.kind===V.kind)G.count+=V.count;else{var W={kind:V.kind,count:V.count};_.code.push(W),G=W}break;case Jn.Comma:P=null===(r=v[w+2])||void 0===r?void 0:r.kind;if((s=P)!==Pp.Numeral&&s!==Jn.Hash&&s!==Jn.Zero&&s!==Jn.Question){x=V.count;var Y=Wp(h.pictureSingle,Jn.Space);Y===Wp(h.pictureSingle,Jn.Comma)&&(!h.isCurrencySymbolLead&&h.isCurrencySepBySpace&&P===Pp.Currency||h.isPercentSepBySpace&&P===Jn.Percent)&&(_.code.push({kind:400,formattedStr:Y}),x-=1),x>0&&(_.numThousands+=x)}else g||(_.comma=!0);break;default:H=!1}if(!H)break}break;case Jn.Percent:N+=1;_={kind:3,code:[{kind:Jn.Percent,formattedStr:M.tokenStr}]};p.suns.push(_),p.hasPercent=!0;break;case Pp.Exp:_={kind:4,code:[{kind:Pp.Exp,formattedStr:M.eStr,isNeg:M.isNeg}],isNeg:M.isNeg};p.suns.push(_);break;case Pp.General:_={kind:6,code:[M]};p.suns.push(_);break;case Jn.Star:case Pp.PrefixDigTh:case Jn.Underscore:case Pp.Currency:case Pp.CurrCode:_={kind:7,code:[M]};p.suns.push(_);break;case Jn.Text:_={kind:5,code:[M]};p.suns.push(_);break;case Pp.StrLit:_={kind:7,code:[M]};p.suns.push(_);break;case Jn.ColorEnd:case Jn.Plus:_={kind:7,code:[{kind:400,formattedStr:M.tokenStr}]};p.suns.push(_);break;case Jn.OpenParen:case Jn.CloseParen:case Pp.Char:_={kind:7,code:[{kind:400,formattedStr:M.escaped}]};p.suns.push(_);break;case Jn.Slash:if(b){var q={kind:1,code:[D(M)]};p.suns.push(q);break}_={kind:2,code:[{kind:Jn.Slash,formattedStr:M.tokenStr}]};p.suns.push(_);break;case Jn.Minus:if(b){var J={kind:1,code:[D(M)]};p.suns.push(J);break}_={kind:7,code:[{kind:400,formattedStr:Wp(h.pictureSingle,M.kind)}]};p.suns.push(_);break;case Jn.ColorStart:var z=0;for(_={kind:1,code:[]};w+1<v.length&&2!==z;w+=1){var Q=v[w+1];switch(Q.kind){case Jn.ColorEnd:if(1!==z)throw new rm(_f("unexpected closing ]"));z=2;continue;case Jn.Hour:case Jn.Month:case Jn.Minute:case Jn.Second:if(Q.kind===Jn.Month&&!m)break;var X;F(X=Q.kind===Jn.Month?Jn.Minute:Q.kind,O=!0,_),C+=1;x=j(2,Q.count);X===Jn.Hour?_.code.push({kind:X,count:x,isAbs:O,isAMPM:!1}):_.code.push({kind:X,count:x,isAbs:O}),b=!0,z=1;continue;case Pp.Char:if(Q.tokenStr===Wp(h.pictureSingle,Jn.Space))continue;break;case Jn.HourTh:throw new rm(hr(["Thai hour in ["]))}throw new rm(_f("unexpected token after ["))}if(2!==z)throw new rm(hr(["semicolon inside [ ]"]));p.suns.push(_);break;default:return y("calc.numfmt.NumberFormatImpl: convertTokToSun tok",M)}}(void 0!==a&&(a.numThousands=i.numThousands,a.numPercent=N),T&&void 0!==o)&&((W=o.code[0]).isAMPM=!0);if(E)for(var Z=0,$=p.suns;Z<$.length;Z++){if(1===(_=$[Z]).kind)for(var ee=0,te=_.code;ee<te.length;ee++){switch((W=te[ee]).kind){case Jn.Hour:case Jn.HourTh:case Jn.Minute:case Jn.MinuteTh:case Jn.Second:case Jn.SecondTh:W.isAbs=jp[W.kind]===n}}}return p.hasDate=S>0,p.hasTime=C>0,p},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,a=e.hasDate,i=e.hasTime,o=2===t,u=3===t,s=!o&&!u,c=0,l=r;c<l.length;c++){var d=l[c];switch(d.kind){case 0:case 2:case 3:case 4:o=!0;break;case 5:u=!0;break;case 6:continue;case 7:case 1:break;default:return y("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}s=!1}if((o?1:0)+(a||i?1:0)+(u?1:0)>1)throw new rm(_f("cannot mix number/date/text"));return o||a||i?2:u?3:s&&!n?1:t},e.prototype.convertSunToCode=function(e){var t,r=e.suns,n=e.isEmpty,a=e.dbnum,i=this.config.localeInfo,o=[];function u(e){for(var t=e-1;t>=0;t-=1){var n=r[t];if(0===n.kind)return[t,n]}}function s(e){for(var t=e+1;t<r.length;t+=1){var n=r[t];if(0===n.kind)return[t,n]}}for(var c=!1,l=0,d=0;d<r.length;d+=1){var f=r[d];switch(f.kind){case 5:if(5===t)break;if(void 0!==t)throw new rm(_f("@ after other control"));t=5;break;case 6:if(void 0!==t)throw new rm(_f("General after other control"));if(c)throw new rm(_f("General after number"));t=6;break;case 0:if(c=!0,6===t)throw new rm(_f("number after General"));break;case 2:if(void 0!==t)throw new rm(_f("/ after other control"));if(i.isEastAsia&&void 0!==a)throw new rm(_f("/ not allowed with DBNUM"));t=2;var v=u(d);if(void 0===v)throw new rm(_f("no number before /"));var h=this.mergeNumSuns(r,l,v[0]),p=h[0],m=h[1],g=h[2],S=s(d);if(void 0===S)throw new rm(_f("no number after /"));var C=r.slice(v[0]+1,S[0]),k=void 0!==s(S[0]);B(o,this.flattenSuns(p)),B(o,this.buildFractCode(m,g,v[1],C,S[1],k)),l=S[0]+1;break;case 4:if(void 0!==t)throw new rm(_f("E after other control"));t=4;var b=this.mergeNumSuns(r,l,d),E=b[0],A=b[1],T=b[2];if(void 0===A)throw new rm(_f("no number before E"));var N=this.mergeNumSuns(r,d+1,r.length),R=N[0],F=N[1],I=N[2];if(void 0===F)throw new rm(_f("no number after E"));B(o,this.flattenSuns(E)),B(o,this.buildExpCode(f.isNeg,A,M(T,[r[d]],R),F)),B(o,this.flattenSuns(I)),l=r.length;break;case 3:case 7:case 1:break;default:return y("calc.numfmt.NumberFormatImpl: convertSunToCode sun",f)}}if(void 0===t){var D=this.mergeNumSuns(r,l,r.length),w=(p=D[0],D[1]),_=D[2];B(o,void 0!==w?this.buildNumberCode(p,w):this.flattenSuns(p)),B(o,this.flattenSuns(_)),l=r.length}return B(o,this.flattenSuns(r.slice(l))),0!==r.length||n||o.push(Yp),o},e.prototype.flattenSuns=function(e){return G([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new rm(_f("comma following E"));var a=this.bumpDigitsForComma(t),i=a.code,o=a.comma;return[{kind:402,isNeg:e,numMantDigLeft:a.numDigLeft,numMantDigDec:t.numDigDec,numExpDigLeft:n.numDigLeft,commaMant:o,codeMant:i,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=this.bumpDigitsForComma(t),n=r.code,a=r.comma;return[{kind:403,numDigLeft:r.numDigLeft,numDigDec:t.numDigDec,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:n}]},e.prototype.buildFractCode=function(e,t,r,n,a,i){var o,u,s,c,l,d,f=this.config.mathpack;if(r.comma)throw new rm(_f("comma in numerator"));if(r.decimal)throw new rm(hr(["decimals in numerator"]));if(a.comma)throw new rm(_f("comma in denominator"));if(a.decimal)throw new rm(_f("decimals in denominator"));if(0!==r.numDigDec)throw new rm(_f("decimals in numerator"));if((d=a).numVal&&d.nonZero&&d.digitTokens)throw new rm(_f("literal and placeholder digits mixed in denominator"));if(i)throw new rm(hr(["fraction number formats with trailing numbers"]));var v,h=!1,p=0;if(void 0!==e){if(!e.reallyNum)throw new rm(hr(["fixed numerals in fraction integer part"]));if(e.decimal)throw new rm(hr(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new rm(_f("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new rm(hr(["numerals in fraction integer part"]));v=(o=this.bumpDigitsForComma(e)).code,h=o.comma,p=o.numDigLeft}var m=null!=(s=null===(u=e)||void 0===u?void 0:u.numPercent)?s:r.numPercent,g=null!=(l=null===(c=e)||void 0===c?void 0:c.numThousands)?l:r.numThousands;if(g>0)throw new rm(hr(["fraction number formats with thousands"]));var S,y=a.code,k=a.numDigLeft,b=a.firstDig;if(a.numVal&&a.nonZero){if(i)throw new rm(hr(["fraction number formats with specified denominator and trailing numbers"]));if(a.code.length>5)throw new rm(hr(["too many digits in denominator"]));for(var E=0,A=0;A<a.code.length;A+=1){var T=a.code[A];switch(T.kind){case Pp.Numeral:E=10*E+T.ordinal;break;case Jn.Zero:if(0===A)throw new rm(hr(["leading zero in denominator"]));E*=10;break;default:return C("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(E>32767)throw new rm(hr(["overflow in denominator not emulated"]));y=[{kind:Jn.Hash,count:1}],k=1,b=void 0,S=f.fromNumber(E)}return[{kind:401,numIntDigLeft:p,numPercent:m,numThousands:g,numNumerDig:r.numDigLeft,numDenomDig:k,commaInt:h,codeInt:v,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:y,denomValue:S,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:b,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,a=[],i=[],o=t;o<e.length&&o<r;o+=1){var u=e[o];void 0!==n?0===u.kind?(n.decimal?n.numDigDec+=u.numDigLeft+u.numDigDec:(n.numDigLeft+=u.numDigLeft,n.numDigDec+=u.numDigDec),n.comma=n.comma||u.comma,n.decimal=n.decimal||u.decimal,n.numVal=n.numVal||u.numVal,n.nonZero=n.nonZero||u.nonZero,void 0!==u.lastDig&&(n.lastDig=u.lastDig),void 0===n.firstDig&&(n.firstDig=u.firstDig),n.anyHash=n.anyHash||u.anyHash,n.anyQuestion=n.anyQuestion||u.anyQuestion,n.anyZero=n.anyZero||u.anyZero,B(n.code,this.flattenSuns(i)),i.length=0,B(n.code,u.code)):i.push(u):0===u.kind?n=u:a.push(u)}return[a,n,i]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var a=e.code[n];switch(a.kind){case Jn.Hash:return(i=e.code.slice())[n]=F(F({},a),{count:a.count+(r-e.numDigLeft)}),{code:i,comma:!0,numDigLeft:r};case Jn.Zero:case Jn.Question:case Jn.Decimal:var i;return(i=e.code.slice()).splice(n,0,{kind:Jn.Hash,count:r-e.numDigLeft}),{code:i,comma:!0,numDigLeft:r}}}throw new rm(hr(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t,r=null===(t=e)||void 0===t?void 0:t.kind;return r===Jn.Hash||r===Jn.Zero||r===Jn.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var a=e.code[n];if(a.kind===Jn.Decimal)return!1;if(t(a))for(var i=0;i<a.count;i+=1)if((r-=1)>0&&r%3==0&&(i+1<a.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){throw new rm(hr(["parsing of CurrCode"]))},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var a=n[r];t.accountFill=!1;var i=this.determineValueTypeCodes(t,a.code);if(void 0!==i)return i;if(t.accountFill&&(t.fvt===Lf.Number||t.fvt===Lf.Currency))return Lf.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===Wp(e.pictureSpecial,qn.General)?Lf.General:Lf.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var a=t[n];switch(a.kind){case Pp.General:break;case Jn.Text:return Lf.Text;case Jn.Star:e.accountFill=!0;break;case 400:case Pp.Exp:case Jn.Slash:case Pp.StrLit:case Jn.Percent:case Jn.Underscore:case Pp.Numeral:case 405:case 406:break;case Pp.Currency:e.fvt=Lf.Currency;break;case Pp.CurrCode:void 0!==a.currCode.currencySymbol&&(e.fvt=Lf.Currency);break;case 403:e.fvt=1===a.numPercent&&0===a.numThousands?Lf.Percentage:Lf.Number;var i=a.codeBefore,o=0;if(r.isEastAsia){if(o<i.length&&"("===Kp(i[o])&&(o+=1),o<i.length&&"US$"===Kp(i[o]))return Lf.Currency;if(r.isChinaT){if(o<i.length&&"NT$"===Kp(i[o]))return Lf.Currency}else if(o<i.length&&"$"===Kp(i[o]))return Lf.Currency}var u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBefore.slice(o))))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.code)))return u;break;case 402:e.fvt=Lf.Scientific;u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeMant)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeExp)))return u;break;case 401:e.fvt=Lf.Fraction;u=void 0;if(void 0!==a.codeInt&&void 0!==(u=this.determineValueTypeCodes(e,a.codeInt)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween1)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeNumer)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween2)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeDenom)))return u;break;case Jn.Decimal:case Jn.Hash:case Jn.Zero:case Jn.Question:break;case Pp.PrefixDigTh:case Pp.LatinDate:case Pp.BidiDate:break;case Jn.HourTh:case Jn.MinuteTh:case Jn.SecondTh:case Jn.Hour:case Jn.Minute:case Jn.Second:case 404:return Lf.Time;case Pp.AMPM:case Pp.AMPMFE:break;case Jn.Era:case Jn.EraYear:case Jn.YearTh:case Jn.EngYearTh:case Jn.ThYear:case Jn.MonthTh:case Jn.DayTh:case Jn.Year:case Jn.Month:case Jn.Day:case Jn.LocDay:return Lf.Date;default:return y("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",a)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=Wp(this.config.localeInfo.pictureSingle,Jn.BidiDate);return v(this.formatString,e+"1")?Pf.English:v(this.formatString,e+"2")?Pf.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],a=t[2],i=t[3],o=!(zp(i)||i===r),u=this.posBeforeText||!o,s="";return u&&(s+=this.printPart(r,this.condPos),n!==r&&(s+=Wp(e.pictureSingle,Jn.Sep),s+=this.printPart(n,this.condNeg),a!==r&&(s+=Wp(e.pictureSingle,Jn.Sep),s+=this.printPart(a,void 0)))),o&&(u&&(s+=Wp(e.pictureSingle,Jn.Sep)),s+=this.printPart(i,void 0)),s},e.prototype.printPart=function(e,t){var r,n=this.config,a=n.mathpack,i=n.localeInfo,o="";if(void 0!==e.color&&(o+=Wp(i.pictureSingle,Jn.ColorStart)+("number"==typeof e.color?Wp(i.pictureColor,zn.Color)+String(e.color-8):Wp(i.pictureColor,(r=e.color,zn[r])))+Wp(i.pictureSingle,Jn.ColorEnd)),void 0!==t){o+=Wp(i.pictureSingle,Jn.ColorStart)+Wp(Up,Gp[t.operator])+a.formatGeneral(i,t.operand,21)+Wp(i.pictureSingle,Jn.ColorEnd)}return void 0!==e.dbnum&&(o+=Wp(i.pictureSingle,Jn.ColorStart)+Wp(i.pictureDbnum,e.dbnum-1)+Wp(i.pictureSingle,Jn.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,a,i,o=this.config,u=o.mathpack,s=o.localeInfo,c="";if(void 0!==r&&r.numThousands>0){for(var l=0;l<t.length;l+=1){var d=t[l].kind;d!==Jn.Zero&&d!==Jn.Hash&&d!==Jn.Question&&d!==Jn.Decimal&&d!==Pp.Numeral||(i=l)}k("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==i)}var f=function(o){var l=t[o],d=e.wasPrevDig;switch(e.wasPrevDig=!1,l.kind){case Pp.General:c+=Wp(s.pictureSpecial,qn.General);break;case Jn.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,c+=Wp(s.pictureSingle,Jn.Decimal);break;case Jn.Hash:case Jn.Zero:case Jn.Question:e.seenDig=!0,e.wasPrevDig=!0;var f=h(l.kind===Jn.Zero?"0":Wp(s.pictureSingle,l.kind),l.count);if(void 0===r||r.decimal){c+=f;break}if(r.comma){var p=r.numDigLeft-l.count;c+=gv({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>p||((n=null===(r=t[o+1])||void 0===r?void 0:r.kind)===Jn.Hash||n===Jn.Zero||n===Jn.Question))},thousandsSeparator:Wp(s.pictureSingle,Jn.Comma)},f,p)}else c+=f;r.numDigLeft-=l.count;break;case Pp.Numeral:e.wasPrevDig=!0,c+=l.formattedStr;break;case 402:c+=v.printCodes(e,l.codeMant,{comma:l.commaMant,numThousands:0,decimal:!1,numDigLeft:l.numMantDigLeft})+v.printCodes(e,l.codeBetween,void 0)+v.printCodes(e,l.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:l.numExpDigLeft});break;case 403:c+=v.printCodes(e,l.codeBefore,void 0)+v.printCodes(e,l.code,{comma:l.comma,numThousands:l.numThousands,decimal:!1,numDigLeft:l.numDigLeft});break;case 401:var m=void 0===l.codeInt?"":v.printCodes(e,l.codeInt,{comma:l.commaInt,numThousands:0,decimal:!1,numDigLeft:l.numIntDigLeft}),g=v.printCodes(e,l.codeBetween1,void 0),S=v.printCodes(e,l.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:l.numNumerDig}),C=v.printCodes(e,l.codeBetween2,void 0),b=v.printCodes(e,l.codeDenom,{comma:!1,numThousands:l.numThousands,decimal:!1,numDigLeft:l.numDenomDig});c+=m+g+S+C+(void 0!==l.denomValue?Ip(u,l.denomValue):b);break;case 400:var E=Wp(s.pictureSingle,Jn.Backslash),A=Hp(s,s.pictureSingle,l.formattedStr,0),T=function(e,t,r,n){var a=r.substring(n,n+La(xa(r,n)));for(var i in t){var o=t[i];if(null!=o&&0!==o.length){var u=o.substring(0,La(xa(o,0)));if(0===e.stringCompareCI(a,u))return!0}}return!1}(s,s.pictureSpecial,l.formattedStr,0);if(void 0!==A&&A!==Jn.Extra&&A!==Jn.Zero)switch(A){case Jn.Comma:var N=t[o+1];if(d){var R=Wp(s.pictureSingle,Jn.Space);if(l.formattedStr!==R||void 0===N||(s.isCurrencySymbolLead||!s.isCurrencySepBySpace||N.kind!==Pp.Currency)&&(!s.isPercentSepBySpace||N.kind!==Jn.Percent)){c+=E;break}}if(400===(null===(n=N)||void 0===n?void 0:n.kind)&&(null===(a=N)||void 0===a?void 0:a.formattedStr)===l.formattedStr){c+=E;break}break;case Jn.Decimal:c+=E;break;case Jn.Slash:e.seenDig&&(c+=E);break;case Jn.Space:case Jn.Minus:case Jn.Plus:case Jn.OpenParen:case Jn.CloseParen:break;case Jn.DateSep:Wp(s.pictureSingle,Jn.DateSep)!==Wp(s.pictureSingle,Jn.Minus)&&(c+=E);break;default:c+=E}else(T||s.isNumeral(xa(l.formattedStr,0)))&&(c+=E);c+=l.formattedStr;break;case Pp.Exp:c+=l.formattedStr+(l.isNeg?"-":"+");break;case Pp.StrLit:E=Wp(s.pictureSingle,Jn.Quote);k("calc.numfmt.NumberFormatImpl: printCodes StrLit",l.escaped.indexOf(E)<0),c+=E+l.escaped+E;break;case Jn.Slash:c+=Wp(s.pictureSingle,Jn.Slash);break;case Jn.Percent:c+=Wp(s.pictureSingle,Jn.Percent);break;case Jn.Star:c+=Wp(s.pictureSingle,Jn.Star)+l.escaped;break;case Jn.Underscore:c+=Wp(s.pictureSingle,Jn.Underscore)+l.escaped;break;case Pp.PrefixDigTh:c+="t";break;case Pp.Currency:c+=Wp(s.pictureSpecial,qn.Currency);break;case Pp.CurrCode:throw new rm(hr(["printing CurrCode"]));case Jn.Text:c+=Wp(s.pictureSingle,Jn.Text);break;case Pp.LatinDate:c+=Wp(s.pictureSingle,Jn.BidiDate)+"1";break;case Pp.BidiDate:c+=Wp(s.pictureSingle,Jn.BidiDate)+"2";break;case 404:c+=Wp(s.pictureSingle,Jn.Decimal)+h("0",l.rounding);break;case 405:c+=Wp(s.pictureSingle,Jn.DateSep);break;case 406:c+=Wp(s.pictureSingle,Jn.Colon);break;case Jn.Era:case Jn.EraYear:case Jn.Year:case Jn.YearTh:case Jn.EngYearTh:case Jn.ThYear:case Jn.Month:case Jn.MonthTh:case Jn.Day:case Jn.DayTh:case Jn.LocDay:c+=h(Wp(s.pictureSingle,l.kind),l.count);break;case Jn.Hour:case Jn.HourTh:case Jn.Minute:case Jn.MinuteTh:case Jn.Second:case Jn.SecondTh:if(l.isAbs){c+=Wp(s.pictureSingle,Jn.ColorStart)+h(Wp(s.pictureSingle,l.kind),l.count)+Wp(s.pictureSingle,Jn.ColorEnd);break}c+=h(Wp(s.pictureSingle,l.kind),l.count);break;case Pp.AMPM:case Pp.AMPMFE:l.kind===Pp.AMPMFE||s.isEastAsia||l.pictureKind===qn.AP2?c+=l.tokenStr:c+=Wp(s.pictureSpecial,l.pictureKind);break;default:return{value:y("calc.numfmt.NumberFormatImpl: printCodes code",l)}}o===i&&(c+=h(Wp(s.pictureSingle,Jn.Comma),r.numThousands))},v=this;for(l=0;l<t.length;l+=1){var p=f(l);if("object"==typeof p)return p.value}return c},e}();function am(e,t,r,n){try{var a=void 0,i=void 0,o=void 0,u=e.config.localeInfo;switch(r.kind){case J.String:a=function(e){if(0===e.length)return!1;var t=xa(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?Bf.Right:Bf.Left,i=Vf.None,o=r;break;case J.Number:a=t.isTextOnly?Bf.Left:Bf.Right,i=Vf.All,o=r;break;case J.Boolean:a=Bf.Center,i=Vf.All,o=Pe(r.value?u.trueName:u.falseName);break;case J.Blank:return Rt(Zf([],void 0,Bf.Left,Vf.All));case J.Error:var s=u.errorNames[r.type];return null==s?Ft(mr("missing error name")):Rt(Zf([qf(s)],void 0,Bf.Center,Vf.All));case J.Array:return Ft(hr(["Array applyFormat"]));case J.Rich:return Ft(hr(["Rich applyFormat"]))}return t.apply(o,a,i,n)}catch(e){return Ft(Dt(e))}}var im=function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}},om={},um=gr("InferenceError"),sm={getDocumentLoc:function(){return Ft(pr(["defaultInferenceGlobals getDocumentLoc"]))},getSheetIndex:function(){return Ft(pr(["defaultInferenceGlobals getSheetIndex"]))},getSheetName:function(){return Ft(pr(["defaultInferenceGlobals getSheetName"]))},getNameLoc:function(){return Ft(pr(["defaultInferenceGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return Ft(pr(["defaultInferenceGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return Rt(ft([],0))},getCellFormat:function(){return Ft(pr(["defaultInferenceGlobals getCellFormat"]))},getKnownFormat:function(){return Ft(pr(["defaultInferenceGlobals getKnownFormat"]))},getIformat:function(){return Ft(pr(["defaultInferenceGlobals getIformat"]))},getFormatString:function(){return Ft(pr(["defaultInferenceGlobals getFormatString"]))}};function cm(e,t){var r,n,a=function(e){var t,r,n,a,i,o,u,s,c,l,d,f,v,h,p,m;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:sm.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:sm.getSheetIndex),getSheetName:(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e),null!=o?o:sm.getSheetName),getNameLoc:sm.getNameLoc,getUserDefinedFuncLoc:sm.getUserDefinedFuncLoc,getSheetRangeIndexes:(s=null===(u=e.getSheetRangeIndexes)||void 0===u?void 0:u.bind(e),null!=s?s:sm.getSheetRangeIndexes),getCellFormat:(l=null===(c=e.getCellFormat)||void 0===c?void 0:c.bind(e),null!=l?l:sm.getCellFormat),getKnownFormat:(f=null===(d=e.getKnownFormat)||void 0===d?void 0:d.bind(e),null!=f?f:sm.getKnownFormat),getIformat:(h=null===(v=e.getIformat)||void 0===v?void 0:v.bind(e),null!=h?h:sm.getIformat),getFormatString:(m=null===(p=e.getFormatString)||void 0===p?void 0:p.bind(e),null!=m?m:sm.getFormatString)}}(e);return{globals:a,locals:t,config:e.config,localeInfo:(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo,null!=n?n:e.config.localeInfo),mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!It(e))throw new um(e);return e.value.document},get defaultFormat(){var e=mm(this,Mr.General);return im(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=mm(this,Mr.General);return im(!0,e,e.valueType,e.decimals)},resolver:Wi(a),multOrDivTainted:!1}}var lm,dm=((Xp={})[Lf.General]=0,Xp[Lf.Number]=1,Xp[Lf.Currency]=2,Xp[Lf.Accounting]=2,Xp[Lf.Percentage]=3,Xp[Lf.Date]=4,Xp[Lf.Time]=5,Xp[Lf.Fraction]=6,Xp[Lf.Scientific]=7,Xp[Lf.Text]=8,Xp[Lf.Custom]=9,Xp);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(lm||(lm={}));var fm=((Zp={})[Z.INT]=lm.Propagate,Zp[Z.MOD]=lm.Propagate,Zp[Z.ROUND]=lm.Propagate,Zp[Z.SUM]=lm.Propagate,Zp[Z.TRUNC]=lm.Propagate,Zp[Z.AVERAGE]=lm.Propagate,Zp[Z.MAX]=lm.Propagate,Zp[Z.MEDIAN]=lm.Propagate,Zp[Z.MIN]=lm.Propagate,Zp[Z.ROUNDUP]=lm.Propagate,Zp[Z.ROUNDDOWN]=lm.Propagate,Zp[Z.NPV]=Mr.CoCurrencyDec,Zp[Z.PV]=Mr.CoCurrencyDec,Zp[Z.FV]=Mr.CoCurrencyDec,Zp[Z.PMT]=Mr.CoCurrencyDec,Zp[Z.RATE]=Mr.Pct0,Zp[Z.MIRR]=Mr.Pct0,Zp[Z.IRR]=Mr.Pct0,Zp[Z.DATE]=Mr.MMDDYY,Zp[Z.TIME]=Mr.HHMMAP,Zp[Z.NOW]=Mr.MDYHMS,Zp[Z.SLN]=Mr.CoCurrencyDec,Zp[Z.SYD]=Mr.CoCurrencyDec,Zp[Z.DDB]=Mr.CoCurrencyDec,Zp[Z.IPMT]=Mr.CoCurrencyDec,Zp[Z.PPMT]=Mr.CoCurrencyDec,Zp[Z.TODAY]=Mr.MMDDYY,Zp[Z.VDB]=Mr.CoCurrencyDec,Zp[Z.DB]=Mr.CoCurrencyDec,Zp);var vm=[[Lf.General,Lf.Number,Lf.Currency,Lf.Percentage,Lf.Date,Lf.Time,Lf.Fraction,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.Number,Lf.Currency,Lf.Percentage,Lf.Date,Lf.Time,Lf.Number,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.Currency,Lf.General,Lf.General,Lf.General,Lf.Currency,Lf.Currency,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.Percentage,Lf.General,Lf.General,Lf.Percentage,Lf.Percentage,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Date,Lf.General,Lf.General,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Time,Lf.General,Lf.General,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Fraction,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Custom]],hm=[[Lf.General,Lf.Number,Lf.Currency,Lf.General,Lf.Date,Lf.Time,Lf.Fraction,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.Number,Lf.Currency,Lf.Number,Lf.Date,Lf.Time,Lf.Fraction,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.Currency,Lf.General,Lf.General,Lf.Currency,Lf.Currency,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.Percentage,Lf.Date,Lf.Time,Lf.Percentage,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Date,Lf.Date,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Time,Lf.Time,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Fraction,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Scientific,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Text,Lf.Custom],[Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.General,Lf.Custom]];function pm(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!It(r))throw new um(r.reason);return r.value}function mm(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!It(r))throw new um(r.reason);return r.value}function gm(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!It(r))throw new um(r.reason);return void 0!==r.value?r.value:t}function Sm(e,t,r){return k("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,Nm(e,t[0]),Nm(e,t[1]))}function ym(e,t,r,n){var a=dm[r.valueType],i=dm[n.valueType],o=a<=i?t[a][i]:t[i][a],u=dm[o],s=n.decimals>r.decimals?n.decimals:r.decimals;switch(u){case a:return im(!0,r.format,r.valueType,s);case i:return im(!0,n.format,n.valueType,s);default:return e.unitlessFormat}}function Cm(e,t,r){return ym(e,hm,t,r)}function km(e,t,r){if(t.format===r.format&&t.valueType===r.valueType&&t.valueType===Lf.Time)return im(!0,t.format,t.valueType,t.decimals);if(t.valueType===Lf.Date&&r.valueType===Lf.Time||t.valueType===Lf.Time&&r.valueType===Lf.Date){var n=mm(e,Mr.MDYHMS),a=n.valueType,i=n.decimals;return im(!0,n,a,i)}return ym(e,vm,t,r)}var bm=function(e){return e.unitlessFormat};function Em(e,t,r){return t.format===r.format?im(!0,t.format,t.valueType,t.decimals):e.unitlessFormat}function Am(e){return dm[e]===dm[Lf.General]}var Tm=xi(Rt,(function(e){return Rt(void 0)}),(function(e,t){return k("calc.numfmt.evalFormat: NoOriginSheet",e.kind!==Ri.NoOriginSheet),Ft(e)}));function Nm(e,t){switch(t.kind){case Nr.App:var r=t.head;if(qt(r))return function(e,t,r){switch(t){case ae.Mul:case ae.Div:return e.multOrDivTainted=!0,Sm(e,r.args,Cm);case ae.Pow:return Sm(e,r.args,Cm);case ae.Add:case ae.Sub:return Sm(e,r.args,km);case ae.Percent:k("calc.numfmt.evalFormat: well-formed unary op",1===r.args.length);var n=r.args[0];if(n.kind!==Nr.Literal||!$t(n.oper))return e.defaultFormat;var a=Nm(e,n),i=a.strong,o=a.decimals,u=mm(e,Mr.Pct);return im(i,u,u.valueType,o);case ae.Pound:case ae.At:return e.defaultFormat;case ae.Neg:case ae.Pos:return k("calc.numfmt.evalFormat: well-formed unary op",1===r.args.length),Nm(e,r.args[0]);case ae.Lt:case ae.Le:case ae.Eq:case ae.Ge:case ae.Gt:case ae.Ne:return Sm(e,r.args,bm);case ae.Isect:case ae.Union:case ae.Range:case ae.Concat:return Sm(e,r.args,Em);case ae.And:case ae.Or:case ae.Xor:case ae.Min:case ae.Max:throw new um(hr(["evalFormat for Yellow ops"]));default:return y("calc.numfmt.evalFormat: unexpected operator id",t)}}(e,r.id,t);if(Jt(r)){var n=r.id,a=null!=(_=fm[n])?_:lm.Ignore,i=Ee(n),o=Yt(t);if(k("calc.numfmt.evalFormula: well-formed WSF args",Xt(i,o.length)),a===lm.Ignore)return e.defaultFormat;if(a===lm.Propagate){if(0===o.length)return e.defaultFormat;var u=o.map((function(t){return Nm(e,t)})),s=u[0],c=s.format,l=s.valueType,d=s.decimals,f=!Am(l);if(!s.strong&&f)return e.unitlessFormat;for(var v=f,h=1;h<u.length;h+=1){var p=u[h],m=!Am(p.valueType);if(!p.strong&&m)return e.unitlessFormat;v||(c=p.format,l=p.valueType,d=p.decimals,v=m)}return im(!0,c,l,d)}var g=mm(e,a),S=g.valueType,b=g.decimals;return im(!0,g,S,b)}return Nm(e,r);case Nr.Let:case Nr.Fun:case Nr.Array:return e.defaultFormat;case Nr.CellRef:var E=e.resolver.resolveCellRef(e.locals,t).resolution,A=Tm(t.ref,E);if(!It(A))throw new um(A.reason);var T=A.value;if(void 0===T)throw om;if(!Ot(T))return e.unitlessFormat;var N=Ht(T),R=e.globals.getCellFormat(N);if(!It(R))throw new um(R.reason);var F=R.value,I=pm(e,F);if(!(Pt(N.sheet.document,e.document)||"number"==typeof F&&I.isBuiltIn))return e.defaultFormat;S=I.valueType,b=I.decimals;return im(!0,F,S,b);case Nr.Literal:switch(t.oper.kind){case J.String:case J.Boolean:case J.Error:case J.Missing:return e.defaultFormat;case J.Number:var D=e.mathpack.formatGeneral(e.localeInfo,e.mathpack.abs(t.oper),21),w=D.indexOf(e.localeInfo.decimalSeparator),M=(b=w>=0?D.length-w-1:0,mm(e,Mr.General));return im(!1,M,M.valueType,b);default:return y("calc.numfmt.evalFormat: unexpected literal oper",t.oper)}case Nr.Name:return e.defaultFormat;case Nr.Paren:return Nm(e,t.node);case Nr.FieldRef:return Nm(e,t.lhs),e.defaultFormat;case Nr.StructRef:throw new um(hr(["evalFormat: StructRefNode"]));case Nr.Bad:return C("calc.numfmt.evalFormat: unexpected bad node");default:return y("calc.numfmt.evalFormat: node kind",t)}var _}function Rm(e,t,r){try{var n=cm(e,t);return Rt(function(e,t){var r=t.strong,n=t.format,a=t.valueType,i=t.decimals;if(a!==Lf.Number||!e.multOrDivTainted){if(i>0&&r&&(a===Lf.Number||a===Lf.Currency||a===Lf.Accounting||a===Lf.Percentage)){var o=pm(e,n);i!==o.decimals&&(n=o.synthesizeDecimals(i))}if(a!==Lf.General&&r)return n=gm(e,n)}}(n,Nm(n,r)))}catch(e){return e instanceof um?Ft(e.reason):e===om?Rt(void 0):Ft(Dt(e))}}var Fm,Im,Dm,wm={getKnownFormat:function(){return Ft(pr(["defaultUtilGlobals getKnownFormat"]))},getIformat:function(){return Ft(pr(["defaultUtilGlobals getIformat"]))},getFormatString:function(){return Ft(pr(["defaultUtilGlobals getFormatString"]))}};function Mm(e,t,r,n){var a=t.getFormatString(r,n);if(!It(a))return a;if(void 0!==a.value)return t.getIformat(r,a.value);var i=e.createFormat(n,!1);return It(i)?i:i.reason.kind===Rf.NotFormatString?Ft(Kf()):Ft(i.reason)}function _m(e,t,r){var n=er(r)?Vf.None:Vf.All,a=t.apply(r,Bf.Right,n,!0);if(!It(a))return a;var i=e.renderValue(a.value,iv);return It(i)?ev(i.value)?Rt(i.value.units):Rt(ov(i.value)):i}function Om(e,t,r,n,a){if(a.isDate||a.isTime){var i=function(e,t,r,n,a){var i=t.config,o=i.mathpack,u=i.localeInfo;if(o.cond(n)<0)return Rt(void 0);var s="",c=0!==o.fix(n)||a.isDate,l=n;if(c){var d=o.trunc(n),f=Mm(e,t,r,wv(u,!0));if(!It(f))return f;if(!It(h=_m(e,f.value,d)))return h;if("string"!=typeof h.value)return Rt(void 0);s+=h.value;var v=o.sub(n,d);k("calc.numfmt.renderFormulaBar: sub error",!rr(v)),l=v}if(o.cond(l)>0||a.isTime){c&&(s+="  ");var h,p=t.getKnownFormat(r,u.clock24Hour?Mr.HHMMSS:Mr.HHMMSSAP);if(!It(p))return p;if(!It(h=_m(e,p.value,l)))return h;if("string"!=typeof h.value)return Rt(void 0);s+=h.value}return Rt(s)}(e,function(e){var t,r,n,a,i,o;return{config:e.config,getKnownFormat:(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e),null!=r?r:wm.getKnownFormat),getIformat:(a=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e),null!=a?a:wm.getIformat),getFormatString:(o=null===(i=e.getFormatString)||void 0===i?void 0:i.bind(e),null!=o?o:wm.getFormatString)}}(t),r,n,a);if(!It(i))return i;if(void 0!==i.value){i.value;return i}}var o=t.config,u=o.mathpack,s=o.localeInfo;if(a.isPercent){var c=u.mul(n,u.fromNumber(100));return rr(c)?Ft(hr(["renderFormulaBar % overflow"])):Rt(u.formatGeneral(s,c,21)+"%")}return Rt(u.formatGeneral(s,n,21))}function xm(e){return{createFormat:function(t,r){return function(e,t,r){try{return Rt(new nm(e.config,{old:void 0,formatString:t,isBuiltIn:r}))}catch(e){return Ft(e instanceof rm?e.reason:Dt(e))}}(e,t,r)},applyFormat:function(t,r,n){return am(e,t,r,n)},renderValue:function(t,r){return Tp(e.config.mathpack,t,r)},renderFormulaBar:function(t,r,n,a){return function(e,t,r,n,a,i){try{var o=t.config.localeInfo;switch(n.kind){case J.Number:return Om(e,t,r,n,a);case J.String:return Rt(i?"'"+n.value:n.value);case J.Boolean:return Rt(n.value?o.trueName:o.falseName);case J.Error:var u=o.errorNames[n.type];return null==u?Ft(mr("missing error name")):Rt(u);case J.Array:return Ft(hr(["Array renderFormulaBar"]));case J.Rich:return Ft(hr(["Rich renderFormulaBar"]));case J.Blank:return Rt("");default:return y("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return Ft(Dt(e))}}(this,e,t,r,n,a)},parseGeneral:function(t,r,n,a){return function(e,t,r,n,a){try{var i=e.config,o=Uv(i.localeInfo,i.mathpack,t,r,n,!1);return It(o)?void 0!==o.value?o:fh(Gv(e),t,void 0,a):o}catch(e){return Ft(Dt(e))}}(e,t,r,n,a)},parseDate:function(t,r){return function(e,t,r){try{return fh(Gv(e),t,void 0,r)}catch(e){return Ft(Dt(e))}}(e,t,r)},parseEdit:function(t,r){return function(e,t,r){try{if(r.valueType===Lf.Text)return vh(t);if(""===t)return Rt(lv(tt));if(v(t,"="))return Rt(uv(t));if(!v(t,"'")){var n=mh(e,t,r);if(!It(n))return n;if(void 0!==n.value)return Rt(n.value)}return"="===(a=t[0])||"+"===a||"-"===a||"@"===a?Rt(uv(t)):vh(t)}catch(e){return Ft(Dt(e))}var a}(e,t,r)},evalFormat:function(t,r){return Rm(e,t,r.node)}}}(Im=Fm||(Fm={})).FormatReasonKind=Rf,Im.ReasonKind=wf,Im.notValueString=Mf,Im.notFormatString=_f,Im.noFormatPart=Of,Im.tooWide=xf,Im.dateOverflow=Wf,Im.fractionOverflow=jf,Im.previousFormatFailure=Kf,Im.FormatValueType=Lf,Im.NamedColor=Uf,Im.Alignment=Bf,Im.Clip=Vf,Im.FormattedUnitKind=Hf,Im.formattedValue=Zf,Im.renderedValue=$f,Im.hashesValue=Xf,Im.isHashesValue=ev,Im.renderCallback=tv,Im.renderInfiniteWidth=iv,Im.renderedValueToString=ov,Im.EditKind=rv,Im.formulaEdit=uv,Im.stringEdit=sv,Im.numberEdit=cv,Im.otherEdit=lv,Im.evalFormatLocalsGrid=dv,Im.KnownFormat=Mr,Im.CurrencyFormat=Ir,Im.DateOrder=Dr,Im.NumberShape=wr,Im.getKnownFormat=_v,Im.isKnownFormatDefined=Ov,Im.shouldInstallFormat=gh,Im.createNumberFormatter=xm,function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(Dm||(Dm={}));var Lm=F(F(F({},vr),Dm),Rf);function Pm(e){return{config:e}}function Um(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Rt(t),allowUnqualifiedCell:!0}}function Bm(e,t){return{config:null!=t?t:void 0,lexicalKind:$e.NameManager,originGridCell:Rt(e),allowUnqualifiedCell:!1}}var Gm,Vm,Hm,Wm=function(e,t){return A("calc.runtime.interval: end",t),T("calc.runtime.interval: start",e,t),{start:e,end:t}};function jm(e,t,r){return{kind:Lm.IllFormedFormula,message:e,mode:t,diagnostics:r}}function Km(e){return{kind:Gm.FinalValue,oper:e}}function Ym(e){return{kind:Gm.PendingValue,anchor:e}}function qm(e,t){return{kind:Gm.Formula,source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(Gm||(Gm={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Vm||(Vm={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(Hm||(Hm={}));var Jm={kind:Lm.Stopped};function zm(e,t){return{arity:e,func:t}}function Qm(e,t,r,n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k,b,E,A,T){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:s,getWorksheetFunc:c,getUserDefinedFunc:l,getNameFormula:d,getCellFormula:f,getUsedRange:v,interruptToken:[Vm.Continue],getHiddenRows:h,isInFilterMode:p,getKnownFormat:m,getIformat:g,getFormatString:S,getRandom:y,getTime:C,schedulerConfig:null!=A?A:{},limits:null!=T?T:{},setCellValue:k,setCellValues:b,setCellFailure:E}}var Xm,Zm,$m,eg=function(e,t,r,n,a,i,o,u,s,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:u,wrapCellReferences:s,followHyperlinks:c}};function tg(e){return{kind:Lm.NameCycle,names:e}}function rg(e){return{kind:Lm.CellCycle,cells:e}}function ng(e){return{kind:Lm.PreviousFailure,range:e}}function ag(e){return{kind:Lm.LimitExceeded,limit:e}}function ig(e){return{kind:gt.Paused,reason:Lm.Timeout,resume:e}}function og(e){if(e.kind===gt.Failure)return e.reason.kind}!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.CallLambda=-2147483638]="CallLambda"}($m||($m={}));var ug,sg=(Xm=O(x,x)).wrap,cg=Xm.unwrap,lg=(Zm=O((function(e){return-e}),(function(e){return-e}))).wrap,dg=Zm.unwrap;function fg(e){return e>0}function vg(e){return{kind:e,data:void 0,children:void 0}}function hg(e,t,r){var n=vg($m.Array);return n.children=r,n.data={rows:e,cols:t},n}function pg(e,t,r,n){var a=vg($m.Fun);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function mg(e,t,r){var n=vg($m.Let);return n.children=M(e,[r]),n.data={rec:t},n}function gg(e,t,r,n){var a=vg($m.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function Sg(e,t,r){var n=vg($m.Name);return n.data={name:e,qualifier:t},n.children=r,n}function yg(e,t,r){var n=vg($m.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function Cg(e,t){var r=vg($m.CellRef);return r.data={ref:e,qualifier:t},r}function kg(e){var t=vg($m.ReadStack);return t.data=e,t}function bg(e,t,r,n,a){var i=vg($m.Conditional);return i.children=M([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function Eg(e){return e.kind>0}function Ag(e,t){for(var r,n=0;n<e.length;n+=1){var a=e[n],i=t(a);void 0===r?i!==a&&(r=e.slice(0,n)).push(i):r.push(i)}return void 0!==r?r:e}function Tg(e,t){return Ag(e,function(e){return function(t){return Ag(t,e)}}(t))}function Ng(e,t){return t(function(e,t){if(Eg(e))return e;switch(e.kind){case $m.Let:var r=Ag(e.children,t);return r===e.children?e:mg(r.slice(0,r.length-1),e.data.rec,r[r.length-1]);case $m.App:var n=Ag(e.children,t);return n===e.children?e:gg(e.data.funName,e.data.funType,e.data.isFormulaRoot,n);case $m.Conditional:var a=e.children,i=a[0],o=a.slice(1),u=t(i),s=Ag(o,t);return i===u&&o===s?e:bg(e.data.funName,e.data.funType,e.data.isFormulaRoot,u,s);case $m.Fun:var c=t(e.children);return c===e.children?e:pg(e.data.arity,e.data.closureId,e.data.closedIdents,c);case $m.Array:var l=Tg(e.children,t);return l===e.children?e:hg(e.data.rows,e.data.cols,l);case $m.Name:return(d=void 0===e.children?void 0:t(e.children))===e.children?e:Sg(e.data.name,e.data.qualifier,d);case $m.Udf:var d;return(d=void 0===e.children?void 0:t(e.children))===e.children?e:yg(e.data.name,e.data.qualifier,d);case $m.CellRef:case $m.ReadStack:case $m.ReadClosure:return e}}(e,(function(e){return Ng(e,t)})))}var Rg=F,Fg=gr("CompileError"),Ig=ne(1,[J.Number|J.String|J.Boolean|J.Rich|J.Error|J.Blank],[J.Number|J.String|J.Boolean|J.Rich|J.Error|J.Blank|J.Missing|J.Array|J.Range],[],z.All,Q.None,X.Allow3dRef),Dg=zh(Ee(Z.IF)),wg=zh(Ee(Z.CHOOSE));function Mg(e){return Eg(e)&&0!=(e.kind&dr)}var _g=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),Og=Ud.create((function(e,t){return e-t}));function xg(e,t){var r=Z.FIELDVALUE;return gg(lg(r),Ee(r),!1,[e,Pe(t)])}function Lg(e,t,r,n,a,i){var o=i.qualifier;return function a(i,u){if(!o){var s=t.getEntry(u.asWhole);if(void 0!==s){e.annotations[u.label]=Jr(s.key);var c=s.value,l=c[0],d=c[1];if(l===n.getCount())return kg(r-d-1);var f=n.getValue(l+1);return k("calc.runtime.toNameTerm: closure",void 0!==f),function(e,t){var r=vg($m.ReadClosure);return r.data=[e,t],r}(f.id,f.mapStackId(d))}}var v;if(u.kind!==Rr.IdentNamePart&&Ra(ba.CalcDotOperator))if(u.lhs.kind===Rr.CellRefNamePart){if(null!=o&&o.kind===br.Document||null==o&&!e.locals.allowUnqualifiedCell);else v=xg(Cg(u.lhs.ref,null!=o&&o.kind===br.Ident?Lr(o.name):o),u.rhs)}else{v=xg(a(!1,u.lhs),u.rhs)}else;return!i||o&&o.kind!==br.Document&&o.kind!==br.Ident||(v=yg(u.asWhole,o,v)),Sg(u.asWhole,o,v)}(a,i.parts)}function Pg(e,t,r,n,a,o,u){switch(void 0===o&&(o=!1),void 0===u&&(u=!1),a.kind){case Nr.Array:var c=a.nodes.map((function(a){return a.map((function(a){return Pg(e,t,r,n,a)}))}));return g=(m=c).length,b=void 0===m[0]?0:m[0].length,m.every((function(e){return e.every(Mg)}))?Qe(g,b,m):hg(g,b,m);case Nr.App:if(qt(h=a.head)){var l=Yt(a).map((function(a){return Pg(e,t,r,n,a)})),d=be(h.id);return gg(sg(h.id),d,u,l)}if(Jt(h)){var f=h.id,v=void 0;switch(f){case Z.IF:v=function(e,t,r,n,a){var i=a.args;switch(i.length){case 3:return bg(lg(Z.IF),Dg,!1,Pg(e,t,r,n,i[0]),[Pg(e,t,r,n,i[1]),Pg(e,t,r,n,i[2])]);case 2:return bg(lg(Z.IF),Dg,!1,Pg(e,t,r,n,i[0]),[Pg(e,t,r,n,i[1]),nt]);default:return C("calc.runtime.toIfTerm: expected wff")}}(e,t,r,n,a);break;case Z.CHOOSE:v=function(e,t,r,n,a){var i=a.args;return k("calc.runtime.toChooseTerm: expected wff",i.length>=1),bg(lg(Z.CHOOSE),wg,!1,Pg(e,t,r,n,i[0]),i.slice(1).map((function(a){return Pg(e,t,r,n,a)})))}(e,t,r,n,a);break;case Z.IFERROR:case Z.IFNA:v=function(e,t,r,n,a,i){var o=a.args;k("calc.runtime.toIfPredicateTerm: expected wff",2===o.length);var u=kg(0),s=bg(lg(Z.IF),Dg,!1,gg(lg(i),Ee(i),!1,[u]),[Pg(e,t,r+1,n,o[1]),u]);return mg([Pg(e,t,r,n,o[0])],!1,s)}(e,t,r,n,a,f===Z.IFERROR?Z.ISERROR:Z.ISNA);break;default:l=Yt(a).map((function(a){return Pg(e,t,r,n,a)})),d=Ee(f);v=gg(lg(f),d,!1,l)}return e.annotations[h.label]=qr(f),v}return function(e,t,r,n,a){var i=Yt(a).map((function(a){return Pg(e,t,r,n,a)}));return gg(lg(Z._UDF),Ig,!1,[Pg(e,t,r,n,a.head,!0)].concat(i))}(e,t,r,n,a);case Nr.Let:var h=a.head;return e.annotations[h.label]=qr(h.id),function(e,t,r,n,a,i){for(var o=t,u=a.vars.length,s=[],c=0;c<a.vars.length;c+=1){var l=a.vars[c][0],d=l.whole;e.annotations[l.parts.label]=Jr(d)}if(i){for(c=0;c<a.vars.length;c+=1){d=a.vars[c][0].whole;var f=r+c;o=o.setValue(d,[n.getCount(),f])}for(c=0;c<a.vars.length;c+=1){var v=a.vars[c][1];s.push(Pg(e,o,r+u,n,v))}}else for(c=0;c<a.vars.length;c+=1){var h=a.vars[c];d=h[0].whole,v=h[1],f=r+c;s.push(Pg(e,o,f,n,v)),o=o.setValue(d,[n.getCount(),f])}return mg(s,i,Pg(e,o,r+u,n,a.body))}(e,t,r,n,a,h.id===Z.LETREC);case Nr.Fun:h=a.head;return e.annotations[h.label]=qr(h.id),function(e,t,r,n,a){var i=new _g(n.getCount()+1),o=n.setValue(i.id,i),u=a.params.reduceRight((function(t,n,a){var i=n.whole;return e.annotations[n.parts.label]=Jr(i),t.setValue(i,[o.getCount(),r+a])}),t),s=Pg(e,u,r+a.params.length,o,a.body),c=i.slots.map((function(e){return r-e-1}));return pg(a.params.length,i.id,c,s)}(e,t,r,n,a);case Nr.Paren:return Pg(e,t,r,n,a.node);case Nr.Name:return Lg(e,t,r,n,o,a);case Nr.CellRef:return Cg(a.ref,a.qualifier);case Nr.Literal:return a.oper;case Nr.FieldRef:return xg(Pg(e,t,r,n,a.lhs,o,u),a.rhs.field);case Nr.StructRef:throw new Fg(hr(["formulaToTermIR: StructRef"]));case Nr.Bad:var p="calc.runtime.compile: unexpected bad node "+s(a);return S.ULS.assertTag(595980820,i.LogCategory.msoulscat_ES_EWAJS,!1,p);default:return y("calc.runtime.compile",a)}var m,g,b}var Ug=((ug={})[ae.At]=Z.SINGLE,ug[ae.Pound]=Z.ANCHORARRAY,ug);var Bg,Gg=function(e){if(!Eg(e)&&e.kind===$m.App&&fg(e.data.funName)){var t=Ug[cg(e.data.funName)];if(void 0!==t)return gg(lg(t),Ee(t),e.data.isFormulaRoot,e.children)}return e};function Vg(e,t){return"object"!=typeof t.term?C(e+": expected known compiled formula type; given "+s(t)):t.term}function Hg(e,t,r){var n,a;try{var i=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,o=Ud.create(i.stringCompareCI),u=Rg([],r.annotations),s=Pg({globals:e,locals:t,localeInfo:i,annotations:u},o,0,Og,r.node,void 0,!0);return Rt(function(e,t,r){return F(F({},e),{annotations:t,term:r})}(r,u,Ng(s,Gg)))}catch(e){return Ft(e instanceof Fg?e.reason:Dt(e))}}function Wg(e){return{compileFormula:function(t,r){return Hg(e,t,r)}}}function jg(e){return 0===e.length&&C("calc.runtime.unevaluated: expected nonempty array"),{kind:Bg.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(Bg||(Bg={}));var Kg=gr("EvaluationError");function Yg(e){throw new Kg(e)}function qg(e,t,r){var n;switch(r.kind){case Bg.Unevaluated:if(t.map.getCount()+1>(null!=(n=e.globals.limits.maxCellChain)?n:1/0))return Ft(ag(Hm.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return Fh(new Oh(a),Dh());default:return Ft(r)}}function Jg(){return xe([],[],Q.None,Ie.Lower)}function zg(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function Qg(e,t){return e<t?-1:e===t?0:1}function Xg(e,t){return"string"==typeof e?"string"!=typeof t?1:Qg(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function Zg(e,t){var r;return 0!==(r=Qg(e.name,t.name))?r:zg(e.path,t.path,Qg)}function $g(e,t){return{current:e,map:t}}var eS=$g(void 0,Ud.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=Xg(e.sheet.index,t.sheet.index))?r:Zg(e.sheet.document,t.sheet.document)})));function tS(e,t){return{current:e,map:t}}var rS=tS(void 0,Ud.create((function(e,t){var r;return 0!==(r=Qg(e.name,t.name))||0!==(r=zg(e.scope.index,t.scope.index,Xg))?r:Zg(e.scope.document,t.scope.document)})));var nS=function(){function e(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.isRunning=!1}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e},e.prototype.next=function(){return this.transition instanceof e?this.transition=Fh(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if(It(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState(Ft(Dt(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState(Rt(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new Oh(t.map(e.resolve)))},e.prototype.settle=function(){return new _h(this).run()},e.resolve=function(t){return t instanceof e?t:new e(Rt(t),void 0,void 0)},e.reject=function(t){return new e(Ft(t),void 0,void 0)},e.undefined=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefined,void 0,void 0);return r.transition=Fh(t,r),r},e.try=function(t){return e.undefined.bind(t)},e.guardStackDepth=0,e.guard=function(t){if(e.guardStackDepth>=7)return e.undefined.bind(t);e.guardStackDepth+=1;try{return e.resolve(t())}catch(t){return e.reject(Dt(t))}finally{e.guardStackDepth-=1}},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.isRunning=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?Fh(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return It(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?Rt(this.accum):(this.accum=e,Rh)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}(),aS=function(){function e(e,t,r,n){var a=this;this.context=e,this.visitedCells=t,this.cell=r,this.isPrecedent=n,this.receiveSuccess=function(e){return function(t){if(nr(t)||ir(t)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+s(t));return S.ULS.assertTag(595980815,i.LogCategory.msoulscat_ES_EWAJS,!1,r)}return a.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===Bg.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+s(t));return S.ULS.assertTag(595980817,i.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=t.kind===Lm.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return a.writeFailure(e.source,n,e.precedents),nS.reject(a.isPrecedent?ng(e.source.range):n)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===gt.Failure)return nS.reject(e.reason);var t=e.value;if(t.kind===Gm.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===gt.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return S.ULS.assertTag(595980813,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+s(t.anchor)+") != null");return S.ULS.assertTag(595980814,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}var o,u,c,l,d,f,v=this.visitAnchor(a),h=this.context.createFormulaEvaluationMachine(this.context,(c=v.source,l=Ht(c.range),d=Rt(l.range),f=Rt(l.sheet),eg(c,d,f,c.kind===$e.Range,d,f,c.kind===$e.Cell,!0,!1,Rt(!1))),v.precedents,(o=this.visitedCells,k("calc.runtime.appendVisitedCell",(u=v).previous===o.current),$g(u,o.map.setValue(u.cell,u))),a.formula);return nS.fromMachine(h).bind(this.receiveSuccess(v)).catch(this.receiveFailure(v))},e.prototype.visitAnchor=function(e){var t=Ht(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+s(t)+"; given "+s(r));return S.ULS.assertTag(595980812,i.LogCategory.msoulscat_ES_EWAJS,!1,n)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:Jg()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=or(t)?n:t;if(e.kind===$e.Cell){if(ar(a)){var i=void 0===a.opers[0]?Ke:a.opers[0][0],o=or(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,s=Hh(u.rows,u.cols,a).opers,c=function(e){return or(e)?n:e},l=s.map((function(e){return e.map(c)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function iS(e,t,r,n){return nS.try((function(){return new aS(e,t,r,n).evalCell()}))}function oS(e,t){for(var r=lS(e),n=[],a=0;a<t.length;a+=1)n.push(iS(r.machineContext,eS,t[a],!1));return new vS(r,n)}function uS(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:$()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function sS(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=$()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:j(e.endTimeMs,t)}}var cS={kind:Lm.Timeout};function lS(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&$()>=e}},machineContext:dS(e)}}function dS(e){return{globals:e,resolver:Wi(e),numberFormatter:xm(e),parser:gd(e),analyzer:Df(e),createCellEvaluationMachine:iS,createFormulaEvaluationMachine:YS,createLambdaEvaluationMachine:qS}}var fS,vS=function(){function e(e,t){A("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new _h(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===Vm.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(sS(e));return Array.isArray(r)?Promise.resolve(r):new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))}))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===Vm.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return Array.isArray(a)?a:ig((function(t){return r(void 0!==t?t:sS(e))}))};return r(sS(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return cS;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+m(e);return S.ULS.assertTag(595980807,i.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),Rh},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(Ft(Jm))},e}();function hS(e){return{kind:fS.RangeValues,arrays:e}}function pS(e){return e.kind===fS.RangeValues}function mS(e,t,r,n){if(r.kind===Ar.Abs)return r;var a=di(e,r.index,n)-t;return a===r.index?r:Br(Ar.Rel,a)}function gS(e,t,r){var n=mS(e.row,t.row,r.row,1<<20),a=mS(e.col,t.col,r.col,16384);return n===r.row&&a===r.col?r:Vr(n,a,r.label)}function SS(e,t,r){switch(r.kind){case Er.Error:return r;case Er.Single:return gS(e,t,r);case Er.Range:var n=gS(e,t,r.ref1),a=gS(e,t,r.ref2);return n===r.ref1&&a===r.ref2?r:Hr(n,a,r.label);case Er.Row:var i=mS(e.row,t.row,r.row1,1<<20),o=mS(e.row,t.row,r.row2,1<<20);return i===r.row1&&o===r.row2?r:Wr(i,o,r.label);case Er.Col:var u=mS(e.col,t.col,r.col1,16384),s=mS(e.col,t.col,r.col2,16384);return u===r.col1&&s===r.col2?r:jr(u,s,r.label)}}!function(e){e.RangeValues="RangeValues"}(fS||(fS={}));var yS=gr("TransformError");function CS(e,t,r){if(Bt(e,t))return Rt(r);try{var n=(a=r.node,i=SS.bind(void 0,e,t),function e(t){switch(t.kind){case Nr.Name:if(!Ra(ba.CalcDotOperator))return t;for(var r=t.parts;r.kind===Rr.FieldRefNamePart;)r=r.lhs;if(r.kind===Rr.CellRefNamePart)throw new yS(hr(["transformRefs: CellRefNamePart"]));return t;case Nr.Literal:case Nr.Bad:return t;case Nr.Array:return Qr(n=t.nodes.map((function(t){return t.map(e)})),t.isClosed,t.label);case Nr.App:return Xr(qt(t.head)||Jt(t.head)?t.head:e(t.head),t.args.map(e),t.isClosed,t.label);case Nr.Let:return Zr(t.head,t.vars.map((function(t){return[t[0],e(t[1])]})),e(t.body),t.isClosed,t.label);case Nr.Fun:return $r(t.head,t.params,e(t.body),t.isClosed,t.label);case Nr.Paren:return(n=e(t.node))===t.node?t:rn(n,t.isClosed,t.label);case Nr.CellRef:return(n=i(t.ref))===t.ref?t:sn(n,t.qualifier,t.label);case Nr.FieldRef:return(n=e(t.lhs))===t.lhs?t:cn(n,t.rhs,t.label);case Nr.StructRef:var n;return(n=e(t.lhs))===t.lhs?t:dn(n,t.rhs,t.label)}}(a));return Rt(n===r.node?r:F(F({},r),{node:n}))}catch(e){if(e instanceof yS)return Ft(e.reason);throw e}var a,i}var kS,bS=function(){function e(e,t){void 0===t&&(t=Ve),this._fields=e,this._fallback=t,this.kind=J.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),ES=function(){function e(e,t,r,n){this.arity=e,this.kind=J.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return Ve},e.prototype.getField=function(e){},e}();function AS(e,t){var r=t.map.getValue(e);if(void 0!==r)return Yg(function(e,t){for(var r=[],n=rg(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function TS(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===gt.Failure)return Yg(n.reason);var a=n.value;if(a.kind===Gm.FinalValue)return a.oper;AS(a.anchor,e.visitedCells),r.push(a.anchor)}function NS(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||qh(t.range)<=16)a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;It(i)?o=null==i.value?void 0:i.value.range:Yg(i.reason);var u=void 0===o?void 0:Kh(t.range,ht(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new Ch(t.range.rows,t.range.cols,0,0,[],tt);a=Ct(t.sheet,u)}var s=e.globals.getCellValues(a);if(s.kind===gt.Failure)return Yg(s.reason);var c=r.length,l=function(e,t,r,n,a){var i=[],o=n.length,u=0;k("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var s=0;s<o;s+=1){i.push([]);var c=n[s].length;k("calc.runtime.deference: readIntoArray2D number of cols",c===r.cols),u=0===s?c:j(c,u);for(var l=0;l<c;l+=1){var d=n[s][l];Gm.FinalValue===d.kind?i[s][l]=d.oper:(AS(d.anchor,e.visitedCells),k("calc.runtime.deference: readIntoArray2D correct sheet",Ut(d.anchor.sheet,t.sheet)),a.push(d.anchor),i[s][l]=He)}}return new Ch(t.range.rows,t.range.cols,o,u,i,tt)}(e,t,a.range,s.value,r);return c===r.length?l:void 0}function RS(e,t,r){var n,a=NS(e,t,r,!1);if(null!=a)return Qe(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:Eh((n=a).rows,n.cols,n.get.bind(n)))}function FS(e,t,r,n){if(0!=(r&J.Range))return t;if(!nr(t))return t;var a=t.sheets;if(!wt(a))return Vh("calc.runtime.dereference",Oe.REF,"3D range, oper = "+s(t)),He;if(1!==t.ranges.length)return Vh("calc.runtime.dereference",Oe.VALUE,"union range, oper = "+s(t)),Ve;var i=t.ranges[0];if(0!=(r&Bh)){if(_t(i))return TS(e,kt(a,i),n);if(e.locals.implicitIntersect&&!Ra(ba.CalcSupportDynamicArrays)&&!Ra(ba.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!It(o))return Yg(o.reason);var u=Yh(o.value,i);return null==u?(Vh("calc.runtime.dereference",Oe.VALUE,"empty intersection, oper = "+s(t)),Ve):TS(e,kt(a,u),n)}return RS(e,Ct(a,i),n)}return 0!=(r&J.Array)?RS(e,Ct(a,i),n):(Vh("calc.runtime.dereference",Oe.VALUE,"bad target type "+r),Ve)}function IS(e,t,r){var n=[],a=FS(e,t,r,n);if(null==a){if(n.length>0)return Yg(jg(n));var o="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+s(t);return S.ULS.assertTag(595980819,i.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}function DS(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=FS(e,t[a],Qt(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return Yg(jg(n))}function wS(e,t){return 0!=(t&J.Number)?e.zero:0!=(t&J.String)?rp:0!=(t&J.Boolean)?nt:Ve}function MS(e,t,r){var n=function e(t,r,n){var a=t.globals.config,i=a.localeInfo,o=a.mathpack;if($t(r)){if(0!=(n&J.Number))return r;if(0!=(n&J.String)){return Pe(o.formatGeneral(i,r,20))}return 0!=(n&J.Boolean)?Le(0!==o.cond(r)):0!=(n&J.Array)?Qe(1,1,[[r]]):Ve}if(er(r)){if(0!=(n&J.String))return r;if(0!=(n&J.Number)){if(0===r.value.length)return Ve;if(r.value.length>255)return Ve;var u=t.numberFormatter.parseGeneral(r.value,!1,!0,Gf.NonVolatile);return It(u)||Yg(u.reason),void 0!==u.value?u.value.value:Ve}return 0!=(n&J.Boolean)?0===i.stringCompareCI(r.value,i.trueName)?rt:0===i.stringCompareCI(r.value,i.falseName)?nt:Ve:0!=(n&J.Array)?Qe(1,1,[[r]]):Ve}if(tr(r))return 0!=(n&J.Boolean)?r:0!=(n&J.Number)?r.value?o.one:o.zero:0!=(n&J.String)?Pe(r.value?i.trueName:i.falseName):0!=(n&J.Array)?Qe(1,1,[[r]]):Ve;if(0!=(n&r.kind))return r;switch(r.kind){case J.Error:return r;case J.Missing:return 0!=(n&J.Blank)?tt:wS(o,n);case J.Blank:return wS(o,n);case J.Rich:return e(t,r.getFallback(),n);default:return Ve}}(e,t,r);return rr(n)&&!rr(t)&&Vh("calc.runtime.coerceOper",n.type,"kind = "+t.kind),n}function _S(e,t){return k("calc.runtime.lambdaCall",t.length===e.arity),{kind:kS.LambdaCall,lambda:e,args:t}}function OS(e){return e.kind===kS.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(kS||(kS={}));var xS=function(){function e(e){this.kind=J.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return C("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return C("calc.runtime.UdfOper.getField")},e}(),LS=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=Q.RefStyle,o},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return It(e)?e.value:Yg(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return It(e)?e.value:Yg(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return It(e)?e.value:Yg(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return It(e)?e.value:Yg(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return It(e)?e.value:Yg(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=Ee(e),n=t.some(nr)?t.slice(0):t;return DS(this,n,r),this.handleLambda(this.dispatchFunction(lg(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(_S(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof Kg)return qg(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(fg(e))return vp(this.globals,cg(e),t,r);var n=dg(e);if(n===Z._UDF){if(t[0]instanceof ES){var a=t[0];return t.length-1!==a.arity?Ke:_S(a,t.slice(1))}if(t[0]instanceof xS){var i=t[0];if(t.length-1!==i.arity)return Ve;if((c=i.func(this,t.slice(1))).kind===J.Error){var o="UDF function return value";Vh("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",c.type,o)}return c}return t.length>0&&rr(t[0])?t[0]:He}var u=this.globals.getWorksheetFunc(n);if(u.kind===gt.Failure)return Yg(u.reason);var s=u.value;if(null==s){o="nonexistent worksheet function "+n;return Vh("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Oe.NAME,o),We}try{var c;if((c=s(this,t)).kind===J.Error){o="worksheet function "+n+" return value";Vh("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",c.type,o)}return c}catch(e){throw function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message=t+" "+String(r.message),r}(e,"(in WSF "+ma(n)+")")}},e.prototype.handleLambda=function(e){return OS(e)?xh(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!Xt(t,n.length)){var o=JSON.stringify(t),u="calc.runtime.FunctionDispatcher.dispatchFunction: "+(g="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+o);return S.ULS.assertTag(593372499,i.LogCategory.msoulscat_ES_EWAJS,!1,u)}for(var c=n.length,l=z.None,d=0;d<c;d+=1){var f=n[d],v=f.kind;0==(v&Qt(t,d,c))&&(l|=v),nr(f)&&0==(t.flags&X.Allow3dRef)&&!wt(f.sheets)&&(l|=v)}if(l===z.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(l&J.Array)){return Xh(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}l&=~J.Array;var h=[];for(d=0;d<c;d+=1){var p=n[d];if(0!=(l&p.kind)){var m=Qt(t,d,c);if(rr(p=this.coerceOper(p,m))&&0==(m&J.Error))return p;if(nr(p)&&0==(t.flags&X.Allow3dRef)&&!wt(p.sheets)){var g="3D reference, oper = "+s(p);return Vh("calc.runtime.FunctionDispatcher.dispatchFunction",Oe.VALUE,g),Ve}}h[d]=p}return this.applyOperatorOrFunction(e,h,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return It(t)?H(t.value)?void 0:t.value:Yg(t.reason)},e.prototype.getNameFormula=function(e,t){var r=this,n=xi((function(e){r.precedents.names.push(e);var t=r.globals.getNameFormula(e);return It(t)?[e,t.value]:Yg(t.reason)}),(function(e){}),(function(e,t){return e.kind===Ri.NoOriginSheet?void 0:Yg(e)}))(e,this.context.resolver.resolveName(this.locals,nn(t,e)).resolution);if(null!=n){var a=n[0],i=n[1];if(null!=i)return[a,i.node]}},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:Rt(r.range),originSheet:Rt(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n};return xi((function(e){return Ze(e.sheet,e.range)}),(function(e){}),(function(e,t){return e.kind===Ri.NoOriginSheet?void 0:Yg(e)}))(e,this.context.resolver.resolveCellRef(a,sn(t,e)).resolution)},e.prototype.dereferenceOper=function(e,t){return IS(this,e,t)},e.prototype.dereferenceOpers=function(e,t){DS(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return It(t)?this.getAvailableFormula(e):Yg(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return It(r)?(this.precedents.special|=Q.OwnDocSheets,null==r.value?void 0:lt(e,r.value)):Yg(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=Q.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return It(t)?t.value.position:Yg(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=Q.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return It(t)?t.value.sheets:Yg(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var s=e[o];if(!nr(s))return i.push(s),"continue";for(var c=[],l=function(e){var r=NS(n,e,a,!0);void 0!==r&&c.push(t(r,e))},d=u.getSheetRangeIndexes(s.sheets),f=function(e){for(var t=lt(s.sheets.document,d[e]),n=function(e){var n=s.ranges[e];if(!r)return l(Ct(t,n)),"continue";var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!It(a))return{value:Yg(a.reason)};var i=a.value;if(0===i.length)return l(Ct(t,n)),"continue";for(var o=function(e,r){var a=ht(e,n.col,r-e,n.cols);l(Ct(t,a))},c=0;c<i.length;c+=1){var d=i[c],f=d.start,v=d.end,h=0===c?n.row:i[c-1].end;k("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",h<=f&&f<v&&v<=n.row+n.rows),h!==f&&o(h,f);var p=ht(f,n.col,v-f,n.cols);u.precedents.cells.push(Ct(t,p))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<s.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},v=0;v<d.length;v+=1){var h=f(v);if("object"==typeof h)return h}i.push({kind:fS.RangeValues,arrays:c})},u=this,s=0;s<e.length;s+=1){var c=o(s);if("object"==typeof c)return c.value}return a.length>0?Yg(jg(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,x,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new bh(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=kt(t.sheet,pt(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(jo(r.lexicalKind,t,{refStyle:e}),n);if(!It(a))return a;var i=this.context.analyzer.checkFormula(r,a.value);if(!It(i))return i;if(!Mt(i.value))return Ft(jm("ill-formed indirect formula","indirect"));i.value;return i},e.prototype.getRandom=function(){this.precedents.special|=Q.Calc;var e=this.globals.getRandom();return It(e)||Yg(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=Q.Time;var t=this.globals.getTime(e,Gf.Volatile);return It(t)||Yg(t.reason),t.value},e.prototype.coerceOper=function(e,t){return MS(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,Gf.NonVolatile);return It(n)||Yg(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,Gf.NonVolatile);return It(r)||Yg(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=be(e),n=[nt,nt];return function(a,i){n[0]=a,n[1]=i,DS(t,n,r);var o=t.dispatchFunction(sg(e),r,!1,n);return k("calc.runtime.FunctionDispatcher.getBinaryOperator",!OS(o)&&!Lh(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=be(e),n=[nt];return function(a){n[0]=a,DS(t,n,r);var i=t.dispatchFunction(sg(e),r,!1,n);return k("calc.runtime.FunctionDispatcher.getUnaryOperator",!OS(i)&&!Lh(i)),i}},e.prototype.isInFilterMode=function(e){this.precedents.special|=Q.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(nr(n))for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(lt(n.sheets.document,o));if(!It(u))return Yg(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=kt(e.source.range.sheet,t),n=CS(Vt(e.source.range.range),t,e.formula);if(!It(n))return Yg(n.reason);var a=this.context.parser.formatFormula(Xo(e.source,r,{refStyle:this.config.refStyle}),n.value);return It(a)?a.value:Yg(a.reason)},e.prototype.applyFormat=function(e,t,r){var n;if("number"==typeof t){var a=this.globals.getKnownFormat(e,t);if(!It(a))return Yg(a.reason);n=a.value}else{var i=Mm(this.context.numberFormatter,this.globals,e,t);if(!It(i))switch(i.reason.kind){case Rf.PreviousFormatFailure:return;default:return Yg(i.reason)}n=i.value}var o=_m(this.context.numberFormatter,n,r);return It(o)?"string"==typeof o.value?o.value:void 0:Yg(o.reason)},e}(),PS=[void 0,We],US=[void 0,He],BS=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?Yg(hr(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),GS=Ud.create((function(e,t){return e-t})),VS={kind:$m.CallLambda};var HS,WS,jS,KS=function(){function e(e,t,r,n,a,i,o,u,c,l,d){var f=this;this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=c,this.isLambda=l,this.isRunning=!1,this.cellEvaluator=xi((function(e){return Ze(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+s(e.data.qualifier);return Vh("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Oe.REF,t),He}),(function(e,t){if(e.kind===Ri.NoOriginSheet){var r="error ref, no sheet, qualifier = "+s(t.data.qualifier);return Vh("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Oe.REF,r),He}return Yg(e)})),this.udfEvaluator=function(e,t,r){return xi((function(e){if(e.length>1){return Vh("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Oe.NAME,"UDF resolution, ambiguous name"),We}var t=f.globals.getUserDefinedFunc(e[0]);return It(t)?new xS(t.value):Yg(t.reason)}),void 0!==r?function(){return r}:function(e){var t="UDF resolution, qualifier = "+s(e.data.qualifier);return Vh("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Oe.NAME,t),We},(function(e,t){return Yg(e)}))(e,t)},this.term=d,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof Kg)return qg(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return It(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Eg(this.term)){var e=this.continuation;if(0===e.length){var t=MS(this,IS(this,this.term,this.target),this.target);return this.precedents.bound=Ie.Exact,!Ra(ba.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==$e.Cell||!ar(t)||1===t.rows&&1===t.cols?Rt(t):Ft(hr(["spilling"]))}var r=e[e.length-1];return this.applyContinuation(this.term,r)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case $m.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case $m.Conditional:var i;if(0===(n=t.holeIndex)){var o=dg(r.data.funName),u=o===Z.IF?J.Boolean:J.Number,c=IS(this,e,u);if(ar(c))return t.locals=[c],this.nextHoleTransition(t,r.children[n+1]);if(ur(c))return Ft(hr(["IF/CHOOSE with a rich value condition"]));if(c=MS(this,c,u),o===Z.IF&&tr(c))return this.popContextTransition(r.children[c.value?1:2]);if(o===Z.CHOOSE&&$t(c)){var l=this.context.globals.config.mathpack.fix(c);if(l<1||l>r.children.length-1){var d="CHOOSE; out of bounds option = "+s(l);return Vh("calc.runtime.FormulaEvaluationMachine.applyContinuation",Oe.VALUE,d),this.popContextTransition(Ve)}return this.popContextTransition(r.children[l])}return k("calc.runtime.FormulaEvaluationMachine.applyContinuation",rr(c)),this.popContextTransition(c)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case $m.Name:var f=this.popContextTransition(e),v=t.locals;return this.locals=v.locals,this.visitedNames=v.visitedNames,f;case $m.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){f=this.popContextTransition(e),v=t.locals;return this.stackEnv.length=v.stackEnvLen,f}if(r.data.rec){var p=this.stackEnv.length-h+n;this.stackEnv[p].value=e,this.stackEnv[p]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case $m.Array:var m=IS(this,e,Uh),g=r.data,S=g.rows,C=g.cols,b=t.holeIndex,E=b%C,A=C===E+1,T=(b-E)/C,N=t.locals;if(N[T][E]=MS(this,m,Uh),S===T+1&&A)return this.popContextTransition(Qe(S,C,N));var R=A?T+1:T,F=A?0:E+1;return this.nextHoleTransition(t,r.children[R][F]);case $m.CallLambda:f=this.popContextTransition(e),v=t.locals;return this.locals=v.locals,this.stackEnv.length=v.stackEnvLen,this.closureEnv=v.closureEnv,this.usage.lambdaDepth-=1,f;default:return y("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case $m.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case $m.App:var r=e.data.funName;if(!fg(r)){var n=dg(r);if(n!==Z._UDF){var a=this.globals.getWorksheetFunc(n);if(a.kind===gt.Failure)return Yg(a.reason)}}return 0===e.children.length?OS(i=new LS(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):Lh(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case $m.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case $m.Let:return this.evaluateLetTransition(e);case $m.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],s=i[2],c=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=Rt(n);else{var a=t.originSheet;if(!It(a))return Yg(a.reason);r=Pt(a.value.document,n.document)?a:Rt(n)}var i=t.originGridCell;return eg(e,i,r,t.calcingArray,i,r,!1,!1,!0,Rt(!1))}(ut(o),this.locals),this.visitedNames=s,c}var l=i[1];return this.updateTermTransition(l);case $m.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case $m.ReadStack:return k("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(d instanceof BS?d.value:d);case $m.ReadClosure:var d;return k("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(v=this.closureEnv.getValue(e.data[0]))),k("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=v[e.data[1]])),d instanceof BS&&(d=d.value,v[e.data[1]]=d),this.updateTermTransition(d);case $m.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case $m.Fun:var f=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return k("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),v=this.closureEnv.setValue(e.data.closureId,f);return this.updateTermTransition(new ES(e.data.arity,this.locals,v,e.children));default:return y("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;DS(this,t,a);var o=new LS(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return OS(o)?this.evaluateLambdaTransition(e,o):Lh(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),Fh(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i,o=t.lambda,u=t.args,s=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],c=(null===(r=s)||void 0===r?void 0:r.context.kind)===$m.CallLambda?s:void 0;return this.usage.lambdaCalls[0]+1>(null!=(n=this.globals.limits.maxLambdaCalls)?n:1/0)?Yg(ag(Hm.LambdaCalls)):void 0===c&&this.usage.lambdaDepth+1>(null!=(a=this.globals.limits.maxLambdaDepth)?a:1/0)?Yg(ag(Hm.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==c?(i=this.updateTermTransition(o.term),this.stackEnv.length=c.locals.stackEnvLen):(i=this.pushContextTransition(VS,o.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),B(this.stackEnv,u),this.closureEnv=o.env,this.locals=function(e,t){return eg(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.allowUnqualifiedCell,e.locals.wrapCellReferences,Rt(!1))}(o,this.locals),this.usage.lambdaCalls[0]+=1,i)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new BS);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,Rh},e.prototype.getNameFormulaAsTerm=function(e){this.precedents.names.push(e);var t=this.globals.getNameFormula(e);if(t.kind===gt.Failure)return Yg(t.reason);var r=t.value;return null!=r?Vg("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",r):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?Yg(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),tg(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!=(t=this.globals.limits.maxNameChain)?t:1/0)?Yg(ag(Hm.NameChain)):function(e,t){var r={name:t,previous:e.current};return tS(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.nameEvaluator=function(e,t,r){var n=this,a=void 0!==r?function(){return[void 0,r]}:function(e){var t="name resolution; qualifier = "+s(e.data.qualifier);return Vh("calc.runtime.FormulaEvaluationMachine.evalName",Oe.NAME,t),PS};return xi((function(t){var r=n.getNameFormulaAsTerm(t);return void 0===r?a(e):[t,r,n.checkForNameCycle(t)]}),a,(function(e,t){if(e.kind===Ri.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+s(t.data.qualifier);return Vh("calc.runtime.FormulaEvaluationMachine.evalName",Oe.REF,r),US}return Yg(e)}))(e,t)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,nn(e.data.name,e.data.qualifier)).resolution;return this.nameEvaluator(e,t,e.children)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,sn(e.data.ref,e.data.qualifier)).resolution;return this.cellEvaluator(e,t)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,nn(e.data.name,e.data.qualifier)).resolution;return this.udfEvaluator(e,t,e.children)},e}();function YS(e,t,r,n,a){return new KS(e,t,r,n,rS,[],GS,{lambdaCalls:[0],lambdaDepth:0},Gh,!1,Vg("calc.runtime.createFormulaEvaluationMachine",a))}function qS(e,t,r,n,a,i,o,u){return k("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new KS(e,t,r,n,a,M(u),o.env,i,z.All,!0,o.term)}function JS(e,t,r){var n,a=lS(e),i=Jg(),o=YS(a.machineContext,t,i,eS,r),u=new vS(a,[o]),s=uS(null!=(n=t.schedulerConfig)?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:ig((function(r){return e(t.resume(r))}))}(u.evaluateSync(s))}function zS(e){return{evalFormula:function(t,r){return JS(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=oS(e,t),n=uS(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=oS(e,t),n=uS(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}function QS(e,t,r,n){var a=gd(Wo(e)).parseFormula(kr.A1,n,$e.Range,r);if(It(a)){var i=a.value;if(!(t<0||t>=r.length))return{formula:i,subexpression:jt(i,t)}}}function XS(e){return e.formula.spans[e.subexpression.label]}function ZS(e,t,r){var n=t.formula;return function(e,t,r,n){if((t.kind===Nr.App||t.kind===Nr.Let)&&Jt(t.head)&&t.head.id===Z.LET){for(var a=[],i=r.spans[t.label],o=0;o<t.args.length-1;o+=2){var u=0===o?r.spans[t.head.label]:r.spans[t.args[o].label],s=r.spans[t.args[o+1].label];if(i&&u&&s){var c=n.indexOf(e.listSeparator,s.end);c>=0?c+=1:(c=n.indexOf(")",s.end))<0&&(c=s.end);var l=Yr(0===o?u.end+1:u.start,c,"","");a.push(l)}}return a}if(t.kind===Nr.Name||t.kind===Nr.Bad)return function e(t,r,n,a){switch(r.kind){case Nr.App:case Nr.Let:case Nr.Fun:if(Jt(r.head)&&r.head.id===Z.LET)for(var i=0;i<r.args.length;i+=1)if(i%2==0&&i<r.args.length-1){var o=r.args[i],u=r.args[i+1];if(o.kind===Nr.Name&&a.kind===Nr.Name&&0===t.stringCompareCI(o.whole,a.whole)||o.kind===Nr.Bad&&a.kind===Nr.Bad&&o.type===Fr.CellRef&&a.type===Fr.CellRef&&0===t.stringCompareCI(o.contents,a.contents)){var s=[],c=n.spans[o.label],l=n.spans[u.label],d=n.spans[a.label];if(d&&c&&l&&c.start===d.start&&c.end===d.end)return s.push(Yr(c.start,l.end,"","")),s}}else{if((s=e(t,r.args[i],n,a)).length>0)return s}else for(i=0;i<r.args.length;i+=1){if((s=e(t,r.args[i],n,a)).length>0)return s}return[];case Nr.Array:for(i=0;i<r.nodes.length;i+=1)for(var f=0;f<r.nodes[i].length;f+=1){if((s=e(t,r.nodes[i][f],n,a)).length>0)return s}return[];case Nr.Paren:return e(t,r.node,n,a);case Nr.Bad:case Nr.CellRef:case Nr.FieldRef:case Nr.Literal:case Nr.Name:case Nr.StructRef:return[];default:return y("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,n,r)}function $S(e,t,r,n){var a=r;a.startsWith("=")||(a="="+r);var i=gd(Wo(e)),o=i.parseFormula(kr.A1,n,$e.Range,t),u=i.parseFormula(kr.A1,n,$e.Range,a);if(It(o)&&It(u))return{formula:o.value,subexpression:u.value.node}}function ey(e,t,r,n){var a=ty(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),i=jn(Aa()),o=Lo(_o(i),Oo(ot($e.Cell,n),n,i),{node:a,spans:t.formula.spans});return It(o)?o.value:""}function ty(e,t,r,n,a){switch(r.kind){case Nr.App:case Nr.Let:case Nr.Fun:if(Jt(r.head)&&r.head.id===Z.LET)return function(e,t,r,n,a){for(var i=[],o=0;o<r.args.length;o+=1){var u=t.spans[r.args[o].label];if(u&&n.start>=u.start&&n.end<=u.end){var s=r.args[o];if((n.start>u.start||n.end<u.end)&&(s=ty(e,t,r.args[o],n,a)),o===r.args.length-1&&r.args.length%2==1)i.push(s);else if(o%2==1){if(1===o)return s;i.pop(),i.push(s)}else i.push(s),i.push(r.args[o+1]),i.push(s);return Xr(r.head,i,!0,r.label)}i.push(r.args[o])}return a}(e,t,r,n,a);for(var i=0;i<r.args.length;i+=1){var o=t.spans[r.args[i].label];if(o&&n.start>=o.start&&n.end<=o.end)return ty(e,t,r.args[i],n,a)}return a;case Nr.Array:for(i=0;i<r.nodes.length;i+=1)for(var u=0;u<r.nodes[i].length;u+=1){var s=t.spans[r.nodes[i][u].label];if(s&&n.start>=s.start&&n.end<=s.end)return ty(e,t,r.nodes[i][u],n,a)}return a;case Nr.Paren:var c=t.spans[r.node.label];return c&&n.start>=c.start&&n.end<=c.end?ty(e,t,r.node,n,a):a;case Nr.Bad:case Nr.CellRef:case Nr.FieldRef:case Nr.Literal:case Nr.Name:case Nr.StructRef:return a;default:return y("calc.runtime.makeSubstitutions",r)}}function ry(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var n=r.pop();if(void 0!==n)switch(n.kind){case Nr.App:case Nr.Let:case Nr.Fun:if(Jt(n.head)&&0!=(Ee(n.head.id).staticPrecs&(Q.Time|Q.Calc)))return!0;n.args.map((function(e){r.push(e)}));break;case Nr.Array:n.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case Nr.FieldRef:case Nr.StructRef:r.push(n.lhs);break;case Nr.Paren:r.push(n.node);break;case Nr.Bad:case Nr.CellRef:case Nr.Literal:case Nr.Name:case Nr.Operator:break;default:y("calc.runtime.isVolatile",n)}}return!1}(jS=HS||(HS={})).ReasonKind=Lm,jS.interval=Wm,jS.CellKind=Gm,jS.Interrupt=Vm,jS.finalValue=Km,jS.pendingValue=Ym,jS.cellFormula=qm,jS.userDefinedFunc=zm,jS.stopped=Jm,jS.nameCycle=tg,jS.cellCycle=rg,jS.paused=ig,jS.previousFailure=ng,jS.evalGlobals=Qm,jS.evalLocals=eg,jS.compileLocalsGrid=Um,jS.compileLocalsName=Bm,jS.getEvalFailureReason=og,jS.illFormedFormula=jm,jS.createCompileGlobals=Pm,jS.limitExceeded=ag,jS.LimitKind=Hm,jS.createCompiler=Wg,jS.createEvaluator=zS,(WS=jS.extension||(jS.extension={})).DerefOperKind=fS,WS.machine=a,jS.getSubExpressionFromFormulaCharacterIndex=QS,jS.getSubExpressionSpan=XS,jS.getFormulaSubExpressionObject=$S,jS.getSubstitutedSubExpressionString=ey,jS.getSubExpressionSubspans=ZS,jS.isFormulaSubExpressionVolatile=ry;var ny=function(e,t){return{functionId:e,functionName:t}},ay=function(e,t){return{errorType:e,errorName:t}},iy=function(e,t,r,n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k,b,E,A,T,N,R,F,I,D,w,M,_,O,x,L,P,U,B,G,V,H,W,j,K,Y,q){return{worksheetFunctionNames:e,errorTypeNames:t,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:s,rightBracket:c,decimalSeparator:l,listSeparator:d,columnSeparator:f,rowSeparator:v,thousandsData:h,thousandsSeparator:p,lcid:m,country:g,numberDecimals:S,isExpSepBySpace:y,fractionSeparator:C,isPercentSepBySpace:k,currencyFormat:b,isCurrencySymbolLead:E,isCurrencySepBySpace:A,currencySymbol:T,currencyDecimals:N,dateOrder:R,dateSeparator:F,dateAltSeparator:I,year4Digits:D,month2Digits:w,day2Digits:M,longDateFormat:_,timeSeparator:O,timeAltSeparator:x,hour2Digits:L,clock24Hour:P,isAMPMSepBySpace:U,ampmSymbols:B,dayNameShort:G,dayNameLong:V,monthNameShort:H,monthNameLong:W,pictureSpecial:j,pictureSingle:K,pictureColor:Y,pictureDbnum:q}},oy=function(e,t,r){return{iformat:e,formatString:t,builtIn:r}},uy=function(e,t){return{sheetId:e,sheetName:t}},sy={kind:"Blank"},cy=function(e){return{kind:"Error",type:e}},ly=function(e){return{kind:"Rich",fields:e}};function dy(e){return"object"==typeof e?e.kind:typeof e}function fy(e){return"object"==typeof e?e.kind:typeof e}var vy=function(e,t){return{row:e,column:t}},hy=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},py=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},my=function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}},gy=function(e,t,r,n,a){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function Sy(e,t,r,n){return gy(e,t,r,n,"CellFormula")}function yy(e,t,r){return gy(void 0,e,t,r,"ArrayFormula")}function Cy(e,t,r,n){return gy(e,t,r,n,"Value")}var ky=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},by=function(e,t,r,n){return ky(e,t,void 0,r,n)};function Ey(e,t,r,n){return ky(e,void 0,t,r,n)}var Ay=function(e,t){return{isSpilled:e,formulaBarText:t}},Ty=function(e,t,r){return{range:e,data:t,fromStateId:r}};function Ny(e,t){return Ty(e,t,void 0)}function Ry(e,t){return Ty(e,void 0,t)}var Fy=function(e,t){return{sheetId:e,usedRange:t}},Iy=function(e){return{kind:"NamedValue",value:e}},Dy=function(e){return{kind:"NamedFormula",formulaBarText:e}},wy=function(e){return{kind:"NamedRange",range:e}},My=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},_y=function(e,t){return{name:e,data:t}},Oy=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function xy(e,t){return Oy(e,t,void 0)}function Ly(e){return Oy(e,void 0,void 0)}function Py(e,t){return Oy(e,void 0,t)}var Uy=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function By(e,t,r,n){return Uy(e,t,void 0,r,n,"CellFormula")}function Gy(e,t,r,n){return Uy(e,t,r,void 0,n,"Value")}function Vy(e,t,r,n){return Uy(e,t,void 0,r,n,"Inferred")}var Hy=function(e,t){return{kind:e,format:t}};function Wy(e){return Hy("SetFormat",e)}var jy=function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}},Ky=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},Yy=function(e,t,r){return{isExact:"number"==typeof e,iformat:"number"==typeof e?e:0,format:e,category:t,decimals:r}},qy=function(e,t,r,n,a){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}},Jy=function(e,t){return{range:e,data:t}},zy=function(e,t){return{range:e,data:t}},Qy=function(e,t){return{range:e,reason:t}},Xy=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}},Zy=function(e,t){return{kind:e,iformat:t}};function $y(){return Zy("Origin")}function eC(e){return Zy("Iformat",e)}function tC(){return Zy("Inferred")}function rC(e,t){return{value:e,formatted:t}}var nC,aC,iC,oC,uC=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},sC=function(e,t){return{name:e,param:t}},cC=function(e,t,r,n,a,i,o,u,s,c,l){return{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:c,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:l,runExperiments:s}},lC=function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}};function dC(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function fC(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function vC(e,t){var r=fC(),n=r[0],a=r[1],i=a[0],o=a[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),i(e)},function(e){clearTimeout(u),o(e)}]]}function hC(e,t,r){var n=vC(e,(function(){return c(t())})),a=n[0],i=n[1],o=i[0],u=i[1],s=!1;function c(e){u(e),s=!0}var l=Promise.resolve().then((function(e){return r(c,(function(){return s}))}));return dC(Promise.race([a,l]),o)}function pC(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function mC(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function gC(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(nC||(nC={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(aC||(aC={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(iC||(iC={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(oC||(oC={}));var SC,yC={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function CC(e){return[e.name,e.message,e.stack]}function kC(e){var t,r=e[0],n=e[1],a=e[2],i=yC[r];return null!=i?t=new i(n):(t=new Error(n)).name=r,void 0!==a&&(t.stack=a),t}function bC(e){return gC(e)?[SC.Error,CC(e)]:[SC.Unknown,e]}function EC(e,t,r,n){var a=new Error(e);return a.stack=e+"\n    at "+t+":"+r+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(SC||(SC={}));function AC(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?kC(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:EC(e.message,e.filename,e.lineno,e.colno)}function TC(e,t,r,n){var a=e[t];null!=a&&(delete e[t],a[r](n))}function NC(e,t,r,n,a,i){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function s(e,t,r,n,a){var i;try{i=u()}catch(e){return Promise.reject(e)}var o=i.lastAppId+1,s=[iC.App,o,e,t,r,a],c=vC(n,(function(){l(s,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),d=c[0],f=c[1];i.callbacks[o]=f,i.lastAppId=o;try{i.port.postMessage(s)}catch(e){l(s,e)}return d}function c(e,t,r,n){var a=u(),i=[iC.App,-1,e,t,r,n];try{a.port.postMessage(i)}catch(e){l(i,e)}}function l(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&TC(o.callbacks,r,oC.Rejected,t),n?g(r>=0?aC.PostCallError:aC.PostNotifyError,t,!0):(r<0&&g(aC.PostNotifyError,t,!1),s("","",[],Math.max(S.callTimeout,S.initTimeout),!0).catch((function(e){}))))}function d(e){var t=e[1],r=e[2],n=e[3],a=e[4],i=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,i=n,u=o.modules[t],s=null!=u?u[i]:void 0;if(null==s)throw new Error("method "+t+"."+i+" has not been exported");return s.apply(u,a)}}));t>=0?u.then((function(e){return f(t,oC.Fulfilled,e,i)}),(function(e){return f(t,oC.Rejected,e,i)})):u.catch((function(e){g(aC.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(gC(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+String(e));return a.stack=void 0,a}(e,r,n),!1)}))}else f(t,oC.Fulfilled,void 0,i)}function f(e,t,r,n){if(null!=o){var a=[iC.Result,e,t,bC(r),n];try{o.port.postMessage(a)}catch(e){v(a,e)}}}function v(e,t){var r=e[1],n=e[4];null!=o&&(n?g(aC.PostResultError,t,!0):f(r,oC.Rejected,bC(t),!0))}function h(e){var t=e[1],r=e[2],n=e[3];null!=o&&TC(o.callbacks,t,r,function(e){return e[0]===SC.Unknown?e[1]:kC(e[1])}(n))}function p(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([iC.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in r)TC(r,Number(a),oC.Rejected,n);try{t.close()}catch(e){}if(null!=i)try{i(S)}catch(n){var u=m(n);console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,t,r){if(null!=o){var n=void 0;try{a(S,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&p(),null!=n){var i=m(n[0]);console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+i)}}}var S={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=null!=r.callTimeout?r.callTimeout:S.callTimeout;return s(e,t,n,i,r.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];c(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:p,dispatchError:g};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case iC.App:return d(e);case iC.Result:return h(e);case iC.Close:return p(!1);default:return y("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case iC.App:return l(e,t);case iC.Result:return v(e,t);case iC.Close:return;default:return y("calc.worker.createPortEndpoint.onMessageError",e)}}}),S}function RC(e,t,r){var n=this,a=null!=t.initTimeout?t.initTimeout:6e4,i=null!=t.callTimeout?t.callTimeout:3e4;return hC(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(o,u){return D(n,void 0,void 0,(function(){function n(e){return function(t,r){return c?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function s(e){return function(t){c&&null!=e.onClosed&&e.onClosed(t)}}var c,l,d;return w(this,(function(o){switch(o.label){case 0:return c=!1,l=NC(e,r.outside,a,i,n(t.outside),s(t.outside)),d=NC(e,r.inside,a,i,n(t.inside),s(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(d)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return c=!0,[2,l]}}))}))}))}function FC(){return"undefined"!=typeof MessageChannel}var IC=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return C("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var DC,wC;function MC(){if(null==So.getCalcAbsUrl()){return S.ULS.traceTag(595907587,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function _C(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function OC(){var e={};for(var t in ba){var r=ba[t];null!=r&&(e[r]=Ra(r))}return e}var xC=((DC={})[nC.FunctionCall]=function(){return!0},DC[nC.MessageChannel]=FC,DC[nC.Dedicated]=MC,DC);function LC(e){return xC[e]()}var PC=((wC={})[nC.FunctionCall]=function(e){return RC(nC.FunctionCall,e,(t=new IC,r=new IC,t.open(r),{outside:t,inside:r}));var t,r},wC[nC.MessageChannel]=function(e){if(!FC())return C("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:mC(e.port1,e.port1.close.bind(e.port1)),inside:mC(e.port2,e.port2.close.bind(e.port1))}}();try{return RC(nC.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},wC[nC.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,a=e.initTimeout,o=e.callTimeout,u=n.scriptName;if(null==u)return C("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var s=So.getCalcAbsUrl();if(!MC()||null==s)return C("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:6e4,l=null!=o?o:3e4;return hC(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return re("calc.worker.createDedicatedWorker (total)",(function(){return D(t,void 0,void 0,(function(){function t(t){return D(this,void 0,void 0,(function(){function a(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function i(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,u,d,f,v;return w(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),u=new Worker(t),f=mC(u,(function(){return _C(u)})),d=NC(nC.Dedicated,f,c,l,a,i),u.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):AC(e),d.dispatchError(aC.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,a){try{t.ULS.shipAssertTag(e,r,n,a)}catch(e){}},assertTag:function(e,r,n,a){try{t.ULS.assertTag(e,r,n,a)}catch(e){}},traceTag:function(e,r,n,a){try{t.ULS.traceTag(e,r,n,a)}catch(e){}},debugTraceTag:function(e,r,n,a){try{t.ULS.debugTraceTag(e,r,n,a)}catch(e){}}};e.setExports("",r)}(d,S),n()?[3,3]:[4,re("calc.worker.createDedicatedWorker (inside)",(function(){var e=d.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:l,calcAbsUrl:s,features:OC()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(d)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,d];case 6:throw v=e.sent(),null!=d?d.close():null!=u&&_C(u),v;case 7:return[2]}}))}))}var a,o,d,f;return w(this,(function(e){switch(e.label){case 0:n=u+(/\.min\.js$/.test(r=s)?".min.js":".js"),c=r.lastIndexOf("/"),a=r.substring(0,c+1)+n,o="calc.worker.createDedicatedWorker: workerUrl = "+a,S.ULS.traceTag(595907588,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,o),e.label=1;case 1:e.trys.push([1,6,,7]),d=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),f=URL.createObjectURL(d),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(f)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(f),[7];case 5:return[3,7];case 6:return e.sent(),S.ULS.traceTag(595881991,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,t(a)];case 7:return[2]}var r,n,c}))}))}))}))},wC);function UC(e,t){return PC[e](t)}function BC(e,t){return D(this,void 0,void 0,(function(){var r,n,a,o,u;return w(this,(function(s){switch(s.label){case 0:r=0,s.label=1;case 1:if(!(r<e.length))return[3,6];if(!LC(n=e[r]))return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,UC(n,t)];case 3:return[2,s.sent()];case 4:return a=s.sent(),o=m(a),u="calc.worker.tryCreateWorker: starting "+n+" worker threw "+o,S.ULS.traceTag(595907598,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function GC(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[j(r,a),K(n,i)]}function VC(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[K(r,a),j(n,i)]}function HC(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return K(r,a)<j(n,i)}function WC(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function jC(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}var KC,YC=F;function qC(e){var t,r,n,a=F(F({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return JC(a,sk(a,a.top,e))}}function JC(e,t){return t===ok||t===ik?t:{setOperations:e,root:t}}function zC(e,t){return t===ok?e:t===ik||e===ok?t:e===ik?e:JC(e.setOperations,QC(e.setOperations,e.setOperations.top,e.root,t.root))}function QC(e,t,r,n){if(n===ok)return r;if(n===ik)return n;if(r===ok)return n;if(r===ik)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var s=e.compare(u,t);return void 0!==s&&0===s?ik:ck(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=lk(e,t,r),o=lk(e,t,n),u=e.split(t),s=u[0][0],c=u[1][0];return ak(e,s,c,QC(e,s,i.left,o.left),QC(e,c,i.right,o.right))}function XC(e,t){return e===ok?e:t===ok||e===ik?t:t===ik?e:JC(e.setOperations,ZC(e.setOperations,e.setOperations.top,e.root,t.root))}function ZC(e,t,r,n){if(r===ok)return r;if(n===ok)return n;if(r===ik)return n;if(n===ik)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return ok;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return ck(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=lk(e,t,r),o=lk(e,t,n),u=e.split(t),s=u[0][0],c=u[1][0];return ak(e,s,c,ZC(e,s,i.left,o.left),ZC(e,c,i.right,o.right))}function $C(e,t,r,n){if(r===ok||n===ok)return!1;if(r===ik||n===ik)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=lk(e,t,r),i=lk(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0];return $C(e,u,a.left,i.left)||$C(e,s,a.right,i.right)}function ek(e,t){return e===ok||t===ok?e:t===ik?ok:e===ik?JC(t.setOperations,tk(t.setOperations,t.setOperations.top,e,t.root)):JC(e.setOperations,tk(e.setOperations,e.setOperations.top,e.root,t.root))}function tk(e,t,r,n){if(r===ok)return r;if(n===ok)return r;if(n===ik)return ok;if(r===ik){var a=lk(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return ak(e,o,u,tk(e,o,ik,a.left),tk(e,u,ik,a.right))}if(r.isExact&&n.isExact){var s=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return ck(e,t,o,!0);return}(e,t,r,n);if(void 0!==s)return s}var c=lk(e,t,r),l=lk(e,t,n),d=e.split(t),f=d[0][0],v=d[1][0];return ak(e,f,v,tk(e,f,c.left,l.left),tk(e,v,c.right,l.right))}function rk(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function nk(e,t,r,n){if(r===n)return 0;if(r===ok)return-1;if(n===ok)return 1;if(r===ik)return n===ik?0:1;if(n===ik)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=lk(e,t,r),i=lk(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0],c=nk(e,u,a.left,i.left);if(void 0!==c){var l=nk(e,s,a.right,i.right);if(void 0!==l)return rk(c,l)}}function ak(e,t,r,n,a){return n===ok?a===ok?ok:a===ik?uk(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):uk(n,a,void 0,!1,a.infimum,a.supremum):a===ok?n===ik?uk(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):uk(n,a,void 0,!1,n.infimum,n.supremum):n===ik?a===ik?ik:uk(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===ik?uk(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):uk(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(KC||(KC={}));var ik=KC.Dense,ok=KC.Empty;function uk(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function sk(e,t,r){if(!e.meets(t,r))return ok;var n=e.compare(t,r);if(void 0!==n)return n<=0?ik:ck(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?ck(e,t,a,!0):ck(e,t,r,!1)}function ck(e,t,r,n){return uk(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function lk(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=ak(e,a,i,sk(e,a,r.key),sk(e,i,r.key));if(o===ok||o===ik)throw new Error("incorrect set operations implementation");var u=o;return YC(r,{left:u.left,right:u.right})}function dk(e){return e===ok||e===ik?0:function e(t){if(void 0===t||t===ok||t===ik)return 0;return e(t.left)+e(t.right)+1}(e.root)}function fk(e,t){return e===ok||function(e,t,r){return function t(n,a){if(a===ok)return!0;if(a===ik)return r(n);if(a.isExact)return r(a.key);var i=lk(e,n,a),o=e.split(n),u=o[0][0],s=o[1][0];return t(u,i.left)&&t(s,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function vk(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,s=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,s)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=j(K(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function hk(e,t,r,n,a){var i=vk(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:HC,intersect:VC,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],K(a,o)<=j(i,u)?GC(e,t):void 0;var r,n,a,i,o,u},except:WC,compare:jC,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return j(e,t)},combineSuprema:function(e,t){return K(e,t)}}}var pk={},mk=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=JSON.stringify(t.sort()),o=pk[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},pk[i]=o),o};function gk(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?ik:{isSubspace:!0,bounds:e}}function Sk(e){return e.isSubspace?1:e.subspaceCount}var yk=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:Sk(e)+Sk(t)}};function Ck(e,t){if(t===ik)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return ik}return{productOperations:e,root:t}}function kk(e){return void 0===e?ik:e}var bk={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===ok)return ok;if(o===ik)continue;t[i]=o.setOperations,r[i]=o.root}}return Ck(t,gk(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var s=n(e[u],e[u].top,kk(t[u]),kk(r[u]));if(s===ok)return s;if(s===ik)continue;a[u]=s}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=JC(e[o],void 0!==u?u:ik)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=ik}return t}},Ek=bk.unzip.bind(bk);function Ak(e,t,r){var n=bk.combineProduct(e,t,r,QC);if(n===ok)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function Tk(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=kk(t[o]),s=kk(r[o]),c=e[o];if(void 0===(n=rk(n,nk(c,c.top,u,s))))return}}return n}var Nk,Rk=(Nk={},function(e,t,r){var n;if(t===Nk.left&&r===Nk.right)return Nk.res;Nk.left=t,Nk.right=r;var a,i=Tk(e,t.bounds,r.bounds);if(void 0!==i)return Nk.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)&&0!==nk(e[s],e[s].top,kk(t.bounds[s]),kk(r.bounds[s]))){if(void 0!==a)return Nk.res=void 0;a=s}}if(void 0!==a){var c=QC(e[a],e[a].top,kk(t.bounds[a]),kk(r.bounds[a]));if(c===ok)return Nk.res=ok;if(c===ik){var l=t.bounds,d=a,f=(l[d],I(l,["symbol"==typeof d?d:d+""]));return Nk.res=gk(f)}var v=F(F({},t.bounds),((n={})[a]=c,n));return Nk.res=gk(v)}return Nk.res=void 0});function Fk(e,t,r){if(r===ok)return t;if(r===ik)return r;if(t===ok)return r;if(t===ik)return t;if(!t.isSubspace||!r.isSubspace)return yk(t,r,Ak(e,t.bounds,r.bounds));var n=Rk(e,t,r);return void 0!==n?n:yk(t,r,Ak(e,t.bounds,r.bounds))}function Ik(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=bk.restrict.apply(bk,M([t.bounds],r));if(t.isSubspace)return gk(a);var i=Ik.apply(void 0,M([e,t.left],r));if(i===ik)return ik;var o=Ik.apply(void 0,M([e,t.right],r));return Fk(e,i,o)}function Dk(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===ik||e===ok)return e;var n=bk.restrict.apply(bk,M([e.productOperations],t)),a=Ik.apply(void 0,M([n,e.root],t));return a===ok?a:Ck(n,a)}function wk(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,s=t.box,c=t.probabilities,l=0,d=0,f=Object.keys(e);d<f.length;d++){var v=f[d];if(Object.prototype.hasOwnProperty.call(e,v)){var h=c[v],p=e[v];if(void 0===h){o=v,u=p.top;break}if(h>l){var m=kk(s[v]);if(m===ok)throw new Error("the key split can never return empty");var g=p.top;if(m!==ik){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=v,l=h,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var S=e[o],y=S.split(u),C=y[0],k=C[0],b=C[1],E=y[1],A=E[0],T=E[1],N=[{box:F(F({},s),(r={},r[o]=sk(S,S.top,k),r)),probabilities:F(F({},c),(n={},n[o]=b,n)),depth:t.depth+1},{box:F(F({},s),(a={},a[o]=sk(S,S.top,A),a)),probabilities:F(F({},c),(i={},i[o]=T,i)),depth:t.depth+1}];return t.depth<10&&(t.children=N),N}var Mk=function(e,t,r,n){return function e(t,r,n,a){if(r===ok)return[ok,ok];if(r===ik)return[gk(n),gk(a)];var i=Tk(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,ok];var o=bk.combineProduct(t,r.bounds,n,ZC);if(o===ok)return[ok,r];var u=bk.combineProduct(t,r.bounds,a,ZC);if(r.isSubspace)return[gk(o),u===ok?ok:gk(u)];var s=e(t,r.left,n,a),c=s[0],l=s[1],d=e(t,r.right,n,a),f=d[0],v=d[1];return[Fk(t,c,f),Fk(t,l,v)]}(e,t,r.box,n.box)};function _k(e,t,r,n,a){var i=wk(e,n),o=i[0],u=i[1],s=Mk(e,t,o,u),c=s[0],l=s[1],d=Mk(e,r,o,u),f=d[0],v=d[1],h=a(e,c,f,o);return h===ik?ik:Fk(e,h,a(e,l,v,u))}function Ok(e,t,r,n){if(r===ok)return t;if(t===ok)return r;if(t===ik)return t;if(r===ik)return r;if(t.isSubspace&&r.isSubspace){var a=Rk(e,t,r);if(void 0!==a)return a}return _k(e,t,r,n,Ok)}function xk(e,t){if(t===ok)return e;if(t===ik)return t;if(e===ok)return t;if(e===ik)return e;var r=F(F({},e.productOperations),t.productOperations),n=Ok(r,e.root,t.root,mk(r));return n===ok?n:Ck(r,n)}function Lk(e,t,r,n){if(t===ok||r===ok)return ok;if(t===ik)return r;if(r===ik)return t;if(t.isSubspace&&r.isSubspace){var a=bk.combineProduct(e,t.bounds,r.bounds,ZC);return a===ok?ok:gk(a)}return _k(e,t,r,n,Lk)}function Pk(e,t){if(e===ok)return e;if(t===ok)return t;if(e===ik)return t;if(t===ik)return e;var r=F(F({},e.productOperations),t.productOperations),n=Lk(r,e.root,t.root,mk(r));return n===ok?n:Ck(r,n)}function Uk(e,t,r,n){if(t===ok)return t;if(r===ik)return ok;if(r===ok)return t;if(t===ik)return _k(e,t,r,n,Uk);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=Tk(e,t.bounds,r.bounds);if(0===i||-1===i)return ok;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)){var c=nk(e[s],e[s].top,kk(t.bounds[s]),kk(r.bounds[s]));if(void 0===c||c>0){if(void 0!==a)return;a=s}}}if(void 0!==a){var l=tk(e[a],e[a].top,kk(t.bounds[a]),kk(r.bounds[a]));if(l===ok)return ok;if(l===ik){var d=t.bounds,f=a;d[f];return gk(I(d,["symbol"==typeof f?f:f+""]))}return gk(F(F({},t.bounds),((n={})[a]=l,n)))}}(e,t,r);if(void 0!==a)return a}return _k(e,t,r,n,Uk)}function Bk(e,t){if(e===ok)return e;if(t===ok)return e;if(t===ik)return ok;if(e===ik){var r=Uk(t.productOperations,ik,t.root,mk(t.productOperations));return r===ok?r:Ck(t.productOperations,r)}var n=F(F({},e.productOperations),t.productOperations),a=Uk(n,e.root,t.root,mk(n));return a===ok?a:Ck(n,a)}function Gk(e,t){if(e===t)return 0;if(e===ok)return-1;if(t===ok)return 1;if(e===ik)return t===ik?0:1;if(t===ik)return-1;var r=F(F({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===ok)return-1;if(n===ok)return 1;if(r===ik)return n===ik?0:1;if(n===ik)return-1;if(r.isSubspace&&n.isSubspace)return Tk(t,r.bounds,n.bounds);var i=wk(t,a),o=i[0],u=i[1],s=Mk(t,r,o,u),c=s[0],l=s[1],d=Mk(t,n,o,u),f=d[0],v=d[1],h=e(t,c,f,o);return void 0!==h?rk(h,e(t,l,v,u)):void 0}(r,e.root,t.root,mk(r))}function Vk(e,t,r,n){if(t===ok||r===ok)return!1;if(t===ik||r===ik)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=kk(t[i]),u=kk(r[i]),s=e[i];if(!$C(s,s.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=wk(e,n),i=a[0],o=a[1],u=Mk(e,t,i,o),s=u[0],c=u[1],l=Mk(e,r,i,o),d=l[0],f=l[1];return Vk(e,s,d,i)||Vk(e,c,f,o)}function Hk(e,t){if(e===ok||t===ok)return!1;if(e===ik||t===ik)return!0;var r=F(F({},e.productOperations),t.productOperations);return Vk(r,e.root,t.root,mk(r))}function Wk(e){return e===ok||e===ik?0:Sk(e.root)}var jk=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!0,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),Kk=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function Yk(e,t){return function(r,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];var o=t.get(r);void 0===o?(e.apply(void 0,M([r,n],a)),t.set(r,t.size)):n.push("__cached__",o)}}function qk(e,t){return function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];if("__cached__"===r.pick()){r.pop();var i=r.pop();return t[i]}var o=e.apply(void 0,M([r],n));return t.push(o),o}}var Jk;!function(){function e(t){var r,n,a,i,o=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new Kk,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==ok&&e!==ik){var r=e,n=o.getDims(r.productOperations);t.push(n),o.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===ok||t===ik)return t;e.putBack(t);for(var r={},n=e.pop(),a=0,i=n;a<i.length;a++){var u=i[a],s=o.globalProductOperations[u];r[u]=s}return{productOperations:r,root:o.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){var a,i,u,s,c,l;r.push(null===(a=t)||void 0===a?void 0:a.isExact),r.push(o.serializers[n].serializeBound(null===(i=t)||void 0===i?void 0:i.infimum)),r.push(o.serializers[n].serializeBound(null===(u=t)||void 0===u?void 0:u.supremum));var d=e.normalizeKey(null===(s=t)||void 0===s?void 0:s.key);r.push(o.serializers[n].serializeKey(d));for(var f=0,v=[null===(c=t)||void 0===c?void 0:c.left,null===(l=t)||void 0===l?void 0:l.right];f<v.length;f++){var h=v[f];null==h||h===ok||h===ik?r.push(h):(r.push("us"),o.serializeUntypedSparseCached(h,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=o.serializers[t].deserializeBound(e.pop()),a=o.serializers[t].deserializeBound(e.pop()),i=o.serializers[t].deserializeKey(e.pop()),u=["left","right"].map((function(r){var n=e.pop();return"us"===n?o.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:u[0],right:u[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,a=r;n<a.length;n++){var i=a[n],u=e.bounds[i];o.serializeUntypedSparseCached(u,t,i)}e.isSubspace||(o.serializeUntypedSparseProductCached(e.left,t,r),o.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},a=0,i=t;a<i.length;a++){var u=i[a],s=o.deserializeUntypedSparseCached(e,u);n[u]=s}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:o.deserializeUntypedSparseProductCached(e,t),right:o.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=Yk(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=qk(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=Yk(this.serializeProductSet,this.cached),this.deserializeProductSetCached=qk(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=Yk(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=qk(this.deserializeUntypedSparseProduct,this.cache),t){var s={serializeKey:(r=t[u].serializeKey,null!=r?r:function(e){return JSON.stringify(e)}),deserializeKey:(n=t[u].deserializeKey,null!=n?n:function(e){return JSON.parse(e)}),serializeBound:(a=t[u].serializeBound,null!=a?a:function(e){return JSON.stringify(e)}),deserializeBound:(i=t[u].deserializeBound,null!=i?i:function(e){return JSON.parse(e)})};this.serializers[u]=s}}e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var a=n[r];this.serializeProductSetCached(a,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new jk(JSON.parse(e)),r=t.pop(),n=[],a=0;a<r;a+=1){var i=this.deserializeProductSetCached(t);n.push(i)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=F({},e);return delete t.depth,delete t.split,t}return e}}();!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(Jk||(Jk={}));var zk=[Jk.AvailableSet,Jk.AvailableRead+1],Qk=[0,1<<20],Xk=[0,16384],Zk={availability:hk(1,zk[0]+1,zk[1],zk,"Availability operations, alpha = 1"),row:hk(.2,Qk[0]+1,Qk[1],Qk,"Row operations, alpha = 0.2"),col:hk(.35,Xk[0]+1,Xk[1],Xk,"Col operations, alpha = 0.35")},$k={availability:qC(Zk.availability),row:qC(Zk.row),col:qC(Zk.col)};function eb(e){return Ek({row:$k.row([e.row,e.row+e.rows]),col:$k.col([e.col,e.col+e.cols])})}function tb(e){if(e!==ok){var t,r,n=e===ik?void 0:e.root.bounds.row,a=e===ik?void 0:e.root.bounds.col,i=void 0===n?Zk.row.top:(t=JC(Zk.row,n),r=[],ub(t,(function(e){return r.push(e),!0})),r.reduce(GC)),o=i[0],u=i[1],s=void 0===a?Zk.col.top:function(e){var t=[];return sb(e,(function(e){return t.push(e),!0})),t.reduce(GC)}(JC(Zk.col,a)),c=s[0];return ht(o,c,u-o,s[1]-c)}}var rb,nb,ab=Ek({availability:$k.availability([Jk.AvailableSet,Jk.AvailableSet+1])}),ib=Ek({availability:$k.availability([Jk.AvailableRead,Jk.AvailableRead+1])}),ob=Ek({availability:$k.availability([Jk.AvailableSet,Jk.AvailableRead+1])});function ub(e,t){return e!==ik?fk(e,t):t(Zk.row.top)}function sb(e,t){return e!==ik?fk(e,t):t(Zk.col.top)}function cb(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=Dk.apply(void 0,M([e],r));if(a===ok)return!0;if(a===ik)return t(bk.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(bk.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return ub(e.row,(function(r){var n=r[0],a=r[1];return sb(e.col,(function(e){var r=e[0],i=e[1];return t(ht(n,r,a-n,i-r))}))}))}),"row","col")}function lb(e,t){return cb(e,(function(e){return Lt(e,t)}))}function db(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(rb||(rb={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(nb||(nb={}));var fb,vb,hb,pb,mb,gb={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function Sb(e,t){var r;return F(F({},e),((r={})[t]=(e[t]||0)+1,r))}function yb(e,t){switch(t.message){case fb.ChangedCell:return F(F({},e),{changedCellCount:Sb(e.changedCellCount,t.cellKind),calculatedCellCount:Sb(e.calculatedCellCount,t.cellKind)});case fb.UnchangedCell:return F(F({},e),{calculatedCellCount:Sb(e.calculatedCellCount,t.cellKind)});case fb.ContinueComputation:return F(F({},e),{continueCount:e.continueCount+1});case fb.StateTimedOut:return F(F({},e),{stateTimedOut:!0});case fb.EditFinished:return F(F({},e),{editFinishedCount:e.editFinishedCount+1});case fb.RecalcFinished:return F(F({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return y("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function Cb(e,t){e[t]=(e[t]||0)+1}function kb(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function bb(e,t){return function(r,n,a){return V(r)&&e(r)||kb(n,a,t)}}function Eb(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){Cb(r,u[o])}return i}function Ab(e,t,r,n){var a=n+".<index>";return e.filter((function(e){return Eb(e,t,r,a)}))}function Tb(e){return function(t,r,n){return!!H(t)||e(t,r,n)}}function Nb(e){return function(t,r,n){if(H(t))return kb(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function Rb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function Fb(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function Ib(e){return function(t,r,n){if(!Array.isArray(t))return kb(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function Db(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){if(H(r))return kb(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return H(o)?(a.push("kind"),kb(n,a,t)):o(r,n,a)}finally{a.length=i}}}function wb(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){var i=e[typeof r];return H(i)?kb(n,a,t):i(r,n,a)}}function Mb(e){return"number"==typeof e&&e>-1/0&&e<1/0}function _b(e){return(0|e)===e||Math.floor(e)===e}function Ob(e,t,r){return void 0===r&&(r=0!==e?"integer >= "+e+" and < "+t:"natural < "+t),bb((function(r){return"number"==typeof r&&r>=e&&r<t&&_b(r)}),r)}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(fb||(fb={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(vb||(vb={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Inferred="Inferred"}(hb||(hb={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(pb||(pb={}));var xb=bb((function(e){return!1}),"never"),Lb=bb(Mb,"finite number"),Pb=bb((function(e){return Mb(e)&&_b(e)}),"integer"),Ub=Ob(0,1/0,"natural"),Bb=bb((function(e){return"string"==typeof e}),"string"),Gb=bb((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),Vb=bb((function(e){return"boolean"==typeof e}),"boolean"),Hb=bb((function(e){return Array.isArray(e)}),"Array");function Wb(e){return bb((function(t){return t===e}),JSON.stringify(e))}function jb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e);return bb((function(e){return"string"==typeof e&&!0===r[e]}),o)}function Kb(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var Yb=bb((function(e){return"string"==typeof e&&Kb(e)}),"formula text"),qb=Nb({functionId:Ub,functionName:Gb}),Jb=Nb({errorType:Ub,errorName:bb((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),zb=Nb({iformat:Ub,formatString:Bb,builtIn:Vb}),Qb=bb((function(e){return"string"==typeof e||Mb(e)}),"string or finite number"),Xb=Nb({sheetId:Qb,sheetName:Bb}),Zb=Ob(0,1<<20),$b=Ob(0,16384),eE=Nb({row:Zb,column:$b}),tE=Rb(eE,Nb({lastRow:Tb(Zb),lastColumn:Tb($b)})),rE=Rb(tE,Nb({sheetId:Qb})),nE=Rb(rE,Nb({lastRow:Tb(xb),lastColumn:Tb(xb)})),aE=Nb({kind:Wb("Blank")}),iE=Nb({kind:Wb("Error"),type:Ub}),oE=wb({number:Lb,string:Bb,boolean:Vb,object:Db({Blank:aE,Error:iE})}),uE=wb({number:Ub,string:Bb}),sE=Rb(Nb({value:oE,iformat:Ub,failureReason:Tb(Bb)}),Db({CellFormula:Nb({formulaBarText:Yb}),ArrayFormula:Nb({formulaBarText:Tb(xb)}),Value:Nb({formulaBarText:Bb})})),cE=Nb({range:rE,excludeRows:Tb(Ib(Zb)),excludeColumns:Tb(Ib($b)),data:Tb(sE),fromStateId:Tb(Pb)}),lE=Nb({isSpilled:Vb,formulaBarText:Yb}),dE=Nb({range:rE,data:Tb(lE),fromStateId:Tb(Pb)}),fE=Nb({sheetId:Qb,usedRange:Tb(tE)}),vE=wb({number:Lb,string:Bb,boolean:Vb,object:Db({Error:iE})}),hE=Nb({kind:Wb("NamedValue"),value:vE}),pE=Nb({kind:Wb("NamedFormula"),formulaBarText:Yb}),mE=Nb({kind:Wb("NamedRange"),range:rE}),gE=Nb({kind:Wb("NamedFailure"),failureReason:Bb,objectKind:Tb(jb("NamedValue","NamedFormula","NamedRange","NamedTable"))}),SE=Nb({name:Bb,data:Tb(Db({NamedValue:hE,NamedFormula:pE,NamedRange:mE,NamedFailure:gE}))}),yE=Nb({scope:Tb(Qb),objects:Tb(Hb),fromStateId:Tb(Pb)}),CE=bb((function(e){return e.length>0}),"a non-empty array"),kE=bb((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),bE=Fb(Ib(rE),(function(e){return CE}),(function(e){return kE})),EE=Rb(Nb({range:bE,origin:Tb(eE),viewport:Tb(rE)}),Db({CellFormula:Nb({formulaBarText:Yb,value:Tb(xb)}),Value:Nb({formulaBarText:Bb,value:oE}),Inferred:Nb({formulaBarText:Bb,value:Tb(xb)})})),AE=Db({SetFormat:Nb({format:uE})}),TE=Nb({range:bE,operation:AE,origin:Tb(eE),viewport:Tb(rE)}),NE=Nb({range:rE,formulaBarText:bb((function(e){return"string"==typeof e&&(0===e.length||Kb(e))}),"empty string or text denoting formula"),origin:Tb(eE),viewport:Tb(rE)}),RE=bb((function(e){return 2===e.length}),"2 AM/PM symbols"),FE=bb((function(e){return 7===e.length}),"7 day symbols"),IE=bb((function(e){return 12===e.length}),"12 month symbols");function DE(e){var t=U(e,x);return bb((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var wE=DE(qn),ME=DE(Jn),_E=DE(zn),OE=DE(Qn),xE=Nb({worksheetFunctionNames:Hb,thousandsData:Tb(Ib(Ub)),errorTypeNames:Hb,trueName:Gb,falseName:Gb,rowLetter:Gb,columnLetter:Gb,leftBrace:Gb,rightBrace:Gb,leftBracket:Gb,rightBracket:Gb,decimalSeparator:Gb,listSeparator:Gb,columnSeparator:Gb,rowSeparator:Gb,thousandsSeparator:Tb(Bb),lcid:Tb(Ub),country:Tb(Ub),numberDecimals:Tb(Ub),isExpSepBySpace:Tb(Vb),fractionSeparator:Tb(Gb),isPercentSepBySpace:Tb(Vb),currencyFormat:Tb(jb(Ir.Paren,Ir.Lead,Ir.Intern,Ir.Trail)),isCurrencySymbolLead:Tb(Vb),isCurrencySepBySpace:Tb(Vb),currencySymbol:Tb(Bb),currencyDecimals:Tb(Ub),dateOrder:Tb(jb(Dr.MDY,Dr.DMY,Dr.YMD,Dr.MYD,Dr.DYM,Dr.YDM)),dateSeparator:Tb(Bb),dateAltSeparator:Tb(Bb),year4Digits:Tb(Vb),month2Digits:Tb(Vb),day2Digits:Tb(Vb),longDateFormat:Tb(Vb),timeSeparator:Tb(Bb),timeAltSeparator:Tb(Bb),hour2Digits:Tb(Vb),clock24Hour:Tb(Vb),isAMPMSepBySpace:Tb(Vb),ampmSymbols:Tb(Fb(Ib(Bb),(function(e){return RE}))),dayNameShort:Tb(Fb(Ib(Bb),(function(e){return FE}))),dayNameLong:Tb(Fb(Ib(Bb),(function(e){return FE}))),monthNameShort:Tb(Fb(Ib(Bb),(function(e){return IE}))),monthNameLong:Tb(Fb(Ib(Bb),(function(e){return IE}))),pictureSpecial:Tb(Fb(Ib(Tb(Gb)),(function(e){return wE}))),pictureSingle:Tb(Fb(Ib(Tb(Gb)),(function(e){return ME}))),pictureColor:Tb(Fb(Ib(Tb(Gb)),(function(e){return _E}))),pictureDbnum:Tb(Fb(Ib(Tb(Gb)),(function(e){return OE})))}),LE=Nb({yr:Pb,mon:Ob(1,13),dom:Ob(1,6),wdy:Ob(1,8),hour:Ob(0,24),min:Ob(0,60),sec:Ob(0,60),fracSec:Wb(0),rounding:Ob(0,4)}),PE=Fb(Nb({bias:Lb,standardDate:Tb(LE),standardBias:Lb,daylightDate:Tb(LE),daylightBias:Lb}),(function(e){return bb((function(e){return H(e.standardDate)===H(e.daylightDate)}),"standardDate iff daylightDate")})),UE=Nb({date1904:Tb(Vb),dateCompatibility:Tb(Vb),timezone:Tb(PE)}),BE=Tb(Db({Origin:Nb({value:Tb(xb)}),Iformat:Nb({value:Tb(Ub)}),Inferred:Nb({value:Tb(xb)})})),GE=((mb={})[J.Number]=!0,mb[J.String]=!0,mb[J.Boolean]=!0,mb[J.Error]=!0,mb[J.Array]=!1,mb[J.Blank]=!0,mb[J.Rich]=!1,mb),VE=bb((function(e){return GE[e.kind]}),"supported ReadOper");function HE(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function WE(e,t,r){return{kind:e,key:t,value:r}}function jE(e,t){return WE(1,e,t)}function KE(e,t){return WE(2,e,t)}function YE(e,t){return WE(3,e,t)}var qE=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Re(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=$E(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,ZE(this.lattice,this.root,jE(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==$E(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return JE(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return JE(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return JE(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return JE(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return W(e,1);if(2===e.kind){for(var u=e.value,s=0;s<u.length;s+=1)if(0===a.keyCompare(u[s].key,t)){if((v=HE(u,s)).length<r){var c=KE(e.key,v);return n.push(c),W(c,3)}return W(KE(QE(a,v),v),2)}}else for(u=e.value,s=0;s<u.length;s+=1){var l=i(u[s],a.minChildren),d=l[0],f=l[1];if(3===f){var v;if((v=HE(u,s)).length>=r)return W(YE(QE(a,v),v),2);c=YE(e.key,v);return n.push(c),W(c,3)}if(2===f)return W(YE(e.key,HE(u,s,d)),2)}return W(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),s=u[0],c=u[1];if(s===this.root)return this;for(var l=3===c?void 0:s,d=0;d<n.length;d+=1)JE(n[d],(function(e,t){return l=ZE(r.lattice,l,jE(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function JE(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function zE(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return W(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],s=0;s<t.length;s+=1){var c=t[s];u.push([c,e.keyDistance(i,c.key)-e.keyDistance(o,c.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var d=[],f=[];for(s=0;s<l;s+=1)d.push(u[s][0]);for(s=l;s<t.length;s+=1)f.push(u[s][0]);return W(d,f)}function QE(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function XE(e,t,r){var n=zE(e,r),a=n[0],i=n[1];return W(WE(t,QE(e,a),a),WE(t,QE(e,i),i))}function ZE(e,t,r){if(null==t)return KE(r.key,[r]);var n=function t(n){if(2===n.kind){var a=M(n.value,[r]);if(a.length>e.maxChildren){var i=XE(e,n.kind,a),o=i[0],u=i[1];return W(KE(o.key,o.value),u)}return W(KE(e.keyJoin(n.key,r.key),a),void 0)}var s=n.value.slice(),c=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],s=e.keyDistance(u.key,r);(s<a||s===a&&u.value.length<i)&&(n=o,a=s,i=u.value.length)}return n}(e,s,r.key),l=t(s[c]),d=l[0],f=l[1];if(s[c]=d,null!=f&&(s.push(f),s.length>e.maxChildren)){var v=XE(e,n.kind,s),h=v[0];u=v[1];return W(YE(h.key,h.value),u)}return W(YE(e.keyJoin(n.key,r.key),s),void 0)}(t),a=n[0],i=n[1];return null!=i?YE(e.keyJoin(a.key,i.key),[a,i]):a}function $E(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return YE(n.key,HE(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return KE(n.key,HE(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?jE(t.key,a):t}}function eA(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return K(r,o)<j(r+a,o+s)&&K(n,u)<j(n+i,u+c)}function tA(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=r+a,c=o+t.rows,l=n+i,d=u+t.cols;return r===o&&s===c&&n===u&&l===d?0:r<=o&&s>=c&&n<=u&&l>=d?1:r>=o&&s<=c&&n>=u&&l<=d?-1:void 0}function rA(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return Y(r-o+.5*(a-s))+Y(n-u+.5*(i-c))}function nA(){return qE.create(Wh,eA,tA,rA)}function aA(e){return Array.isArray(e)}var iA,oA=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(iA||(iA={}));var uA,sA={fmla:"",lexicalKind:$e.Cell,origin:pt(0,0),compiledFmla:void 0,hasHyperlink:!1},cA={fmla:"",lexicalKind:$e.Range,origin:pt(0,0),compiledFmla:void 0,hasHyperlink:!1},lA=function(e,t){return""===e&&!t},dA=sA;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(uA||(uA={}));var fA={kind:uA.ClientValueUnknown};function vA(e){return e.kind===uA.ClientValueUnknown}var hA={oper:tt,failure:void 0};function pA(e,t){return or(e)&&void 0===t}function mA(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!Bt(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function gA(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===$e.Cell?sA:cA;e=e.setValue(t,n)}return!0})),e}function SA(e,t,r,n){var a=Pk(t,ib);return lb(Bk(t,Dk(Pk(r,a),"row","col")),(function(t){return e=e.setValue(t,n),!0})),e}var yA={values:nA(),formats:nA(),formulae:nA(),dirty:ok},CA={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var kA=ht(0,0,1<<20,16384);var bA=function(){function e(e,t,r,n,a,i,o,u){void 0===t&&(t=yA),void 0===r&&(r=ok),void 0===n&&(n=kA),void 0===a&&(a=ok),void 0===i&&(i=ok),void 0===o&&(o=!1),void 0===u&&(u=!1),this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=t,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenAvailability=i,this.inFilterMode=o,this.filterModeAvailable=u,this.rollBackToServerState()}return e.create=function(t){return new e(t)},e.prototype.cloneServer=function(){return new e(this.sheet,this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenAvailability,this.inFilterMode,this.filterModeAvailable)},e.prototype.advanceState=function(e){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=ok,this.serverUsed=kA,this.hiddenRows=this.hiddenAvailability=ok,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState()},e.prototype.rollBackToServerState=function(){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=ok,this.rollBackToEditedState()},e.prototype.rollBackToEditedState=function(){this.clientContents=this.editedContents,this.recalcValues=this.editedContents.values,this.recalcFailures=ok,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=Pk(eb(e),ib),n=Pk(t,r),a=Dk(Bk(r,n),"row","col"),i=Gk(n,r);return!!(void 0!==i&&i>=0)||a},e.prototype.hasRecalcDirty=function(e){return Hk(this.recalcDirty,eb(e))},e.prototype.hasRecalcFailure=function(e){return Hk(this.recalcFailures,eb(e))},e.prototype.hasEditedEditTaint=function(e){return Hk(this.editedTaint,eb(e))},e.prototype.hasRecalcEditTaint=function(e){return Hk(this.recalcTaint,eb(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,a=$k.row(W(e,t)),i=(r=this.hiddenAvailability)===(n=a)?0:r===ok?-1:n===ok?1:r===ik?n===ik?0:1:n===ik?-1:nk(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==i&&i>=0))return Ft({kind:SF.HiddenRows});var o=[];return ub(XC(this.hiddenRows,a),(function(e){var t=e[0],r=e[1];return o.push(Wm(t,r)),!0})),Rt(o)},e.prototype.setHiddenRows=function(e,t){var r=$k.row(W(e.row,e.row+e.rows));this.hiddenRows=zC(ek(this.hiddenRows,r),XC(t,r)),this.hiddenAvailability=zC(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?Rt(this.inFilterMode):Ft({kind:SF.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var a=Pk(e,ab);return cb(Pk(r,a),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!lA(n.fmla,void 0!==n.compiledFmla)||Lt(Kh(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=Pk(e,ib);return cb(Pk(r,n),(function(e){return Lt(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=Pk(e,ab),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=Gk(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,Pk(e,ob)),this.unionTaint(!0,ok),this.unionUsed(!0,tb(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?ok:eb(e),r=Bk(ik,t),n=this.serverContents,a=n.values,i=n.formats,o=n.formulae,u=n.dirty;cb(r,(function(e){return a.forEachLe(e,(function(e,t){return pA(t.oper,t.failure)||(a=a.setValue(e,hA)),!0})),i.forEachLe(e,(function(e,t){return oA(t)||(i=i.setValue(e,0)),!0})),!0})),cb(r,(function(e){return o=gA(o,e),!0})),u=Bk(u,r),this.setContents(!0,{values:a,formats:i,formulae:o,dirty:u});var s=this.serverAvailability;s=xk(s=Pk(s,t),Pk(r,ib)),this.serverAvailability=this.editedAvailability=s,this.editedTaint=this.recalcTaint=ok;var c,l,d=this.serverUsed;l=e,d=void 0===(c=d)||void 0===l?void 0:Kh(c,l),this.serverUsed=this.editedUsed=d},e.prototype.setRecalcFailure=function(e){this.recalcFailures=xk(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=xk(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;Lt(e,(function(e,n,a){return r.recalcValues=r.recalcValues.setValue(e,{oper:aA(t)?t[n][a]:t,failure:void 0}),!0})),this.recalcDirty=Bk(this.recalcDirty,eb(e))},e.prototype.setClientValue=function(e,t){var r=this.clientContents.values;Lt(e,(function(e,n,a){return r=r.setValue(e,{oper:aA(t)?t[n][a]:t,failure:void 0}),!0})),this.clientContents=F(F({},this.clientContents),{values:r})},e.prototype.setClientFormula=function(e,t,r){var n=this.clientContents.formulae;n=function(e,t){return e.forEachMeets(t,(function(t,r){return r.fmla.length>0&&(e=e.setValue(t,dA)),!0})),e}(n,e),void 0!==t?n=n.setValue(t,r):Lt(e,(function(e){return n=n.setValue(e,r),!0})),this.clientContents=F(F({},this.clientContents),{formulae:n})},e.prototype.setClientFormat=function(e,t){var r=this.clientContents.formats;Lt(e,(function(e){return r=r.setValue(e,t),!0})),this.clientContents=F(F({},this.clientContents),{formats:r})},e.prototype.getRecalcValue=function(e){var t=this.recalcValues.getValue(e);return null!=t?t:hA},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:hA},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:hA},e.prototype.getServerFormula=function(e){return this.serverContents.formulae.getValue(e)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=F(F({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:0},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:0},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!lA(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,e&&(this.clientContents=this.editedContents),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=ok},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=xk(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?ok:xk(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,a=e?this.serverUsed:this.editedUsed;n=t,a=void 0===(r=a)?n:void 0===n?r:Wh(r,n),e&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(e,t,r,n,a,i,o){this.setCommon(e,t,void 0,r,n,a,i,o)},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=eb(t);this.setCommon(e,o,t,r,n,void 0,a,i)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u){var s,c=this,l=e?this.serverContents:this.editedContents,d=l.values,f=l.formats,v=l.formulae,h=l.dirty,p=void 0===n&&void 0!==a||void 0!==(null===(s=n)||void 0===s?void 0:s.compiledFmla),m=n;void 0!==n&&(cb(t,(function(e){return v=gA(v,e),!0})),lA(n.fmla,void 0!==n.compiledFmla)&&(m=void 0));var g=void 0!==m&&void 0===r?n:void 0,S=void 0!==m&&void 0!==r?n:void 0,y=a;void 0!==a&&pA(a,i)&&(cb(t,(function(e){return d.forEachLe(e,(function(e,t){return pA(t.oper,t.failure)||(d=d.setValue(e,hA)),!0})),!0})),h=p?xk(h,t):Bk(h,t),y=void 0);var C=void 0!==y?{oper:y,failure:i}:void 0,k=o;void 0!==o&&oA(o)&&(cb(t,(function(e){return f.forEachLe(e,(function(e,t){return oA(t)||(f=f.setValue(e,0)),!0})),!0})),k=void 0);var b=k===hb.Weak?void 0:k,E=k===hb.Weak?k:void 0,A=t;if(!e){var T=Pk(t,ab);A=xk(Dk(Pk(this.editedAvailability,T),"row","col"),Pk(t,void 0!==u?eb(u):ok))}if(void 0===g&&void 0===b&&void 0===C||(lb(A,(function(e){return void 0!==g&&(v=mA(v,e,g)),void 0!==b&&(f=f.setValue(e,b)),void 0!==C&&(d=d.setValue(e,C)),!0})),void 0===g&&void 0===C||(h=p?xk(h,A):Bk(h,A))),void 0!==S){v=mA(v,r,S);var N=eb(r);h=p?xk(h,N):Bk(h,N)}void 0!==E&&(f=SA(f,A,e?this.serverAvailability:this.editedAvailability,hb.Unavailable));var R=void 0===a?ok:A,I=void 0===n?ok:A,D=void 0===o?ok:A,w=void 0===a&&void 0===o?ok:A;e||(cb(R,(function(e){return c.setClientValue(e,fA),!0})),void 0!==n&&(void 0!==r?this.setClientFormula(r,r,n):cb(I,(function(e){return c.setClientFormula(e,void 0,n),!0}))),o===hb.Weak?this.clientContents=F(F({},this.clientContents),{formats:SA(this.clientContents.formats,D,this.editedAvailability,hb.ClientValueUnknown)}):cb(D,(function(e){return c.setClientFormat(e,hb.ClientValueUnknown),!0}))),this.setContents(e,{values:d,formats:f,formulae:v,dirty:h}),this.unionAvailability(e,Pk(R,ob)),e||(this.editedAvailability=Bk(this.editedAvailability,Bk(t,A))),this.unionTaint(e,w),this.unionUsed(e,tb(t))},e.prototype.getDirtyEditedCells=function(){return Pk(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return Bk(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return Bk(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,ok),this.unionTaint(e,ok),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:Wk(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:Wk(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:Wk(this.recalcDirty),recalcFailuresSetSubspaceCount:Wk(this.recalcFailures),recalcTaintSetSubspaceCount:Wk(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:Wk(this.editedAvailability),hiddenRowsNodeCount:dk(this.hiddenRows)+dk(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=ok;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=xk(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return Hk(Pk(eb(e),ab),t)}function i(e,t){return!lA(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return!oA(t)&&a(e)}function u(e,t){return!(!vA(t.oper)&&pA(t.oper,t.failure))&&a(e)}var s=Dk(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u),dirty:Pk(this.serverContents.dirty,s)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u),dirty:Pk(this.editedContents.dirty,s)},this.clientContents={formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(u)},this.recalcValues=this.recalcValues.filter(u),this.recalcDirty=Pk(this.recalcDirty,s)},e}(),EA=function(e){return{kind:"NamedValue",value:e}},AA=function(e){return{kind:"NamedFormula",fmla:e}},TA=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},NA={namesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var RA,FA=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(Ud.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?Rt(void 0):Ft({kind:SF.NameLoc,name:Tt(e,t)}):Rt(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),IA=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=FA.create(e),this.emptyRecalcFailures=this.recalcFailures=De.create(e)}return e.prototype.cloneServer=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return It(t)?Rt(void 0!==t.value?Tt(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return It(t)?Rt(void 0!==t.value?t.value.value:void 0):t},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),DA=function(){function e(e,t,r,n,a,i){this.document=e,this.stringCompareCI=t,this.formats=r,this.sheets=n,this.oldSheets=a,this.globalNames=null!=i?i:new IA(t,Et(e))}return e.prototype.cloneServer=function(){var t;if(this.sheets){for(var r=this.sheets,n=r.data,a=r.sheetPosToId,i=r.sheetNameToId,o=Object.create(null),u=0,s=a;u<s.length;u++){var c=s[u],l=n[c];o[c]=F(F({},l),{grid:l.grid.cloneServer()})}t={data:o,sheetPosToId:a,sheetNameToId:i}}return new e(this.document,this.stringCompareCI,this.formats.cloneServer(),t,void 0,this.globalNames.cloneServer())},e.prototype.setClientValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===gt.Failure?r:Rt(r.value.grid.setClientValue(e.range,t))},e.prototype.setClientFormula=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===gt.Failure?r:Rt(r.value.grid.setClientFormula(e.range,e.range,t))},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===gt.Failure?r:Rt(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===gt.Failure?r:Rt(r.value.grid.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===gt.Failure?r:Rt(r.value.grid.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===gt.Failure?r:Rt(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===gt.Failure?r:Rt(r.value.grid.setClientFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:Rt(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===gt.Failure?r:Rt(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===gt.Failure)return u;var s=void 0!==o&&Ut(t.sheet,o.sheet)?o.range:void 0;return Rt(u.value.grid.setCellContents(e,t.set,r,n,a,i,s))},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=this.getSheetById(t.sheet.index);if(o.kind===gt.Failure)return o;var u=void 0!==i&&Ut(t.sheet,i.sheet)?i.range:void 0;return Rt(o.value.grid.setRangeFormula(e,t.range,r,n,a,u))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(db(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(db(t.grid.sheet,t.grid.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(db(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===gt.Failure?n:Rt(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===gt.Failure?t:Rt(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===gt.Failure?r:Rt(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n,a,i=null===(n=null!=(r=this.sheets)?r:this.oldSheets)||void 0===n?void 0:n.data,o=Object.create(null),u=[],s=[],c=0;c<t.length;c+=1){var l=t[c],d=l.sheetName,f=l.sheetId;u[c]=f,s.push([d,f]);var v=null===(a=i)||void 0===a?void 0:a[f];if(void 0===v){var h=lt(this.document,f);o[f]={grid:bA.create(h),names:new IA(this.stringCompareCI,h),pos:c,name:d}}else o[f]=F(F({},v),{pos:c})}var p=De.create(this.stringCompareCI).setValues(s);return new e(this.document,this.stringCompareCI,this.formats,{data:o,sheetPosToId:u,sheetNameToId:p},void 0,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===gt.Failure?r:Rt(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:Rt(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===gt.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,gt.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);return t.kind===gt.Failure?t:t.value.getNameFormula(e.name)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===gt.Failure?t:Rt(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===gt.Failure?t:Rt(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return Rt(this.globalNames);var t=this.getSheetById(e);return t.kind===gt.Failure?t:Rt(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===gt.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getServerFormat(e.range))},e.prototype.getClientFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getClientValue(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===gt.Failure?t:Rt(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===gt.Failure?t:Rt(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:Rt(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:Rt(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===gt.Failure?n:Rt(n.value.grid.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===gt.Failure||void 0===t.value?t:Rt(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===gt.Failure?t:Rt(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===gt.Failure?t:Rt(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r,n,a=null===(t=this.sheets)||void 0===t?void 0:t.sheetPosToId;if(!a)return this.unavailableFailure({kind:SF.SheetNames});if(void 0===e.index)r=0,n=a.length;else{var i=this.getSheetById(e.index);if(!It(i))return i;var o=this.getSheetById(e.index2);if(!It(o))return o;r=j(i.value.pos,o.value.pos),n=K(i.value.pos,o.value.pos)+1}for(var u=[],s=r;s<n;s+=1)u.push(a[s]);return Rt(ft(u,r))},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheets=this.sheets,this.sheets=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=CA;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,clientFormulaeNodeCount:r.clientFormulaeNodeCount+n.clientFormulaeNodeCount,clientFormatsNodeCount:r.clientFormatsNodeCount+n.clientFormatsNodeCount,clientValuesNodeCount:r.clientValuesNodeCount+n.clientValuesNodeCount,recalcValuesNodeCount:r.recalcValuesNodeCount+n.recalcValuesNodeCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getServerAvailableCells=function(){var e=[],t=this.sheets;if(t)for(var r=0,n=t.sheetPosToId;r<n.length;r++){var a=n[r],i=t.data[a],o=lt(this.document,a);e.push({sheetIdx:o,availableCells:i.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.data;for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n))e(r[n])}},e.prototype.getSheetById=function(e){var t=this.sheets;if(!t)return this.unavailableFailure({kind:SF.SheetNames});var r=t.data[e];return void 0===r?this.unavailableFailure({kind:SF.SheetId,document:this.document,sheetId:e}):Rt(r)},e.prototype.getSheetByName=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.sheetNameToId;if(!r)return this.unavailableFailure({kind:SF.SheetNames});var n=r.getValue(e);return void 0===n?Rt(void 0):this.getSheetById(n)},e.prototype.unavailableFailure=function(e){return Ft(e)},e}(),wA=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();function MA(e){var t=e.value;if(It(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return J.Blank;case"Error":return J.Error;case"Rich":return J.Rich;default:y("calc.calc.extractResultValue",r)}case"boolean":return J.Boolean;case"number":return J.Number;case"string":return J.String;default:return y("calc.calc.extractResultValue",r)}}}function _A(e){var t=e.value;if(!It(t))return t.reason.kind}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(RA||(RA={}));var OA=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);126===i&&a+1<t.length?(n+=t.charAt(a+1),a+=1):126!==i&&(63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i)))}this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(RA.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(RA.OP_DOT):this.bytecode.push(RA.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case RA.OP_DOT:this.addState(t,i+1);break;case RA.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,n=t;n<r.length&&r[n]===RA.OP_DOTSTAR;n+=1)e[n+1]=!0},e}(),xA={"=":ae.Eq,"<":ae.Lt,">":ae.Gt},LA={"<>":ae.Ne,"<=":ae.Le,">=":ae.Ge};function PA(e,t){if(!er(t))return t;var r,n,a=(r=t.value).length>=2&&void 0!==(n=LA[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=xA[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return rt;if(0===r.stringCompareCI(t,r.falseName))return nt;for(var n=1;n<r.errorNames.length;n+=1){var a=r.errorNames[n];if(void 0!==a&&0===r.stringCompareCI(a,t))return Ue(n)}var i=e.parseGeneral(t,!1);return void 0!==i?i:Pe(t)}(e,a[1])}}function UA(e,t,r,n){var a=function(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:ae.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===ae.Ne&&np(r.operand))return function(e){return!or(e)};if(r.operator===ae.Eq&&np(r.operand))return or;if(void 0!==r.operator&&np(r.operand))return function(e){return!1};if(void 0===r.operator&&np(r.operand))return function(e){return or(e)||np(e)};var o,u,s=void 0===r.operator?ae.Eq:r.operator;switch(r.operand.kind){case J.Number:return o=s,u=r.operand,function(t){var r=ur(t)?t.getFallback():t;if($t(r))return dp(a,o,r,u);if(er(r)&&o===ae.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&dp(a,o,n,u)}return o===ae.Ne};case J.Boolean:return function(e,t){return function(r){var n=ur(r)?r.getFallback():r;return tr(n)?cp(e,n,t):e===ae.Ne}}(s,r.operand);case J.String:return function(e,t){switch(e){case ae.Eq:case ae.Ne:var r=new OA(i,t.value);return function(t){var n=ur(t)?t.getFallback():t;return er(n)?r.test(n.value)===(e===ae.Eq):e===ae.Ne};case ae.Lt:case ae.Gt:case ae.Le:case ae.Ge:return function(r){var n=ur(r)?r.getFallback():r;return!!er(n)&&lp(i,e,n,t)}}}(s,r.operand);case J.Error:return function(e,t){return function(r){var n=ur(r)?r.getFallback():r;return rr(n)?sp(e,n.type-t.type):e===ae.Ne}}(s,r.operand);default:return y("calc.funcs.criteria.compileCriteria",r.operand)}}(e,PA(e,r)),i=t,o=void 0===n?i:n;return new bh(o.rows,o.cols,K(i.denseRows,o.denseRows),K(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}var BA=J.Number|J.String|J.Boolean;function GA(e,t,r,n,a){var i=function(n,i,u,s){var c;if((null===(c=i)||void 0===c?void 0:c.kind)===J.Array){for(var l=new Sh(i.rows,i.cols,i.opers),d=n,f=0;f<u;f+=1)d=o(d,l);return d}var v=(s&&void 0!==a?a:r)(e,i);return null==v?n:t(n,v,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var s=t.get(o,u);void 0!==s&&(r=i(r,s,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var c=(t.rows-t.denseRows)*t.cols;return c>0&&void 0!==n&&(r=i(r,n,c,!1)),r}return n.reduce((function(e,t){return pS(t)?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function VA(e,t){var r=ur(t)?t.getFallback():t;switch(r.kind){case J.Number:return r;case J.Boolean:case J.String:return;case J.Error:return r;case J.Missing:case J.Blank:return;default:return y("calc.funcs.arithmeticOperationCoerce",r)}}function HA(e,t){var r=ur(t)?t.getFallback():t;switch(r.kind){case J.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case J.Number:return r;case J.String:return e.mathpack.zero;case J.Error:return r;case J.Missing:case J.Blank:return;default:return y("calc.funcs.arithmeticAOperationCoerce",r)}}function WA(e){return function(t,r,n){if(void 0!==t&&rr(t))return t;if(k("calc.funcs.numberReducer",void 0===t||$t(t)),rr(r))return r;var a,i;k("calc.funcs.numberReducer",$t(r)),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(rr(u))return u;a=u}return a}}function jA(e){return function(t,r,n){return e.count+=n,r}}function KA(e,t,r){var n;if(!$t(r))return r;var a=function(e){for(var t,r,n=e.length-1;n>=0;n-=1){var a=e[n];if(void 0!==a&&pS(a))for(var i=a.arrays.length-1;i>=0;i-=1){var o=a.arrays[i];if(o.rows>o.denseRows||o.cols>o.denseCols)if((null===(t=c=o.getSparse())||void 0===t?void 0:t.kind)===J.Number)return c;for(var u=o.denseRows-1;u>=0;u-=1)for(var s=o.denseCols-1;s>=0;s-=1){var c;if((null===(r=c=o.get(u,s))||void 0===r?void 0:r.kind)===J.Number)return c}}}}(t);return(null===(n=a)||void 0===n?void 0:n.kind)!==J.Number?r:e.mathpack.checkAlmostCancellation(a,r)}function YA(e,t,r){var n=GA(t,WA(t.mathpack.add),VA,r);return null==n?t.mathpack.zero:(e&&(n=KA(t,r,n)),n)}var qA=YA.bind(void 0,!1),JA=YA.bind(void 0,!0);function zA(e){return nr(e)&&1!==e.ranges.length}function QA(e,t,r){if(zA(t))return Ft(Ve);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return Rt({values:n,valuesToFilter:n})}if(zA(r))return Ft(Ve);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=j(r.cols,16384-n.col),i=j(r.rows,(1<<20)-n.row),o=ht(r.row,r.col,i,a),u=Ze(e.sheets,o),s=ht(n.row,n.col,i,a),c=Ze(t.sheets,s);return{actualEvalRange:u,actualFilterRange:c}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],s=o.ranges[0],c=e.dereferenceAllOpers([i])[0];return u.col===s.col&&u.row===s.row?Rt({values:c,valuesToFilter:c}):Rt({values:c,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function XA(e,t){var r=t,n=r[0],a=r[1],i=QA(e,n,r[2]);if(!It(i))return i.reason;var o=i.value,u=o.values,s=o.valuesToFilter,c=[hS([UA(e,u.arrays[0],a,s.arrays[0])])];return qA(e,c)}function ZA(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(zA(o))return Ft(Ve);if(r){var u=t[1],s=e.dereferenceAllOpers([o])[0];a=UA(e,s.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var c=i;c<t.length;c+=2){var l=t[c],d=t[c+1];if(zA(l))return Ft(Ve);if(l.ranges[0].cols!==o.ranges[0].cols||l.ranges[0].rows!==o.ranges[0].rows)return Ft(Ve);s=e.dereferenceAllOpers([l])[0];a=UA(e,s.arrays[0],d,a)}return n&&(a=a.strict()),Rt(hS([a]))}function $A(e,t){var r=GA(e,WA(e.mathpack.mul),VA,t);return null==r?e.mathpack.zero:r}function eT(e,t,r,n,a,i){var o,u=GA(a,WA(a.mathpack.add),e,i,t);if(null==u)return n;if(r&&(u=KA(a,i,u)),rr(u))return u;var s={count:0},c=GA(a,jA(s),e,i,t);k("calc.funcs.averageCoerceInner",$t(u)&&(null===(o=c)||void 0===o?void 0:o.kind)===J.Number&&s.count>0);var l=a.mathpack.div(u,a.mathpack.fromNumber(s.count));return rr(l)?l:[l,s.count]}function tT(e,t,r,n,a){var i=eT(e,t,r,Ge,n,a);return Array.isArray(i)?i[0]:i}var rT=tT.bind(void 0,VA,void 0,!1),nT=tT.bind(void 0,VA,void 0,!0),aT=tT.bind(void 0,HA,(function(e,t){var r=ur(t)?t.getFallback():t;return er(r)?e.mathpack.zero:VA(0,r)}),!0);function iT(e,t){var r=t,n=r[0],a=r[1],i=QA(e,n,r[2]);if(!It(i))return i.reason;var o=i.value,u=o.values,s=o.valuesToFilter,c=[hS([UA(e,u.arrays[0],a,s.arrays[0]).strict()])];return rT(e,c)}function oT(e,t,r,n,a){for(var i=void 0,o=0,u="",s=function(e,t){return e.coerceOper(t,J.String)},c=function(e,n,a){if(void 0!==e&&rr(e))return e;for(var s=0;s<a;s+=1){if(void 0!==i&&t.length>0&&(!r||i.value.length>0)){var c=t[o];if(o=(o+1)%t.length,u.length+c.value.length>32767)return Ve;u+=c.value}if(rr(n))return n;if(k("calc.funcs.concatInner: expected string in reducer",er(n)),u.length+n.value.length>32767)return Ve;if(u+=n.value,i=n,""===n.value&&(0===t.length||r))break}return n},l=0;l<a.length;l+=1){var d=n[l];if(nr(d)&&d.ranges.length>1)return Ve;var f=GA(e,c,s,a.slice(l,l+1));if(void 0!==f&&rr(f))return f;k("calc.funcs.concatInner: expected string from reduce",void 0!==f&&er(f))}if(r&&void 0!==i&&""===i.value&&t.length>0&&u.length>0){var v=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-v.value.length)}return Pe(u)}function uT(e,t,r){var n={count:0};return GA(t,jA(n),e,r),t.mathpack.fromNumber(n.count)}var sT=uT.bind(void 0,(function(e,t){var r=ur(t)?t.getFallback():t;return $t(r)?r:void 0}));var cT=uT.bind(void 0,(function(e,t){var r=ur(t)?t.getFallback():t;return or(r)||np(r)?r:void 0}));var lT=uT.bind(void 0,(function(e,t){var r=ur(t)?t.getFallback():t;return cr(r)||rr(r)?r:void 0}));var dT=uT.bind(void 0,(function(e,t){return t}));function fT(e,t){var r=t,n=r[0],a=r[1];if(zA(n))return Ve;var i=e.dereferenceAllOpers([n])[0],o=[hS([UA(e,i.arrays[0],a)])];return dT(e,o)}var vT=function(e,t,r){return e.mathpack.cond2(t,r)>0},hT=function(e,t,r){return e.mathpack.cond2(t,r)<0};function pT(e,t,r,n,a){var i=GA(n,(function(t,r,a){return void 0===t?r:rr(t)?t:(k("calc.funcs.minMaxCoerceInner",$t(t)),rr(r)?r:(k("calc.funcs.minMaxCoerceInner",$t(r)),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var mT=pT.bind(void 0,vT,VA,void 0),gT=pT.bind(void 0,hT,VA,void 0),ST=pT.bind(void 0,vT,HA,VA),yT=pT.bind(void 0,hT,HA,VA);function CT(e,t){var r=ur(t)?t.getFallback():t;switch(r.kind){case J.Boolean:return r;case J.Number:return Le(0!==e.mathpack.cond(r));case J.String:return;case J.Error:return r;case J.Missing:case J.Blank:return;default:return y("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function kT(e,t,r){var n=GA(t,(function(t,r,n){var a;return void 0!==t&&rr(t)?t:rr(r)?r:(k("calc.funcs.booleanInner",(void 0===t||tr(t))&&tr(r)),Le(e(null===(a=t)||void 0===a?void 0:a.value,r.value,n)))}),CT,r);return null==n?Ve:n}var bT=kT.bind(void 0,(function(e,t){return!1!==e&&t})),ET=kT.bind(void 0,(function(e,t){return!0===e||t})),AT=kT.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function TT(e,t){return function(r,n,a){if(void 0!==r&&rr(r))return r;if(!rr(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function NT(e,t,r,n){var a=[],i=GA(t,TT(a,ep),VA,[r]);if(null==i)return je;if(rr(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return je;if(o.cond2(n,o.fromNumber(a.length))>0)return je;var u=a.sort(o.cond2);if(e){var s=ep(o.add(ep(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(s)-1]}return u[o.lfix(n)-1]}var RT=NT.bind(void 0,!0),FT=NT.bind(void 0,!1);function IT(e,t,r,n){var a=e.mathpack,i=[],o=GA(e,TT(i,ep),VA,t);if(null==o)return je;if(rr(o))return o;if(rr(r))return r;if(a.cond(r)<0)return je;if(a.cond2(r,a.one)>0)return je;var u=i.sort(a.cond2),s=ep(a.sub(a.fromNumber(u.length),a.one)),c=ep(a.add(a.fromNumber(u.length),a.one)),l=ep(n?a.mul(s,r):a.sub(ep(a.mul(c,r)),a.one));if(a.cond(l)<0||a.cond2(l,s)>0)return je;var d=a.lfix(l),f=ep(a.sub(l,a.fromNumber(d)));if(0===a.cond(f))return u[d];var v=a.sub(u[d+1],u[d]);return rr(v)?v:a.add(u[d],ep(a.mul(v,f)))}var DT=function(e,t,r){return IT(e,[t],r,!0)};function wT(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return DT(e,n,a)}var MT=function(e,t,r){return IT(e,[t],r,!1)};function _T(e,t){var r=e.mathpack;if(r.cond(t)<0)return je;if(r.cond2(t,r.fromNumber(5))>=0)return je;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var OT=function(e,t,r){return IT(e,[t],_T(e,r),!0)};function xT(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return OT(e,n,a)}var LT=function(e,t,r){return IT(e,[t],_T(e,r),!1)};function PT(e,t){return IT(e,t,e.mathpack.fromNumber(.5),!0)}function UT(e){return function(t,r){var n=e(t,r);return void 0!==n&&$t(n)?t.mathpack.mul(n,n):n}}function BT(e,t){return function(r,n){var a,i=e(r,n);if((null===(a=i)||void 0===a?void 0:a.kind)!==J.Number)return i;var o=r.mathpack,u=o.sub(i,t);return rr(u)?u:o.mul(u,u)}}function GT(e,t,r,n){var a,i={count:0};if(null==GA(r,jA(i),e,n,t))return Ge;k("calc.funcs.varFirstPass: unexpected count type",i.count>=1);var o=WA(r.mathpack.add),u=GA(r,o,e,n,t),s=GA(r,o,UT(e),n,void 0===t?void 0:UT(t));if(k("calc.funcs.varFirstPass: unexpected sum type",null!=u),rr(u))return u;k("calc.funcs.varFirstPass: unexpected error",$t(u)&&(null===(a=s)||void 0===a?void 0:a.kind)===J.Number);var c=r.mathpack,l=c.div(u,c.fromNumber(i.count));return rr(l)?l:[i.count,u,s,l]}function VT(e,t,r,n,a){var i,o=GA(r,WA(r.mathpack.add),BT(e,a),n,void 0===t?void 0:BT(t,a));return k("calc.funcs.varSecondPass: unexpected error",(null===(i=o)||void 0===i?void 0:i.kind)===J.Number),o}function HT(e,t,r,n){var a=GT(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],c=a[3];if(o<2)return Ge;var l=i.mul(u,u);if(rr(l))return l;var d=ep(i.div(l,i.fromNumber(o))),f=ep(i.sub(s,d));if(0===i.cond(c))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o-1));if(i.cond(f)>=0){var v=ep(i.div(f,i.fromNumber(o-1)));if(i.cond2(v,i.fromNumber(21219957905e-324))>0){var h=i.div(d,s),p=rr(h)?h:i.sub(h,i.one);if(!rr(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(c,v),g=rr(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!rr(g)&&i.cond(g)<0)return v}}}var S=VT(e,t,r,n,c);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o-1))}function WT(e,t,r,n){var a=GT(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],c=a[3];if(o<1)return Ge;var l=i.mul(u,u);if(rr(l))return l;var d=i.mul(s,i.fromNumber(o));if(rr(d))return d;var f=ep(i.sub(d,l));if(0===i.cond(c))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o*o));if(i.cond(f)>=0){var v=ep(i.div(f,i.fromNumber(o*o)));if(i.cond2(v,i.fromNumber(21219957905e-324))>0){var h=i.div(ep(i.div(l,i.fromNumber(o))),s),p=rr(h)?h:i.sub(h,i.one);if(!rr(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(c,v),g=rr(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!rr(g)&&i.cond(g)<0)return v}}}var S=VT(e,t,r,n,c);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o))}var jT=HT.bind(void 0,VA,void 0),KT=WT.bind(void 0,VA,void 0),YT=HT.bind(void 0,HA,VA),qT=WT.bind(void 0,HA,VA);function JT(e){return function(t,r){var n=e(t,r);return $t(n)?t.mathpack.sqrt(n):n}}var zT=JT(jT),QT=JT(KT),XT=JT(YT),ZT=JT(qT);function $T(e,t){var r=e.dereferenceAllOpers(t);return zT(e,r)}function eN(e,t){var r=e.dereferenceAllOpers(t);return QT(e,r)}function tN(e,t){var r=e.dereferenceAllOpers(t);return jT(e,r)}function rN(e,t){var r=e.dereferenceAllOpers(t);return KT(e,r)}var nN=[nT,sT,lT,mT,gT,$A,zT,QT,JA,jT,KT];function aN(e,t){var r,n=[],a=GA(e,(r=n,function(e,t,n){if(void 0!==e&&rr(e))return e;if($t(t))for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),VA,t);if(null==a)return Ke;if(rr(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,s=0,c=1/0,l=[];function d(e){u=1,c=e.index}var f,v,h,p=function(e){var t=e.value;u>s?(s=u,l.length=0,l.push({value:t,index:c})):u===s&&l.push({value:t,index:c})};d(o[0]);for(var m=1;m<o.length;m+=1)v=o[m-1],h=o[m],0===i.cond2(v.value,h.value)?((f=o[m]).index<c&&(c=f.index),u+=1):(p(o[m-1]),d(o[m]));return p(o[o.length-1]),s<2?Ke:(k("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function iN(e,t){var r=aN(e,t);return Array.isArray(r)?r[0].value:r}function oN(e,t){var r=e.dereferenceAllOpers(t);return iN(e,r)}function uN(e){return pS(e)?hS(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===Tr.WorksheetFuncName&&(r.id===Z.SUBTOTAL||r.id===Z.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))}))):e}var sN=M(nN,[PT,iN]),cN=[RT,FT,DT,OT,MT,LT];function lN(e,t){return dN(e,t,!1)}function dN(e,t,r){var n,a,i=t[0],o=null!=(a=null===(n=t[2])||void 0===n?void 0:n.value)&&a?1:-1,u=0,s=0,c=e.mathpack,l=GA(e,(function(e,t,r){if(void 0!==e)return e;if(rr(t))return t;var n=c.cond2(i,ep(t));0===n?u+=r:n===o&&(s+=r)}),VA,e.dereferenceAllOpers([t[1]]));if(void 0!==l)return l;if(0===u)return Ke;var d=c.fromNumber(s+1);if(r){var f=c.div(c.fromNumber(u-1),c.fromNumber(2));return c.add(d,ep(f))}return d}function fN(e){return function(t,r){var n,a=e(t,r);return(null===(n=a)||void 0===n?void 0:n.kind)===J.Number?t.mathpack.abs(a):a}}function vN(e,t,r){var n=eT(VA,void 0,!0,je,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=GA(t,WA(t.mathpack.add),e(function(e,t){return function(r,n){var a,i=e(r,n);return(null===(a=i)||void 0===a?void 0:a.kind)===J.Number?r.mathpack.sub(i,t):i}}(VA,a)),r);return k("calc.funcs.sumDevAndCount",void 0!==o),rr(o)?o:[ep(o),i]}function hN(e,t,r){var n=t.datepack,a=t.config,i=n.fromNum(a,r[0],Sn.RoundSec);return!1===i?je:t.mathpack.fromNumber(e(i))}var pN=hN.bind(void 0,(function(e){return e.yr})),mN=hN.bind(void 0,(function(e){return e.mon})),gN=hN.bind(void 0,(function(e){return e.dom})),SN=hN.bind(void 0,(function(e){return e.hour})),yN=hN.bind(void 0,(function(e){return e.min})),CN=hN.bind(void 0,(function(e){return e.sec}));function kN(e,t,r){void 0===r&&(r=!1);var n,a=t,i=a[0],o=a[1],u=e.config,s=e.mathpack,c=e.datepack.fromNum(F(F({},u),{date1904:u.date1904&&!r}),i,Sn.RoundSec);if(!1===c)return je;switch(void 0!==o?s.sfix(o):1){case 1:case 17:n=c.wdy;break;case 2:case 11:n=1===c.wdy?7:c.wdy-1;break;case 3:n=1===c.wdy?6:c.wdy-2;break;case 12:n=(c.wdy+4)%7+1;break;case 13:n=(c.wdy+3)%7+1;break;case 14:n=(c.wdy+2)%7+1;break;case 15:n=(c.wdy+1)%7+1;break;case 16:n=c.wdy%7+1;break;default:return je}return s.fromNumber(n)}function bN(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return je}function EN(e,t,r){var n=r,a=n[0],i=n[1],o=ip(t,a);if(rr(o))return o;var u=function(e,t,r){if(void 0===t||ir(t))return[r?2:1,r];var n=ap(e,t);if(!rr(n)){var a=e.mathpack.sfix(n);if(r){if(1===a||2===a)return[a,r]}else{if(1===a||2===a)return[a,r];if(a>=11&&a<=16)return[a-9,r];if(17===a)return[1,r];if(21===a)return[2,!0]}}return[void 0,r]}(t,i,e),s=u[0],c=u[1];if(void 0===s)return je;var l=t.mathpack,d=t.datepack,f=t.config,v=F(F({},f),{date1904:!1}),h=d.fromNum(v,o,Sn.RoundSec);if(!1===h)return bN(l,v.dateCompatibility,o);var p=yn(h.yr,1,1,0,0,0,0,0,Sn.RoundSec),m=d.toNum(v,p);if(rr(m))return bN(l,v.dateCompatibility,o);var g=kN(t,[m],!0);if(rr(g))return g;var S=ep(l.add(ep(l.sub(g,l.fromNumber(s))),l.fromNumber(7))),y=ep(up(l,S,l.fromNumber(7))),C=ep(l.add(l.floor(ep(l.div(ep(l.add(ep(l.sub(o,m)),y)),l.fromNumber(7)))),l.one));return c?function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=F({},n),s=(t+6-u.wdy)%7;if(12===u.mon&&u.dom+s>=35)return a.one;u.dom=4,u.mon=1;var c=i.toDays(o,u);if(k("calc.funcs.weeknumISOAmendments",!1!==c),((c=(c-1)%7+1)-t+7)%7<3){var l=ep(a.sub(r,a.one));if(0===a.cond(l)){var d=u.yr-1;return t===c||d%4==0&&(d%100!=0||d%400==0)&&(t-c+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return l}return r}(t,s,C,h):C}var AN=EN.bind(void 0,!0),TN=EN.bind(void 0,!1);var NN;function RN(e,t){var r;if(er(t)){var n=t.value.replace(/^\s+/,"");if(rr(r=e.coerceOper(Pe(n),J.Number)))return r}else r=t;return ip(e,r)}function FN(e,t,r){return r?ep(e.sub(t,e.fromNumber(1462))):t}function IN(e,t){return 0!=(e>>t%7&1)}function DN(e){switch(e){case 1:return NN.Saturday|NN.Sunday;case 2:return NN.Sunday|NN.Monday;case 3:return NN.Monday|NN.Tuesday;case 4:return NN.Tuesday|NN.Wednesday;case 5:return NN.Wednesday|NN.Thursday;case 6:return NN.Thursday|NN.Friday;case 7:return NN.Friday|NN.Saturday;case 11:return NN.Sunday;case 12:return NN.Monday;case 13:return NN.Tuesday;case 14:return NN.Wednesday;case 15:return NN.Thursday;case 16:return NN.Friday;case 17:return NN.Saturday;default:return!1}}function wN(e){if(7!==e.length)return!1;for(var t=NN.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function MN(e,t){var r=NN.Saturday|NN.Sunday,n=t[0],a=t[1],i=ip(e,n);if(rr(i))return i;var o=ap(e,a);if(rr(o))return o;var u=e.mathpack,s=e.config;o=u.floor(o);var c=u.cond(o)>0?u.one:u.fromNumber(-1),l=u.abs(o);if(!op(e,ep(u.add(i,o))))return je;if(0===u.cond(l))return FN(u,i,s.date1904);var d=null,f=[];if(2!==t.length){var v=t[2];if(!ir(v)){if($t(v)){var h=DN(u.lfix(v));if(!1===h)return je;r=h}else{if(!er(v))return je;var p=wN(v.value);if(!1===p)return Ve;r=p}if(127===r)return Ve}if(4===t.length){var m=t[3];if(!ir(m)){var g=function e(t,r){switch(r.kind){case J.Number:return Rt(new Ch(1,1,1,1,[[r]],tt));case J.String:var n=t.coerceOper(r,J.Number);return rr(n)?Ft(Ve):Rt(new Ch(1,1,1,1,[[n]],tt));case J.Blank:return Rt(new Ch(1,1,1,1,[[t.mathpack.zero]],tt));case J.Missing:return Ft(Ke);case J.Error:return Ft(r);case J.Range:return e(t,Jh(t,r,!1));case J.Array:return Rt(new Ch(r.rows,r.cols,r.rows,r.cols,r.opers,tt));default:return Ft(Ve)}}(e,m);if(!It(g))return g.reason;d=g.value}}}for(var S=null==d?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var i=0;i<e.denseCols;i+=1){var o=e.get(a,i);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var u=0;u<n;u+=1)t.push(r)}var s=(e.rows-e.denseRows)*e.cols;if(s>0&&void 0!==r)for(a=0;a<s;a+=1)t.push(r);return t}(d),y=S.length-1;y>=0;y-=1){var C=S[y];switch(C.kind){case J.Number:case J.String:case J.Blank:var k=ip(e,C);if(rr(k))return k;f[y]=k;break;case J.Error:return C;default:return Ve}}for(;u.cond(l)>0;){if(i=ep(u.add(i,c)),!IN(r,u.lfix(i))){var b=!0;for(y=0;y<S.length;y+=1)if(0===u.cond2(f[y],i)){b=!1;break}b&&(l=ep(u.sub(l,u.one)))}}return op(e,i=FN(u,i,s.date1904))?i:je}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(NN||(NN={}));function _N(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=F(F({},o),{date1904:!1}),s=i.fromNum(u,t,Sn.RoundSec);if(!1===s)return s;var c=a.fromNumber(s.dom),l=a.fromNumber(s.mon),d=a.fromNumber(12),f=a.fromNumber(s.yr);if(a.cond(r)>=0){f=ep(a.add(a.floor(ep(a.div(r,d))),f));var v=ep(up(a,r,d)),h=ep(a.add(v,l));1===a.cond2(h,d)&&(f=ep(a.add(f,a.one))),l=ep(up(a,h,d))}else{var p=a.neg(r),m=a.floor(ep(a.div(p,d)));f=ep(a.sub(f,m));v=ep(up(a,p,d));if(a.cond2(v,l)>=0)f=ep(a.sub(f,a.one)),l=ep(a.add(ep(a.sub(l,v)),d));else{var g=ep(a.sub(l,v));l=ep(up(a,g,d))}}0===a.cond(l)&&(l=d);var S=a.lfix(l);switch(S){case 4:case 6:case 9:case 11:var y=a.fromNumber(30);a.cond2(c,y)>0&&(c=y);break;case 2:a.cond2(c,a.fromNumber(28))>0&&(c=a.fromNumber(i.daysPerMonth(2,a.toNumber(f),!1)))}if(n&&(c=a.fromNumber(i.daysPerMonth(S,a.toNumber(f),!1))),a.lfix(f)<(u.dateCompatibility?1900:-9999))return!1;var C=function(e,t,r,n,a,i){var o=e.lfix(n),u=e.lfix(a),s=e.lfix(i);return t.toNum(r,yn(s,u,o,0,0,0,0,0,Sn.RoundSec))}(a,i,u,c,l,f);return!rr(C)&&C}function ON(e,t,r){var n=r,a=n[0],i=n[1],o=ip(t,a);if(rr(o))return o;var u=ap(t,i);if(rr(u))return u;var s=t.mathpack,c=t.config,l=_N(t,o,u=s.cond(u)>0?s.floor(u):s.ceil(u),!e);return!1===l?je:FN(s,l,c.date1904)}var xN,LN=ON.bind(void 0,!0),PN=ON.bind(void 0,!1);function UN(e,t){var r,n,a=e.mathpack,i=NN.Saturday|NN.Sunday,o=5,u=t[0],s=t[1],c=t[2];function l(e){o=7;for(var t=i=e;0!==t;)1==(1&t)&&(o-=1),t>>=1}if(void 0!==c&&!ir(c))if(er(c)){var d=wN(c.value);if(!1===d)return Ve;l(d)}else{var f=ap(e,c);if(rr(f))return Ve;var v=DN(a.lfix(f));if(!1===v)return je;l(v)}var h=null!=(r=t[3])?r:et,p=ip(e,u);if(rr(p))return p;var m=ip(e,s);if(rr(m))return m;var g,S=a.lfix(p),y=a.lfix(m);S>y?(g=S,S=y,y=g,n=-1):n=1,g=S%7,g=y%7;for(var C=0,k=S<y?S:y,b=S<y?y:S;k%7!=0&&k!==b;)IN(i,k)||(C+=1),k+=1;for(;b%7!=6&&k!==b;)IN(i,b)||(C+=1),b-=1;if(b===k&&1!=(i>>k%7&1)&&(C+=1),S>y){var E=k;k=b,b=E}var A=a.fromNumber(o*Math.floor((b+1-k)/7)+C);switch(h.kind){case J.Number:case J.String:var T=ip(e,h);if(rr(T))return T;(g=a.lfix(T))>=S&&g<=y&&g%7>=2&&(A=ep(a.sub(A,a.one)));break;case J.Range:case J.Array:var N=function(e,t,r,n,a,i){var o,u=e.mathpack;if(void 0===i||ir(i))o=NN.Saturday|NN.Sunday;else if(er(i)){var s=wN(i.value);if(!1===s)return Ve;o=s}else{var c=ap(e,i);if(rr(c))return Ve;var l=DN(u.lfix(c));if(!1===l)return je;o=l}var d=u.fromNumber(r),f=u.fromNumber(n),v=e.dereferenceOper(a,J.Array);if(!ar(v))return Ve;var h=[];function p(e){if(u.cond2(e,d)>=0&&u.cond2(e,f)<=0){var t=u.lfix(e);IN(o,t)||h.push(e)}}for(var m=0;m<v.rows;m+=1)for(var g=0;g<v.cols;g+=1){var S=v.opers[m][g];switch(S.kind){case J.Number:case J.String:var y=ip(e,S);if(rr(y))return y;p(y);break;case J.Blank:break;case J.Error:return S;default:return Ve}}var C=t;if(0!==h.length){var k=h.sort((function(e,t){return u.cond2(e,t)})),b=k[0];C=ep(u.sub(C,u.one));for(m=0;m<k.length;m+=1){var E=k[m];0!==u.cond2(E,b)&&(b=E,C=ep(u.sub(C,u.one)))}}return C}(e,A,S,y,h,c);if(rr(N))return N;A=N;break;case J.Error:return h;case J.Missing:break;default:return Ve}return a.mul(a.fromNumber(n),A)}function BN(e,t,r,n,a,i,o){var u=360*(r-t),s=30*(a-n);return e.mathpack.fromNumber(o-i+s+u)}function GN(e,t,r,n){var a=e.datepack,i=e.config;return t===a.daysPerMonth(r,n,i.dateCompatibility)}function VN(e,t,r,n,a){var i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case xN.Basis30360:return function(e,t,r,n,a){var i=e.datepack,o=e.config,u=i.fromNum(o,t,Sn.RoundSec);if(!1===u)return!1;var s=u.dom,c=u.mon,l=u.yr,d=i.fromNum(o,r,Sn.RoundSec);if(!1===d)return!1;var f=d.dom,v=d.mon,h=d.yr;return 2===f&&GN(e,f,v,h)&&(2===s&&GN(e,s,c,l)||3===n)&&(f=30),31===f&&(s>=30||3===n)&&(f=30),31===s&&(s=30),a&&2===c&&GN(e,s,c,l)&&(s=30),BN(e,l,h,c,v,s,f)}(e,t,r,a,!0);case xN.BasisActual360:case xN.BasisActual365:case xN.BasisActual:return ep(i.sub(r,t));case xN.BasisE30360:return function(e,t,r){var n=e.datepack,a=e.config,i=n.fromNum(a,t,Sn.RoundSec);if(!1===i)return!1;var o=i.dom,u=i.mon,s=i.yr,c=n.fromNum(a,r,Sn.RoundSec);if(!1===c)return!1;var l=c.dom,d=c.mon;return 31===o&&(o=30),31===l&&(l=30),BN(e,s,c.yr,u,d,o,l)}(e,t,r)}}return!1}function HN(e,t){var r=t,n=r[0],a=r[1],i=void 0===a||ir(a)?e.mathpack.zero:ap(e,a);if(rr(i))return i;var o=ap(e,n);return rr(o)?o:[o,i]}function WN(e,t){if(nr(t)){if(wt(t.sheets)){var r=Xe(t.sheets,[Vt(t.ranges[0])]);return e.dereferenceOper(r,Gh)}return Ve}return t}function jN(e,t,r){var n=Jh(e,t,!0);return n instanceof ES?void 0!==r&&n.arity!==r?Ke:n:rr(n)?n:He}function KN(e,t){var r=t,n=r[0],a=r.slice(1),i=jN(e,n,a.length);return rr(i)?i:e.applyLambda(i,a)}function YN(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=jN(e,i,2);if(rr(o))return o;var u=e.mathpack,s=u.fix(n),c=u.fix(a);if(s<1||c<1)return Ve;if(s*c>1e6)return Yg(hr(["ARRAY.MAKE with very large size"]));var l=[nt,nt];return xh(new Ph(e,s,c,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(o,l)})))}function qN(e,t){var r=Jh(e,t[0],!0);return r instanceof ES?e.mathpack.fromNumber(r.arity):Ke}!function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(xN||(xN={}));var JN=zh(Ee(Z.IFS)),zN=zh(Ee(Z.SWITCH));function QN(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),Xh(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=Qt(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}var XN=function(e){return e<0?ae.Lt:e>0?ae.Gt:ae.Eq};function ZN(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(t.kind){case J.Number:n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,XN(r.cond2(n,a)))};var r,n,a};break;case J.String:if(r){var u=new OA(i,t.value);n=function(e){return{correctType:!0,sgnT:u.test(e.value)?ae.Eq:ae.Ne}}}else n=function(e){return{correctType:!0,sgnT:XN(i.stringCompareCI(e.value,t.value))}};break;case J.Boolean:n=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,XN(r-n))};var r,n};break;case J.Rich:return Yg(hr(["lookup with rich value condition"]));default:return y("calc.funcs.makeLookupComparer",t)}return function(e){var r=ur(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:ae.Ne}:n(r)}}function $N(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,s=ZN(e,t);;){var c=s(r.get(i)).sgnT;if(c===ae.Ne){if(i<u)for(var l=i+1;l<=u;l+=1)if((c=s(r.get(l)).sgnT)!==ae.Ne){i=l;break}c===ae.Ne&&(i=Math.floor((o+u)/2),c=ae.Gt)}if(c===ae.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(c===ae.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(c===ae.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function eR(e,t,r,n){for(var a=-1,i=ZN(e,t,n===ae.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),s=u.correctType,c=u.sgnT;if(s){if(c===ae.Eq)return o;if(c!==ae.Ne&&c===n)return a;a=o}o===r.denseLength&&(o=K(o,r.length-2))}return n!==ae.Eq?a:r.length}function tR(e){switch(e.kind){case J.Number:return Ke;case J.Range:return wt(e.sheets)?e.ranges.length>1?Ke:e:Ve;case J.Array:return e}}function rR(e,t){var r;switch(t.kind){case J.Number:return t;case fS.RangeValues:r=t.arrays[0].get(0,0);break;case J.Array:r=t.opers[0][0];break;default:return y("calc.funcs.lookupFuncs.getNumFromRef",t)}return rr(r=e.coerceOper(r,J.Number))?He:r}function nR(e){switch(e.kind){case J.Number:case J.Rich:return Ke;case J.Range:if(!wt(e.sheets))return Ve;if(e.ranges.length>1)return Ke;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?Ke:e;case J.Array:return 1!==e.rows&&1!==e.cols?Ke:e}}function aR(e){switch(e.kind){case fS.RangeValues:return e.arrays[0];case J.Array:return new Ch(e.rows,e.cols,e.rows,e.cols,e.opers,tt)}}function iR(e,t){switch(t.kind){case J.Range:var r=t.sheets,n=t.ranges[0];return new bh(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=pt(n.row+t,n.col+a);return e.dereferenceAllOpers([Xe(r,[i])])[0].arrays[0].get(0,0)}),(function(){return C("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case J.Array:return new Ch(t.rows,t.cols,t.rows,t.cols,t.opers,tt)}}function oR(e){if(nr(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function uR(e,t,r){var n,a,i=t,o=i[0],u=i[1],s=i[2],c=i[3],l=tR(u);if(rr(l))return l;var d=cR(l,r),f=sR(aR(e.dereferenceAllOpers([d])[0]),r),v=!(null==(a=null===(n=c)||void 0===n?void 0:n.value)||a)?eR(e,o,f,ae.Eq):$N(e,o,f);if(v<0||v>=f.length)return Ke;var h=function(e,t){switch(t.kind){case J.Number:return t;case J.Range:if(!wt(t.sheets))return Ve;if(t.ranges.length>1)return He;var r=t.ranges;return e.calcingArray?Yg(hr(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?Yg(hr(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case J.Array:return Yg(hr(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,s);if(rr(h))return h;var p=e.dereferenceAllOpers([h])[0],m=rR(e,p);if(rr(m))return m;var g=e.mathpack.sfix(m)-1,S=iR(e,l);return g<0?Ve:g>=(r?S.rows:S.cols)?He:r?S.get(g,v):S.get(v,g)}function sR(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function cR(e,t){if(nr(e)){var r=e.ranges[0],n=ht(r.row,r.col,t?1:r.rows,t?r.cols:1);return Xe(e.sheets,[n])}return e}var lR=Zh((function(e){return e.mathpack.sqrt})),dR=Zh((function(e){return e.mathpack.exp})),fR=$h((function(e){return e.mathpack.power})),vR=Zh((function(e){return e.mathpack.ln})),hR=Zh((function(e){return e.mathpack.log}));var pR=Zh((function(e){return e.mathpack.sin})),mR=Zh((function(e){return e.mathpack.cos})),gR=Zh((function(e){return e.mathpack.tan})),SR=Zh((function(e){return e.mathpack.asin})),yR=Zh((function(e){return e.mathpack.acos})),CR=Zh((function(e){return e.mathpack.atan})),kR=$h((function(e){return e.mathpack.atan2}));var bR=$h((function(e){return e.mathpack.round}));var ER=$h((function(e){return e.mathpack.roundUp})),AR=$h((function(e){return e.mathpack.roundDown}));function TR(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return je;if(0===n||0===a)return e.zero;var i=e.div(t,r);return rr(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function NR(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return je;if(0===n&&0===a)return t;var i=e.div(t,r);return rr(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function RR(e,t){return TR(e.mathpack,t[0],t[1])}function FR(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||ir(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:TR(i,n,o)}function IR(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(ep(up(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(ep(up(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var DR=IR.bind(void 0,!0),wR=IR.bind(void 0,!1),MR=Zh((function(e){return e.mathpack.abs}));function _R(e,t){var r,n=t,a=n[0],i=n[1].value;if(er(a)&&a.value.length>255||i.length>255)return Ve;switch(a.kind){case J.String:r=$t(o=e.coerceOper(a,J.Number))?o:a;break;case J.Number:r=a;break;case J.Boolean:var o;k("calc.funcs.text",er(o=e.coerceOper(a,J.String))),r=o}var u=e.applyFormat(e.originSheet.document,i,r);return void 0!==u?Pe(u):Ve}function OR(e,t,r,n){if(void 0===r||ir(r))return{formatValue:t,formatDecimals:null!=n?n:2};var a=e.config.mathpack;if(a.cond(r)<0){var i=bR(e,[t,r]);return k("calc.funcs.fixedDollarRound",$t(i)||rr(i)),{formatValue:i,formatDecimals:0}}var o=a.sfix(r);return o<0||o>127?{formatValue:Ve,formatDecimals:0}:{formatValue:t,formatDecimals:o}}function xR(e,t){var r,n,a,i=t,o=i[0],u=i[1],s=i[2],c=OR(e,o,u,void 0),l=c.formatValue,d=c.formatDecimals;if(rr(l))return l;a=null!=(n=null===(r=s)||void 0===r?void 0:r.value)&&n?0===d?Mr.NoComFixed0:2===d?Mr.NoComFixed:Cv(e.config.localeInfo,!1,1,d):0===d?Mr.Fixed0:2===d?Mr.Fixed:Cv(e.config.localeInfo,!0,4,d);var f=e.applyFormat(e.originSheet.document,a,l);return void 0!==f?Pe(f):Ve}function LR(e,t){var r=t,n=r[0],a=r[1],i=e.config.localeInfo,o=OR(e,n,a,i.isEastAsia?i.currencyDecimals:void 0),u=o.formatValue,s=o.formatDecimals;if(rr(u))return u;var c=0===s?Mr.Currency:2===s?Mr.CurrencyDec:Tv(i,!1,s,!0,!1),l=e.applyFormat(e.originSheet.document,c,u);return void 0!==l&&l.length>0&&32===l.charCodeAt(l.length-1)?Pe(l.substring(0,l.length-1)):void 0!==l?Pe(l):Ve}function PR(e){for(var t=0;t<e.length&&32===e.charCodeAt(t);)t+=1;return e.substring(t)}function UR(e,t){var r=t[0];switch(r.kind){case J.Boolean:return Ve;case J.Number:return r;case J.String:return r.value.length>255?Ve:e.coerceOper(Pe(PR(r.value)),J.Number)}}function BR(e,t){var r;return er(t)?t.value.length>255?Ve:null!=(r=e.parseDate(PR(t.value)))?r:Ve:Ve}function GR(e,t){var r=BR(e,t[0]);return rr(r)?r:e.mathpack.trunc(r)}function VR(e,t){var r=BR(e,t[0]);return rr(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))}function HR(e,t){return Le(Jh(e,t[0],!0)instanceof ES)}function WR(e,t){var r=ap(e,t[0]);if(rr(r))return r;var n=e.mathpack,a=ep(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=ep(n.div(n.floor(a),n.fromNumber(2)));return Le(0===n.cond2(i,n.floor(i)))}function jR(e,t,r){var n=t[0];if(!wt(n.sheets))return Ve;var a=n.ranges[0];if(e.calcingArray||!_t(a)){var i=n.sheets;return Qe(a.rows,a.cols,Eh(a.rows,a.cols,(function(t,n){var o=kt(i,pt(a.row+t,a.col+n));return r(e.getCellFormula(o),o)})))}var o=Ht(Ct(n.sheets,a));return r(e.getCellFormula(o),o)}function KR(e,t){if(0===t.length)return[e.reflectionGridCell,!e.calcingArray];var r=t[0];if(!wt(r.sheets))return Ve;if(r.ranges.length>1)return He;var n=r.ranges[0];return[n,_t(n)]}function YR(e,t){var r=t[0],n=t[1].value;if(ur(r)){var a=r.getField(n);if(void 0!==a)return a}return qe}function qR(e,t){for(var r=t[0],n=e.config.localeInfo,a=Ud.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i].value,u=t[i+1];a=a.setValue(o,u)}return new bS(a,r)}function JR(e,t){return void 0===t?1:e.cond(t)<0?Ve:e.sfix(t)}function zR(e){return e>=65&&e<=90||e>=97&&e<=122}function QR(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():Yg(hr([t+" for non-ASCII input"]))}var XR={};XR[Z.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return JA(e,r)},XR[Z.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return $A(e,r)},XR[Z.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return nT(e,r)},XR[Z.COUNTBLANK]=function(e,t){var r=t[0];if(!nr(r)||!wt(r.sheets)||1!==r.ranges.length)return Ve;var n=e.dereferenceAllOpers(t);return cT(e,n)},XR[Z.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return mT(e,r)},XR[Z.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return gT(e,r)},XR[Z.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return bT(e,r)},XR[Z.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return lT(e,r)},XR[Z.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return ET(e,r)},XR[Z.CONCAT]=function(e,t){var r=t,n=e.dereferenceAllOpers(t);return oT(e,[],!0,r,n)},XR[Z.AVERAGEIF]=iT,XR[Z.AVERAGEIFS]=function(e,t){if(3===t.length)return iT(e,[t[1],t[2],t[0]]);var r=ZA(e,t,void 0,!0);return It(r)?rT(e,[r.value]):r.reason},XR[Z.COUNT]=function(e,t){var r=e.dereferenceAllOpers(t);return sT(e,r)},XR[Z.COUNTIF]=fT,XR[Z.COUNTIFS]=function(e,t){if(2===t.length)return fT(e,t);var r=ZA(e,t,!0);return It(r)?dT(e,[r.value]):r.reason},XR[Z.MEDIAN]=function(e,t){var r=e.dereferenceAllOpers(t);return PT(e,r)},XR[Z.SUMSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=UT(VA),a=GA(e,WA(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},XR[Z.SUMIF]=XA,XR[Z.SUMIFS]=function(e,t){if(3===t.length)return XA(e,[t[1],t[2],t[0]]);var r=ZA(e,t);return It(r)?qA(e,[r.value]):r.reason},XR[Z.LARGE]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return RT(e,n,a)},XR[Z.SMALL]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return FT(e,n,a)},XR[Z.RANK]=lN,XR[Z.RANK_EQ]=lN,XR[Z.RANK_AVG]=function(e,t){return dN(e,t,!0)},XR[Z.PERCENTILE]=wT,XR[Z.PERCENTILE_INC]=wT,XR[Z.PERCENTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return MT(e,n,a)},XR[Z.QUARTILE]=xT,XR[Z.QUARTILE_INC]=xT,XR[Z.QUARTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return LT(e,n,a)},XR[Z.TRIMMEAN]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=GA(e,TT(i,ep),VA,[n]);if(null==o)return je;if(rr(o))return o;var u=e.mathpack;if(u.cond(a)<0)return je;if(u.cond2(a,u.one)>=0)return je;i=i.sort(u.cond2);var s=u.lfix(ep(u.div(ep(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));k("calc.funcs.trimmean",s+s<i.length);var c=i[s],l=i[i.length-1-s],d=0,f=0,v=GA(e,WA(e.mathpack.add),(function(e,t){var r=VA(0,t);if(void 0===r)return r;k("calc.funcs.trimmean: unexpected error",$t(r));var n=e.mathpack;if(n.cond2(r,c)<0)d+=1;else{if(!(n.cond2(r,l)>0))return r;f+=1}}),[n]);k("calc.funcs.trimmean: found no elements",void 0!==v&&$t(v)),k("calc.funcs.trimmean: trimmed too many",d<=s&&f<=s);for(var h=v;d<s;d+=1){if(rr(p=u.sub(h,c)))return p;h=p}for(;f<s;f+=1){var p;if(rr(p=u.sub(h,l)))return p;h=p}return u.div(h,u.fromNumber(i.length-s-s))},XR[Z.AVERAGEA]=function(e,t){var r=e.dereferenceAllOpers(t);return aT(e,r)},XR[Z.MAXA]=function(e,t){var r=e.dereferenceAllOpers(t);return ST(e,r)},XR[Z.MINA]=function(e,t){var r=e.dereferenceAllOpers(t);return yT(e,r)},XR[Z.MAXIFS]=function(e,t){var r=ZA(e,t);return It(r)?mT(e,[r.value]):r.reason},XR[Z.MINIFS]=function(e,t){var r=ZA(e,t);return It(r)?gT(e,[r.value]):r.reason},XR[Z.XOR]=function(e,t){var r=e.dereferenceAllOpers(t);return AT(e,r)},XR[Z.AGGREGATE]=function(e,t){var r=e.mathpack,n=r.sfix(t[0]),a=r.sfix(t[1]);if(!(n>=1&&n<=sN.length+cN.length&&a>=0&&a<=7))return Ve;var i=1==(1&a),o=2==(2&a),u=!(4==(4&a));function s(t){var r=u?e.dereferenceAllOpersAndFormulae(t,i).map(uN):e.dereferenceAllOpers(t,i);return o&&(r=r.map((function(e){if(function(e){var t=e.kind;return"number"==typeof t&&0!=(t&BA)}(e))return e;if(pS(e))return hS(e.arrays.map((function(e){return e.map((function(e){return void 0===e||rr(e)?void 0:e}))})));if(function(e){return e.kind===J.Array}(e)){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||rr(e)?void 0:e}))}));return function(e,t,r){return E("calc.runtime.coercedArrayOper",e),E("calc.runtime.coercedArrayOper",t),r.length!==e?C("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:J.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(n>sN.length){if(4!==t.length)return Ve;var c=J.Number,l=e.coerceOper(e.dereferenceOper(t[3],c),c);if(rr(l))return Ve;var d=t[2];if(nr(d)&&!wt(d.sheets))return Ve;var f=s([d])[0],v=sN.length;return(0,cN[n-v-1])(e,f,l)}for(var h=2;h<t.length;h+=1){var p=t[h];if(!nr(p)||!wt(p.sheets))return Ve}var m=s(t.slice(2));return k("calc.funcs.aggregate: requested non-array function with unexpected number",n>=1&&n<=sN.length),(0,sN[n-1])(e,m)},XR[Z.SUBTOTAL]=function(e,t){var r=e.mathpack.sfix(t[0]),n=nN.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return Ve;var a=r>100||e.isInFilterMode(t.slice(1)),i=e.dereferenceAllOpersAndFormulae(t.slice(1),a).map(uN);return(0,nN[r%100-1])(e,i)},XR[Z.VAR]=tN,XR[Z.VAR_S]=tN,XR[Z.VARP]=rN,XR[Z.VAR_P]=rN,XR[Z.STDEV]=$T,XR[Z.STDEV_S]=$T,XR[Z.STDEVP]=eN,XR[Z.STDEV_P]=eN,XR[Z.VARA]=function(e,t){var r=e.dereferenceAllOpers(t);return YT(e,r)},XR[Z.VARPA]=function(e,t){var r=e.dereferenceAllOpers(t);return qT(e,r)},XR[Z.STDEVA]=function(e,t){var r=e.dereferenceAllOpers(t);return XT(e,r)},XR[Z.STDEVPA]=function(e,t){var r=e.dereferenceAllOpers(t);return ZT(e,r)},XR[Z.AVEDEV]=function(e,t){var r=e.dereferenceAllOpers(t),n=vN(fN,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))},XR[Z.DEVSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=vN(UT,e,r);return Array.isArray(n)?n[0]:n},XR[Z.MODE]=oN,XR[Z.MODE_SNGL]=oN,XR[Z.MODE_MULT]=function(e,t){var r=e.dereferenceAllOpers(t),n=aN(e,r);return Array.isArray(n)?Qe(n.length,1,n.map((function(e){return[e.value]}))):n},XR[Z.TEXTJOIN]=function(e,t){var r=t,n=r[0],a=r[1],i=r.slice(2),o=[];if(!ir(n)){if(nr(n)&&n.ranges.length>1)return Ve;var u=GA(e,TT(o,tp),(function(e,t){return e.coerceOper(t,J.String)}),e.dereferenceAllOpers([n]));if(void 0!==u&&rr(u))return u;k("calc.funcs.textjoin: expected string from reduce",void 0!==u&&er(u))}return oT(e,o,ir(a)||a.value,i,e.dereferenceAllOpers(i))},XR[Z.YEAR]=pN,XR[Z.MONTH]=mN,XR[Z.DAY]=gN,XR[Z.HOUR]=SN,XR[Z.MINUTE]=yN,XR[Z.SECOND]=CN,XR[Z.WEEKNUM]=TN,XR[Z.ISOWEEKNUM]=AN,XR[Z.WEEKDAY]=function(e,t){return kN(e,t)},XR[Z.DATE]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=e.datepack,s=e.config,c=o.sfix(n);if(c>9999)return je;var l=o.sfix(a);if(l>32767||l<-32768)return je;var d=o.sfix(i);(d>32767||d<-32768)&&(d=32767),s.dateCompatibility?c<1900&&(c+=1900):c<1900&&!(1899===c&&12===l&&d>=30)&&(c+=1900);var f=yn(c,l,d,0,0,0,0,0,Sn.RoundSec);return u.toNum(s,f)},XR[Z.TIME]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=e.datepack,s=e.config,c=o.sfix(n);if(c>32767)return je;var l=o.sfix(a);if(l>32767)return je;var d,f,v,h=o.sfix(i);if(h>32767)return je;s.dateCompatibility?(d=s.date1904?1904:1900,f=1,v=s.date1904?1:0):(d=1899,f=12,v=30);var p=yn(d,f,v,c,l,h,0,0,Sn.RoundSec),m=u.toNum(s,p);return rr(m)?m:o.cond(m)<0?je:o.sub(m,o.trunc(m))},XR[Z.DAYS360]=function(e,t){var r,n,a=e.mathpack,i=e.datepack,o=e.config,u=null!=(n=null===(r=t[2])||void 0===r?void 0:r.value)&&n,s=i.fromNum(o,t[0],Sn.RoundSec);if(!1===s)return Ke;var c=31===s.dom||!u&&2===s.mon&&s.dom===i.daysPerMonth(2,s.yr,o.dateCompatibility)?30:s.dom,l=a.fromNumber(360*(s.yr-1900)+30*s.mon+c),d=i.fromNum(o,t[1],Sn.RoundSec);if(!1===d)return Ke;var f=31!==d.dom||!u&&30!==s.dom?d.dom:30,v=a.fromNumber(360*(d.yr-1900)+30*d.mon+f);return a.sub(v,l)},XR[Z.DAYS]=function(e,t){var r=t,n=r[0],a=r[1];if(er(n)&&n.value.length>255||er(a)&&a.value.length>255)return Ve;var i=RN(e,n);if(rr(i))return i;var o=RN(e,a);return rr(o)?o:e.mathpack.sub(i,o)},XR[Z.DATEDIF]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2].value;if(i.length>2||0===i.length)return je;var o=e.mathpack,u=e.datepack,s=e.config,c=o.lfix(n),l=u.fromNum(s,n,Sn.RoundSec);if(!1===l)return je;var d=e.mathpack.lfix(a),f=u.fromNum(s,a,Sn.RoundSec);if(!1===f)return je;if(c>d)return je;var v=f.dom,h=f.mon,p=f.yr;l.dom>v&&(0===(h-=1)&&(h=12,p-=1),v+=u.daysPerMonth(h,p,s.dateCompatibility)),l.mon>h&&(h+=12,p-=1);var m=function(e,t){return 0===s.localeInfo.stringCompareCI(e,t)};if(m(i,"Y"))return o.fromNumber(p-l.yr);if(m(i,"M"))return o.fromNumber(12*(p-l.yr)+(h-l.mon));if(m(i,"D"))return o.fromNumber(d-c);if(m(i,"MD"))return o.fromNumber(v-l.dom);if(m(i,"YM"))return o.fromNumber(h-l.mon);if(m(i,"YD")){for(var g=0,S=l.mon;S<h;S+=1)g+=u.daysPerMonth(S,l.yr,s.dateCompatibility);return o.fromNumber(g+(v-l.dom))}return je},XR[Z.WORKDAY]=function(e,t){return 2===t.length?MN(e,t):MN(e,[t[0],t[1],et,t[2]])},XR[Z.WORKDAY_INTL]=MN,XR[Z.EDATE]=LN,XR[Z.EOMONTH]=PN,XR[Z.NETWORKDAYS]=function(e,t){return 2===t.length?UN(e,t):UN(e,[t[0],t[1],et,t[2]])},XR[Z.NETWORKDAYS_INTL]=UN,XR[Z.YEARFRAC]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=xN.DefaultBasis;if(void 0!==i){var u=function(e,t){var r=xN.DefaultBasis;if(void 0===t||ir(t))return r;var n=ap(e,t);if(rr(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case xN.Basis30360:case xN.BasisActual:case xN.BasisActual360:case xN.BasisActual365:case xN.BasisE30360:return r;default:return je}}(e,i);if("number"!=typeof u)return u;o=u}var s=ip(e,n);if(rr(s))return s;var c=ip(e,a);if(rr(c))return c;var l=e.mathpack;if(l.cond2(s,c)>0){var d=s;s=c,c=d}var f=VN(e,s,c,o,0);if(!1===f)return je;var v=function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=a.fromNumber(360),s=a.fromNumber(365),c=a.fromNumber(366);switch(t){case xN.BasisActual:var l=i.fromNum(o,r,Sn.RoundSec);if(!1===l)return!1;var d=l.dom,f=l.mon,v=l.yr,h=i.fromNum(o,n,Sn.RoundSec);if(!1===h)return!1;var p,m=h.dom,g=h.mon,S=h.yr,y=S-1;if(v===S)return 29===i.daysPerMonth(2,v,o.dateCompatibility)?c:s;if(y===v&&(f>g||f===g&&d>=m))return 29===i.daysPerMonth(2,v,o.dateCompatibility)?!rr(p=i.toNum(o,yn(v,2,29,0,0,0,0,0,Sn.RoundSec)))&&(a.cond2(p,r)>=0?c:s):29===i.daysPerMonth(2,S,o.dateCompatibility)?!rr(p=i.toNum(o,yn(v,2,29,0,0,0,0,0,Sn.RoundSec)))&&(a.cond2(p,n)<=0?c:s):s;for(var C=0,k=v;k<=S;k+=1)29===i.daysPerMonth(2,k,o.dateCompatibility)?C+=366:C+=365;var b=a.fromNumber(S-v+1);return ep(a.div(a.fromNumber(C),b));case xN.Basis30360:case xN.BasisActual360:case xN.BasisE30360:return u;case xN.BasisActual365:return s;default:return u}}(e,o,s,c);return!1===v?je:l.div(f,v)},XR[Z.DELTA]=function(e,t){var r=HN(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero},XR[Z.GESTEP]=function(e,t){var r=HN(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero},XR[Z.NA]=function(e,t){return Ke},XR[Z.T]=function(e,t){var r=WN(e,t[0]);return er(r)||rr(r)?r:rp},XR[Z.N]=function(e,t){var r=WN(e,t[0]);if($t(r)||rr(r))return r;var n=e.mathpack;return tr(r)&&r.value?n.one:n.zero},XR[Z.TYPE]=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case J.Number:return n.fromNumber(1);case J.String:return n.fromNumber(2);case J.Boolean:return n.fromNumber(4);case J.Error:return n.fromNumber(16);case J.Array:return n.fromNumber(64);case J.Rich:return n.fromNumber(128);default:return y("calc.funcs.type",r)}},XR[Z.ERROR_TYPE]=function(e,t){var r=t[0];return rr(r)?e.mathpack.fromNumber(r.type):Ke},XR[Z.INFO]=function(e,t){return Ve},XR[Z.IF]=function(e,t){var r=t[0];return k("calc.funcs.if",tr(r)),t[r.value?1:2]},XR[Z.IFS]=function e(t,r){for(var n=0;n<r.length;n+=2){var a=r[n];if(ar(a)){var i=r.slice(n);return QN(t,JN,e,i)}if(rr(a))return a;if(k("calc.funcs.ifs",tr(a)),a.value)return r[n+1]}return Ke},XR[Z.SWITCH]=function e(t,r){var n=r[0];if(ar(n))return QN(t,zN,e,r);if(rr(n))return n;for(var a=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case J.Number:return function(e){return ur(e)?Yg(hr(["SWITCH with a rich value case"])):$t(e)&&0===r.compare(t,e)};case J.String:return function(e){return ur(e)?Yg(hr(["SWITCH with a rich value case"])):er(e)&&0===n.stringCompareCI(t.value,e.value)};case J.Boolean:return function(e){return ur(e)?Yg(hr(["SWITCH with a rich value case"])):tr(e)&&t.value===e.value};case J.Rich:return Yg(hr(["SWITCH with a rich value condition"]));default:return y("calc.funcs.makeSwitchComparer",t)}}(t.config,n),i=1;i<r.length-1;i+=2){var o=J.Error|J.Rich|J.Number|J.Boolean|J.String|J.Array,u=t.coerceOper(t.dereferenceOper(r[i],o),o);if(ar(u))return QN(t,zN,e,r);if(rr(u))return u;if(a(u))return r[i+1]}return r.length%2==0?r[r.length-1]:Ke},XR[Z.TRUE]=function(e,t){return rt},XR[Z.FALSE]=function(e,t){return nt},XR[Z.NOT]=function(e,t){return Le(!t[0].value)},XR[Z.CHOOSE]=function(e,t){var r=t[0];k("calc.funcs.choose",$t(r));var n=e.mathpack.fix(r);return n<1||n>t.length-1?Ve:t[n]},XR[Z.INDEX]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=e.mathpack,s=u.sfix(a);if(s<0)return Ve;var c=void 0===i?void 0:u.sfix(i);if(void 0!==c&&c<0)return Ve;var l,d,f=void 0===o?0:u.sfix(o)-1;if(f<0)return Ve;switch(n.kind){case J.Range:if(!wt(n.sheets))return Ve;if(f>=n.ranges.length)return He;var v=n.ranges[f];if(void 0===c)if(1===v.rows)l=0,d=s-1;else{if(1!==v.cols)return He;l=s-1,d=-1}else l=s-1,d=c-1;if(l>=v.rows||d>=v.cols)return He;var h=ht(v.row+K(l,0),v.col+K(d,0),-1===l?v.rows:1,-1===d?v.cols:1);return Xe(n.sheets,[h]);case J.Array:return f>0?He:(void 0===c?1===n.rows?(l=0,d=s-1):(l=s-1,d=-1):(l=s-1,d=c-1),l>=n.rows||d>=n.cols?He:-1===l&&-1===d?n:-1===l?Qe(n.rows,1,n.opers.map((function(e){return[e[d]]}))):-1===d?Qe(1,n.cols,[n.opers[l]]):n.opers[l][d]);default:return y("calc.funcs.lookupFuncs: INDEX",n)}},XR[Z.MATCH]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=function(e){switch(e.kind){case J.Number:return e;case J.Range:if(!wt(e.sheets))return Ve;if(e.ranges.length>1)return He;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?He:e}}(null!=i?i:o.one);if(rr(u))return u;var s=e.dereferenceAllOpers([u])[0],c=rR(e,s);if(rr(c))return c;var l=nR(a);if(rr(l))return l;var d=aR(e.dereferenceAllOpers([l])[0]),f=sR(d,1===d.rows),v=-1;return(v=o.cond(c)>0?$N(e,n,f):0===o.cond(c)?eR(e,n,f,ae.Eq):eR(e,n,f,ae.Lt))<0||v>=f.length?Ke:e.mathpack.fromNumber(v+1)},XR[Z.LOOKUP]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=tR(a);if(rr(o))return o;var u=oR(o),s=cR(o,u),c=sR(aR(e.dereferenceAllOpers([s])[0]),u),l=$N(e,n,c);if(l<0)return Ke;if(void 0!==i){var d=nR(i);if(rr(d))return d;var f=oR(d),v=sR(iR(e,function(e,t,r){if(nr(r)){var n=r.ranges[0],a=ht(n.row,n.col,j(t?1:e,(1<<20)-n.row),j(t?e:1,16384-n.col));return Ze(r.sheets,a)}return r}(c.length,f,d)),f);return l>=v.length?ar(d)?Ke:tt:v.get(l)}var h=iR(e,o);return u?h.get(h.rows-1,l):h.get(l,h.cols-1)},XR[Z.HLOOKUP]=function(e,t){return uR(e,t,!0)},XR[Z.VLOOKUP]=function(e,t){return uR(e,t,!1)},XR[Z.ABS]=MR,XR[Z.CEILING]=RR,XR[Z.ECMA_CEILING]=RR,XR[Z.DEGREES]=function(e,t){var r=e.mathpack,n=ep(r.div(r.fromNumber(180),r.pi));return r.mul(t[0],n)},XR[Z.FLOOR]=function(e,t){return NR(e.mathpack,t[0],t[1])},XR[Z.RADIANS]=function(e,t){var r=e.mathpack,n=ep(r.div(r.pi,r.fromNumber(180)));return r.mul(t[0],n)},XR[Z.ROUND]=bR,XR[Z.ROUNDUP]=ER,XR[Z.ROUNDDOWN]=AR,XR[Z.EVEN]=DR,XR[Z.SIGN]=function(e,t){var r=e.mathpack;return r.fromNumber(r.cond(t[0]))},XR[Z.PI]=function(e,t){return e.mathpack.pi},XR[Z.SQRT]=lR,XR[Z.EXP]=dR,XR[Z.POWER]=fR,XR[Z.LN]=vR,XR[Z.LOG10]=hR,XR[Z.LOG]=function(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;if(void 0===a)return i.log(n);var o=i.ln(n);if(rr(o))return o;var u=i.ln(a);return rr(u)?u:i.div(o,u)},XR[Z.SIN]=pR,XR[Z.COS]=mR,XR[Z.TAN]=gR,XR[Z.ASIN]=SR,XR[Z.ACOS]=yR,XR[Z.ATAN]=CR,XR[Z.ATAN2]=kR,XR[Z.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return je;for(var i=n.one,o=a;o>0;o-=1){if(rr(i))return i;i=n.mul(n.fromNumber(o),i)}return i},XR[Z.SQRTPI]=function(e,t){var r=ap(e,t[0]);if(rr(r))return r;var n=e.mathpack;if(n.cond(r)<0)return je;var a=n.mul(n.pi,r);return rr(a)?a:n.sqrt(a)},XR[Z.FACTDOUBLE]=function(e,t){var r=ap(e,t[0]);if(rr(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return je;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(rr(i))return i;i=n.mul(n.fromNumber(o),i)}return i},XR[Z.INT]=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},XR[Z.TRUNC]=function(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;return i.roundDown(n,null!=a?a:i.zero)},XR[Z.ROUNDDOWN]=AR,XR[Z.ODD]=wR,XR[Z.MROUND]=function(e,t){var r=ap(e,t[0]);if(rr(r))return r;var n=ap(e,t[1]);if(rr(n))return n;var a=e.mathpack;if(0===a.cond(n))return a.zero;if(0!==a.cond(r)&&a.cond(r)<0!=a.cond(n)<0)return je;var i=a.div(r,n);if(rr(i))return je;var o=a.floor(i),u=ep(a.sub(i,o)),s=a.fromNumber(.5-5e-15);if(a.cond2(u,s)<0)return a.mul(o,n);var c=a.add(o,a.one);return rr(c)?c:a.mul(c,n)},XR[Z.QUOTIENT]=function(e,t){var r=ap(e,t[0]);if(rr(r))return r;var n=ap(e,t[1]);if(rr(n))return n;var a=e.mathpack;if(0===a.cond(n))return Ge;var i=a.div(r,n);return rr(i)?je:a.cond(i)>0?a.floor(i):a.ceil(i)},XR[Z.FLOOR_MATH]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||ir(a)?o.one:o.abs(a),s=void 0===i||ir(i)?o.zero:i;return 0!==o.cond(s)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:NR(o,n,u)},XR[Z.FLOOR_PRECISE]=function(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||ir(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:NR(i,n,o)},XR[Z.CEILING_MATH]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||ir(a)?o.one:o.abs(a),s=void 0===i||ir(i)?o.zero:i;return 0!==o.cond(s)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:TR(o,n,u)},XR[Z.CEILING_PRECISE]=FR,XR[Z.ISO_CEILING]=FR,XR[Z.ISERROR]=function(e,t){return Le(rr(t[0]))},XR[Z.ISERR]=function(e,t){var r=t[0];return Le(rr(r)&&r.type!==Oe.NA)},XR[Z.ISBLANK]=function(e,t){return Le(or(t[0]))},XR[Z.ISLOGICAL]=function(e,t){return Le(tr(t[0]))},XR[Z.ISNA]=function(e,t){var r=t[0];return Le(rr(r)&&r.type===Oe.NA)},XR[Z.ISNONTEXT]=function(e,t){return Le(!er(t[0]))},XR[Z.ISTEXT]=function(e,t){return Le(er(t[0]))},XR[Z.ISNUMBER]=function(e,t){return Le($t(t[0]))},XR[Z.ISREF]=function(e,t){return Le(nr(t[0]))},XR[Z.ISEVEN]=WR,XR[Z.ISODD]=function(e,t){var r=WR(e,t);return tr(r)?Le(!r.value):r},XR[Z.ISFORMULA]=function(e,t){return jR(e,t,(function(e){return Le(void 0!==e)}))},XR[Z.FORMULATEXT]=function(e,t){return jR(e,t,(function(t,r){if(void 0===t)return Ke;var n=e.formatFormula(t,r.range);return t.source.kind===$e.Cell?Pe(n):Pe("{"+n+"}")}))},XR[Z.ROWS]=function(e,t){var r=t[0],n=e.mathpack;return ar(r)?n.fromNumber(r.rows):wt(r.sheets)?r.ranges.length>1?He:n.fromNumber(r.ranges[0].rows):Ve},XR[Z.COLUMNS]=function(e,t){var r=t[0],n=e.mathpack;return ar(r)?n.fromNumber(r.cols):wt(r.sheets)?r.ranges.length>1?He:n.fromNumber(r.ranges[0].cols):Ve},XR[Z.AREAS]=function(e,t){var r=t[0];return wt(r.sheets)?e.mathpack.fromNumber(r.ranges.length):Ve},XR[Z.SHEETS]=function(e,t){var r=e.mathpack;if(0===t.length)return r.fromNumber(e.getSheetRangeIndexes(dt(e.reflectionSheet.document)).length);var n=t[0];return ar(n)?Ke:r.fromNumber(e.getSheetRangeIndexes(n.sheets).length)},XR[Z.ROW]=function(e,t){var r=KR(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Qe(n.rows,1,Eh(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))},XR[Z.COLUMN]=function(e,t){var r=KR(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Qe(1,n.cols,Eh(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))},XR[Z.SHEET]=function(e,t){var r=e.mathpack;if(0===t.length){var n=e.reflectionSheet;return void 0===n.index?Ke:r.fromNumber(e.getSheetRangePosition(n)+1)}var a=t[0];if(er(a)){var i=e.getSheetIndex(e.reflectionSheet.document,a.value);return void 0===i?Ke:r.fromNumber(e.getSheetRangePosition(i)+1)}return nr(a)?r.fromNumber(e.getSheetRangePosition(a.sheets)+1):ar(a)?Ke:y("calc.funcs.sheet",a)},XR[Z.OFFSET]=function(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4];if(!wt(n.sheets))return Ve;if(1!==n.ranges.length)return Ve;var s=e.mathpack,c=n.ranges[0],l=c.row,d=c.col,f=c.rows,v=c.cols,h=l;$t(a)&&(h+=s.lfix(a));var p=d;$t(i)&&(p+=s.lfix(i));var m=h+f-1;if(void 0!==o&&$t(o)){if(0===(S=s.cond(o)))return He;m=h+s.lfix(o)-(S>0?1:-1)}var g=p+v-1;if(void 0!==u&&$t(u)){var S;if(0===(S=s.cond(u)))return He;g=p+s.lfix(u)-(S>0?1:-1)}var y=j(h,m),C=j(p,g),k=K(h,m)-y+1,b=K(p,g)-C+1;return y<0||C<0||y+k>1<<20||C+b>16384?He:Xe(n.sheets,[ht(y,C,k,b)])},XR[Z.TRANSPOSE]=function(e,t){var r=t[0];return ar(r)?Qe(r.cols,r.rows,Eh(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},XR[Z.SINGLE]=function(e,t){var r,n,a=t[0];if(cr(a))return a;if(ar(a))return a.opers[0][0];if(!wt(a.sheets))return He;if(1!==a.ranges.length)return Ve;if(null!=(n=null===(r=t[1])||void 0===r?void 0:r.value)&&n)return Xe(a.sheets,[Vt(a.ranges[0])]);var i=Yh(e.originGridCell,a.ranges[0]);return void 0===i?Ve:Xe(a.sheets,[i])},XR[Z.ADDRESS]=function(e,t){var r,n,a,i=t,o=i[0],u=i[1],s=i[2],c=i[3],l=i[4],d=e.mathpack,f=(null===(r=s)||void 0===r?void 0:r.kind)===J.Number?d.sfix(s)-1:0;if(f<0||f>3)return Ve;var v=0!=(1&f),h=0!=(2&f),p=(null===(n=c)||void 0===n?void 0:n.kind)!==J.Boolean||c.value?kr.A1:kr.R1C1,m=function(e,t,r){return p===kr.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},g=d.sfix(o);if(!m(h,1<<20,g))return Ve;if(!$t(u))return Ve;var S=d.sfix(u);if(!m(v,16384,S))return Ve;var y=pt(g<0?1048575:0,S<0?16383:0),C=Br(h?Ar.Rel:Ar.Abs,p===kr.R1C1&&h?g:g-1),b=Br(v?Ar.Rel:Ar.Abs,p===kr.R1C1&&v?S:S-1),E=bi(e.config.localeInfo,p,y,C,b,!1);return k("calc.funcs.address: cell wrapped",void 0!==E),(null===(a=l)||void 0===a?void 0:a.kind)===J.String?""===l.value?Pe("!"+E):l.value.length>255?Ve:Pe(wi(e.config.localeInfo,e.config.refStyle,l.value)+"!"+E):Pe(E)},XR[Z.INDIRECT]=function(e,t){var r,n,a=t,i=a[0].value,o=null==(n=null===(r=a[1])||void 0===r?void 0:r.value)||n?kr.A1:kr.R1C1;if(i.length>255||v(i," "))return Ve;var u=bt(e.originSheet,e.originGridCell),s={lexicalKind:$e.Indirect,originGridCell:Rt(u.range),originSheet:Rt(u.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},c=e.parseFormula(o,u.range,s,"="+i);if(!It(c))return He;for(var l=c.value.node,d=!1,f=!1;;){if(!d&&l.kind===Nr.App&&qt(l.head)&&l.head.id===ae.Pound&&1===l.args.length&&(d=!0,l=l.args[0]),f||l.kind!==Nr.Name){if(l.kind===Nr.CellRef){var h=e.getCellRef(l.qualifier,l.ref,u,!0);return void 0===h?He:wt(h.sheets)?d?vp(e,ae.Pound,[h]):h:He}return He}var p=e.getNameFormula(l.qualifier,l.whole);if(void 0===p)return He;u=bt(u.sheet,pt(0,0)),l=p[1],f=!0}},XR[Z.LEFT]=function(e,t){var r,n=t,a=n[0].value,i=n[1];if(void 0!==i&&rr(i))return i;var o=JR(e.mathpack,i);if("number"!=typeof o&&rr(o))return Ve;var u=null!=(r=_a(a,0,o))?r:a.length;return Pe(a.substring(0,u))},XR[Z.RIGHT]=function(e,t){var r,n=t,a=n[0].value,i=n[1];if(void 0!==i&&rr(i))return i;var o=JR(e.mathpack,i);if("number"!=typeof o&&rr(o))return Ve;var u=null!=(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;Ia(e.charCodeAt(n-1))&&n-2>=0&&Fa(e.charCodeAt(n-2))?n-=2:n-=1}return n}(a,a.length,o))?r:0;return Pe(a.substring(u))},XR[Z.MID]=function(e,t){var r,n,a=t,i=a[0].value,o=a[1],u=a[2],s=e.mathpack,c=s.fix(o)-1,l=s.fix(u);if(s.cond(o)<0||c<0||s.cond(u)<0||l<0)return Ve;var d=null!=(r=_a(i,0,c))?r:i.length,f=null!=(n=_a(i,d,l))?n:i.length;return Pe(i.substring(d,f))},XR[Z.LEN]=function(e,t){var r=t[0].value;return e.mathpack.fromNumber(Oa(r,0,r.length))},XR[Z.CONCATENATE]=function(e,t){for(var r=t,n="",a=0;a<r.length;a+=1){var i=r[a].value;if(n.length+i.length>32767){n+=i.substring(0,32767-n.length);break}n+=i}return Pe(n)},XR[Z.EXACT]=function(e,t){var r=t,n=r[0],a=r[1];return Le(n.value===a.value)},XR[Z.REPT]=function(e,t){var r=t[0].value,n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?Ve:""===r?rp:i*r.length>32767?Ve:Pe(h(r,i))},XR[Z.TRIM]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),Pe(n)},XR[Z.CLEAN]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return Pe(n)},XR[Z.CHAR]=function(e,t){var r=e.mathpack.sfix(t[0]);return r<1||r>255?Ve:Pe(String.fromCharCode(r))},XR[Z.UNICHAR]=function(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||a>=1114112?Ve:a<=65535&&Da(a)||a>=64976&&a<=65007||(65535&a)>=65534?Ke:Pe(Ma(a))},XR[Z.CODE]=function(e,t){var r=t[0].value;if(0===r.length)return Ve;var n=r.charCodeAt(0);return n>255?Yg(hr(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)},XR[Z.UNICODE]=function(e,t){var r=t[0].value;if(0===r.length)return Ve;var n=r.charCodeAt(0),a=e.mathpack;if(!Da(n))return a.fromNumber(n);if(1===r.length)return Ve;var i=wa(n,r.charCodeAt(1));return void 0===i?Ve:a.fromNumber(i)},XR[Z.LOWER]=function(e,t){var r=t[0].value;return Pe(QR(r,"LOWER",r.toLowerCase.bind(r)))},XR[Z.UPPER]=function(e,t){var r=t[0].value;return Pe(QR(r,"UPPER",r.toUpperCase.bind(r)))},XR[Z.PROPER]=function(e,t){var r=t[0].value;return Pe(QR(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!zR(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n;for(t+=e.charAt(n).toUpperCase(),n+=1;n<e.length&&zR(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t})))},XR[Z.FIND]=function(e,t){var r,n=t,a=n[0].value,i=n[1].value,o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return Ve;var s=null!=(r=_a(i,0,u))?r:i.length,c=i.indexOf(a,s);return c>=0?e.mathpack.fromNumber(Oa(i,0,c)+1):Ve},XR[Z.REPLACE]=function(e,t){var r,n,a=t,i=a[0].value,o=a[1],u=a[2],s=a[3].value,c=e.mathpack.sfix(o)-1;if(c<0||c>=32767)return Ve;var l=e.mathpack.sfix(u);if(l<0||l>32767)return Ve;var d=null!=(r=_a(i,0,c))?r:i.length,f=null!=(n=_a(i,d,l))?n:i.length,v=i.slice(0,d),h=i.slice(f);return v.length+s.length+h.length>32767?Ve:Pe(v+s+h)},XR[Z.SEARCH]=function(e,t){var r,n=t,a=n[0].value,i=n[1].value,o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return Ve;for(var s=null!=(r=_a(i,0,u))?r:i.length,c=new OA(e.config.localeInfo,a,!0);s<i.length;s+=1)if(c.test(i.slice(s)))return e.mathpack.fromNumber(Oa(i,0,s)+1);return Ve},XR[Z.SUBSTITUTE]=function(e,t){var r=t,n=r[0],a=r[1].value,i=r[2].value,o=r[3],u=n.value,s=1/0;if(void 0!==o){var c=e.coerceOper(o,J.Number);if(rr(c))return c;if((s=e.mathpack.sfix(c))<1||s>2147483646)return Ve}var l=a.length;if(l>0){for(var d="",f=0,v=0;s>=0&&-1!==(v=u.indexOf(a,v));)if((s-=1)===1/0||0===s){var h=u.slice(f,v);if(d.length+h.length+i.length>32767)return Ve;d+=h,d+=i,f=v+=l}else v+=1;var p=u.slice(f);return d.length+p.length>32767?Ve:Pe(d+=p)}return n},XR[Z.RAND]=function(e,t){return e.getRandom()},XR[Z.RANDBETWEEN]=function(e,t){var r=ap(e,t[0]),n=ap(e,t[1]);if(rr(r))return r;if(rr(n))return n;var a=e.mathpack;if(a.cond2(r,n)>0)return je;var i=e.getRandom(),o=a.ceil(r),u=a.floor(n),s=a.sub(u,o);return rr(s)?s:a.add(a.floor(ep(a.mul(ep(a.add(s,a.one)),i))),o)},XR[Z.NOW]=function(e,t){return e.getTime(hn.Instant)},XR[Z.TODAY]=function(e,t){return e.getTime(hn.Day)},XR[Z.HYPERLINK]=function(e,t){var r=t,n=r[0],a=r[1];return e.followHyperlinks?n:null!=a?a:n};var ZR=!1;function $R(e){return ZR||(ZR=!0,Ra(ba.CalcNumFmtFunctions)&&(Ra(ba["OfficeVSO:3852168_CalcCGTEXT"])&&(XR[Z.TEXT]=_R),Ra(ba["OfficeVSO:3852168_CalcCGFIXED"])&&(XR[Z.FIXED]=xR),Ra(ba["OfficeVSO:3852168_CalcCGDOLLAR"])&&(XR[Z.DOLLAR]=LR),Ra(ba["OfficeVSO:3852168_CalcCGVALUE"])&&(XR[Z.VALUE]=UR),Ra(ba["OfficeVSO:3852168_CalcCGDATEVALUE"])&&(XR[Z.DATEVALUE]=GR),Ra(ba["OfficeVSO:3852168_CalcCGTIMEVALUE"])&&(XR[Z.TIMEVALUE]=VR)),Ra(ba.CalcFieldValueFunction)&&(XR[Z.FIELDVALUE]=YR,XR[Z._FV]=YR),Ra(ba.CalcRecordFunctions)&&(XR[Z.RECORD]=qR),Ra(ba.CalcNestedRecordFunction)&&(XR[Z.NESTEDRECORD]=qR),Ra(ba.CalcFunFunctions)&&(XR[Z.ARITY]=qN,XR[Z.APPLY]=KN,XR[Z.ARRAYMAKE]=YN,XR[Z.ISFUN]=HR)),XR[e]}var eF=function(){function e(e){this.iformats=[],this.formatStrings=L(),this.knownFormats=e}return e.prototype.cloneServer=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=L(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?Ft({kind:SF.NumberFormat,iformat:e}):Rt(t.compiledFormat)},e.prototype.getKnownFormat=function(e){return Rt(this.knownFormats[e])},e.prototype.getFormatString=function(e){return Rt(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=L()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var a=e[t];r.iformats[t]=a,r.formatStrings[a.formatString]=t}))},e}(),tF=function(e,t){return(e<<t|e>>>32-t)>>>0},rF=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-tF(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^tF(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}(),nF=pt(0,0);var aF,iF=xe([],[],Q.None,Ie.Exact);!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(aF||(aF={}));var oF={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},uF=function(){function e(e,t,r,n,a){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=a,this.random=new rF(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.interruptToken=[Vm.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=e,this.parser=gd(this),this.analyzer=Df(this),this.formatter=xm(this),this.compiler=Wg(this),this.evaluator=zS(this)}return e.prototype.cloneServer=function(t){var r;void 0===t&&(t=oF);var n=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells);return n.documentLoc=this.documentLoc,n.document=null===(r=this.document)||void 0===r?void 0:r.cloneServer(),n.worksheetFuncOverrides=this.worksheetFuncOverrides,n.userDefinedFuncOverrides=this.userDefinedFuncOverrides,n},e.prototype.reconfigure=function(e,t,r){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Ft(EF([{kind:SF.DocumentLoc,document:st(e,t)}])):Rt(r)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===gt.Failure?Ft(EF([n.reason])):n},e.prototype.getUserDefinedFuncLoc=function(e,t){return void 0!==this.userDefinedFuncOverrides[t]?Rt([Nt(e,t)]):Ft(hr(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===gt.Failure)return Ft(EF([t.reason]));if(!0!==t.value)return Ft(EF([{kind:SF.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===gt.Failure?Ft(EF([r.reason])):r.value===hb.Unavailable?Ft(EF([{kind:SF.CellFormat}])):Rt(r.value)},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getIformat(t);if(n.kind===gt.Failure)return Ft(EF([n.reason]));var a=n.value.getValue();return a.kind===gt.Failure?Ft(Kf()):a},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===gt.Failure)return Ft(EF([n.reason]));var a=n.value.getValue();return a.kind===gt.Failure?Ft(Kf()):a},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getFormatString(t);return n.kind===gt.Failure?Ft(EF([n.reason])):n},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===gt.Failure)return Ft(EF([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));if(void 0===r.value)return Rt(void 0);var n=r.value.compiledFmla.getValue();if(It(n))return n;var a=this.hasRecalcNameFailure(e);return It(a)?a.value||this.setNameFailure(e,n.reason):this.cb.onUnavailableObject(a.reason),Ft(function(e){return{kind:Lm.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===gt.Failure)return Ft(EF([t.reason]));if(void 0===t.value)return Rt(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return Rt(void 0);var i=Ct(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return It(o)?Rt(qm(ot(a.lexicalKind,i),o.value)):o},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===gt.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===gt.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===gt.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setRecalcValue(e,t);if(a.kind===gt.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===gt.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(Ee(e).staticPrecs&(Q.Time|Q.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case Z.RAND:case Z.RANDBETWEEN:case Z.RANDARRAY:case Z.NOW:r=n===aF.GroundTruth;break;case Z.TODAY:r=n===aF.GroundTruth||n===aF.Estimation;break;default:r=void 0===Z[e]}if(!r)return Ft(EF([{kind:SF.VolatileFunction,name:ma(e)}]))}var a=null!=(t=this.worksheetFuncOverrides[e])?t:$R(e);return null!=a?Rt(a):Ft(hr([ma(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?Rt(this.userDefinedFuncOverrides[t]):Ft(hr(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===gt.Failure?Ft(EF([t.reason])):Rt(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,eb(e.range));if(n.kind===gt.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setClientValue(e,fA);if(a.kind===gt.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.setRecalcValue(e,tt);if(i.kind===gt.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.propagateEditTaint(e,r);if(o.kind===gt.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onRangeFailure(e,t,r,o.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===gt.Failure?Ft(EF([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getSheetName(t);return n.kind===gt.Failure?Ft(EF([n.reason])):void 0===n.value?n:Rt(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===gt.Failure)return Ft(EF([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===gt.Failure?Ft(EF([n.reason])):void 0===n.value?n:Rt(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===gt.Failure)return Ft(EF([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===gt.Failure?Ft(EF([a.reason])):a},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===gt.Failure)return Ft(EF([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===gt.Failure?Ft(EF([r.reason])):r},e.prototype.getRandom=function(){return k("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===aF.GroundTruth),Rt(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){var r=this.evalParams.volatileMode;switch(r){case aF.PrecisionTest:return Ft(EF([{kind:SF.GetTimeKind,getTimeKind:t}]));case aF.Estimation:switch(t){case Gf.NonVolatile:return Ft(EF([{kind:SF.GetTimeKind,getTimeKind:t}]));case Gf.ValueCell:case Gf.Volatile:}break;case aF.GroundTruth:}var n=this.config,a=n.mathpack,i=n.datepack,o=new Date,u=i.utcToLocal(this.config,yn(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCDay()+1,o.getUTCMilliseconds(),Sn.Round1000ths),this.config.timezone);k("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==u);var s=u.yr,c=u.rounding,l=u.mon,d=u.dom,f=u.hour,v=u.min,h=u.sec,p=u.fracSec;e<hn.Instant&&(p=0,h=0,v=0,f=0),e<hn.Day&&(d=1,l=1);var m=yn(s,l,d,f,v,h,1,p,c),g=i.toNum(this.config,m);k("calc.calc.PartialWorkbookDocumentCollection: toNum",!rr(g));var S=a.toNumber(g);if(r===aF.GroundTruth)return Rt(g);var y=i.toNum(this.config,u);k("calc.calc.PartialWorkbookDocumentCollection: toNum",!rr(y));var C,b=a.toNumber(y);switch(e){case hn.Instant:C=b;break;case hn.Day:C=S+1;break;case hn.Year:var E=yn(s+1,l,d,f,v,h,1,p,c),A=i.toNum(this.config,E);k("calc.calc.PartialWorkbookDocumentCollection: toNum",!rr(A)),C=a.toNumber(A)}return b<S+10/1440||b>C-10/1440?Ft(EF([{kind:SF.TimeGranularity,granularity:e}])):Rt(g)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:ig((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==gt.Paused?a:ig((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCell:t,volatileMode:r},(function(){return n.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t,r,n){var a=this,i={lexicalKind:$e.Other,originGridCell:Rt(t.range),originSheet:Rt(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},o={lexicalSource:{kind:$e.Other},originGridCell:Rt(t.range),originSheet:Rt(t.sheet),calcingArray:!1,reflectionGridCell:Rt(t.range),reflectionSheet:Rt(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:Rt(!1)},u=function(e,n){if(n.kind===gt.Paused)return ig((function(){return u(e,n.resume())}));if(!It(n))return Rt({value:n});var i=a.evalFormulaFormat(t,e,n.value,r);return Rt({value:Rt(n.value),formatted:i})};return this.withEvalParamsEvalFormula({computeKind:rb.EvalFormula,computeCell:t,volatileMode:n},(function(){var t=a.parser.parseFormula(i,e),r=a.checkFormula(i,t,e,"eval-formula"),n=a.compileFormula(i,r);return It(n)?u(n.value,a.evaluator.evalFormula(o,n.value)):Rt({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){if(void 0!==n){if(n===hb.Origin){var a=this.allEditedAvailable(e);return It(a)?!0!==a.value?Ft(EF([{kind:SF.GridRange,unavailableCells:a.value,range:e}])):this.formatValueCell(e,r):void this.cb.onUnavailableObject(a.reason)}if(n===hb.Inferred){var i={lexicalSource:{kind:$e.Other},originGridCell:Rt(e.range),originSheet:Rt(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},o=this.formatter.evalFormat(i,t);return It(o)?void 0===o.value?this.formatValueKnownFormat(e.sheet.document,Mr.General,r):"number"==typeof o.value?this.formatValueIformat(e.sheet.document,o.value,r):this.formatter.applyFormat(o.value,r,!0):o}return this.formatValueIformat(e.sheet.document,n,r)}},e.prototype.evalValue=function(e,t,r){var n,a=this.evalParams;this.evalParams={computeKind:t,computeCell:e,volatileMode:r};try{var i=this.getEditedFormula(e);if(!It(i))return this.cb.onUnavailableObject(i.reason);if(void 0!==(null===(n=i.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!It(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var u=this.tryGetCellValue(e.range,e.sheet);if(void 0===u)return;k("calc.calc.PartialWorkbookDocumentCollection.evalValue",u.kind===Gm.FinalValue),this.cb.onReturnCellValue(e,u.oper,nb.EditedCell)}finally{this.evalParams=a}},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===gt.Failure?r:(this.document=r.value.setSheetNames(t),Rt(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===gt.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===gt.Failure?i:i.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===gt.Failure?i:i.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():CA},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():NA},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getServerFormat(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===gt.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===gt.Failure||void 0===r.value?r:Rt(Ct(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){B(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===gt.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===gt.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,s){var c=this.getDocument(t.sheet.document);if(c.kind===gt.Failure)return c;var l=void 0===r?void 0:n?this.compileFmla(e,$e.Cell,kt(t.sheet,a),void 0,r):""===r?sA:{fmla:r,lexicalKind:$e.Cell,origin:a,compiledFmla:void 0,hasHyperlink:iA.ClientValueUnknown};return c.value.setCellContents(e,t,l,i,o,u,s)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getDocument(t.sheet.document);if(u.kind===gt.Failure)return u;var s=""===r?cA:this.compileFmla(e,$e.Range,kt(t.sheet,n),Vt(t.range),r);return u.value.setRangeFormula(e,t,s,a,i,o)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===gt.Failure)return n;var a=ut(t),i=void 0===r?void 0:this.compileNamedObject(e,a,r);return n.value.setNamedObject(e,t,i)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===gt.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===gt.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,a=this.ensureDocument(e);if(a.kind===gt.Failure)return a;var i=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,a=e.builtIn,o=n.compileNumberFormat(r,a);i[t]={formatString:r,compiledFormat:o}})),Rt(a.value.setNumberFormats(i,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===gt.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===gt.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return Rt(t);var r=this.getDocument(e);if(!It(r))return Ft(EF([r.reason]));var n=r.value.getIformat(t);return It(n)?n.value.getValue():Ft(EF([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!It(n))return n;var a=this.getFormatString(e,n.value.formatString);return It(a)?Rt(null!=(r=a.value)?r:n.value):a},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return It(r)?void 0!==r.value?Rt(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?Rt(t):this.resolveStringFormat(e,t)},e.prototype.parseInferredEdit=function(e,t,r){var n=this.allEditedAvailable(e);if(!It(n))return Ft(EF([n.reason]));if(!0!==n.value)return Ft(EF([{kind:SF.GridRange,unavailableCells:n.value,range:e}]));var a=this.getEditedFormat(e);if(!It(a))return Ft(EF([a.reason]));if(a.value===hb.Unavailable)return Ft(EF([{kind:SF.CellFormat}]));var i=this.resolveCellFormat(e.sheet.document,a.value);if(!It(i))return i;var o=this.evalParams;this.evalParams={computeKind:rb.ParseEdit,computeCell:e,volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=o}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!It(t))return Rt(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return Rt(void this.cb.onUnavailableObject({kind:SF.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!It(r))return Rt(hb.Unavailable);var n=ot(t.value[1].lexicalKind,Ct(e.sheet,t.value[0])),a=r.value;return this.formatter.evalFormat(dv(n),a)},e.prototype.fillInferredFormat=function(e,t){var r=this;lb(e.set,(function(n){var a=kt(e.sheet,n);if(t===hb.Unavailable)return It(u=r.setEditedFormat(a,hb.Unavailable))||r.cb.onUnavailableObject(u.reason),!0;var i=r.resolveCellFormat(e.sheet.document,t);if(!It(i))return r.cb.onInferFormatFailure(a,i.reason),!0;var o=r.getEditedFormat(a);if(!It(o))return r.cb.onUnavailableObject(o.reason),!0;if(o.value===hb.Unavailable)return!0;var u,s=r.resolveCellFormat(e.sheet.document,o.value);if(!It(s))return r.cb.onInferFormatFailure(a,s.reason),!0;gh(i.value,s.value)&&(It(u=r.setEditedFormat(a,t))||r.cb.onUnavailableObject(u.reason));return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i,o=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==o&&It(o)?[Po(this.config,o.value,e),(n=o.value,a=[],i=qi(Yi((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return Ki(e,i)}))}))},vApp:function(e){var t;if(qt(e.head))a.push(ga(e.head.id));else{var r=n.annotations[e.head.label];(null===(t=r)||void 0===t?void 0:t.kind)===Tr.WorksheetFuncName&&a.push(ma(r.id))}for(var o=0,u=e.args;o<u.length;o++)Ki(u[o],i)},vParen:function(e){Ki(e.node,i)},vFieldRef:function(e){Ki(e.lhs,i)}}),ji(n.node,i),a)]:[Ho(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new wA((function(){var o=i.parser.parseFormula(jo(t,r.range),a),u=e?o:i.autocorrectFormula(Xd(t,r),o),s=i.checkFormula(Xd(t,r),u,a,e?"server-cell-formula":"edit-cell-formula"),c=i.adjustFormulaOrigin(s,r.range,n);return i.compileFormula(Um(t,r.range),c)})),hasHyperlink:iA.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return It(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new wA((function(){var t=r.fmla,i=n.parser.parseFormula(jo($e.NameManager,nF),t);k("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var o=Zd(bt(Et(n.documentLoc),nF)),u=i,s=n.checkFormula(o,u,t,a);return n.compileFormula(Bm(nF),s)}))};case"NamedValue":return{obj:r,compiledFmla:new wA((function(){var e,a;if(nr(r.value)){k("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",wt(r.value.sheets)&&1===r.value.ranges.length);var i=r.value.sheets,o=n.getDocument(i.document);if(!It(o))return n.cb.onUnavailableObject(o.reason),Ft(EF([o.reason]));var u=o.value.getSheetName(i.index);if(!It(u))return n.cb.onUnavailableObject(u.reason),Ft(EF([u.reason]));var s=r.value.ranges[0];e=Kr(sn(Hr(Vr(Br(Ar.Abs,s.row),Br(Ar.Abs,s.col)),Vr(Br(Ar.Abs,s.row+s.rows-1),Br(Ar.Abs,s.col+s.cols-1))),Lr(u.value,xr(i.document.name,i.document.path))),[]),a=kt(i,nF)}else e=Kr(zr(r.value,!0),[]),a=bt(Et(n.documentLoc),nF);var c=n.analyzer.checkFormula(Zd(a),e);return It(c)&&Mt(c.value)?n.compileFormula(Bm(nF),Rt(c.value)):C("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+Po(n.config,e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new wA((function(){return Ft(EF([{kind:SF.ClientFailure,reason:r.failureReason}]))}))};default:return y("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!It(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);return It(a)?Mt(a.value[0])?Rt(a.value[0]):Ft(jm("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Ho(r),n,zd(a.value[1]))):a},e.prototype.autocorrectFormula=function(e,t){return It(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){return It(e)&&void 0!==r?CS(t,r,e.value):e},e.prototype.compileNumberFormat=function(e,t){var r=this;return new wA((function(){var n=r.formatter.createFormat(e,t);return It(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return U(Mr,(function(t){return e.compileNumberFormat(_v(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.parser.formatFormula(Xo(e,kt(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return It(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,v(r,"'")):n},e.prototype.formatValueCell=function(e,t){var r=this.getEditedResolvedFormat(e);if(!It(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return It(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return It(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return It(t)?t.value===hb.Unavailable?Ft(EF([{kind:SF.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):Ft(EF([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Pt(this.documentLoc,e)?Rt(this.document):this.unavailableFailure({kind:SF.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new DA(e,this.config.localeInfo.stringCompareCI,new eF(this.compileKnownFormats()))),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return Ft(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return Lt(e,(function(a,i,o){var u=r.tryGetCellValue(a,t);return void 0!==u&&((void 0!==n[i]?n[i]:n[i]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=kt(t,e),n=this.getRecalcValue(r);if(n.kind!==gt.Failure){var a=n.value,i=a.oper,o=a.failure;if(void 0===o){var u=this.hasRecalcDirty(r);if(It(u)){if(!u.value)return Km(i);var s=this.getEditedFormula(r);if(s.kind!==gt.Failure)if(void 0!==s.value){var c=s.value,l=c[0],d=c[1];if(void 0!==d.compiledFmla){if(It(this.readCompiledFmla(Ct(t,l),d.compiledFmla)))return Ym(kt(t,Vt(l)))}else this.cb.onUnavailableObject({kind:SF.CellEvaluatingValue})}else this.setCellFailure(r,EF([{kind:SF.CellMissingFormula}]),iF);else this.cb.onUnavailableObject(s.reason)}else this.cb.onUnavailableObject(u.reason)}else this.setCellFailure(r,o,iF)}else this.cb.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===gt.Failure)return Ft(EF([n.reason]));if(!0!==n.value)return Ft(EF([{kind:SF.GridRange,range:r,unavailableCells:n.value}]));var a=t.hasRecalcFailure(r);if(a.kind===gt.Failure)return Ft(EF([a.reason]));if(a.value)return Ft(ng(r));if(qh(r.range)>t.maxDereferenceCells)return Ft(EF([{kind:SF.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?Ft(ng(r)):Rt(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(It(r))return r;if(this.setCellFailure(e,r.reason,iF),r.reason.kind===Lm.Unavailable){r.reason;return r}return Ft(EF([{kind:SF.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===gt.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===gt.Failure||void 0===r.value?r:Rt(Ct(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===gt.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===gt.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===gt.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===gt.Failure?r:r.value.setClientFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===gt.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===gt.Failure)return r;var n=vA(r.value.oper)||!fr(this.config.mathpack,r.value.oper,t,!0);if(n){var a=this.setClientValue(e,t);if(a.kind===gt.Failure)return a}return Rt(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===gt.Failure)return r;var n=t!==r.value;if(n){var a=this.setClientFormat(e,t);if(a.kind===gt.Failure)return a}return Rt(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,a=this.getClientFormula(Ht(e));if(a.kind===gt.Failure)return a;var i=null!=(n=a.value)?n:[e.range,dA],o=i[0],u=i[1],s=Vt(e.range),c=void 0!==t&&t!==u.fmla||void 0!==u.compiledFmla&&!Bt(s,u.origin),l=void 0!==r&&r!==u.hasHyperlink;if(c||l){var d=u.compiledFmla,f=this.setClientFormula(Ct(e.sheet,o),{fmla:null!=t?t:u.fmla,compiledFmla:d,origin:void 0!==t?s:u.origin,hasHyperlink:null!=r?r:u.hasHyperlink});if(f.kind===gt.Failure)return f}return Rt({hasFmlaChanged:c,hasHyperlinkChanged:l})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===gt.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===gt.Failure)return r;if(r.value)return Rt(nb.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i,o=a[n],u=this.hasRecalcEditTaint(o);if(u.kind===gt.Failure)return u;if(u.value)return(i=this.setRecalcEditTaint(e.sheet,eb(e.range))).kind===gt.Failure?i:Rt(nb.DependentCell)}return 0!=(t.special&(Q.Calc|Q.Time))?(i=this.setRecalcEditTaint(e.sheet,eb(e.range))).kind===gt.Failure?i:Rt(nb.DependentCell):t.bound===Ie.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===rb.EditedCell?Rt(nb.IndependentCell):Rt(nb.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===gt.Failure?r:r.value.setClientValue(e,t)},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===gt.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===gt.Failure?r:r.value.setClientFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===gt.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===gt.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===gt.Failure)return this.cb.onUnavailableObject(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}();function sF(e,t){return e&t-1}var cF,lF=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[sF(this.front+t,r)]=this.values[sF(this.front+t,e)];this.values.length=r,this.front=sF(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[sF(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=sF(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[sF(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.popBack=function(){var e=sF(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=sF(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[sF(this.front+r,t)]))return!1}return!0},e}();!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(cF||(cF={}));var dF,fF,vF=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,a=null!=(n=this.taskDeqs[e])?n:this.taskDeqs[e]=new lF;t===cF.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!=(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}();function hF(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function pF(e,t){switch(t.kind){case J.Number:return{kind:"n",magnitude:hF(e.toNumber(t))};case J.String:return{kind:"s"};case J.Boolean:return{kind:"b"};case J.Error:return{kind:"e",type:(r=t.type,n=la[r],void 0===n?"error.type:"+r:n)};case J.Rich:return{kind:"r"};case J.Array:return{kind:"a"};case J.Blank:return{kind:"z"};default:return y("calc.calc.precisionValue",t)}var r,n}function mF(e,t){var r=e[t.sheet.index];return void 0!==r&&Hk(r,eb(t.range))}function gF(e,t){var r,n=null!=(r=e[t.sheet.index])?r:ok;e[t.sheet.index]=xk(n,eb(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(dF||(dF={})),function(e){e.Success="Success",e.Timeout="Timeout"}(fF||(fF={}));var SF,yF=function(){function e(e){var t,r,n,a=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){return function e(t){return nS.try((function(){var r=t();return Array.isArray(r)?r:e(r.resume)}))}((function(){return a.docs.evaluate(rb.EditedCell,e,aF.PrecisionTest)}))},this.testPrint=function(e){return nS.try((function(){var t=a.getAvailableFormula(e);if(!It(t))return a.onUnavailableObject(t.reason);if(t.value){var r=t.value,n=r[0],i=r[1],o=i.compiledFmla.getValue(),u=It(o)?a.docs.printFormulaBarText(n,i.origin,o.value):o;if(It(u)){var s=Ho(i.fmla),c=u.value===i.fmla?{expected:s}:{expected:s,sampled:Ho(u.value)};a.log.push({kind:dF.PrintFormulaStatistics,stats:{samples:[c],failures:[]}})}else a.log.push({kind:dF.PrintFormulaStatistics,stats:{samples:[],failures:[u.reason]}})}}))},this.config={samplePrecisionEvalRate:(t=e.samplePrecisionEvalRate,null!=t?t:0),samplePrecisionPrintFormulaRate:(r=e.samplePrecisionPrintFormulaRate,null!=r?r:0),rngSeed:(n=e.rngSeed,null!=n?n:0|$())},this.rng=new rF(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(fF.Success)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(fF.Timeout)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells),this.runtime=new _h(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return nS.all(M(r.map(t.testEval),n.map(t.testPrint)))})).catch((function(e){t.log.push({kind:dF.UnhandledFailure,reason:e})})))},e.prototype.step=function(){this.result||(this.result=this.runtime.step())},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(a){var i=a.sheetIdx;return n.push(nS.try((function(){e.docs.forEachServerNonBlankCellInSet(i,ik,(function(n){if(e.rng.next()<e.config.samplePrecisionEvalRate){var a=kt(i,n);gF(e.sampledSets,a),t.push(a)}return e.rng.next()<e.config.samplePrecisionPrintFormulaRate&&r.push(kt(i,n)),!0}))}))),!0})),nS.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!It(t))return t;if(void 0===t.value)return Rt(void 0);var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?Rt(void 0):Rt([ot(a.lexicalKind,Ct(e.sheet,n)),a])},e.prototype.onRangeFailure=function(e,t,r,n,a){var i={samples:[],failures:[t]};this.log.push({kind:dF.EvalStatistics,stats:i})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=EF([e]);this.log.push({kind:dF.UnhandledFailure,reason:t})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return mF(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,a){var i=this.getAvailableFormula(e);if(!It(i))return this.onUnavailableObject(i.reason);if(i.value){var o=i.value,u=o[0],s=o[1],c=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,u,s,c)}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=this.getAvailableFormula(Ht(e));if(!It(o))return this.onUnavailableObject(o.reason);if(o.value){var u=o.value,s=u[0],c=u[1],l=this.hasWrongPrecedent(r);Lt(e.range,(function(r,n,a){return i.logPrecisionResult(kt(e.sheet,r),t[n][a],s,c,l),!0}))}},e.prototype.logPrecisionResult=function(e,t,r,n,a){var i=this.docs.allServerAvailable(e);if(!It(i))return this.onUnavailableObject(i.reason);if(!0===i.value){var o=this.docs.getServerValue(e);if(!It(o))return this.onUnavailableObject(o.reason);var u=mF(this.sampledSets,e),s=this.precisionResult(t,o.value.oper,r,n,u,a);(function(e){return void 0===e.sampled})(s)||gF(this.precisionWrongSets,e);var c={samples:[s],failures:[]};this.log.push({kind:dF.EvalStatistics,stats:c})}},e.prototype.precisionResult=function(e,t,r,n,a,i){var o=this.docs.config.mathpack,u=pF(o,t),s=this.docs.anonymizeFormula(r,n),c=s[0],l=s[1];if(fr(o,e,t,!0))return{expected:u,formula:c,functions:l,root:a,cascaded:i};var d=pF(o,e);if($t(t)&&$t(e)){var f=o.toNumber(t),v=o.toNumber(e);return{expected:u,sampled:d,relMagnitude:hF(0===f?v:(v-f)/f),formula:c,functions:l,root:a,cascaded:i}}return{expected:u,sampled:d,formula:c,functions:l,root:a,cascaded:i}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==fF.Success){for(var n={samples:[],failures:{}},a={samples:[],failures:{}},i={},o=0,u=this.log;o<u.length;o++){var s=u[o];switch(s.kind){case dF.EvalStatistics:(t=n.samples).push.apply(t,s.stats.samples);for(var c=0,l=s.stats.failures;c<l.length;c++){var d=l[c];FD(n.failures,d)}break;case dF.PrintFormulaStatistics:(r=a.samples).push.apply(r,s.stats.samples);for(var f=0,v=s.stats.failures;f<v.length;f++){d=v[f];FD(a.failures,d)}break;case dF.UnhandledFailure:FD(i,s.reason);break;default:y("calc.calc.PrecisionExperiment.createResultMessage",s)}}return["PrecisionExperiment",e,"stateId = "+this.stateId,"evalStats = "+JSON.stringify(n),"printStats = "+JSON.stringify(a),"unhandledFailures = "+JSON.stringify(i)].join(", ")}},e}(),CF=ht(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind"}(SF||(SF={}));var kF,bF,EF=pr;function AF(e){if(Ra(ba.CalcNumFmtPhaseOne)){var t=e();if(Ra(ba.CalcNumFmtPhaseTwo))return t}}!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo"}(kF||(kF={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalFormula=6]="ComputeEvalFormula",e[e.RecalcFinished=7]="RecalcFinished",e[e.MaybeCollectGarbage=8]="MaybeCollectGarbage",e[e.RunExperiment=9]="RunExperiment",e[e.TestAdvanceState=10]="TestAdvanceState"}(bF||(bF={}));var TF=function(){function e(e,t,r,n,a){var i,o=this,u=n.date1904,s=n.dateCompatibility,c=n.timezone;void 0===a&&(a={}),this.scheduler=new vF,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.printFormulaProperties=function(e){var t=Ht(e),r=o.getAvailableFormula(t);if(It(r)){var n=r.value,a=n[0],i=n[1],u=i.compiledFmla.getValue(),s=It(u)?o.docs.printFormulaBarText(a,t.range,u.value):u;return{formulaBarText:s.kind===gt.Success?s.value:void o.outputMessageLog.push({kind:pb.PrintFormulaFailure,stateId:o.stateId,range:e,reason:s.reason}),hasHyperlink:o.formulaHasHyperlink(i),isFormula:!0}}o.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,a=o.docs.getEditedFormula(e);if(It(a)){var i=null!=(n=null===(r=a.value)||void 0===r?void 0:r[1].fmla)?n:"",u=o.docs.renderValueBarText(e,t,i);return{formulaBarText:It(u)?u.value:void o.outputMessageLog.push({kind:pb.PrintFormulaFailure,stateId:o.stateId,range:e,reason:u.reason}),hasHyperlink:!1,isFormula:!1}}o.onUnavailableObject(a.reason)},this.scheduleAvailableFormulas=function(e,t){var r=o.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=kt(e.sheet,r),a=o.docs.getEditedFormula(n);return a.kind===gt.Failure?(o.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&o.enqueueComputeCellValue(n,t),!0)}));It(r)||o.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=o.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=kt(e.sheet,r),a=o.docs.getEditedFormula(n);return a.kind===gt.Failure?(o.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||o.enqueueReturnCellValue(n,t),!0)}));It(r)||o.onUnavailableObject(r.reason)},this.docs=new uF(jn(e,r,t,u,s,c),this,a,a,null!=(i=a.maxDereferenceCells)?i:32768),this.reconfigure(a)}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new rF(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!=(t=e.maxDereferenceCells)?t:32768)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==rb.EvalFormula&&this.outputMessageLog.push({kind:pb.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){a.computeKind!==rb.EvalFormula&&this.outputMessageLog.push({kind:pb.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:pb.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:pb.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=EF([e]);this.outputMessageLog.push({kind:pb.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a){var i=this;if(a.computeKind!==rb.EvalFormula){var o=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.ChangedCell,stateId:this.stateId,cellKind:n}),n!==nb.EditedCell&&n!==nb.DependentCell||this.outputMessageLog.push(F(F({kind:pb.CellWrite,stateId:this.stateId,cellKind:n,cell:e},o),{formatted:AF((function(){return i.formatValue(n,e,t)}))}))):this.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this;if(a.computeKind!==rb.EvalFormula){var o=this.outputRange(e,t,n);void 0!==o&&(n!==nb.EditedCell&&n!==nb.DependentCell||this.outputMessageLog.push(F(F({kind:pb.RangeWrite,stateId:this.stateId,cellKind:n,range:e},o),{formatted:t.map((function(t,r){return t.map((function(t,a){return AF((function(){return i.formatValue(n,kt(e.sheet,pt(e.range.row+r,e.range.col+a)),t)}))}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,a=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==a?(this.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.ChangedCell,stateId:this.stateId,cellKind:nb.EditedCell}),r===nb.EditedCell&&this.outputMessageLog.push(F(F({kind:pb.CellWrite,stateId:this.stateId,cellKind:nb.EditedCell,cell:e},a),{formatted:AF((function(){return n.formatValue(r,e,t)}))}))):this.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.UnchangedCell,stateId:this.stateId,cellKind:nb.EditedCell})},e.prototype.outputCell=function(e,t,r,n){var a,i;if(r===nb.EditedCell||r===nb.DependentCell){var o=this.docs.testAndSetClientValue(e,t);i=It(o)?o.value?t:void 0:void this.onUnavailableObject(o.reason)}var u=this.outputFormat(e,r),s=this.outputFormulaProperties(e,r,n);return void 0!==i||void 0!==u||void 0!==s?{value:t,format:u,formulaBarText:null===(a=s)||void 0===a?void 0:a.formulaBarText,hasHyperlink:AF((function(){var e;return null===(e=s)||void 0===e?void 0:e.hasHyperlink}))}:void 0},e.prototype.outputRange=function(e,t,r){var n,a=this;if(r===nb.EditedCell||r===nb.DependentCell){var i=this.docs.setClientValue(e,t);It(i)||this.onUnavailableObject(i.reason)}var o=t.map((function(t,n){return t.map((function(t,i){return a.outputFormat(kt(e.sheet,pt(e.range.row+n,e.range.col+i)),r)}))}));return{values:t,formats:o,formulaBarText:null===(n=this.outputFormulaProperties(e,r,this.printFormulaProperties))||void 0===n?void 0:n.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===nb.EditedCell){var r=this.docs.getEditedFormat(e);if(It(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(It(n)){if(n.value){var a=r.value;if(a===hb.Unavailable)return{format:EF([{kind:SF.CellFormat}]),valueType:Lf.Custom,decimals:0};var i=this.docs.resolveCellFormat(e.sheet.document,a);return It(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===nb.EditedCell){var n=r(e);if(void 0!==n){var a=n.formulaBarText,i=n.hasHyperlink,o=n.isFormula,u=this.docs.testAndSetClientFormula(e,a,i);if(It(u)){var s=u.value,c=s.hasFmlaChanged,l=s.hasHyperlinkChanged;return c||l?{formulaBarText:c?a:void 0,hasHyperlink:l?i:void 0,isFormula:o}:void 0}this.onUnavailableObject(u.reason)}}},e.prototype.formatValue=function(e,t,r){var n=this.docs.formatValueCell(t,r);if(It(n))return n.value;this.outputMessageLog.push({kind:pb.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:n.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!It(t))return t;if(void 0===t.value)return Ft({kind:SF.CellMissingFormula});var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?Ft({kind:SF.CellEvaluatingValue}):Rt([ot(a.lexicalKind,Ct(e.sheet,n)),a])},e.prototype.formulaHasHyperlink=function(e){var t,r;if(e.lexicalKind!==$e.Cell)return!1;var n=null===(r=null===(t=e)||void 0===t?void 0:t.compiledFmla)||void 0===r?void 0:r.getValue();if(It(n)){var a=n.value.annotations;for(var i in a){var o=a[i];if(o.kind===Tr.WorksheetFuncName&&o.id===Z.HYPERLINK)return!0}return!1}},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,o,u,s){var c,l,d,f,v=void 0!==u?EF([{kind:SF.ClientFailure,reason:u}]):void 0,h=o;void 0!==n?(l=n,k("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),d=a):void 0===r?(k("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==o&&void 0===v),l=!1,d=void 0):(k("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===v&&h===hb.Weak),l=(c=this.parseInferredEdit(t,r,i,v,h)).isFormula,d=c.oper,v=c.cellFailure,h=c.cellFormat,f=c.inferredFormat);var p=this.docs.setCellContents(e,t,r,l,i,d,v,h,s);if(p.kind===gt.Failure)return this.onUnavailableObject(p.reason);if(this.docs.onCellModified(e),!e){var m=kt(t.sheet,i),g=void 0===r?Rt(void 0):l?this.docs.inferFormulaFormat(m):void 0!==f&&f!==Mr.General?this.docs.resolveValueFormat(t.sheet.document,f):Rt(void 0);g.kind!==gt.Success&&(this.onInferFormatFailure(m,g.reason),g=Rt(hb.Unavailable)),void 0!==g.value&&this.docs.fillInferredFormat(t,g.value),this.enqueueBeforeCompute(s)}},e.prototype.parseInferredEdit=function(e,t,r,n,a){var i=this.docs.parseInferredEdit(kt(e.sheet,r),t,this.getVolatileMode());if(!It(i))return{isFormula:!1,oper:tt,cellFailure:i.reason,cellFormat:hb.Unavailable};switch(i.value.kind){case rv.Formula:return{isFormula:!0,oper:tt,cellFailure:n,cellFormat:a};case rv.String:case rv.Other:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a};case rv.Number:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a,inferredFormat:i.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=Kb(r);k("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:tt,u=e?void 0:hb.Weak,s=this.docs.setRangeFormula(e,t,r,n,o,u,a);if(s.kind===gt.Failure)return this.onUnavailableObject(s.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.evalFormula=function(e,t,r,n){var a=this;return new Promise((function(i){var o=function(){return i({value:Ft(Jm)})};a.scheduler.deleteTasks(bF.EvalFormula,void 0),a.scheduler.addTask(bF.EvalFormula,cF.Back,{onRun:function(){if(!a.trySetStateId(bF.EvalFormula,e))return o();a.enqueueComputeEvalFormula(t,r,n,i)},onDeleted:o}),a.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(bF.BeforeCompute,void 0),this.scheduler.addTask(bF.BeforeCompute,cF.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,rb.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,rb.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,rb.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=$();try{r=e()}finally{this.stateEvalTime+=K(1,$()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(kF.EvalTimedOut),this.outputMessageLog.push({kind:pb.RecalcStatistics,stateId:this.stateId,message:fb.StateTimedOut}),r=[])}return r},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,a=t===rb.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?te("calc.calc.PartialWorkbook: recalc edited"):void 0,i=!0,o=function(){return n.docs.evaluate(t,e,n.getVolatileMode())},u=function(){var t,s;if(i){i=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?te("calc.calc.PartialWorkbook: cell eval"):void 0;var c=n.docs.getEditedFormula(e);if(!It(c))return n.onUnavailableObject(c.reason);if(void 0===c.value)return}else n.outputMessageLog.push({kind:pb.RecalcStatistics,stateId:n.stateId,message:fb.ContinueComputation});var l=n.withEvalTiming(o);if(Array.isArray(l))return null===(t=r)||void 0===t||t.stop(),void(null===(s=a)||void 0===s||s.stop());o=l.resume,n.scheduler.addTask(bF.ComputeCellValue,cF.Front,u)};this.scheduler.addTask(bF.ComputeCellValue,cF.Back,u)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,n){var a=this,i=this.getVolatileMode(),o=function(){return a.docs.evalFormula(e,t,r,i)},u={onRun:function(){var e=o();e.kind===gt.Paused?(o=e.resume,a.scheduler.addTask(bF.ComputeEvalFormula,cF.Front,u)):n(e.value)},onDeleted:function(){return n({value:Ft(Jm)})}};this.scheduler.addTask(bF.ComputeEvalFormula,cF.Back,u)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,n=this.getVolatileMode();this.scheduler.addTask(bF.ComputeCellValue,cF.Back,(function(){r.docs.evalValue(e,t,n)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(bF.AfterCompute,kF.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?te("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(bF.AfterCompute,cF.Back,{onRun:function(){var r;null===(r=t)||void 0===r||r.stop(kF.EvalFinished),e.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.EditFinished,stateId:e.stateId})},onDeleted:function(e){var r;null===(r=t)||void 0===r||r.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(bF.RecalcFinished,void 0),this.scheduler.addTask(bF.RecalcFinished,cF.Back,(function(){e.outputMessageLog.push({kind:pb.RecalcStatistics,message:fb.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var a=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(a.trySetStateId(bF.ServerUpdate,e)){var i=a.docs.promoteServerAvailability(r,n);if(i.kind===gt.Failure)return a.onUnavailableObject(i.reason);a.docs.onCellModified(!0),i.value||a.outputMessageLog.push({kind:pb.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u){var s=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){s.trySetStateId(bF.ServerUpdate,e)&&s.handleSetCellContents(!0,t,r,n,i,a,o,u,void 0)}))},e.prototype.editCellContents=function(e,t,r,n,a,i,o){var u=this;void 0===i&&(i=tt),void 0===o&&(o=Ct(t.sheet,CF)),this.scheduler.addTask(bF.ClientEdit,cF.Back,(function(){u.trySetStateId(bF.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,i,a,hb.Weak,void 0,o)})),this.enqueueRecalcFinished()},e.prototype.editCellFormats=function(e,t,r,n){var a=this;void 0===n&&(n=Ct(t.sheet,CF)),this.scheduler.addTask(bF.ClientEdit,cF.Back,(function(){if(a.trySetStateId(bF.ClientEdit,e)){var i=a.docs.resolveEditFormat(t.sheet.document,r);It(i)||cb(t.set,(function(e){return a.onInferFormatFailure(Ct(t.sheet,e),i.reason),!0})),a.handleSetCellContents(!1,t,void 0,void 0,void 0,pt(0,0),It(i)?i.value:hb.Unavailable,void 0,n)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Vt(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){i.trySetStateId(bF.ServerUpdate,e)&&i.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Vt(t.range)),void 0===a&&(a=Ct(t.sheet,CF)),this.scheduler.addTask(bF.ClientEdit,cF.Back,(function(){i.trySetStateId(bF.ClientEdit,e)&&i.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(bF.TestAdvanceState,cF.Back,(function(){t.trySetStateId(bF.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(e,t){var r,n,a,i,o,u;if(t<this.stateId)return!1;if(e===bF.ClientEdit&&(this.deleteComputeTasks(kF.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleWorkbookStatisticsRate)&&this.outputMessageLog.push({kind:pb.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions)for(var s=this.config.experimentDefinitions,c={stateId:this.stateId,documents:this.docs.cloneServer(),stepBudget:s.stepBudget,totalBudget:s.totalBudget},l=0,d=s.experiments;l<d.length;l++){(m=d[l]).setContext(c),this.enqueueRunExperiment(s.stepBudget,s.totalBudget,m)}var f=null!=(r=this.config.samplePrecisionEvalRate)?r:0,v=null!=(n=this.config.samplePrecisionPrintFormulaRate)?n:0;if(this.stateChanges>=2&&(f>0||v>0)&&0===this.scheduler.getCount(bF.RunExperiment)){var h=null!=(i=null===(a=s=this.config.experimentDefinitions)||void 0===a?void 0:a.stepBudget)?i:10,p=null!=(u=null===(o=s)||void 0===o?void 0:o.totalBudget)?u:1e4,m=new yF({samplePrecisionEvalRate:f,samplePrecisionPrintFormulaRate:v});c={stateId:this.stateId,documents:this.docs.cloneServer(m),stepBudget:h,totalBudget:p};m.setContext(c),this.enqueueRunExperiment(h,p,m)}this.deleteComputeTasks(kF.StateIdAdvanced);var g=this.stateId;this.stateId=t,this.docs.advanceState(g),this.outputMessageLog.push({kind:pb.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(bF.BeforeCompute,void 0),this.scheduler.deleteTasks(bF.ComputeCellValue,void 0),this.scheduler.deleteTasks(bF.AfterCompute,e),e!==kF.EvalTimedOut&&this.scheduler.deleteTasks(bF.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r){var n=this,a=0,i=function(){var e=r.failedLogMessage;void 0!==e&&n.outputMessageLog.push({kind:pb.ExperimentRunResult,logMessage:e})},o=function(){if(r.done){var u=r.resultLogMessage;void 0!==u&&n.outputMessageLog.push({kind:pb.ExperimentRunResult,logMessage:u})}else{for(var s=$(),c=s,l=0;l<1e3&&c===s;l+=1){r.step();var d=$();if(d-c>=e&&!r.done)return void i();c=d}(a+=c>s?c-s:1)>=t&&!r.done?i():n.scheduler.addTask(bF.RunExperiment,cF.Front,o)}};this.scheduler.addTask(bF.RunExperiment,cF.Back,o)},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(n.trySetStateId(bF.ServerUpdate,r)){var a=n.docs.setSheetNames(e,t);a.kind===gt.Failure&&n.onUnavailableObject(a.reason),n.deleteComputeTasks(kF.SetSheetNames)}}))},e.prototype.setRefStyle=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone;r.docs.setConfig(jn(a,e,i,o,u,s)),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(kF.SetRefStyle)}}))},e.prototype.setLocaleInfo=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,t)){var n=r.docs.config,a=n.refStyle,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone;r.docs.setConfig(jn(e,a,i,o,u,s)),r.docs.clearCompiledFormulas(),r.docs.clearCompiledNumberFormats(),r.deleteComputeTasks(kF.SetLocaleInfo)}}))},e.prototype.setWorkbookProps=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.refStyle,o=n.mathpack,u=e.date1904,s=e.dateCompatibility,c=e.timezone;r.docs.setConfig(jn(a,i,o,u,s,c))}}))},e.prototype.setNumberFormats=function(e,t,r,n){var a=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(a.trySetStateId(bF.ServerUpdate,n)){var i=a.docs.setNumberFormats(e,t,r);return i.kind===gt.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,n){var a=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(a.trySetStateId(bF.ServerUpdate,e)){var i=a.docs.setNamedObject(!0,Tt(t,r),n);return i.kind===gt.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===gt.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(n.trySetStateId(bF.ServerUpdate,e)){var a=n.docs.promoteNamedObjects(t,r);if(a.kind===gt.Failure)return n.onUnavailableObject(a.reason);a.value||n.outputMessageLog.push({kind:pb.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===gt.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===gt.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(bF.ServerUpdate,cF.Back,(function(){if(r.trySetStateId(bF.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===gt.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(bF.MaybeCollectGarbage,void 0),this.scheduler.addTask(bF.MaybeCollectGarbage,cF.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:pb.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var a=t.sheet,i=eb(t.range),o=0,u=e;o<u.length;o++){Ut(a,(l=u[o]).sheet)&&n(db(a,Pk(l.set,i)),r)}else for(var s=0,c=e;s<c.length;s++){var l;n(l=c[s],r)}},e.prototype.getVolatileMode=function(){var e;return null!=(e=this.config.volatileMode)?e:aF.Estimation},e}();function NF(e){return new Promise((function(t){return setTimeout(t,e)}))}function RF(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,a=t&&t.macrotaskDelay||0,i={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=fC(),u=o[0],s=o[1],c=s[0],l=s[1];var d=!0;var f=NF(a),v=$();return function t(){if(!d||!function(){try{for(var t=0;t<n;){i.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return c();var o=$();o-v<r?(Promise.resolve().then(t),i.microtaskContinues+=1):(f.then((function(){f=NF(a),v=$(),i.macrotaskTotalDelay+=v-o,t()})),i.macrotaskContinues+=1)}(),{promise:u,stop:function(){d=!1},stats:i}}function FF(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}var IF=function(){function e(e){this.perf=FF(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}(),DF=FF();var wF=function(){var e=1/0,t=function(t){if(void 0===t&&(t=""),DF.now()>e)throw new Error("Time limit exceeded with message: "+t)};return t.arm=function(t){e=DF.now()+t},t}(),MF=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,n){wF("wd0x1a9bd3");var a;if(a=e.cell_both_absolute.exec(t)){var i=e.column_name_to_index(a[1]),o=Number(a[2]);return a[2][0]>=""&&(o=Number(a[2].charCodeAt(0)-16384)),[i,o,0]}if(wF("wd0xa26bda"),a=e.cell_col_absolute.exec(t)){i=e.column_name_to_index(a[1]),o=Number(a[2]);return a[2][0]>=""&&(o=Number(a[2].charCodeAt(0)-16384)),[i,o-n,0]}if(wF("wd0x2a23e1"),a=e.cell_row_absolute.exec(t)){i=e.column_name_to_index(a[1]),o=Number(a[2]);return a[2][0]>=""&&(o=Number(a[2].charCodeAt(0)-16384)),[i-r,o,0]}if(wF("wd0x3ebc91"),a=e.cell_both_relative.exec(t)){i=e.column_name_to_index(a[1]),o=Number(a[2]);return a[2][0]>=""&&(o=Number(a[2].charCodeAt(0)-16384)),[i-r,o-n,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var a=e.cell_dependency(t,0,0),i=e.cell_dependency(r,0,0),o="R",u="C";n&&(o="",u="");var s=[];i.forEach((function(e,t,r){s.push(e-a[t])}));var c="";return e.cell_both_absolute.exec(r)?c=o+i[1]+u+i[0]:e.cell_col_absolute.exec(r)?(0===s[1]?c+=o:c+=o+"["+s[1]+"]",c+=u+i[0]):e.cell_row_absolute.exec(r)?(0===s[0]?c+=u:c+=u+"["+s[0]+"]",c=o+i[1]+c):(0===s[1]?c+=o:c+=o+"["+s[1]+"]",0===s[0]?c+=u:c+=u+"["+s[0]+"]"),c},e.formulaToR1C1=function(t,r,n){for(var a,i=t.slice(),o=e.column_index_to_name(r)+n;a=e.range_pair.exec(i);)if(a){var u=a[1];a[2];i=i.replace(a[0],e.toR1C1(o,a[1],!0)+":"+e.toR1C1(o,a[2],!0))}for(var s=null;s=e.single_dep.exec(i);)if(s){u=s[1];i=i.replace(s[0],e.toR1C1(o,u,!0))}return i=(i=i.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){wF("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,n,a){void 0===a&&(a=!0),wF("wd0x2f82fe");var i=null,o=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");i=e.range_pair.exec(t);)if(wF("wd0x784918"),i){for(var u=i[1],s=e.cell_dependency(u,r,n),c=i[2],l=e.cell_dependency(c,r,n),d=l[0]-s[0]+1,f=l[1]-s[1]+1,v=0;v<d;v++)for(var h=0;h<f;h++)o.push([v+s[0],h+s[1],0]);t=t.replace(i[0],"_")}for(var p=null;p=e.single_dep.exec(t);)if(wF("wd0x0fb232"),p){u=p[1];var m=e.cell_dependency(u,r,n);o.push(m),t=t.replace(p[0],"_")}if(a)for(var g=null;g=e.number_dep.exec(t);)wF("wd0xd82ed1"),g&&(o.push([0,0,1]),t=t.replace(g[0],"_"));return o},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var a=null;a=e.single_dep.exec(t);)a&&(t=t.replace(a[0],"_"));for(var i=null;i=e.number_dep.exec(t);)i&&(r.push(parseFloat(i)),t=t.replace(i[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,n,a,i){wF("wd0x961028");var o=[];if(t>=i.length||r>=i[0].length||t<0||r<0)return[];var u=i[t][r];return u.length>1&&"="===u[0]&&(o=e.all_cell_dependencies(u,a,n)),o},e.generate_all_references=function(t,r,n){wF("wd0x6a6002");for(var a={},i=0;i<t.length;i++)for(var o=t[i],u=0;u<o.length;u++){wF("wd0x93d412");var s=o[u];if("="===s[0])for(var c=0,l=e.all_cell_dependencies(s,0,0);c<l.length;c++){var d=l[c];if(wF("wd0x8a466e"),0===d[0]&&0===d[1]&&0!==d[2]);else{var f=d[0]-r-1,v=d[1]-n-1,h=!1;if(v>=t.length||f>=t[0].length||f<0||v<0)h=!0;else{var p=t[v][f];void 0!==p&&"="!==p[0]&&(h=!0)}h&&(a[d.join(",")]=!0)}}}return a},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}(),_F=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],v=d[1];d[2];return!(n-f>1||c-o>1||a-v>1||l-u>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],v=d[1];d[2];return[[Math.min(n,c),Math.min(a,l),0],[Math.max(o,f),Math.max(u,v),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1];a[2];return(i-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1],u=(a[2],i-r+1),s=o-n+1;return Math.sqrt(u*u+s*s)},e.overlap=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],v=d[1];d[2];return(o>f?f-n+1:o-c+1)*(u>v?v-a+1:u-l+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}(),OF=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];r[i]=e.clone(t[i])}return r}return t}return null},e}();function xF(e,t,r){for(var n=0,a=e.length;n<a;){var i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}function LF(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),xF(e,t,r)}function PF(e,t,r){void 0===r&&(r=void 0);var n=xF(e,t,r);return n===e.length||0!==r(e[n],t)?-1:n}function UF(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function BF(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function GF(e,t,r,n,a,i,o,u,s,c){var l,d,f,v=t[0],h=t[1],p=[],m=LF(s,t,(function(e,t){return e[0][0]-t[0][0]})),g=LF(c,t,(function(e,t){return e[0][1]-t[0][1]}));m>g?(l=n,f=m,d=0):(l=a,f=g,d=1),f>0&&(f-=1);for(var S=function(r){var n=l[r];if(n===e)return"continue";var a=u[n];if(0===d){if(h[0]+1<a[0][0])return"break"}else if(h[1]+1<a[0][1])return"break";if(h[0]+1<a[0][0]||h[1]+1<a[0][1]||a[1][0]+1<v[0]||a[1][1]+1<v[1]);else{var s=function(e,t,r,n){var a=e[0],i=e[1],o=t[0],u=t[1],s=[o,i-1,0],c=[o+1,i,0],l=[a,u+1,0],d=[],f=-1;if(-1!==(f=PF(n,[a-1,u,0],BF))&&r[f][1]===i){var v=[r[f],n[f]];d.push(v)}if(-1!==(f=PF(n,s,BF))&&r[f][0]===a){v=[r[f],n[f]];d.push(v)}if(-1!==(f=PF(r,c,BF))&&n[f][1]===u){v=[r[f],n[f]];d.push(v)}if(-1!==(f=PF(r,l,BF))&&n[f][0]===o){v=[r[f],n[f]];d.push(v)}return d}(v,h,i[n],o[n]);s.length>0&&(p=p.concat(s.map((function(r,a,i){return[YF.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]}))))}},y=f;y<l.length;y++){if("break"===S(y))break}return p}function VF(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}function HF(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];wF("wd0xa287cd"),t[a]=e[a].sort(UF).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];wF("wd0xb02b87"),n[u]=r[u].map((function(e,t,r){var n=e[0];e[1];return n})),a[u]=r[u].map((function(e,t,r){e[0];return e[1]}))}var s=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var a=n[r],i=1e6,o=1e6,u=-1e6,s=-1e6,c=0;c<e[a].length;c++){var l=e[a][c][0][0],d=e[a][c][1][0],f=e[a][c][0][1],v=e[a][c][1][1];d>u&&(u=d),l<i&&(i=l),v>s&&(s=v),f<o&&(o=f)}t[a]=[[i,o,0],[u,s,0]]}return t}(e),c=Object.keys(e);VF(c,(function(e,t){return s[e][0][0]-s[t][0][0]}));var l=c.map((function(e,t,r){return s[e]})),d=Object.keys(e);VF(d,(function(e,t){return s[e][0][1]-s[t][0][1]}));for(var f,v=d.map((function(e,t,r){return s[e]})),h=0,p=Object.keys(e);h<p.length;h++){u=p[h];for(var m=0;m<r[u].length;m++){wF("wd0xe37031");var g=GF(u,r[u][m],0,c,d,n,a,s,l,v);t=t.concat(g)}}return t=t.map((function(e,t,r){return BF(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),f={},t=t.filter((function(e){return!(f[e]=e in f)}))}!function(){function e(){}e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)}}();var WF=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,a,i,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var u=i,s=0;s<t.length;s++){var c=t[s],l=c[0];u=o(u,r[n+c[1]][a+l])}return u},e.stencil_computation=function(t,r,n){e.initialize();for(var a=t.length,i=t[0].length,o=Array(a).fill(0).map((function(){return Array(i).fill(0)})),u=1;u<i-1;u++)for(var s=1;s<a-1;s++)o[s][u]=e.apply_stencil(e.stencil,t,u,s,n,r);for(s=1;s<i-1;s++)o[0][s]=e.apply_stencil(e.stencil_top,t,0,s,n,r),o[a-1][s]=e.apply_stencil(e.stencil_bottom,t,a-1,s,n,r);for(u=1;u<a-1;u++)o[u][0]=e.apply_stencil(e.stencil_left,t,u,0,n,r),o[u][i-1]=e.apply_stencil(e.stencil_right,t,u,i-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][i-1]=e.apply_stencil(e.stencil_topright,t,0,i-1,n,r),o[a-1][0]=e.apply_stencil(e.stencil_bottomleft,t,a-1,0,n,r),o[a-1][i-1]=e.apply_stencil(e.stencil_bottomright,t,a-1,i-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();function jF(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=jF(e[r],t[r]);if(0!==n)return n}return 0}function KF(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}var YF=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,n){wF("wd0xea1170");for(var a=JSON.stringify(MF.baseVector()),i=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},o=[],u=0;u<t.length;u++){wF("wd0xa1597b");for(var s=t[u],c=0;c<s.length;c++){wF("wd0x0d7fc8");var l=s[c].toString();if(l.length>0){var d=MF.all_dependencies(u,c,n+u,r+c,t),f=c+r+1,v=u+n+1;if(0===d.length)"="===l[0]&&o.push([[f,v,0],e.distinguishedZeroHash]);else{var h=d.reduce(i);if(JSON.stringify(h)===a)o.push([[f,v,0],h.toString()]);else{var p=this.hash_vector(h).toString();o.push([[f,v,0],p])}}}}}return o},e.color_all_data=function(t){for(var r=[],n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];wF("wd0xc22046");var o=i.split(","),u=Number(o[0]),s=Number(o[1]);r.push([[u,s,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,a){for(var i=[],o=0;o<t.length;o++){wF("wd0x503d57");for(var u=t[o],s=0;s<u.length;s++){wF("wd0x366ad1");var c=u[s].toString();if(c.length>0&&"="!==r[o][s][0])if(Number(c).toString()===c){var l=s+n+1,d=o+a+1;i.push([[l,d,1],e.distinguishedZeroHash])}}}return i},e.identify_ranges=function(e,t){for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];wF("wd0x770d8c"),r[i[1]]=r[i[1]]||[],r[i[1]].push(i[0])}for(var o=0,u=Object.keys(r);o<u.length;o++){var s=u[o];wF("wd0x84ae4d"),r[s].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,a=1;t||(n=1,a=0);for(var i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];wF("wd0xa372ae"),r[u]=[];for(var s=e[u].shift(),c=s,l=0,d=e[u];l<d.length;l++){var f=d[l];f[n]===c[n]&&f[a]===c[a]+1||(r[u].push([s,c]),s=f),c=f}r[u].push([s,c])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=OF.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,a,i){for(var o=new Array(t),u=0;u<t;u++)o[u]=new Array(r).fill(0);for(var s=0,c=i;s<c.length;s++){var l=c[s],d=l[0],f=d[0],v=d[1],h=d[2],p=l[1],m=v-a-1,g=f-n-1,S=Number(e.distinguishedZeroHash);1===h||(S=Number(p)),o[m][g]=S}return o},e.stencilize=function(e){return WF.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),a=0;a<e;a++)n[a]=new Array(t).fill(0);var i=0,o={};for(a=0;a<e;a++)for(var u=0;u<t;u++)o[r[a][u]]=o[r[a][u]]+1||1,0!==r[a][u]&&(i+=1);for(a=0;a<e;a++)for(u=0;u<t;u++)n[a][u]=o[r[a][u]]/i;var s=0,c=0;for(a=0;a<e;a++)for(u=0;u<t;u++)r[a][u]>0&&(c+=o[r[a][u]]);for(a=0;a<e;a++)for(u=0;u<t;u++)o[r[a][u]]>0&&(s+=this.entropy(o[r[a][u]]/c));Math.log2(i);return n},e.generate_suspicious_cells=function(e,t,r,n,a,i,o){void 0===o&&(o=.01);for(var u=[],s=0,c=0,l=0;l<e;l++)for(var d=0;d<t;d++){var f=d+r+1,v=l+n+1;i[l][d]>0&&(s+=a[l][d],c+=1,i[l][d]<=o&&0!==a[l][d]&&u.push([f,v,i[l][d]]))}var h=s/c;return u.sort((function(e,t){return Math.abs(t[2]-h)-Math.abs(e[2]-h)})),u},e.process_suspicious=function(t,r,n){wF("wd0x72fd38");new IF("process_suspicious");var a=MF.extract_sheet_cell(t),i=(a[0],a[1]),o=MF.cell_dependency(i,0,0),u=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):u=e.process_formulas(r,o[0]-1,o[1]-1);var s=[],c=[],l=n.length,d=n[0].length;if(n.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var f=MF.generate_all_references(r,o[0]-1,o[1]-1);s=e.color_all_data(f),c=e.process_values(n,r,o[0]-1,o[1]-1)}var v=e.identify_groups(s),h=e.identify_groups(u),p=[];return n.length<1e4&&(p=e.find_suspicious_cells(l,d,o,r,u,c,1)),KF(p,h,v,e.generate_proposed_fixes(h))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var a=t[0],i=t[1],o=n[0],u=n[1],s=_F.area([[a[0],a[1],0],[i[0],i[1],0]]),c=_F.area([[o[0],o[1],0],[u[0],u[1],0]]),l=Math.min(s,c),d=Math.max(s,c),f=Math.min(r,e),v=Math.max(r,e),h=Math.abs(v-f)/this.Multiplier;h<1&&(h=1);var p=(1+this.entropydiff(l,d))/(h*l);return p=-p},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],a=n[0],i=n[1],o=e[r][2],u=o[0],s=o[1];t+=_F.diagonal([[a[0],a[1],0],[i[0],i[1],0]]),t+=_F.diagonal([[u[0],u[1],0],[s[0],s[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var a in t){if(t[a][1]>t[a][2]){var i=t[a][1];t[a][1]=t[a][2],t[a][2]=i}r[JSON.stringify(t[a][1])]=t[a],n[JSON.stringify(t[a][2])]=t[a]}var o=[],u={};for(var a in t){var s=t[a][0];if(!(-s<e.reportingThreshold/100)){var c=JSON.stringify(t[a][1]),l=JSON.stringify(t[a][2]);if(c in n||l in r){if(!u[c]&&c in n){var d=[-s*JSON.parse(n[c][0]),t[a][1],n[c][1]];o.push(d),u[c]=!0,u[l]=!0;continue}if(!u[l]&&l in r){d=[-s*JSON.parse(r[l][0]),t[a][1],r[l][2]];o.push(d),u[l]=!0,u[c]=!0}}else o.push(t[a])}}return o},e.generate_proposed_fixes=function(e){var t=HF(e);return t.sort(jF),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];wF("wd0x781a33");var a=e[n].slice();e[n]=this.merge_individual_groups(a)}return e},e.merge_individual_groups=function(e){var t=new IF("merge_individual_groups"),r=0;for(e=e.sort();;){wF("wd0x0a3668");for(var n=!1,a={},i=[],o=e.slice();o.length>0;)for(var u=o.shift(),s=0;s<o.length;s++)if(wF("wd0x9cf1d5"),_F.is_mergeable(u,o[s])){var c=JSON.stringify(u),l=JSON.stringify(o[s]);if(!(c in a)&&!(l in a)){i.push(_F.bounding_box(u,o[s])),a[c]=!0,a[l]=!0,n=!0;break}}for(s=0;s<e.length;s++)wF("wd0x1bc2bb"),JSON.stringify(e[s])in a||i.push(e[s]);if(i.sort(),!n)return i;if(e=i.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var a=e[0];if(100*-a<1)return null;for(var i=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),u=i<o?e[1]:e[2],s=i<o?e[2]:e[1],c=u[0],l=c[0],d=c[1],f=u[1],v=(f[0],f[1],s[0]),h=(v[0],v[1],s[1]),p=h[0],m=h[1],g=l-r-1,S=d-n-1,y=p-r-1,C=m-n-1,k=!0,b=JSON.stringify(t[S][g]),E=S;E<=C;E++)for(var A=g;A<=y;A++){if(JSON.stringify(t[E][A])!==b){k=!1;break}}return KF(a,u,s,k)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,a,i,o){return wF("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();function qF(e,t){for(var r=e[0],n=e[1],a=t[0],i=t[1],o=[],u=r;u<=a;u++)for(var s=n;s<=i;s++)o.push([u,s,0]);return o}function JF(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}var zF,QF=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{S.ULS.traceTag(578588694,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,a,i,o=e.getServerDocument(),u=[],s=0,c=e.getServerAvailableCells();s<c.length;s++){var l=c[s],d="UndefinedSheet";if(void 0!==o){var f=e.getSheetName(o,l.sheetIdx.index);f.kind===gt.Success&&(d=f.value)}var v=e.getServerUsedRange(l.sheetIdx);if(v.kind!==gt.Failure&&void 0!==v.value){var h=v.value.sheet,p=F({},v.value.range);p.cols=Math.min(p.cols,75),p.rows=Math.min(p.rows,1e3);for(var m=[],g=[],S=[],y=0,C=p.row,k=p.row+p.rows-1;C<=k;C+=1){for(var b=[],E=[],A=[],T=p.col,N=p.col+p.cols-1;T<=N;T+=1){var R=kt(h,pt(C,T)),I=e.getServerValue(R),D=I.kind===gt.Success?JSON.stringify(I.value):"";E.push(D);var w=e.getServerFormat(R),M=w.kind===gt.Success?JF(JSON.stringify(w.value)).toString():"";A.push(M);var _=e.getServerFormula(R),O=(null===(n=_.kind===gt.Success?null===(r=null===(t=_.value)||void 0===t?void 0:t.compiledFmla)||void 0===r?void 0:r.getValue():void 0)||void 0===n?void 0:n.kind)===gt.Success?null!=(i=null===(a=_.value)||void 0===a?void 0:a.fmla)?i:"":"";""!==O&&(y+=1),b.push(O)}m.push(b),g.push(E),S.push(A)}if(0!==y){var x={sheetName:d,usedRangeAddress:Mi(e.config.localeInfo,p,d),values:g,formulas:m,styles:S};u.push(x)}}}return{workbookName:"PartialWorkbook",worksheets:u}}(t);this.result=function(e,t,r,n){void 0===n&&(n=1/0),t=null!=t?t:YF.getFormattingDiscount(),r=null!=r?r:YF.getReportingThreshold(),wF.arm(n);for(var a={},i=0,o=e.worksheets.map((function(e){if(wF("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var n=e.usedRangeAddress;n=n.replace(/!(!+)/,"!");var a=new IF("excelint"),i=YF.process_suspicious(n,e.formulas,e.values),o=(i[0],i[1],i[2],i[3]);wF("wd0x7919b4");var u=a.elapsedTime(),s=YF.adjust_proposed_fixes(o,e.styles,0,0),c=a.elapsedTime(),l=s.map((function(e){wF("wd0xfb8f16");var n=e[0],a=e[1],i=e[2],o=e[3],u=-n;return o||(u*=(100-t)/100),100*u>=r?KF(u,a,i,o):null})).filter((function(e){return null!==e})),d=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},f=a.elapsedTime(),v=l.map((function(t){wF("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",n=[],a=[],i=[],o=[],u=[],s=[],c=[],l=[],f=[],v=t[3],h=[d.apply(void 0,t[1]),d.apply(void 0,t[2])],p=0;p<2;p++){var m=t[p+1][0],g=m[1]-1,S=m[0]-1,y=e.formulas[g][S],C=MF.numeric_constants(y);u.push(C),s.push(s.reduce((function(e,t){return e+t}),0));var k=MF.all_cell_dependencies(y,S+1,g+1,!1);c.push(k.length);var b=MF.formulaToR1C1(y,S+1,g+1),E=MF.column_index_to_name(S+1)+(g+1)+":",A=E+b;i.push(b),o.push(A),n.push(y),a.push(E+y),l.push((y.match(/\$/g)||[]).length),f.push(k)}var T=Math.abs(s[0]-s[1]),N=[];for(p=0;p<f.length;p++)if(f[p].length>0){if("vertical"===r&&0===f[p][0][0]&&-1===f[p][0][1]){N.push("recurrent-formula");break}if("horizontal"===r&&-1===f[p][0][0]&&0===f[p][0][1]){N.push("recurrent-formula");break}}c[0]!==c[1]&&N.push("different-referent-count"),u[0].length!==u[1].length&&(1===Math.abs(u[0].length-u[1].length)?N.push("one-extra-constant"):N.push("number-of-constants-mismatch")),u[0].length>0&&u[1].length>0&&(c[0]+c[1]===0?N.push("both-constants"):c[0]*c[1]==0&&N.push("one-is-all-constants")),i[0]!==i[1]&&JSON.stringify(f[0].sort())!==JSON.stringify(f[1].sort())&&N.push("r1c1-mismatch"),l[0]!==l[1]&&N.push("absolute-ref-mismatch");for(p=0;p<f.length;p++)if(f[p].length>0&&f[p][0][0]*f[p][0][1]!=0){N.push("off-axis-reference");break}return N===[]&&N.push("unclassified"),{bin:N,direction:r,sameFormat:v,rangeSizes:h,numbers:s,sameConstants:u[0]===u[1],numeric_difference:T,magnitude_numeric_difference:0===T?0:Math.log10(T),formulas:a,r1c1formulas:o,dependence_vectors:f}})),h=a.elapsedTime(),p=e.formulas.flat().filter((function(e){return e.length>0})).length,m=e.values.flat().filter((function(e){return e.length>0})).length,g=e.values[0].length,S=e.values.length,y=S*g,C=l.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),k=l.map((function(e){return wF("wd0xbcc23c"),e[0]>=r/100?qF(e[1][0],e[1][1]).concat(qF(e[2][0],e[2][1])):[]})),b=Array.from(new Set(k.flat(1).map((function(e){return JSON.stringify(e)}))));k=b.map((function(e){return JSON.parse(e)}));var E=a.elapsedTime(),A={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:l,exampleFixes:v,suspiciousRanges:l.length,weightedSuspiciousRanges:C,suspiciousCells:k.length,elapsedTimeSeconds:E/1e3,proposedFixesTimeSeconds:u/1e3,adjustProposedFixesTimeSeconds:(c-u)/1e3,adjustFormatProposedFixesTimeSeconds:(f-c)/1e3,exampleFixesTimeSeconds:(h-f)/1e3,numCountingTimeSeconds:(E-h)/1e3,columns:g,rows:S,totalCells:y,numFormulaCells:p,numValueCells:m};return{name:e.sheetName,out:A}})).filter((function(e){return null!==e.out}));i<o.length;i++){var u=o[i],s=u.name,c=u.out;a[s]=c}return{workbookName:e.workbookName,worksheets:a}}(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: "+e}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],a=e.rangeSizes,i=a.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(Ho),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),a=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:a,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: "+JSON.stringify(this.report)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!0,configurable:!0}),e}();function XF(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.gauss",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(zF||(zF={}));var ZF=function(e,t){return XF(e.consts,t)};function $F(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),k(e,void 0===t.name||1===t.varCount),k(e,t.varCount===r)}function eI(e,t,r){var n={varCount:e,vars:t,consts:r,name:void 0};return $F(zF.Root,n),n}function tI(){}function rI(){return new tI}var nI=rI();function aI(){return eI(0,{},rI())}function iI(e){return eI(0,{},e)}function oI(e){var t,r=eI(1,((t={})[e]=1,t),nI);return r.name=e,r}var uI=function(){return!1};function sI(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===nI||ZF(e,uI))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function cI(e,t){return r=function(e,r){return t.vars[e]===r},XF(e.vars,r)&&ZF(e,(function(e,r){return t.consts[e]===r}));var r}function lI(e,t){var r,n,a=aI(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var c in i){0!==(l=i[c]+(null!=(r=u[c])?r:0))&&(a.vars[c]=l,a.varCount+=1)}for(var c in o){var l;0!==(l=o[c]+(null!=(n=s[c])?n:0))&&(a.consts[c]=l)}for(var c in u)void 0===i[c]&&(a.vars[c]=u[c],a.varCount+=1);for(var c in s)void 0===o[c]&&(a.consts[c]=s[c]);return $F(zF.Root,a),a}function dI(e,t,r){var n=t.vars,a=t.consts,i=n[e];if(void 0===i)return t;var o=0,u=aI(),s=u.vars,c=u.consts;for(var l in n){var d=r.vars[l],f=void 0===d?0:d;0!==(v=(l===e?0:n[l])+f*i)&&(o+=1,s[l]=v)}for(var l in r.vars){void 0===n[l]&&(o+=1,s[l]=i*r.vars[l])}for(var l in a){var v,h=r.consts[l];0!==(v=a[l]+i*(void 0===h?0:h))&&(c[l]=v)}for(var l in r.consts){void 0===a[l]&&(c[l]=i*r.consts[l])}return eI(o,s,c)}var fI=function(){},vI={kind:1,substitution:fI},hI=function(e){return{kind:1,substitution:e}},pI={kind:0},mI=function(e){return e<0?-e:e};function gI(e,t,r){var n={};return r===fI?t:t===fI?r:function(a){var i=n[a];if(void 0!==i)return i;var o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function SI(e,t){return function(r){return e===r?t:void 0}}var yI=function(e,t,r){return function e(t,r,n){if(t>=100)return C(zF.UnifyBound);if(0===n.varCount)return ZF(n,uI)?vI:pI;if(1===n.varCount){var a;for(var i in n.vars){a=i;break}k(zF.Root,void 0!==a);var o=n.vars[a],u={};for(var s in n.consts){if((p=n.consts[s])%o!=0)return pI;u[s]=-p/o}return hI(SI(a,iI(u)))}var c,l=0,d=void 0,f=n.vars,v=n.consts,h=n.varCount;for(var s in f){var p=f[s],m=mI(p);(void 0===d||m<d)&&(l=p,d=m,c=s)}k(zF.Root,void 0!==c),k(zF.Root,0!==l);var g={},S={};for(var s in f)if(s===c)g[s]=1;else{p=f[s];g[s]=-Math.floor(p/l)}for(var s in v){p=v[s];S[s]=-Math.floor(p/l)}var y=eI(h,g,S),b=e(t+1,r,dI(c,n,y));return 0===b.kind?b:hI(gI(r,b.substitution,SI(c,y)))}(0,e,function(e,t){var r,n,a=aI(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var c in i){0!==(l=i[c]-(null!=(r=u[c])?r:0))&&(a.vars[c]=l,a.varCount+=1)}for(var c in o){var l;0!==(l=o[c]-(null!=(n=s[c])?n:0))&&(a.consts[c]=l)}for(var c in u)void 0===i[c]&&(a.vars[c]=-u[c],a.varCount+=1);for(var c in s)void 0===o[c]&&(a.consts[c]=-s[c]);return $F(zF.Root,a),a}(t,r))};function CI(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function kI(e){return{kind:1,reference:e,resolution:void 0}}function bI(e,t){return{kind:2,elementType:e,dimensions:t}}function EI(e){return{kind:3,flags:e}}function AI(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!_t(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function TI(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:F(F({},e),{exact:e.exact&&t});if("object"==typeof t)return F(F({},t),{exact:t.exact&&e});return e&&t}(AI(e),AI(t))}function NI(e,t){return!0===t?e:bI(e,t)}var RI=CI(J.Boolean),FI=CI(J.String),II=CI(J.Number),DI=iI({}),wI=CI(J.Number,DI),MI=CI(J.Error),_I=CI(J.Missing|J.Blank),OI=EI(z.None),xI=EI(z.All),LI=CI(J.Number|J.Boolean|J.String),PI=function(e){return CI(J.Number|J.Boolean|J.String,e)};var UI,BI=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),a=this.find(t);if(n!==a){var i=this.roots,o=this.backlinks,u=this.ranks;if(r){var s=o[a];return o[a]=o[n],o[n]=s,i[a]=n,void(u[n]<=u[a]&&(u[n]=u[a]+1))}if(u[n]<u[a]){s=o[n];o[n]=o[a],o[a]=s,i[n]=a}else{s=o[a];o[a]=o[n],o[n]=s,i[a]=n,u[n]===u[a]&&(u[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),GI={kind:0},VI={kind:1},HI=function(e){return{kind:2,constraint:e}},WI=iI({error:1}),jI=iI({}),KI=iI({currency:1}),YI=iI({percentage:1}),qI=iI({date:1});function JI(e,t,r){var n,a=new BI,i=a.makePoint(WI),o=(n=WI,function(e,t){if(0===t.varCount||e===fI)return t;var r=t;for(var a in t.vars){var i=e(a);if(i===n)return n;void 0!==i&&(r=dI(a,r,i))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:a,errorPoint:i,errorUnit:WI,apply:o}}function zI(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function QI(e,t,r,n){return k(zF.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),GI}function XI(e,t,r,n,a){return t===e.errorUnit?(k(zF.Root,r===e.errorPoint),void 0!==a&&e.uf.union(e.errorPoint,a,!0),GI):n===e.errorUnit?(k(zF.Root,a===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),GI):0===t.varCount?0===n.varCount?cI(i=t,o=n)&&cI(o,i)?GI:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==a&&e.uf.union(e.errorPoint,a,!0),VI):(k(zF.Root,void 0!==a),QI(e,a,t,r)):1===n.varCount?(k(zF.Root,void 0!==r),k(zF.Root,void 0!==a),e.uf.union(r,a),GI):(k(zF.Root,void 0!==r),QI(e,r,n,a));var i,o}function ZI(e,t,r){if(!sI(t))return HI({kind:2,unit:t,target:r});var n=zI(e,r),a=e.uf.findWithDescriptor(n),i=a[0],o=a[1];if(1===t.varCount){k(zF.Root,void 0!==t.name);var u=e.symbolContext.getTable().getValue(t.name);k(zF.Root,void 0!==u);var s=e.uf.findWithDescriptor(zI(e,u)),c=s[0];return XI(e,s[1],c,o,i)}return XI(e,t,void 0,o,i)}function $I(e){return e!==hb.Unavailable&&0!==e&&("object"!=typeof e||e.valueType!==Lf.General)}function eD(e,t,r){var n=e.typeContext.types[t.index];if(void 0===n)return C(zF.Root);var a=n.getValue(r);if(void 0===a){var i=e.typeContext.formats(kt(t,r));if(It(i)){if(!$I(i.value)){var o=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,PI(o)),o}var u=tD(e,i.value);return void 0===u?u=e.symbolContext.freshSymbol().unit:e.stats.formatCells+=1,e.typeContext.types[t.index]=n.setValue(r,PI(u)),u}var s=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,PI(s)),s}return 0===a.kind?a.unit:void 0}function tD(e,t){var r;if("number"==typeof t){var n=e.typeContext.getIformat(t);if(!It(n))return;r=n.value}else r=t;switch(r.valueType){case Lf.Currency:return KI;case Lf.Percentage:return YI;case Lf.Accounting:return KI;case Lf.Fraction:return jI;case Lf.Date:return qI;default:return}}var rD=((UI={})[2]=function(e,t){return ZI(e,t.unit,t.target)},UI[3]=function(e,t){var r=tD(e,t.format);if(void 0===r)return GI;var n=eD(e,t.cell.sheet,t.cell.range);if(void 0===n)return GI;if(!sI(n))return HI(t);if(1===n.varCount){k(zF.Root,void 0!==n.name);var a=e.symbolContext.getTable().getValue(n.name);k(zF.Root,void 0!==a);var i=e.uf.findWithDescriptor(zI(e,a)),o=i[0];return XI(e,i[1],o,r,void 0)}return XI(e,n,void 0,r,void 0)},UI[0]=function(e,t){var r=t.type.resolution;if(!wt(r.sheet))return GI;if(_t(r.range)){var n=eD(e,r.sheet,r.range);return void 0===n?GI:ZI(e,n,t.target)}var a=eb(r.range),i=e.typeContext.available[r.sheet.index];if(void 0===i)return GI;var o=Pk(a,i.availableCells),u=[];return lb(o,(function(e){return u.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:i.sheetIdx,cells:u,target:t.target},output:void 0}},UI[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return GI;var a=n[r],i=eD(e,t.index,a),o=void 0===i?GI:ZI(e,i,t.target);return t.cursor+=1,{kind:3,constraint:t,output:o}},UI);function nD(e){return 1===e.kind?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,a=n.apply,i=n.errorUnit,o={kind:2,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=a(o.substitution,e);if(r!==i){var n=a(o.substitution,t);if(n!==i){var u=yI(a,r,n);1!==u.kind?o.stats.errorCount+=1:o.substitution=gI(a,u.substitution,o.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return o}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.deferred,i=t[n],o=rD[i.kind](r,i);switch(o.kind){case 2:a.push(o.constraint);break;case 1:e.stats.errorCount+=1;break;case 3:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case 2:a.push(o.output.constraint);break;case 1:e.stats.errorCount+=1}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.unifyNF,i=t[n];switch(i.kind){case 2:a(i.unit,i.target.unit);break;case 3:var o=tD(r,i.format);if(void 0===o)break;var u=eD(r,i.cell.sheet,i.cell.range);if(void 0===u)break;a(o,u);break;default:return e.constraintCursor+=1,y(zF.Root,i)}return e.constraintCursor+=1,e}(e)}var aD=function(){function e(){this.isDone=!1}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!0,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=[],r={};e.getServerAvailableCells().forEach((function(e){r[e.sheetIdx.index]=e,t.push(e)}));var n=void 0===e.getServerDocument()?function(){return Ft(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:0,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:Wi(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:r,getIformat:n},constraints:[],stats:{formulaCells:0,formatCells:0,totalCells:0,errorCount:0},sheets:t,mutableState:{symbolContext:iD.init(),cells:void 0,sheetCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return{kind:1,stats:e.stats,context:JI(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,y(zF.Root+"."+zF.Initialised,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case 0:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case 1:return void(this.state=nD(e));case 2:return e.constraintCursor<e.constraints.length?void(this.state=nD(e)):(this.isDone=!0,void(this.statsMessage=JSON.stringify(e.stats)))}}catch(e){return this.statsMessage=zF.Root+"."+zF.Failure+": "+m(e),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e,t){var r=t.mutableState,n=t.stats,a=t.sheets,i=r.sheetCursor,o=[],u=a[i];return e.forEachServerNonBlankCellInSet(u.sheetIdx,u.availableCells,(function(t){var r,a=kt(u.sheetIdx,t),i=e.getServerFormula(a);return i.kind===gt.Success&&void 0!==(null===(r=i.value)||void 0===r?void 0:r.compiledFmla)&&(o.push(i.value),n.formulaCells+=1),n.totalCells+=1,!0})),t.documentTypeContext.types[u.sheetIdx.index]=nA(),r.cells=o,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){var r=t.sheets,n=t.constraints,a=t.stats,i=t.mutableState,o=i.cells,u=i.sheetCursor,s=i.cellCursor,c=r[u],l=o[s],d=l.compiledFmla.getValue();if(d.kind===gt.Success){var f=d.value.node,v=kt(c.sheetIdx,l.origin),h=function(e,t,r){var n=e.constraints,a=e.locale,i=e.mathpack,o=e.resolver,u=e.documentTypeContext,s=u.types[t.sheet.index],c=e.mutableState.symbolContext.copy(),l={origin:t,locale:a,mathpack:i,resolver:o,symbolContext:c,pushConstraint:function(e){return void 0!==e&&(n.push(e),!0)}},d=vD(l,r),f=cD(l,d),v=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var n=t.symbolContext.freshSymbol();return CI(r.flags,n.unit)}return r;case 2:for(var a=r,i=[];2===a.kind;)i.push(a.dimensions),a=a.elementType;var o=e(t,a);return i.reduceRight(bI,o);case 1:case 3:return r;default:return y(zF.Root,r)}}(l,void 0===f?xI:f);if(1===v.kind){var h=c.freshSymbol(),p={kind:0,type:v,target:h};v=PI(h.unit),n.push(p)}if(e.mutableState.symbolContext=c,2===v.kind)return s;return s.setValue(t.range,v)}(t,v,f);t.documentTypeContext.types[c.sheetIdx.index]=h;var p=e.getServerFormat(v);p.kind===gt.Success&&$I(p.value)&&(n.push({kind:3,cell:v,format:p.value}),a.formatCells+=1)}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.cells}(t))return this.initialiseSheetStep(e,t);var r=t.mutableState;return r.cellCursor<r.cells.length?this.checkCell(e,t):(r.cells=void 0,r.sheetCursor+=1,t)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!=(e=this.statsMessage)?e:zF.Root+"."+zF.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return"Units experiment timed out."},enumerable:!0,configurable:!0}),e}(),iD=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,Ud.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t=(void 0===e?"gen":e)+"@"+(this.seed+=1),r={unit:oI(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function oD(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?oD(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return y(zF.Root,e)}}function uD(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?uD(e,t.elementType,!1):void 0;case 1:var n=e.symbolContext.freshSymbol(),a={kind:0,type:t,target:n};return[n.unit,a];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return y(zF.Root,t)}}var sD=xi((function(e){return e}),(function(){return!0}),(function(){return!1}));function cD(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r={originGridCell:Rt(e.origin.range),originSheet:Rt(e.origin.sheet),wrapCellReferences:!0,allowUnqualifiedCell:!0};return sD(void 0,e.resolver.resolveCellRef(r,t.reference).resolution)}(e,t);return"object"==typeof r?function(e,t){var r=kI(e);return r.resolution=t,r}(t.reference,r):r?MI:void 0}if(2===t.kind){var n=cD(e,t.elementType);return void 0===n?n:n===t.elementType?t:bI(n,t.dimensions)}return t}function lD(e,t,r,n,a){var i=e.symbolContext.freshSymbol(),o=oD(t,i,n),u=oD(r,i,n);if(void 0!==o&&void 0!==u||a&&(void 0!==o||void 0!==u))return e.pushConstraint(o),e.pushConstraint(u),i}function dD(e,t,r){if(r.length<2)return xI;var n=cD(e,vD(e,r[0])),a=cD(e,vD(e,r[1]));if(void 0===n||void 0===a)return xI;var i=TI(n,a);if(!1===i)return xI;var o="object"==typeof i;switch(t){case ae.Add:case ae.Sub:case ae.Min:case ae.Max:var u=lD(e,n,a,o,!0);return NI(void 0===u?II:CI(J.Number,u.unit),i);case ae.Eq:case ae.Ne:case ae.Lt:case ae.Le:case ae.Gt:case ae.Ge:return lD(e,n,a,o,!1),NI(RI,i);case ae.Mul:case ae.Div:var s=e.symbolContext.freshSymbol(),c=e.symbolContext.freshSymbol(),l=oD(n,s,o),d=oD(a,c,o);if(e.pushConstraint(l),e.pushConstraint(d),void 0===l&&void 0===d)return NI(II,i);var v=t===ae.Mul?lI(s.unit,c.unit):lI(s.unit,function(e){var t=aI(),r=e.vars,n=e.consts;for(var a in r)t.vars[a]=-r[a];for(var a in n)t.consts[a]=-n[a];return t.varCount=e.varCount,$F(zF.Root,t),t}(c.unit));return NI(CI(J.Number,v),i);case ae.Pow:var h=r[1];if(h.kind===Nr.Literal&&$t(h.oper)){var p=e.mathpack.toNumber(h.oper);if(f(p)){var m=uD(e,n,"object"==typeof i);return void 0===m?NI(II,i):(e.pushConstraint(m[1]),NI(CI(J.Number,function(e,t,r){if(0===t)return r;var n=aI(),a=e.vars,i=e.consts;for(var o in a)n.vars[o]=a[o]*t;for(var o in i)n.consts[o]=i[o]*t;return n.varCount=e.varCount,$F(zF.Root,n),n}(m[0],p,DI)),i))}}return xI;case ae.Range:case ae.Isect:case ae.Union:return xI;case ae.Concat:return NI(FI,i);case ae.And:case ae.Or:case ae.Xor:return NI(RI,i);default:return y(zF.Root,t)}}function fD(e,t,r){switch(t){case ae.Add:case ae.Sub:case ae.Mul:case ae.Div:case ae.Pow:case ae.Eq:case ae.Ne:case ae.Lt:case ae.Le:case ae.Gt:case ae.Ge:case ae.Range:case ae.Isect:case ae.Union:case ae.Concat:case ae.And:case ae.Or:case ae.Xor:case ae.Min:case ae.Max:return dD(e,t,r);case ae.Percent:case ae.Neg:case ae.Pos:case ae.At:case ae.Pound:return r.length<1?xI:function(e,t,r){if(r.length<1)return xI;var n=cD(e,vD(e,r[0]));if(void 0===n)return xI;var a=AI(n);if(!1===a)return xI;switch(t){case ae.Percent:return NI(wI,a);case ae.Neg:case ae.Pos:var i=uD(e,n,"object"==typeof a);return void 0===i?NI(II,a):(e.pushConstraint(i[1]),NI(CI(J.Number,i[0]),a));case ae.At:case ae.Pound:return xI;default:return y(zF.Root,t)}}(e,t,r);default:return y(zF.Root,t)}}function vD(e,t){switch(t.kind){case Nr.Literal:return function(e){switch(e.kind){case J.Number:return II;case J.String:return FI;case J.Boolean:return RI;case J.Error:return MI;default:return _I}}(t.oper);case Nr.Array:return function(e,t){var r=t.nodes.length;if(0===r)return xI;for(var n,a,i=OI,o=t.nodes[0].length,u=0;u<t.nodes.length;u+=1)for(var s=t.nodes[u],c=0;c<s.length;c+=1)n=i,a=vD(e,s[c]),i=n===OI?a:a===OI||n===xI?n:a===xI?a:0===n.kind&&0===a.kind&&void 0===n.unit&&void 0===a.unit?CI(n.flags|a.flags):xI;return bI(i,{rows:r,columns:o,exact:!0})}(e,t);case Nr.Paren:return vD(e,t.node);case Nr.CellRef:return kI(t);case Nr.App:case Nr.Let:case Nr.Fun:return qt(t.head)?fD(e,t.head.id,t.args):Jt(t.head)?function(e,t,r){switch(t){case Z.SUM:case Z.AVERAGE:case Z.MAX:case Z.MIN:if(0===r.length)return xI;var n=e.symbolContext.freshSymbol(),a=!0;return r.forEach((function(t){var r=cD(e,vD(e,t));r&&e.pushConstraint(oD(r,n,!0))&&(a=!1)})),a?II:CI(J.Number,n.unit);case Z.IF:if(r.length<2)return xI;var i=cD(e,vD(e,r[0])),o=cD(e,vD(e,r[1])),u=cD(e,void 0===r[2]?RI:vD(e,r[2]));if(void 0===i)return void 0!==o&&void 0!==u&&lD(e,o,u,!0,!1),xI;var s=AI(i),c="object"==typeof s;if(void 0===o||void 0===u)return xI;var l=lD(e,o,u,!0,!0),d=l?PI(l.unit):LI;return c?bI(d,s):d;default:return xI}}(e,t.head.id,t.args):xI;case Nr.Name:case Nr.Bad:case Nr.FieldRef:case Nr.StructRef:return xI;default:return y(zF.Root,t)}}var hD=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given "+t;S.ULS.traceTag(591974878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=$();$()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();var pD={TestExperiment:hD.create.bind(hD),ExceLintExperiment:function(){return new QF},UnitExperiment:function(){return new aD}};function mD(e,t){var r,n,a,i,o,u,s,c,l,d,f,v,h,p,m,g,S,y,C,k,b,E,A,T,N,R,I,D,w,M,_,O,x,L=q("en-US"),P=function(e,t,r){var n=Ca().slice();return Ab(t,qb,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),ka(e,n)}(L,e.worksheetFunctionNames,t),U=P.getWorksheetFuncId,B=P.getWorksheetFuncName,G=function(e){if(H(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,a=0;a<e.length&&!((n-=e[a])<=0);a+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),V=function(e,t){var r=la.slice();return Ab(e,Jb,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),W=null!=(r=e.lcid)?r:Yn.USA,j=null!=(n=e.country)?n:Kn.USA,K=W===Yn.Thailand,Y=W===Yn.Korea,J=W===Yn.Japan,z=W===Yn.ChinaT||W===Yn.HongKong,Q=W===Yn.China,X=Y||J||Q||z,Z=W===Yn.Hindi||W===Yn.Tamil,$=W===Yn.Thailand||W===Yn.Vietnam||Z,ee=(W&Yn.LANG)==(Yn.Hebrew&Yn.LANG)||(W&Yn.LANG)==(Yn.Arabic&Yn.LANG)||W===Yn.Syriac||$;return F(F({},e),{getWorksheetFuncId:U,getWorksheetFuncName:B,isNumeral:ia,getOrdinal:oa,getNumberShape:ua,isThousandsPosition:G,isIdentStart:sa,isIdentContinue:ca,stringCompareCI:L,errorNames:V,thousandsSeparator:(a=e.thousandsSeparator,null!=a?a:","),lcid:W,country:j,isThai:K,isEastAsia:X,isKorea:Y,isJapan:J,isChinaT:z,isChinaS:Q,isComplexScript:ee,numberDecimals:(i=e.numberDecimals,null!=i?i:2),isExpSepBySpace:(o=e.isExpSepBySpace,null!=o&&o),fractionSeparator:(u=e.fractionSeparator,null!=u?u:" "),isPercentSepBySpace:(s=e.isPercentSepBySpace,null!=s&&s),currencyFormat:(c=e.currencyFormat,null!=c?c:Ir.Paren),isCurrencySymbolLead:(l=e.isCurrencySymbolLead,null==l||l),isCurrencySepBySpace:(d=e.isCurrencySepBySpace,null!=d&&d),currencySymbol:(f=e.currencySymbol,null!=f?f:"$"),currencyDecimals:(v=e.currencyDecimals,null!=v?v:2),dateOrder:(h=e.dateOrder,null!=h?h:Dr.MDY),dateSeparator:(p=e.dateSeparator,null!=p?p:"/"),dateAltSeparator:(m=e.dateAltSeparator,null!=m?m:"-"),year4Digits:(g=e.year4Digits,null==g||g),month2Digits:(S=e.month2Digits,null!=S&&S),day2Digits:(y=e.day2Digits,null!=y&&y),longDateFormat:(C=e.longDateFormat,null==C||C),timeSeparator:(k=e.timeSeparator,null!=k?k:":"),timeAltSeparator:(b=e.timeAltSeparator,null!=b?b:void 0),hour2Digits:(E=e.hour2Digits,null!=E&&E),clock24Hour:(A=e.clock24Hour,null!=A&&A),isAMPMSepBySpace:(T=e.isAMPMSepBySpace,null==T||T),ampmSymbols:(N=e.ampmSymbols,null!=N?N:["AM","PM"]),dayNameShort:(R=e.dayNameShort,null!=R?R:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),dayNameLong:(I=e.dayNameLong,null!=I?I:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),monthNameShort:(D=e.monthNameShort,null!=D?D:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),monthNameLong:(w=e.monthNameLong,null!=w?w:["January","February","March","April","May","June","July","August","September","October","November","December"]),pictureSpecial:(M=e.pictureSpecial,null!=M?M:da),pictureSingle:(_=e.pictureSingle,null!=_?_:fa),pictureColor:(O=e.pictureColor,null!=O?O:va),pictureDbnum:(x=e.pictureDbnum,null!=x?x:ha)})}function gD(e){return mD(e,{})}function SD(e,t){return H(t)?{index:e,length:1}:{index:e,length:Y(t-e)+1}}function yD(e,t){var r=SD(t.row,t.lastRow),n=r.index,a=r.length,i=SD(t.column,t.lastColumn),o=i.index,u=i.length;return Ct(lt(e,t.sheetId),ht(n,o,a,u))}function CD(e,t){var r=t.sheetId,n=t.usedRange;return V(n)?yD(e,F({sheetId:r},n)):{sheet:lt(e,r),range:void 0}}function kD(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=Ek({row:t}),a=Ek({col:r}),i=xk(n,a);return Bk(eb(e),i)}(e.range,t,r)}}function bD(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function ED(e){return xt(e)?py(e.sheet.index,e.range.row,e.range.col):py(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function AD(e,t,r,n){var a=ok;if(H(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=zC(a,r(W(o,o+u)))}}return a}function TD(e,t){switch(typeof t){case"string":return Pe(t);case"boolean":return Le(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return tt;case"Error":return Ue(t.type);default:return}}function ND(e,t){switch(t.kind){case J.String:case J.Boolean:return t.value;case J.Number:return e.toNumber(t);case J.Error:return cy(t.type);case J.Blank:return sy;default:return}}function RD(e,t,r){if(!H(r))switch(r.kind){case"NamedValue":switch(typeof r.value){case"string":return EA(Pe(r.value));case"boolean":return EA(Le(r.value));case"number":return EA(e.fromNumber(r.value))}return"Error"===r.value.kind?EA(Ue(r.value.type)):y("calc.calc.namedObjectDataToNamedObject: NamedValue",r.value.kind);case"NamedFormula":return AA(r.formulaBarText);case"NamedRange":var n=yD(t,r.range);return EA(Ze(n.sheet,n.range));case"NamedFailure":return TA(r.failureReason,H(r.objectKind)?void 0:r.objectKind);default:return y("calc.calc.namedObjectDataToNamedObject: kind",r)}}function FD(e,t){var r,n;if(t.kind===Lm.NotImplemented)for(var a=0,i=t.features;a<i.length;a++){var o=i[a];Cb(e,Lm.NotImplemented+" "+o)}else if(t.kind===Lm.IllFormedFormula)Cb(e,Lm.IllFormedFormula+" "+((null!=(r=t.mode)?r:"")+" ")+JSON.stringify(null!=(n=t.diagnostics)?n:{}));else if(t.kind===Lm.Unavailable)for(var u=0,s=t.objects;u<s.length;u++){var c=s[u],l=[Lm.Unavailable];if("string"==typeof c.kind&&c.kind in SF){var d=c;switch(l.push(d.kind),d.kind){case SF.SheetId:l.push(d.sheetId);break;case SF.NameLoc:l.push(void 0===d.name.scope.index?"global":"sheet");break;case SF.ClientFailure:l.push(d.reason);break;case SF.VolatileFunction:l.push(d.name)}}else l.push(JSON.stringify(c));Cb(e,l.join(" "))}else t.kind===Lm.LimitExceeded?Cb(e,t.kind+" "+Hm[t.limit]):Cb(e,t.kind)}var ID=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==nb.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){B(e!==nb.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==nb.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(uC(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(Xy(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var a=0;a<K(K(t.length,r.length),n.length);a+=10)this.onRecalcResults(Xy(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))},e}();function DD(e){return{kind:e.kind}}var wD=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=st(void 0,""),this.localeInfo=Aa(),this.mathpack=Wn,this.refStyle=kr.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=gb,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.setProps({}),this.dataModel=new TF(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config)}return e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=RF((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),dC(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t=new ID(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var a=n[r];if(a.kind!==pb.GarbageCollected)if(a.kind!==pb.ExperimentRunResult){if(this.setOutputStateId(a.stateId))switch(t.setOutputStateId(a.stateId),a.kind){case pb.CellWrite:var i=a.cell,o=a.value,u=a.format,s=a.cellKind,c=a.formulaBarText,l=a.formatted,d=a.hasHyperlink,f=i.sheet,v=i.range,h=this.cellWriteToRangeDelta(f.index,v.row,v.col,o,u,c,l,d,"messages.<index>.value");V(h)&&t.pushCellWrite(s,h);break;case pb.RangeWrite:var p=a.range,m=a.values,g=(s=a.cellKind,c=a.formulaBarText,l=a.formatted,a.formats);f=p.sheet,v=p.range;t.pushRangeWrite(s,this.rangeWriteToRangeDeltas(f.index,v,m,g,c,l,"messages.<index>.values"));break;case pb.NameFailure:this.nameFailures.push(a);break;case pb.RangeFailure:p=a.range,s=a.cellKind;var S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.rangeFailures.push(a);break;case pb.NumberFormatFailure:this.numberFormatFailures.push(a);break;case pb.PrintFormulaFailure:this.printFormulaFailures.push(a);break;case pb.InferFormatFailure:this.inferFormatFailures.push(a);break;case pb.FormatValueFailure:p=a.range,s=a.cellKind,S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.formatValueFailures.push(a);break;case pb.UnhandledFailure:this.unhandledFailures.push(a);break;case pb.UpdateRequest:t.pushUpdateRequest(ED(a.range));break;case pb.UpdateNamesRequest:t.pushUpdateNameRequest(a.scope);break;case pb.RecalcStatistics:t.pushRecalcFinished(a.message===fb.RecalcFinished),this.recalcStatistics=yb(this.recalcStatistics,a);break;case pb.WorkbookStatistics:this.logWorkbookStats(a.stateId,a.stats);break;case pb.StateAdvanced:break;default:return y("calc.calc.RecalcServiceImpl.processRecalcResults",a)}}else this.logExperimentRunResult(a.logMessage);else this.onGC(a.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e){S.ULS.traceTag(594409422,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.calc.RecalcService: experiment done; "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var a=this.inferFormatFailures;this.inferFormatFailures=[];var o=this.formatValueFailures;this.formatValueFailures=[];var u=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",i.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",i.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",i.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",i.TraceLevel.Info),this.logGenFailureStats(a,590484947,"infer-format",i.TraceLevel.Info),this.logGenFailureStats(o,590484948,"format-value",i.TraceLevel.Info),this.logGenFailureStats(u,595194338,"unhandled",i.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},o=0,u=e;o<u.length;o++){FD(a,u[o].reason)}var s="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);S.ULS.traceTag(t,i.LogCategory.msoulscat_ES_EWAJS,n,s),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var o={},u=0,s=e;u<s.length;u++){var c=s[u],l=c.reason,d=c.cellKind;FD(o[d]||(o[d]={}),l)}Object.getOwnPropertyNames(o).sort().forEach((function(e){var u=o[e],s="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(u);S.ULS.traceTag(t,i.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===Lm.JavaScriptError){var o="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+m(a.error);S.ULS.traceTag(595658721,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,o)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));S.ULS.traceTag(e,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==gb)){var e=this.recalcStatistics;if(this.recalcStatistics=gb,this.lastRecalcStatsStateId=this.currentOutputStateId,this.dataModel.shouldSample(this.config.sampleRecalcStatisticsRate)){var t="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));S.ULS.traceTag(595654593,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,a,i,o,u,s=L(),c=L(),l=0,d=e;l<d.length;l++){var f=d[l],v=f.range;if(f.reason.kind===lr.Unavailable)for(var h=0,p=f.reason.objects;h<p.length;h++){var m=p[h];m.kind===SF.GridRange&&(Ut(m.range.sheet,v.sheet)?s[m.range.sheet.index]=xk(null!=(t=s[m.range.sheet.index])?t:ok,!0!==m.unavailableCells?m.unavailableCells:ok):c[m.range.sheet.index]=xk(null!=(r=c[m.range.sheet.index])?r:ok,!0!==m.unavailableCells?m.unavailableCells:ok))}}var g=0,S=0,y=0,C=L();for(var k in s){var b=null!=(n=s[k])?n:ok;C[k]=xk(null!=(a=C[k])?a:ok,b),cb(b,(function(e){return g+=e.rows*e.cols,!0}))}for(var k in c){b=null!=(i=c[k])?i:ok;C[k]=xk(null!=(o=C[k])?o:ok,b),cb(b,(function(e){return S+=e.rows*e.cols,!0}))}for(var k in C){cb(b=null!=(u=C[k])?u:ok,(function(e){return y+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:g,numOfUnavailableCellsInDifferentSheet:S,totalNumOfUnavailableCells:y}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="calc.calc.RecalcService: unavailable cells statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));S.ULS.traceTag(589632004,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));S.ULS.traceTag(595359882,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(e){Cb(this.ignoredInputStats,e+": input stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){Cb(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,o,u,s){if(Eb(n,VE,this.ignoredOutputStats,s)){var c=ND(this.mathpack,n),l=function(e){var t;if(void 0!==e)return t=e.format,Yy("object"==typeof t?DD(e.format):e.format,e.valueType,e.decimals)}(a);return V(i)||V(c)||V(l)||V(o)||V(u)?Jy(py(e,t,r),qy(i,c,l,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a,i,o){for(var u=o+".<index>.<index>",s=t.row,c=t.col,l=t.rows,d=t.cols,f=[],v=0;v<l;v+=1)for(var h=0;h<d;h+=1){var p=this.cellWriteToRangeDelta(e,s+v,c+h,r[v][h],n[v][h],0===v&&0===h?a:void 0,i[v][h],void 0,u);V(p)&&f.push(p)}return f},e.prototype.rangeFailure=function(e,t){return Qy(ED(e),DD(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?kr.A1:kr.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),Eb(e,xE,this.ignoredInputStats,"localeData")&&(this.localeInfo=mD(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId))},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),Eb(e,UE,this.ignoredInputStats,"workbookProps")&&(this.setProps(e),this.dataModel.setWorkbookProps(this.props,this.currentInputStateId))},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,Ab(e,zb,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,Ab(t,Xb,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e,"namedObjectsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Ab(t,yE,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,s=At(this.document,V(i)?i:void 0);if(V(o))for(var c=0,l=Ab(o,SE,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");c<l.length;c++){var d=l[c],f=d.name,v=d.data;this.dataModel.writeNamedObject(e,s,f,RD(this.mathpack,this.document,v))}else V(u)?this.dataModel.promoteNamedObjects(e,s,u):this.dataModel.writeUndefinedNames(e,s)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Ab(t,fE,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(CD(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e,"rangeUpdates")){this.clearAsyncResumeRecalc();for(var a=0,i=Ab(t,cE,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,s=o.excludeRows,c=o.excludeColumns,l=o.data,d=o.fromStateId,f=yD(this.document,u),v=f.range,h=AD(v.row,v.rows,$k.row,s),p=kD(f,h,AD(v.col,v.cols,$k.col,c)),m=V(l)?TD(this.mathpack,l.value):tt;if(void 0!==m){var g=Vt(v);if(V(l)){var S=l.iformat,y="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,C=null!=(n=l.failureReason)?n:void 0,k="CellFormula"===l.kind;this.dataModel.writeCellContents(e,p,y,k,g,m,S,C)}else H(d)?this.dataModel.writeCellContents(e,p,"",!1,g,tt,0,void 0):this.dataModel.promoteCellContents(e,f,p,d);this.dataModel.writeHiddenRows(e,bD(f,h))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Ab(t,dE,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,s=yD(this.document,i);if(V(o)){var c=o.formulaBarText,l=o.isSpilled,d=Vt(s.range);this.dataModel.writeArrayFormula(e,s,c,d,l)}else V(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormulaEdits")){this.clearAsyncResumeRecalc();for(var n=Ab(t,EE,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,s=t.origin,c=t.viewport,l=ok;a.forEach((function(e){l=xk(l,eb(yD(r.document,e).range))}));var d=yD(i.document,a[0]),f=V(s)?pt(s.row,s.column):Vt(d.range),v=V(c)?yD(i.document,c):void 0,h=void 0;if(V(u)){if(void 0===(h=TD(i.mathpack,u)))return"continue"}else h=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,db(d.sheet,l),o,p,f,h,v)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=Ab(t,TE,this.ignoredInputStats,"rangeFormatEdits"),a=function(t){var n=t.range,a=t.operation,o=(t.origin,t.viewport),u=a.format;if(H(u))return"continue";var s=ok;n.forEach((function(e){s=xk(s,eb(yD(r.document,e).range))}));var c=yD(i.document,n[0]),l=V(o)?yD(i.document,o):void 0;i.dataModel.editCellFormats(e,db(c.sheet,s),u,l)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=Ab(t,NE,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,s=a.viewport,c=yD(this.document,i),l=V(u)?pt(u.row,u.column):pt(i.row,i.column),d=V(s)?yD(this.document,s):void 0;this.dataModel.editArrayFormula(e,c,o,l,d)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,s,c,l,d,f,v=Array.isArray(e.runExperiments)?{stepBudget:(t=e.experimentStepBudget,null!=t?t:10),totalBudget:(r=e.experimentTotalBudget,null!=r?r:1e4),experiments:(f=e.runExperiments,f.map((function(e){var t,r,n=e.name,a=e.param;return null===(r=(t=pD)[n])||void 0===r?void 0:r.call(t,a)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:(n=e.totalEvalTimeMs,null!=n?n:1e4),maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:(a=e.samplePrecisionEvalRate,null!=a?a:.02),samplePrecisionPrintFormulaRate:(i=e.samplePrecisionPrintFormulaRate,null!=i?i:.001),sampleRecalcStatisticsRate:(o=e.sampleRecalcStatisticsRate,null!=o?o:.2),sampleWorkbookStatisticsRate:(u=e.sampleWorkbookStatisticsRate,null!=u?u:.1),sampleCellEvalStopwatchRate:(s=e.sampleCellEvalStopwatchRate,null!=s?s:.003),sampleRecalcEditedStopwatchRate:(c=e.sampleRecalcEditedStopwatchRate,null!=c?c:1),sampleRecalcViewportStopwatchRate:(l=e.sampleRecalcViewportStopwatchRate,null!=l?l:1),rngSeed:(d=e.rngSeed,null!=d?d:1e3*Date.now()),volatileMode:null!=e.volatileMode?aF[e.volatileMode]:aF.Estimation,experimentDefinitions:v}},e.prototype.setProps=function(e){var t,r,n;this.props={date1904:(t=e.date1904,null!=t&&t),dateCompatibility:(r=e.dateCompatibility,null==r||r),timezone:(n=e.timezone,null!=n?n:gn)}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new TF(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config),this.recalcStatistics=gb,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var a=this;return Eb(r,nE,this.ignoredInputStats,"origin")?Eb(n,BE,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,function(e,t){var r=t.row,n=t.column;return kt(lt(e,t.sheetId),pt(r,n))}(this.document,r),function(e){if(null!=e)switch(e.kind){case"Origin":return hb.Origin;case"Iformat":return k("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Inferred":return hb.Inferred;default:return y("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}(n)).then((function(e){var t,r=e.value,n=e.formatted;if(It(r)){if(!Eb(r.value,VE,a.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var i=ND(a.mathpack,r.value);k("calc.calc.RecalcService.evalFormula",void 0!==i),t=Rt(i)}else t=Ft(DD(r.reason));return rC(t,void 0===n?void 0:It(n)?n:Ft(DD(n.reason)))})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return D(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function MD(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:m(t.error)});S.ULS.traceTag(595658753,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,a=t.onGC;e.setExports("service",new wD(r.notify,n.notify,a.notify))},scriptName:"excelOnlineRecalcService.worker"}}var _D,OD,xD,LD;function PD(e){return void 0===e&&(e=_D.Thread),D(this,void 0,void 0,(function(){var t,r,n,a,o,u,s,c,l=this;return w(this,(function(d){switch(d.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=m(r.error),a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});S.ULS.traceTag(595658719,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");S.ULS.traceTag(595658720,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r),t=!0}},inside:MD()},[4,BC(e===_D.Thread?[nC.Dedicated]:e===_D.Local?[nC.FunctionCall]:[nC.Dedicated,nC.FunctionCall],r)];case 1:if(null==(n=d.sent()))throw new Error("could not create recalc service worker");return a="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,S.ULS.traceTag(595731987,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,a),o=-1/0,u={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){o=e}},n.setExports("client",u),(s=n.getImports("service",["setA1ReferenceStyle","setLocale","setWorkbookProps","setNumberFormats","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editRangeFormats","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay","evalFormula","ping"])).ping.callTimeout=3e4,c=function(e,t){},pC((function(){return D(l,void 0,void 0,(function(){var e,r,n,a;return w(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(o.sent(),t)return[2,void 0];e=$(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,s.ping.call()];case 3:return o.sent(),[3,5];case 4:return o.sent(),r=s.ping.callTimeout,n=$()-e,a="calc.calc.RecalcService: unresponsive; timeout = "+r+", waitTime = "+n,S.ULS.traceTag(591934810,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a),c(r,n),[3,5];case 5:return[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+m(e);S.ULS.traceTag(590698012,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t)})),[2,{setOnRecalcResults:function(e){u.onRecalcResults=function(t){try{e(t)}catch(e){var r="calc.calc.RecalcService: onRecalcResults threw an error: "+m(e);S.ULS.traceTag(589898378,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)}}},setOnUpdateRequest:function(e){u.onUpdateRequest=function(t){try{e(t)}catch(e){var r="calc.calc.RecalcService: onUpdateRequest threw an error: "+m(e);S.ULS.traceTag(589898379,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)}}},setOnUnresponsive:function(e){c=e},setA1ReferenceStyle:function(e){t||s.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||s.setLocale.notify(e)},setWorkbookProps:function(e){t||s.setWorkbookProps.notify(e)},setNumberFormats:function(e,r){t||s.setNumberFormats.notify(e,r)},updateSheetNames:function(e,r){t||s.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||s.updateNamedObjects.notify(e,r)},updateUnusedCells:function(e,r){t||s.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||s.updateRanges.notify(e,r)},updateArrays:function(e,r){t||s.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||s.editRangeFormulas.notify(e,r)},editRangeFormats:function(e,r){t||s.editRangeFormats.notify(e,r)},editArrayFormulas:function(e,r){t||s.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||s.resumeRecalc.notify()},reconfigure:function(e){var r;t||(s.ping.callTimeout=null!=(r=e.responsivenessPingTimeout)?r:3e4,s.reconfigure.notify(e))},clearCache:function(){t||s.clearCache.notify()},testAdvanceState:function(e){t||s.testAdvanceState.notify(e)},testResumeRecalc:function(){return s.resumeRecalc.call()},testCrash:function(){return s.testDelay.isCritical=!0,s.testDelay.callTimeout=0,s.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=o},evalFormula:function(e,t,r,n){return s.evalFormula.call(e,t,r,n)}}]}}))}))}function UD(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function BD(e,t,r,n){var a=t.initTimeout,i=t.callTimeout,o=t.calcAbsUrl,u=t.features;return D(this,void 0,void 0,(function(){var t,s,c,l,d=this;return w(this,(function(f){switch(f.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,hC(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,t){return D(d,void 0,void 0,(function(){function s(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function c(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,d,f,v,h,p;return w(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),f=mC(self,UD),d=NC(nC.Dedicated,f,a,i,s,c),v=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);function r(e){return"["+(new Date).toISOString()+"] "+e}return{shipAssertTag:function(e,n,a,i){if(t.shipAssertTag.notify(e,n,a,r(i)),!a)throw new Error("shipAssertTag: "+e+" "+n+" "+i)},assertTag:function(e,n,a,i){if(t.assertTag.notify(e,n,a,r(i)),!a)throw new Error("assertTag: "+e+" "+n+" "+i)},traceTag:function(e,n,a,i){t.traceTag.notify(e,n,a,r(i))},debugTraceTag:function(e,n,a,i){t.debugTraceTag.notify(e,n,a,r(i))}}}(d),h=function(e){var t;return null!=(t=u[e])&&t},r.config.initCalc(v,h,o),t()||null==n.onInit?[3,3]:[4,n.onInit(d)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=d?d.close():UD(),p;case 5:return[2]}}))}))})).then((function(e){return[oC.Fulfilled,e]}),(function(e){return[oC.Rejected,e]}))];case 1:t=f.sent(),s=t[0],c=t[1],l=[iC.Result,e,s,bC(c),!0];try{self.postMessage(l)}catch(e){throw UD(),e}return[2]}}))}))}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(_D||(_D={})),(xD=OD||(OD={})).worksheetFunctionName=ny,xD.errorTypeName=ay,xD.localeData=iy,xD.numberFormat=oy,xD.sheetName=uy,xD.blankValue=sy,xD.errorValue=cy,xD.richValue=ly,xD.getCellValueKind=dy,xD.getCellFormatKind=fy,xD.cellLocation=vy,xD.rangeLocation=hy,xD.sheetRangeLocation=py,xD.sheetCellLocation=my,xD.cellData=gy,xD.cellFormulaCellData=Sy,xD.arrayFormulaCellData=yy,xD.valueCellData=Cy,xD.rangeUpdate=ky,xD.rangeWrite=by,xD.rangePromote=Ey,xD.arrayData=Ay,xD.arrayUpdate=Ty,xD.arrayWrite=Ny,xD.arrayPromote=Ry,xD.unusedCellsUpdate=Fy,xD.namedValueData=Iy,xD.namedFormulaData=Dy,xD.namedRangeData=wy,xD.namedFailureData=My,xD.namedObject=_y,xD.namedObjectsUpdate=Oy,xD.namedObjectsWrite=xy,xD.undefinedNamesWrite=Ly,xD.namedObjectsPromote=Py,xD.rangeFormulaEdit=Uy,xD.cellFormulaRangeFormulaEdit=By,xD.valueRangeFormulaEdit=Gy,xD.inferredRangeFormulaEdit=Vy,xD.formatEditOperation=Hy,xD.formatEditSetFormat=Wy,xD.rangeFormatEdit=jy,xD.arrayFormulaEdit=Ky,xD.inferredFormat=Yy,xD.cellDataDelta=qy,xD.rangeDelta=Jy,xD.arrayDelta=zy,xD.rangeFailure=Qy,xD.recalcResults=Xy,xD.evalFormulaData=rC,xD.evalFormulaFormat=Zy,xD.evalFormulaFormatOrigin=$y,xD.evalFormulaFormatIformat=eC,xD.evalFormulaFormatInferred=tC,xD.updateRequest=uC,xD.runExperiment=sC,xD.recalcServiceConfig=cC,xD.workbookProps=lC,xD.createRecalcService=PD,xD.RecalcServiceCreateMode=_D,xD.localeInfoFromData=gD,xD.recalcServiceInsideDef=MD,xD.getEvalResultKind=MA,xD.getEvalFailureReason=_A,(LD||(LD={})).getWorksheetFunc=$R;var GD=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function VD(){return GD.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function HD(){var e="object"==typeof performance?performance.memory:void 0;return null!=e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:void 0}var WD=function(e){var t=e.config,r=e.connection;"Thread"===r.createMode&&_.setConfig(t);var n=[];return _.Endpoint.createInside(r,(function(){return{startMemoryTest:function(e){var t=HD(),r=0;try{for(;r<e;r+=1){var a=new Uint8Array(1024);a[0]=0,a[1023]=255,n.push(a)}}catch(e){}return[t,r,HD()]},endMemorytest:function(){n=[]},ping:function(e){return e+1},getMissingJSFeatures:VD}}))},jD=!1,KD=void 0;function YD(){null!=KD&&KD.close(),jD=!1}var qD=Promise.resolve();function JD(e,t,r,n){return void 0===n&&(n=0),Ra(ba.CalcWebWorkerTest)?(YD(),qD=qD.then((function(r){return function(e,t,r,n){return D(this,void 0,void 0,(function(){var r,a,o,u,s,c,l,d,f,v,h,p,m,g,y,C,k=this;return w(this,(function(b){switch(b.label){case 0:jD=!0,b.label=1;case 1:if(b.trys.push([1,8,9,10]),C="calc.twSmokeTest.runSmokeTest: starting; duration = "+e+" ms, pingInterval = "+t+" ms",S.ULS.traceTag(593335264,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,C),null==(r=ra()))throw new Error("initCalc was not passed calcAbsUrl");return[4,_.createWorker({id:"SmokeTest",createMode:"ThreadOrLocal"},{local:WD,thread:{scriptUrl:r,insideInitName:"excelOnlineCalc.worker.smokeTestInsideInit"}})];case 2:if(KD=b.sent(),!jD)throw a="smoke test canceled during worker creation",S.ULS.traceTag(593335265,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a),new Error(a);return C="calc.twSmokeTest.runSmokeTest: worker created; outside.createMode = "+KD.createMode,S.ULS.traceTag(593335266,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,C),[4,KD.call.ping(-1)];case 3:if(0!==(o=b.sent()))throw new Error("expected 0; got "+o);return n>0&&"Thread"===KD.createMode?(u=HD(),[4,KD.call.startMemoryTest(n)]):[3,5];case 4:s=b.sent(),c=s[0],l=s[1],d=s[2],f=HD(),v={startMain:u,startThread:c,kb:l,endThread:d,endMain:f},h="calc.twSmokeTest.runSmokeTest: memory = "+JSON.stringify(v),S.ULS.traceTag(592488325,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,h),KD.post.endMemorytest(),b.label=5;case 5:return m={main:VD()},[4,KD.call.getMissingJSFeatures()];case 6:return m.worker=b.sent(),p=m,C="calc.twSmokeTest.runSmokeTest: missing = "+JSON.stringify(p),S.ULS.traceTag(593335267,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,C),g=Date.now(),[4,pC((function(r){return D(k,void 0,void 0,(function(){var n;return w(this,(function(a){switch(a.label){case 0:return Date.now()>=g+e||!KD||KD.hasBeenClosed()?[2,void 0]:r%1e3!=0?[3,2]:(n=te("calc.twSmokeTest.runSmokeTest: ping call roundtrip"),[4,KD.call.ping(r)]);case 1:a.sent(),n.stop(),a.label=2;case 2:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 3:return a.sent(),KD.post.ping(r),[2,r+1]}}))}))}),0)];case 7:return b.sent(),C="calc.twSmokeTest.runSmokeTest: success",S.ULS.traceTag(593335296,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,C),[3,10];case 8:return y=b.sent(),jD&&(C="calc.twSmokeTest.runSmokeTest: failure: "+y.message,S.ULS.traceTag(593335297,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,C)),[3,10];case 9:return YD(),KD=void 0,[7];case 10:return[2]}}))}))}(e,t,0,n)}))):Promise.resolve()}var zD,QD,XD={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});S.ULS.traceTag(595908699,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",uo),e.setExports("talk",{start:function(e,r,n){return D(this,void 0,void 0,(function(){var a,i=this;return w(this,(function(o){switch(o.label){case 0:return a=Date.now(),[4,pC((function(o){return D(i,void 0,void 0,(function(){return w(this,(function(i){switch(i.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return i.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";S.ULS.traceTag(595906820,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,a)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;S.ULS.traceTag(595907656,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;S.ULS.traceTag(595714188,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"};(QD=zD||(zD={})).WorkerKind=nC,QD.ErrorKind=aC,QD.isWorkerSupported=LC,QD.createWorker=UC,QD.tryCreateWorker=BC,QD.dedicatedWorkerInsideInit=BD,QD.runSmokeTest=JD,QD.cancelSmokeTest=YD,QD.smokeTestInsideInit=WD,QD.smokeTestInsideDef=XD,r.d(t,"packageVersion",(function(){return"17.0.1"})),r.d(t,"location",(function(){return uo})),r.d(t,"formula",(function(){return fo})),r.d(t,"value",(function(){return co})),r.d(t,"signature",(function(){return ho})),r.d(t,"util",(function(){return mo})),r.d(t,"config",(function(){return So})),r.d(t,"math",(function(){return Co})),r.d(t,"date",(function(){return bo})),r.d(t,"parse",(function(){return Vd})),r.d(t,"analyze",(function(){return Tf})),r.d(t,"numfmt",(function(){return Fm})),r.d(t,"runtime",(function(){return HS})),r.d(t,"calc",(function(){return OD})),r.d(t,"funcs",(function(){return LD})),r.d(t,"worker",(function(){return zD}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map