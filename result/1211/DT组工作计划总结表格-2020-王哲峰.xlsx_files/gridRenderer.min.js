!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=116)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(2),o=n(3),a=n(16),l=n(1),s=n(5),d=n(4),u=n(15),c=n(44),g=n(65),f=n(23),h=n(8);function m(e,t,n){if(null==e)throw Error(n+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function p(e,t){return e-t}function C(e,t,n,r,i){for(var o=t,a=t+n-1;o<=a;){var l=o+(a-o>>1),s=i(e instanceof Array?e[l]:e.item(l),r);if(0===s)return l;s<0?o=l+1:a=l-1}return~o}function y(e,t){return e.Row===t.Row&&e.Col===t.Col?0:e.Row>t.Row||e.Row===t.Row&&e.Col>t.Col?1:-1}function v(e,t,n){var r,i=F(e.Bold||!1,e.Italic||!1),o=null!=(r=null!=t?t:e.Size)?r:a.DefaultFontSizePt;return l.isFontContainsVerticalAlignment(n,e)&&(o=g.getVerticalAlignmentFontSizeAdjusted(o)),i+" "+o+'pt "'+f.canonizeFontName(e.FontName)+'"'}function F(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function S(e){return e.ClientOnlyCache||T(e),e.ClientOnlyCache}function T(e){e.ClientOnlyCache={}}function x(e){m(e,"model","initCellLookup"),m(e.Cells,"model.Cells","initCellLookup");for(var t={},n=0;n<e.Cells.length;n++){var r=e.Cells[n];if(r)if(t[o.cellLookupKey(r.Row,r.Col)]=r,r.Merge)for(var i=0;i<=r.Merge.Rows;i++)for(var a=0;a<=r.Merge.Columns;a++)t[o.cellLookupKey(r.Row+i,r.Col+a)]=r;else t[o.cellLookupKey(r.Row,r.Col)]=r}return t}function w(e,t,n){m(n,"model","initCellLookup");var r=S(n);return r.CellLookup||(r.CellLookup=x(n)),r.CellLookup[o.cellLookupKey(e,t)]}function b(e,t){return m(e,"cell","getCellStyle"),m(t.Styles,"Styles","getCellStyle"),e.CachedStyle||(e.CachedStyle=r.getReferencedObjectById(e.StyleID,t.Styles)),e.CachedStyle}function A(e){return e.CachedStyle.ShrinkToFit&&!e.WrapText}function R(e){if(A(e))return e.ShrunkSize}function I(e,t,n,r){var i,o,a=A(t),s=a?t.ShrunkSize:n.Size;return l.isFontContainsVerticalAlignment(e,n)&&!r&&(s=g.getVerticalAlignmentFontSizeAdjusted(s)),s<0&&u.setActualFontSizeWarning("\n      actual font size < 0.\n      doesCellHaveShrinkToFit: "+a+",\n      cell.ShrunkSize: "+t.ShrunkSize+",\n      Font:\n        size: "+n.Size+";\n        fontName: "+f.getFontNameForLogging(n.FontName)+";\n        refCount: "+n.RefCount+";\n      cell.CachedStyle:\n        isHidden: "+(null===(i=t.CachedStyle)||void 0===i?void 0:i.IsHidden)+";\n        shrinkToFit: "+(null===(o=t.CachedStyle)||void 0===o?void 0:o.ShrinkToFit)+";\n      cell.Ifmt: "+t.Ifmt+";\n      cell.WrapText: "+t.WrapText+";\n    "),s}function M(e){return!d.isNullOrUndefined(e)}function D(e,t,n){var r;if(o.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,n)&&t.TextRuns&&n.Fonts){return{Text:e,TextRuns:null!=(r=t.CachedDisplayTextRuns)?r:t.TextRuns,Fonts:n.Fonts}}}function P(e,t){if(h.isVerticalTextPresent(t,e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!k(e,t))return e.Text;if(d.isNullOrUndefined(e.CachedDisplayText))if(!d.isNullOrUndefined(e.Text)&&d.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(s.HardBreak)>=0){var r=D(e.Text,e,t);!d.isNullOrUndefined(r)&&r.Text.indexOf(s.HardBreak)>=0&&(e.CachedDisplayTextRuns=function(e){var t=e.TextRuns,n=[],r=e.Text;O(t,r);for(var i=0,o=0;o<t.length;o++){var a=t[o];m(a.EndIndex,"EndIndex","getAdjustedTextRuns"),m(a.StartIndex,"StartIndex ","getAdjustedTextRuns");var l=a.StartIndex,d=a.EndIndex;i!==l&&(d+=i-l,l=i);for(var u=a.StartIndex;u<a.EndIndex;u++)r.charAt(u)!==s.HardBreak||e.WrapText||d--;n.push({StartIndex:l,EndIndex:d,FontID:a.FontID,CachedFont:a.CachedFont}),i=d}return n}(e)),e.CachedDisplayText=L(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function L(e){return-1!==e.indexOf(s.HardBreakCRLF)||-1!==e.indexOf(s.HardBreak)?e.replace(/\r\n|\n/g,""):e}function O(e,t){var n;if(void 0===(null===(n=e[0])||void 0===n?void 0:n.EndIndex))for(var r=0;r<e.length;r++){var i=e[r],o=r<e.length-1?e[r+1].StartIndex:t.length;i.EndIndex=o}}function k(e,t){var n;if(o.isRenderFlagEnabled(i.RenderFlags.FixCellDisplayedTextDiffrentThanOriginalTextLogic,t)){var r=o.isRenderFlagEnabled(i.RenderFlags.NumFmtAccountingAndCustom,t)&&e.ValueType===i.CellValueType.Number,a=!d.isNullOrUndefined(e.Text)&&d.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(s.HardBreak)>=0&&e.Text!==e.CachedDisplayText,l=o.isRenderFlagEnabled(i.RenderFlags.AdvHorizontalAlignmentFillAndCAS,t)&&(null===(n=e.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)===i.HorizontalAlignment.Fill;return r||a||l}return o.isRenderFlagEnabled(i.RenderFlags.NumFmtAccountingAndCustom,t)||!d.isNullOrUndefined(e.Text)&&d.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(s.HardBreak)>=0}t.verifyArgumentNotNull=m,t.numbersComparer=p,t.binarySearch=C,t.cellsPositionComparer=y,t.getFontCssStringFromCell=function(e,t){return v(e.CachedFont,R(e),t)},t.getFontCssStringFromFont=v,t.getCellFontWeightStyle=F,t.throwError=function(e,t){throw Error(t+": "+e)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,n){m(n,"model","isCellAdjacentToMergedCell");for(var r=function(e,t,n){return[w(e-1,t,n),w(e+1,t,n),w(e,t-1,n),w(e,t+1,n)]}(e,t,n),i=0;i<r.length;i++)if(r[i]&&r[i].Merge)return!0;return!1},t.getModelClientCache=S,t.initModelClientCache=T,t.initCellLookup=x,t.getCell=w,t.getColumnWidth=function(e,t){if(m(t,"model","getColumnWidth"),m(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model");return t.ColumnWidths[e]},t.getCellStyle=b,t.getCellFont=function(e,t){if(m(e,"cell","getCellFont"),m(t.Styles,"Styles","getCellFont"),m(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var n=b(e,t);e.CachedFont=r.getReferencedObjectById(n.FontID,t.Fonts)}return e.CachedFont},t.getCellPositionInArray=function(e,t){var n=C(t,0,t.length,e,y);return n<0&&(n=~n),n},t.cellHasShrinkToFit=A,t.getShrunkFontSize=R,t.getTextRunText=function(e,t,n){var r=t[e].StartIndex,i=n.length;return e<t.length-1&&(i=t[e+1].StartIndex),n.substring(r,i)},t.getActualFontSize=function(e,t){return I(t,e,e.CachedFont,!0)},t.getActualFontSizeFromFont=I,t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t){return d.isNullOrUndefined(e)?M(t)?t:s.DefaultBackgroundColor:l.rgbToColorHex(e.BackgroundColor)},t.hasWorkbookBackgroundColor=M,t.isHighContrastMode=function(e){return!d.isNullOrUndefined(e.highContrastScheme)},t.getFormattedText=D,t.getDisplayText=P,t.updateCellText=function(e,t,n){t.Text=n,k(t,e)&&(t.CachedDisplayText=P(t,e)),o.isAccAndCustomNumFmtApplicable(t,e)?c.updateNumFmtFromCell(t):t.NumFmt=void 0},t.removeHardBreaks=L,t.prepareTextRunRanges=O,t.isDefined=function(e){return void 0!==e},t.getModelRowIndex=function(e,t){return m(e,"model","getRowIndex"),m(e.RowNumbers,"RowNumbers","getRowIndex"),C(e.RowNumbers,0,e.RowNumbers.length,t,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(5),o=n(4),a=n(3),l=n(33),s={},d={},u={};function c(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t}function g(e){return e-i.GridLineWidthPx}function f(e,t,n,r,i){e.beginPath(),e.rect(t,n,r,i),e.stroke(),e.clip()}function h(e,t,n,r){return!(t<n||r<e)}t.getDefaultBorderLineWidth=function(e){return o.isNullOrUndefined(s[e])?(s[e]=Math.max(Math.round(e),1),s[e]):s[e]},t.rgbToColorHex=c,t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=function(e,t){return Math.round(e*t)},t.isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.getTextDrawingMaxWidth=function(e,t,n,r){var o=0;return n&&(o=n+l.IconTextMinimalPadding),Math.max(0,e-i.GridLineWidthPx-t-o-r)},t.getTextDrawingMaxHeight=function(e,t){return Math.max(0,e-i.GridLineWidthPx-t)},t.getContainerClipMaskWidth=g,t.drawClipRect=f,t.applyClipping=function(e,t){t&&(e.save(),e.strokeStyle="transparent",f(e,t.x,t.y,t.width,t.height))},t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,n,r,i){e.moveTo(t,n),e.lineTo(r,i)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}},t.cellIntersectsRenderingRegion=function(e,t){var n=e.Row,r=e.Row,i=e.Col,o=e.Col;e.Merge?(r+=e.Merge.Rows,o+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(i=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(i-=e.Spill.SpanToStart,o+=e.Spill.SpanToEnd);var a=h(i,o,t.startColumn,t.endColumn),l=h(n,r,t.startRow,t.endRow);return a&&l},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetsAdjustedForDrawing=function(e,t){var n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=n[n.length-1];return t.IsRtl?r-n[e+1]:n[e]},t.isRtlChar=function(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647},t.getHighContrastTextColor=function(e,t){return o.isNullOrUndefined(e.Hyperlink)?function(e){u[e]||(u[e]=c(e));return u[e]}(t.TextColor):function(e){d[e]||(d[e]=c(e));return d[e]}(t.LinkColor)},t.isCellShrunk=function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size},t.isFontContainsVerticalAlignment=function(e,t){return!(o.isNullOrUndefined(e)||!a.isRenderFlagEnabled(r.RenderFlags.FontVerticalAlignment,e)||o.isNullOrUndefined(t.VerticalAlign)||t.VerticalAlign===r.FontVerticalAlignment.None)},t.getReOrderDiv=function(e,t){var n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(2e3,1.1*t)+"px",n},t.getClipMaskWidth=function(e,t,n){return g(e)-t-n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(t.MenuDisplayType||(t.MenuDisplayType={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.AggregationTypeMax=11]="AggregationTypeMax"}(t.PivotTableDataFieldAggregationType||(t.PivotTableDataFieldAggregationType={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(t.PivotTableDataFieldFormatType||(t.PivotTableDataFieldFormatType={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(t.RangeType||(t.RangeType={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(t.GradientShadingStyle||(t.GradientShadingStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(t.BackgroundFillType||(t.BackgroundFillType={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(t.ReadingOrderType||(t.ReadingOrderType={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(t.UniqueStyleID||(t.UniqueStyleID={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(t.CellValueType||(t.CellValueType={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(t.CellFormulaType||(t.CellFormulaType={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(t.AutoFilterType||(t.AutoFilterType={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(t.CellsEncoding||(t.CellsEncoding={})),function(e){e[e.None=0]="None",e[e.UpdateFontLoadStatus=1]="UpdateFontLoadStatus",e[e.VerticalTextSlice1=2]="VerticalTextSlice1",e[e.VerticalTextSlice2=4]="VerticalTextSlice2",e[e.CanvasHitTest=8]="CanvasHitTest",e[e.VerticalTextSlice3=16]="VerticalTextSlice3",e[e.DataBars=32]="DataBars",e[e.PivotTable=64]="PivotTable",e[e.AdjustDataBarPaddingToDpr=128]="AdjustDataBarPaddingToDpr",e[e.FontVerticalAlignment=512]="FontVerticalAlignment",e[e.RichTextFormat=1024]="RichTextFormat",e[e.MeasureTextWidthUseNewRegex=2048]="MeasureTextWidthUseNewRegex",e[e.AdvancedTextMetrics=8192]="AdvancedTextMetrics",e[e.AdvancedVerticalAlignment=16384]="AdvancedVerticalAlignment",e[e.EmptyCellsCseMismatch=32768]="EmptyCellsCseMismatch",e[e.FontFallback=65536]="FontFallback",e[e.MeasureTextAfterFontDownload=131072]="MeasureTextAfterFontDownload",e[e.NumFmtAccountingAndCustom=262144]="NumFmtAccountingAndCustom",e[e.RichValueIcon=1048576]="RichValueIcon",e[e.NumFmtNewFontAPI=2097152]="NumFmtNewFontAPI",e[e.GridLineColor=8388608]="GridLineColor",e[e.WorkbookBackgroundColor=16777216]="WorkbookBackgroundColor",e[e.AdvHorizontalAlignmentFillAndCAS=33554432]="AdvHorizontalAlignmentFillAndCAS",e[e.AdvHorizontalAlignmentJustifyAndDistributed=67108864]="AdvHorizontalAlignmentJustifyAndDistributed",e[e.PageBreaks=134217728]="PageBreaks",e[e.PrintArea=536870912]="PrintArea",e[e.RemoveBordersWithinASpillCell=2147483648]="RemoveBordersWithinASpillCell",e[e.FixCellDisplayedTextDiffrentThanOriginalTextLogic=4294967296]="FixCellDisplayedTextDiffrentThanOriginalTextLogic"}(t.RenderFlags||(t.RenderFlags={})),function(e){e[e.PivotTable=0]="PivotTable",e[e.FakeFlag1=15]="FakeFlag1",e[e.FakeFlag2=80]="FakeFlag2"}(t.RenderFlagsArray||(t.RenderFlagsArray={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(t.MenuItemType||(t.MenuItemType={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(t.BorderPositionType||(t.BorderPositionType={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(t.OutlineState||(t.OutlineState={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter"}(t.MenuEntryIdentifier||(t.MenuEntryIdentifier={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(t.RichValueCellType||(t.RichValueCellType={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(t.CFIconSet||(t.CFIconSet={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(t.SparklineType||(t.SparklineType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(2),o=n(4),a=n(64);function l(e,t,n){if(void 0===n&&(n=!1),!n)return 0!=(e&t.RenderFlags);if(!o.isNullOrUndefined(t.RenderFlagsArray)){var r=Math.floor(e/a.MaxBitsPerRenderFlag);if(r<t.RenderFlagsArray.length){var i=e%a.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[r]&1<<i)}}return!1}function s(e,t){return!!d(e)&&(l(i.RenderFlags.NumFmtAccountingAndCustom,t)&&e.Ifmt>=a.NumFmtAccountingStartIndex&&!o.isNullOrUndefined(e.NumFmt)&&""!==e.Text)}function d(e){return e.ValueType===i.CellValueType.Number}t.cellLookupKey=function(e,t){return t+"_"+e},t.getReferencedObjectToCache=function(e,t){if(!o.isNullOrUndefined(e)&&!o.isNullOrUndefined(t))return r.getReferencedObjectById(e,t)},t.isRenderFlagEnabled=l,t.doesNumFmtOverrideText=function(e,t){return!!d(e)&&(""!==e.WrapText&&""!==e.Text||s(e,t))},t.isAccAndCustomNumFmtApplicable=s,t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error(n+".verifyArgumentNotNull: "+t+" cannot be null or undefined")},t.getDefaultCell=function(e,t,n,o){void 0===n&&(n=void 0),void 0===o&&(o=void 0);var a=n&&0!==n.length?r.getReferencedObjectById(i.UniqueStyleID.Default,n):void 0;return{Col:t,CachedStyle:a,CachedFont:o&&0!==o.length&&a?r.getReferencedObjectById(a.FontID,o):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:i.UniqueStyleID.Default,BorderStyleID:i.UniqueStyleID.DefaultBorder,Text:"",ValueType:i.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!C(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(l(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])m(s)||!F(s)?a+=" "+s:a+=" "+l(s);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function l(e,n){var r={seen:[],stylize:d};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),u(r,e,r.depth)}function s(e,t){var n=l.styles[t];return n?"["+l.colors[n][0]+"m"+e+"["+l.colors[n][1]+"m":e}function d(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return C(i)||(i=u(e,i,r)),i}var o=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(C(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(p(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(o)return o;var a=Object.keys(n),l=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(x(n)){var s=n.name?": "+n.name:"";return e.stylize("[Function"+s+"]","special")}if(v(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return c(n)}var d,F="",w=!1,b=["{","}"];(f(n)&&(w=!0,b=["[","]"]),x(n))&&(F=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(F=" "+RegExp.prototype.toString.call(n)),S(n)&&(F=" "+Date.prototype.toUTCString.call(n)),T(n)&&(F=" "+c(n)),0!==a.length||w&&0!=n.length?r<0?v(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),d=w?function(e,t,n,r,i){for(var o=[],a=0,l=t.length;a<l;++a)I(t,String(a))?o.push(g(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(g(e,t,n,r,i,!0))})),o}(e,n,r,l,a):a.map((function(t){return g(e,n,r,l,t,w)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(d,F,b)):b[0]+F+b[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,n,r,i,o){var a,l,s;if((s=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?l=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(l=e.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),l||(e.seen.indexOf(s.value)<0?(l=m(n)?u(e,s.value,null):u(e,s.value,n-1)).indexOf("\n")>-1&&(l=o?l.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+l.split("\n").map((function(e){return"   "+e})).join("\n")):l=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return l;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+l}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function p(e){return"number"==typeof e}function C(e){return"string"==typeof e}function y(e){return void 0===e}function v(e){return F(e)&&"[object RegExp]"===w(e)}function F(e){return"object"==typeof e&&null!==e}function S(e){return F(e)&&"[object Date]"===w(e)}function T(e){return F(e)&&("[object Error]"===w(e)||e instanceof Error)}function x(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function b(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(y(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=p,t.isString=C,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=v,t.isObject=F,t.isDate=S,t.isError=T,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(62);var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[b(e.getHours()),b(e.getMinutes()),b(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",R(),t.format.apply(t,arguments))},t.inherits=n(63),t._extend=function(e,t){if(!t||!F(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var M="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(M&&e[M]){var t;if("function"!=typeof(t=e[M]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,M,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),M&&Object.defineProperty(t,M,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=M,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(D,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(61))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.DefaultGridlineColor="#d4d4d4",t.PageLayoutLineColor="#9e9e9e",t.MinimalDprForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},t.RightHorizontalAlignmentItalicExtraPadding=3,t.Whitespace=" ",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.FontHeightToBaselineGapRatio=.22;var i={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Top,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Bottom,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Left,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Right,Color:i,Weight:2}],ID:r.UniqueStyleID.FormulaError,RefCount:0},t.MinUnicodeThaiRange=3584,t.MaxUnicodeThaiRange=3711},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),i=n(2),o=n(3),a=n(5),l=n(16),s=n(4),d=n(0),u=n(34),c=n(47),g=n(48),f=n(18),h=n(20),m=n(11),p=n(13),C=n(7),y=n(49),v=n(1),F=n(8),S=n(29),T=n(21),x=n(27),w=!0,b={},A={};function R(e,t,n,r){if(!t)return 0;if(n&&w){var i=r?t.replace(/^\s+|\s+$/g,""):t.replace(/ +$/,""),o=e.measureText(i);try{if(!s.isNullOrUndefined(o.actualBoundingBoxLeft)&&!s.isNullOrUndefined(o.actualBoundingBoxRight)){var a=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),l=t.length-i.length,d=0;if(l>0)d=l*e.measureText(" ").width;return a+d}}catch(e){}w=!1}return Q(e,t)}function I(e,t){var n=X(e,t),r=!o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||m.isIconAlignedToTheLeft(e,t)?n:0,l=o.isRenderFlagEnabled(i.RenderFlags.PivotTable,e)?m.getExpandCollapseButtonPadding(e,t):0,s=m.shouldExpandCollapseButtonShiftText(e,t)?l:0,d=e.IsRtl?a.GridLineWidthPx:0;return C.getCellLeft(e,t,e.BlockWidth)+r+s+(C.getCellWidth(e,t,!1)-n-l)/2-d}function M(e,t){if(t.Spill){var n=X(e,t),r=o.isRenderFlagEnabled(i.RenderFlags.PivotTable,e)?m.getExpandCollapseButtonPadding(e,t):0,l=e.IsRtl?a.GridLineWidthPx:0,s=C.getSpillCellWidth(t,e)-n-r,d=C.getSpillCellStartOffset(t,e,n,r);return(d+=o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)?0:n)+s/2-l}return I(e,t)}function D(e){return e*a.InCellIndentPaddingPx}function P(e,t){return q(t,e,function(e,t){if(!o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||function(e,t){var n;if(T.isCFIconAlignedToTheLeft(e,t)||(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)){var r=m.isIconAlignedToTheLeft(e,t),o=p.getEffectiveHorizontalAlignment(e,t);switch(o){case i.HorizontalAlignment.Right:return!r;case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return r;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error("unexpected context alignment "+o)}}return!1}(e,t))return X(e,t);return 0}(t,e),m.shouldExpandCollapseButtonShiftText(t,e)?m.getExpandCollapseButtonPadding(t,e):0)}function L(e,t,n,r,a,l,s,d){var u=J(e,t,a),f=p.getEffectiveHorizontalAlignment(e,t),h=g.CalibriRegularPadding;switch(f){case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return u+c.approximateValue(n,h)+s+d;case i.HorizontalAlignment.Right:r&&(h=g.CalibriItalicPadding);var m=o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)?s:0;return u+c.approximateValue(n,h)+m+d;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return l?c.approximateValue(n,h):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+f)}}function O(e,t,n){return u.getCachedFontMetrics(n,t,e).height}function k(e,t,n){var r=O(e,t,n);return Math.ceil(r*l.LineHeightUsingDivFontFactor)}function N(e,t,n,r){switch(e){case i.FontVerticalAlignment.Subscript:var o=B(r);return n+t.baseline/2-o;case i.FontVerticalAlignment.Superscript:return n-2*(t.middle-t.baseline);default:return n}}function B(e){return e?l.SubscriptVerticalPaddingForUnderlinePx:0}function E(e,t,n,r){return W(e-(t+a.GridLineWidthPx-n)/2,r)}function H(e,t,n){return W(e+t,n)}function W(e,t){return e-l.LineHeightBottomConstantPx-t}function z(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||d.updateCellText(t,n,n.Text);var r=n.TextRuns&&o.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,t);if(n.CachedDrawingLayout.CellTextLayout.Width){if(r&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}var a=o.isRenderFlagEnabled(i.RenderFlags.AdvancedTextMetrics,t),l=d.getDisplayText(n,t);if(r){var s=U(n),u=j(e,n.TextRuns,n.Text,t,s);return{width:u.totalSize,textRunsDrawingInformation:u.textRunsDrawingInformation}}return{width:R(e,l,a,o.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t))}}function j(e,t,n,r,i){var o=e.textAlign;e.textAlign="left";var a=_(e,r,n,!1,i,t);return e.textAlign=o,a}function _(e,t,n,a,l,s){for(var u=[],c=function(e,t,n){if(void 0!==e&&e.HasBidi)return h.prepareTextRunsForBidiLayout(t,n);return t}(l,s,n),g=0,f=0;f<c.length;f++){var m=c[f],p={FontID:m.FontID,StartIndex:m.StartIndex},C=d.getTextRunText(f,c,n),y=m.CachedFont,v=d.getFontCssStringFromFont(y,void 0,t);if(a){var F=k(t,y.Size,y.FontName),S=V(F,C);p.HeightPx=S,p.WidthPx=F,g+=S}else{e.font=v;var T=R(e,C,f===c.length-1,o.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t));p.Underline=y.Underline,p.WidthPx=T,g+=T}p.Strikethrough=y.StrikeThrough,p.Text=C,p.FontCss=v,u[f]=r.__assign(r.__assign({},p),m)}return{textRunsDrawingInformation:u,totalSize:g}}function V(e,t){return e*S.breakToGraphemes(t).length}function U(e){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var n=h.analyzeBidiText(e.Text,e.CachedStyle.ReadingOrder);return e.CachedDrawingLayout.BidiContext=n,n}function G(e,t){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedFont,"CachedFont","getTextLineHeight");var n,r=e.TextRuns&&o.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,t);if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;r&&(n=Y(t,e.TextRuns));var a=k(t,r?n.Size:d.getActualFontSizeFromFont(t,e,e.CachedFont,!0),r?n.FontName:e.CachedFont.FontName);return e.CachedDrawingLayout.CellTextLayout.LineHeight=a,a}function Y(e,t){for(var n,r=0;r<t.length;r++){var i=t[r],o=f.getReferencedObjectById(i.FontID,e.Fonts);(!n||n.Size<o.Size)&&(n=o)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function X(e,t){var n=d.getActualFontSize(t,e);return m.getIconSizeAndPadding(e,t,n)}function J(e,t,n){var r;if(F.isVerticalTextPresentSlice2(e,t))return 0;var a=o.isRenderFlagEnabled(i.RenderFlags.PivotTable,e)&&(null===(r=t.PivotTable)||void 0===r?void 0:r.HasWideIndent)?x.WideIndentFactor:1;return D(n)*a}function q(e,t,n,r){var i=t.CachedStyle.Indentation||0,o=d.getActualFontSize(t,e),a=!s.isNullOrUndefined(t.WrapText)||d.cellHasShrinkToFit(t),l=F.isVerticalTextPresent(e,t)?G(t,e)/2:0;return L(e,t,o,t.CachedFont.Italic,i,a,n,r)+l}function Q(e,t){return e.measureText(t).width}t.measureTextWidth=R,t.calculateSubSuperOffsetY=function(e,t,n,r,i,o){var a;return o?N(t,i,r,m.isBottomPaddingNeededForSubscriptUnderline(n,null===(a=e.CachedStyle)||void 0===a?void 0:a.VerticalAlignment)):0},t.getCellTextCenterX=I,t.getTextCenterForCenterAcrossSelection=M,t.getIndentationPaddingPx=D,t.getCellTextHorizontalPadding=P,t.getCellTextHorizontalPaddingWithoutVisualElements=function(e,t){return q(e,t,0,0)},t.getCellTextClipMask=function(e,t,n,r,a,l){var s=t,d=v.getContainerClipMaskWidth(r);return o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)&&(s+=e.IsRtl?0:l,d-=l),{x:s,y:n,width:d,height:a}},t.getWrapTextAdditionalPadding=function(e,t){var n=d.getActualFontSize(t,e),r=!s.isNullOrUndefined(t.WrapText)||d.cellHasShrinkToFit(t);return L(e,t,n,t.CachedFont.Italic,0,r,0,0)},t.getHorizontalPadding=L,t.getFontLineHeight=k,t.getTextVerticalPosition=function(e,t,n,r,o,l){var s,c=e.TextRuns,g=c?Y(t,e.TextRuns):e.CachedFont,f=c?g.Size:d.getActualFontSize(e,t),h=C.getCellTop(t,e),p=C.getCellBottom(t,e),F=function(e,t){return y.cellHasBottomDoubleBorder(t,e)||v.isCellShrunk(t)}(t,e)?a.InCellVerticalPaddingPx:0;if(v.isFontContainsVerticalAlignment(t,g))if(l)s=l;else{var S=u.getCachedFontMetrics(g.FontName,f,t),T=m.isBottomPaddingNeededForSubscriptUnderline(g,o);s=function(e,t,n){switch(t){case i.FontVerticalAlignment.Subscript:return e.baseline/2+B(n);case i.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(S,c?i.FontVerticalAlignment.None:g.VerticalAlign,T)}else s=l||u.getCachedFontMetrics(g.FontName,f,t).baseline;switch(o){case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return F+W(p,s);case i.VerticalAlignment.Top:return H(h,n,s);case i.VerticalAlignment.Center:return E(p,r,n,s);default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+o)}},t.getTextOffsetYAlphabeticBaseline=function(e,t,n,r,o,a){var l=k(e,r,o),s=u.getCachedFontMetrics(o,r,e).baseline;switch(a){case i.VerticalAlignment.Center:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return E(t,n,l,s);case i.VerticalAlignment.Bottom:return W(t,s);case i.VerticalAlignment.Top:return H(t-n,l,s)}},t.getTextAlphabeticBaseline=function(e,t){var n=t.CachedFont,r=t.TextRuns;r&&(n=Y(e,t.TextRuns));var i=r?n.Size:d.getActualFontSize(t,e);return u.getCachedFontMetrics(n.FontName,i,e).baseline},t.getLastRowYTopAlignmentBottomBaseline=function(e,t,n,r){return e+n-Math.round(t*l.LineLeading)+r},t.getLastRowYBottomAlignmentBottomBaseline=function(e,t,n){var r=Math.round(t*l.LineLeading*1.5)-a.InCellBottomAndCenterVerticalPaddingPx-n;return e-Math.max(r,1)},t.getMiddleBaseline=function(e,t,n,r){var i=u.getCachedFontMetrics(n.FontName,r,e);return t-(i.middle-i.baseline)},t.getYPositionForFontVerticalAlignmentRtf=N,t.getTextDecorationLineWidth=function(e){return c.approximateValue(e,g.CalibriTextDecorationLineWidth)},t.getTextHeight=function(e,t,n,r){if(d.verifyArgumentNotNull(t.CachedDrawingLayout,"CachedDrawingLayout","getOrMeasureCellPaddingPx"),d.verifyArgumentNotNull(t.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getOrMeasureCellPaddingPx"),void 0!==t.CachedDrawingLayout.CellTextLayout.Height)return t.CachedDrawingLayout.CellTextLayout.Height;var i=O(e,n,r);return t.CachedDrawingLayout.CellTextLayout.Height=i,i},t.getTextHorizontalPosition=function(e,t){var n=p.getEffectiveHorizontalAlignment(e,t),r=P(t,e);switch(n){case i.HorizontalAlignment.Right:return C.getCellRight(e,t,e.BlockWidth)-r;case i.HorizontalAlignment.Center:return I(e,t);case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return C.getCellLeft(e,t,e.BlockWidth)+r;case i.HorizontalAlignment.CenterAcrossSelection:return o.isRenderFlagEnabled(i.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)?M(e,t):I(e,t);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+n)}},t.getTextWidth=function(e,t,n){var r=z(e,t,n),a=r.width,l=r.textRunsDrawingInformation;return n.CachedDrawingLayout.CellTextLayout.Width=a,o.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,t)&&(n.CachedDrawingLayout.TextRunDrawingInformation=l),a},t.getTextWidthNoCaching=function(e,t,n){return z(e,t,n).width},t.cacheLegacyTextWidthOnCell=function(e,t,n){var r=R(e,n.CachedDisplayText,!1,o.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t));n.CachedDrawingLayout.CellTextLayout.Width=r},t.measureTextRunsWidth=j,t.measureTextRunsHeightForVerticalText=function(e,t,n,r,i,o,a){return i?{textRunsDrawingInformation:[],totalSize:o*n.length}:_(e,r,n,!0,a,t)},t.measureTextHeightForVerticalText=V,t.getBidiContext=U,t.getTextLineHeight=G,t.getFormattedTextLineHeight=function(e,t){var n=Y(e,t.TextRuns);return k(e,n.Size,n.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){var n=Y(e,t.TextRuns);return u.getCachedFontMetrics(n.FontName,n.Size,e)},t.getNumFmtSeparatorWidth=function(e,t,n){var r,i;d.verifyArgumentNotNull(null===(r=t.NumFmt)||void 0===r?void 0:r.Separator,"separator","getNumFmtSeparatorWidth");var o=null===(i=t.NumFmt)||void 0===i?void 0:i.Separator,a=d.getFontCssStringFromCell(t,n)+o,l=b[a];if(s.isNullOrUndefined(l)||0===l){var u=Q(e,o);return b[a]=u,u}return b[a]},t.getNumFmtHashesWidth=function(e,t,n){d.verifyArgumentNotNull(t,"cell","getNumFmtSeparatorWidth");var r=d.getFontCssStringFromCell(t,n),i=A[r];if(s.isNullOrUndefined(i)||0===i){var o=Q(e,"#");return A[r]=o,o}return A[r]},t.getDistanceFromCellStartToIconEnd=X,t.doesExpandCollapseButtonShiftText=function(e,t){if(!o.isRenderFlagEnabled(i.RenderFlags.PivotTable,e))return!1;var n=p.getEffectiveHorizontalAlignment(e,t);switch(n){case i.HorizontalAlignment.Left:case i.HorizontalAlignment.CenterAcrossSelection:case i.HorizontalAlignment.Center:return!e.IsRtl;case i.HorizontalAlignment.Right:return e.IsRtl;case i.HorizontalAlignment.Automatic:default:throw Error("doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getCellHorizontalIndentationPaddingPx=J},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(5),a=n(4),l=n(11);function s(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellWidth"),r.verifyArgumentNotNull(e,"model","getCellWidth"),r.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&r.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),F(e,t,n,!1)}function d(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellHeight"),r.verifyArgumentNotNull(e,"model","getCellHeight"),r.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&r.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","getCellHeight"),v(e,t,n,!1)}function u(e,t){return y(e,t,!1)}function c(e,t){return r.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),F(e,t,!1,!0)}function g(e,t){return r.verifyArgumentNotNull(e,"model","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellHeightAdjustedForDrawing"),v(e,t,!1,!0)}function f(e,t,n){return r.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),S(e,t,void 0,n,!0)}function h(e,t){var n=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=n.length-1,i=t.Col;if(!e.IsRtl)return f(e,t,!1)+c(e,t)-o.GridLineWidthPx;var a=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return n[r]+a-n[i]}function m(e,t){return y(e,t,!0)}function p(e,t){var n=t.ColumnOffsets[C(e)],i=function(e,t){return r.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}(e,t),o=t.ColumnOffsets[i];return t.ColumnWidths[i]+Math.abs(o-n)}function C(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function y(e,t,n){var r=T(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&(r-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),r}function v(e,t,n,r){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,r);var o=T(e,t.Row,r);return function(e,t,n){var r=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[r+1]:e.RowOffsets[r]+e.RowHeights[r]}(e,t,r)-o}return function(e,t,n){if(n)return i.getRowHeightFromOffsets(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing);return e.RowHeights[t.Row]}(e,t,r)}function F(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,o);var a=x(e,t.Col,o);return function(e,t,n){var r=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[r+1]:e.ColumnOffsets[r]+e.ColumnWidths[r]}(e,t,o)-a}return function(e,t,n){return n?i.getColWidthFromOffsets(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):r.getColumnWidth(t.Col,e)}(e,t,o)}function S(e,t,n,r,i){var a=x(e,t.Col,i);return t.Merge&&t.Merge.SpansBlocks&&(a-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,i)),!e.IsRtl||r?a:(i?h(e,t):n-a)-F(e,t,!1,i)+o.GridLineWidthPx}function T(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function x(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}t.getCellWidth=s,t.getCellHeight=d,t.getCellLeft=function(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellWidth"),r.verifyArgumentNotNull(e,"model","getCellWidth"),r.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&r.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),S(e,t,n,!1,!1)},t.getCellRight=function(e,t,n){var r=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(r-=t.Merge.OriginDeltaX),e.IsRtl?n-r:r+s(e,t,!1)-o.GridLineWidthPx},t.getCellBottom=function(e,t){return u(e,t)+d(e,t,!1)},t.getCellTop=u,t.getCellCenterY=function(e,t){return u(e,t)+d(e,t,!1)/2-o.GridLineWidthPx/2},t.getCellWidthAdjustedForDrawing=c,t.getCellHeightAdjustedForDrawing=g,t.getCellLeftAdjustedForDrawing=f,t.getCellRightAdjustedForDrawing=h,t.getCellBottomAdjustedForDrawing=function(e,t){return m(e,t)+g(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return m(e,t)+g(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t){return(h(e,t)+f(e,t,!1))/2},t.getCellTopAdjustedForDrawing=m,t.isCellSpansMultipleRowsOrBlocks=function(e){return!a.isNullOrUndefined(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=p,t.getSpillCellStartOffset=function(e,t,n,r){var i=l.getSpillCellVisualElementsPadding(t,e,n,r),o=t.ColumnOffsets[C(e)]+i;return t.IsRtl?t.BlockWidth-p(e,t)-o+1:o},t.getCellDimensionsAdjustedForDrawing=function(e,t,n){return{x:f(e,t,n)-o.GridLineWidthPx,y:m(e,t)-o.GridLineWidthPx,width:c(e,t)+o.GridLineWidthPx,height:g(e,t)+o.GridLineWidthPx}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3);function o(e,t){var n;return i.isRenderFlagEnabled(r.RenderFlags.VerticalTextSlice1,e)&&!0===(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)}function a(e,t){return o(e,t)&&i.isRenderFlagEnabled(r.RenderFlags.VerticalTextSlice2,e)}function l(e,t){var n;return a(e,t)&&i.isRenderFlagEnabled(r.RenderFlags.VerticalTextSlice3,e)&&!0===(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)}t.isVerticalTextPresent=o,t.isVerticalTextPresentSlice2=a,t.isVerticalTextPresentSlice3=l,t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=function(e,t){if(l(e,t))switch(t.CachedStyle.VerticalAlignment){case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=function(e,t){var n;if(l(e,t))switch(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(r=t.CFIconImage||(t.CFIconImage={})),t.IconImageLookup=[[r.ColoredArrowDown,r.ColoredArrowRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowRight,r.GrayArrowUp],[r.FlagLow,r.FlagMedium,r.FlagHigh],[r.CircleLow,r.CircleMedium,r.CircleHigh],[r.TrafficLow,r.TrafficMedium,r.TrafficHigh],[r.SignLow,r.SignMedium,r.CircleHigh],[r.CircleSymbolLow,r.CircleSymbolMedium,r.CircleSymbolHigh],[r.SymbolLow,r.SymbolMedium,r.SymbolHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.FourCircleLow,r.FourCircleMedium1,r.FourCircleMedium2,r.FourCircleHigh],[r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.FourCircleLow,r.CircleLow,r.CircleMedium,r.CircleHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.SignalBarEmpty,r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.CircleEmpty,r.Circle25,r.CircleHalf,r.Circle75,r.CircleFilled],[r.StarLow,r.StarMedium,r.StarHigh],[r.TriangleLow,r.TriangleMedium,r.TriangleHigh],[r.QuadrantEmpty,r.Quadrant25,r.QuadrantHalf,r.Quadrant75,r.QuadrantFull]],t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3;var i=Math.PI/5;t.StarRotationSin=Math.sin(i),t.StarRotation2Sin=Math.sin(2*i),t.StarRotationCos=Math.cos(i),t.StarRotation2Cos=Math.cos(2*i),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.4,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkPaddingFromCircle=2,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125,t.QuarterPiTan=Math.tan(Math.PI/4),t.CircleHighContrastSmallRadiusPortion=.4,t.CircleHighContrastMediumRadiusPortion=.55,t.CircleHighContrastLargeRadiusPortion=.7,t.StripedCircleUpperLineAngle=.05*Math.PI,t.StripedCircleMiddleLineAngle=.25*Math.PI,t.StripedCircleLowerLineAngle=.45*Math.PI},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.ShapeOutlineWidthPx=1,t.ShapeLinesAdjustment=r.getLinePixelTranslation(t.ShapeOutlineWidthPx)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(47),i=n(48),o=n(16),a=n(2),l=n(3),s=n(27),d=n(5),u=n(21),c=n(4),g=n(13);function f(e,t){return Math.floor(r.approximateValue(e,i.FontSizeToIconSize)*t)}function h(e,t){return Math.floor(r.approximateValue(e,i.IconHorizontalPadding)*t)}function m(e,t){var n;return!!u.isCFIconAlignedToTheLeft(e,t)||l.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&!c.isNullOrUndefined(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)&&!e.IsRtl}function p(e){var t,n;return e.CachedIsTextWidthExceedsCellWidth||(null===(t=e.Text)||void 0===t?void 0:t.startsWith("#"))&&!(null===(n=e.Value)||void 0===n?void 0:n.startsWith("#"))}t.getIconSize=f,t.getIconHorizontalPadding=h,t.pointsToPixels=function(e){return Math.round(e*o.PointToPixelRatio)},t.isBottomPaddingNeededForSubscriptUnderline=function(e,t){return t===a.VerticalAlignment.Bottom&&(e.Underline===a.FontUnderline.Single||e.Underline===a.FontUnderline.Double)},t.adjustNumberToRange=function(e,t,n){return e<t?t:e>n?n:e},t.isIconAlignedToTheLeft=m,t.getIconSizeAndPadding=function(e,t,n){var r,i,o;return(null===(r=t.CondFormat)||void 0===r?void 0:r.Icon)?f(n,1)+h(n,1)+d.GridLineWidthPx:l.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&(null===(i=t.LinkedEntity)||void 0===i?void 0:i.IconWidth)?null===(o=t.LinkedEntity)||void 0===o?void 0:o.IconWidth:0},t.getExpandCollapseButtonPadding=function(e,t){var n,r,i=(null===(n=t.CondFormat)||void 0===n?void 0:n.Icon)&&p(t);return l.isRenderFlagEnabled(a.RenderFlags.PivotTable,e)&&(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator)&&!i?s.ExpandCollapseButtonSizePx+s.PaddingBetweenExpandCollapseButtonAndTextPx:0},t.shouldExpandCollapseButtonShiftText=function(e,t){if(!l.isRenderFlagEnabled(a.RenderFlags.PivotTable,e))return!1;var n=g.getEffectiveHorizontalAlignment(e,t);switch(n){case a.HorizontalAlignment.Left:case a.HorizontalAlignment.Center:return!e.IsRtl;case a.HorizontalAlignment.Right:return e.IsRtl;case a.HorizontalAlignment.Automatic:default:throw Error("shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getSpillCellVisualElementsPadding=function(e,t,n,r){return(l.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&m(e,t)?n:0)+(l.isRenderFlagEnabled(a.RenderFlags.PivotTable,e)&&e.IsRtl?0:r)},t.cellTextReplacedWithHashes=p},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return l})),n.d(t,"__param",(function(){return s})),n.d(t,"__metadata",(function(){return d})),n.d(t,"__awaiter",(function(){return u})),n.d(t,"__generator",(function(){return c})),n.d(t,"__createBinding",(function(){return g})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return h})),n.d(t,"__read",(function(){return m})),n.d(t,"__spread",(function(){return p})),n.d(t,"__spreadArrays",(function(){return C})),n.d(t,"__await",(function(){return y})),n.d(t,"__asyncGenerator",(function(){return v})),n.d(t,"__asyncDelegator",(function(){return F})),n.d(t,"__asyncValues",(function(){return S})),n.d(t,"__makeTemplateObject",(function(){return T})),n.d(t,"__importStar",(function(){return x})),n.d(t,"__importDefault",(function(){return w})),n.d(t,"__classPrivateFieldGet",(function(){return b})),n.d(t,"__classPrivateFieldSet",(function(){return A}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function l(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,r){t(n,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function g(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}function f(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function C(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,i++)r[i]=o[a];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function v(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||l(e,t)}))})}function l(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(s,d):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function s(e){l("next",e)}function d(e){l("throw",e)}function u(e,t){e(t),o.shift(),o.length&&l(o[0][0],o[0][1])}}function F(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function A(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(1),a=n(3),l=n(8);function s(e,t){var n,s,d=null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment;if(a.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)&&(null===(s=t.PivotTable)||void 0===s?void 0:s.HasExpandCollapseIndicator)&&!i.isNullOrUndefined(t.Spill))return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;switch(d){case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.Fill:case r.HorizontalAlignment.Automatic:return!l.isVerticalTextPresent(e,t)&&a.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)?function(e,t){var n,l,s,d=null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment;if(a.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)&&(null===(l=t.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator)&&(d===r.HorizontalAlignment.Distributed||d===r.HorizontalAlignment.Fill))return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;switch(null===(s=t.CachedStyle)||void 0===s?void 0:s.ReadingOrder){case r.ReadingOrderType.LeftToRight:return r.HorizontalAlignment.Left;case r.ReadingOrderType.RightToLeft:return r.HorizontalAlignment.Right;case r.ReadingOrderType.Context:var u=t.Text;if(!i.isNullOrUndefined(u)&&""!==u)return o.isRtlChar(u[0])?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left}return r.HorizontalAlignment.Left}(e,t):r.HorizontalAlignment.Left}return d}t.isHorizontalAlignmentCenteredAcrossSelection=function(e,t){var n;return a.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)&&(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e,t){var n;if(a.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,e))switch(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1},t.getTextAlignment=function(e,t){if(l.isVerticalTextPresent(e,t))return"center";var n=s(e,t);switch(n){case r.HorizontalAlignment.Right:return"right";case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return"center";case r.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: "+n)}},t.getEffectiveHorizontalAlignment=s,t.adjustXForHorizontalAlignment=function(e,t,n,i){var o=0,a=s(e,t);switch(a){case r.HorizontalAlignment.Left:o=n;break;case r.HorizontalAlignment.Right:o=n-i;break;case r.HorizontalAlignment.Center:case r.HorizontalAlignment.CenterAcrossSelection:o=n-i/2;break;default:throw Error("unexpected context alignment "+a)}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagPoleColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i="",o=[],a=s()?window.performance:void 0,l=void 0;function s(){if(l)return l;l=!1,window.performance&&"function"==typeof window.performance.now&&(l=!0);try{window.performance.now()}catch(e){l=!1}return l}t.verifyPerformanceNowSupported=s,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:o}},t.clearPerformanceMetrics=function(){o=[]},t.trackDuration=function(e,t,n){var r=a?a.now():-1;if(t(),a){var i=a.now()-r;n?o[e]+=i:o[e]=i}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderBlockInternalDurationMs=3]="RenderBlockInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs"}(t.RenderPerformanceMetric||(t.RenderPerformanceMetric={})),t.getRenderingMessage=function(){var e=i;return i="",e},t.setDivMetricWarning=function(e){r.isNullOrUndefined(e)||""===e||(i=(i+"; "+e).substring(0,2500))},t.setActualFontSizeWarning=function(e){r.isNullOrUndefined(e)||""===e||(i=(i+"; "+e).substring(0,2500))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.PointToPixelRatio=4/3,t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.KnownFontNamesLowerCase=["angsananew","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho"],t.SubscriptVerticalPaddingForUnderlinePx=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(10);t.drawRectangle=function(e,t,n,o){r.verifyArgumentNotNull(e,"ctx","drawRectangle"),r.verifyArgumentNotNull(t,"model","drawRectangle"),r.verifyArgumentNotNull(n,"cell","drawRectangle"),r.verifyArgumentNotNull(o,"drawingContext","drawRectangle");var a=o.innerColor,l=o.outerColor,s=o.left,d=o.bottom,u=o.height,c=o.width;(function(e,t,n,r,i,o){e.strokeStyle=o,e.beginPath(),e.rect(t,n,r,i),e.stroke()})(e,s+i.ShapeLinesAdjustment,d-u-i.ShapeLinesAdjustment,c,u,l),a&&function(e,t,n,r,i,o){e.fillStyle=o,e.beginPath(),e.fillRect(t,n,r,i),e.fill()}(e,s+i.ShapeOutlineWidthPx,d-u,c-i.ShapeOutlineWidthPx,u-i.ShapeOutlineWidthPx,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(4);t.getReferencedObjectById=function(e,t){var n;switch(e){case r.UniqueStyleID.Default:case r.UniqueStyleID.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if(i.isNullOrUndefined(n))throw Error("RefObject is null or undefined");if(n.ID!==e)throw Error("RefIDs are not sorted as expected");return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(6),a=n(20),l=n(3),s=n(22),d=n(1),u=n(7),c=n(15),g=n(5),f=n(13),h=n(24),m=n(4),p=n(37),C=n(34),y=n(38),v=n(8),F=n(11),S=n(29),T=n(16);function x(e,t){return e>=t.StartIndex&&e<t.EndIndex}function w(e,t,n){for(var r,i=[],o=0;o<t.length;o++){var a=t[o];if(x(e,a))return o;a&&i.push({index:o,startIndex:a.StartIndex,endIndex:a.EndIndex})}var l=n.text,s=n.formattedTextLength,d=n.isCarriageReturnExists,u=S.breakToGraphemes(l);throw Error("Failed to find text run index for textOffsetIndex: "+e+", runs.length: "+t.length+", runsIndices: "+JSON.stringify(i)+", formattedTextLength: "+s+", isCarriageReturnExists:"+d+", isGraphemeExists: "+((null===(r=l)||void 0===r?void 0:r.length)!==u.length)+" ")}function b(e,t,n){var r=e.CachedFont;e.ShrunkSize=r.Size*t,e.FontCss=i.getFontCssStringFromFont(r,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function A(e,t,n){var r,a=t.CachedFont;t.ShrunkSize=n;var l=o.getFontLineHeight(e,t.ShrunkSize,null===(r=a)||void 0===r?void 0:r.FontName),s=o.measureTextHeightForVerticalText(l,t.Text);t.FontCss=i.getFontCssStringFromFont(a,t.ShrunkSize,e),t.MaxGlyphHeightPx=l,t.HeightPx=s}function R(e,t){for(var n=0,i=t,o=!1,a=!1,l=t;l<e.length;l++){var s=e[l];if(s.Underline===r.FontUnderline.None)break;s.Underline===r.FontUnderline.Single?o=!0:s.Underline===r.FontUnderline.Double&&(a=!0);var d=s.CachedFont;n=Math.max(n,s.ShrunkSize||d.Size),i=l}return{maxFontSize:n,sequenceEndRunIndex:i,hasMixedUnderlineTypes:o&&a}}function I(e,t,n,r,i){return r?n:i?t:e}function M(e,t,n,i,a,l){var s,d=l,u=0;return(s=t===r.FontVerticalAlignment.Subscript||t===r.FontVerticalAlignment.Superscript)&&(u=o.calculateSubSuperOffsetY(e,t,n,i,a,s),d=!0),{subSuperOffsetY:u,hasVerticalAlignedFont:d,isFontVerticalAlignment:s}}function D(e,t,n,i,o,a,l,d,u,c,g,f,h,m){var C,y=a,v=o;if(h)!function(e,t,n,i,o,a,l,d,u,c,g){var f,h;if(!n.JustifyDistributedLine)return;var m=t+(u?0:n.JustifyDistributedLine.Start.Offset),p=m,C=!0===n.Strikethrough;P(e,o,a,n.JustifyDistributedLine.Start,t,i,u,n.MaxGlyphHeightPx,l,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),(null===(f=n.JustifyDistributedLine)||void 0===f?void 0:f.Middle)&&(P(e,o,a,n.JustifyDistributedLine.Middle,t,i,u,n.MaxGlyphHeightPx,l,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width));(null===(h=n.JustifyDistributedLine)||void 0===h?void 0:h.End)&&(P(e,o,a,n.JustifyDistributedLine.End,t,i,u,n.MaxGlyphHeightPx,l,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width));if(!u&&(n.Underline!==r.FontUnderline.None||n.Strikethrough)){var y={dpr:l,clipRect:c,textPositionX:p,textPositionY:i,textWidth:m-p,partOfMixedUnderlineSequence:n.HasMixedUnderline};s.cacheTextDecorationLayout(o,a,y,d,n.UnderlineWidth)}}(e,o,l,a,t,n,i,l.CachedFont,f,c,m);else{if(L(e,t,n,l.Text,o,a,f,l.MaxGlyphHeightPx,i,!0===l.Strikethrough,l.CachedFont,c),!f&&(l.Underline!==r.FontUnderline.None||l.Strikethrough)){var F={dpr:i,clipRect:c,textPositionX:o,textPositionY:a,textWidth:l.WidthPx,containSubscript:g===r.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:l.HasMixedUnderline};s.cacheTextDecorationLayout(t,n,F,l.CachedFont,l.UnderlineWidth)}f?y=function(e,t,n,i,o){var a=o+1<i.length?p.getTextRun(!0,i,o+1).HeightPx:0;switch(e){case r.VerticalAlignment.Top:return t-a;case r.VerticalAlignment.Center:return t-(n.HeightPx+a)/2;case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return t-n.HeightPx}}(null===(C=n.CachedStyle)||void 0===C?void 0:C.VerticalAlignment,a,l,d,u):v+=l.WidthPx}return{offsetX:v,offsetY:y}}function P(e,t,n,r,i,o,a,l,s,d,u,c,g){var f=i,h=o;a?h-=r.Offset:f+=r.Offset,L(e,t,n,r.Text,f,h,a,l,s,d,u,c,g)}function L(e,t,n,r,i,o,a,l,s,d,u,c,g){a?y.fillVerticalTextForRTF(e,t,n,r,i,o,l,s,d,u,c,g):e.fillText(r,i,o)}function O(e,t){for(var n=0,r=t[0],i=0;i<e.length;i++){var o=e[i].CachedFont;n=Math.max(n,o.Size),r.Size<n&&(r=o)}return r}t.fillRichTextFormat=function(e,t,n,g,y,S,x,w,P,L){var k;if(i.verifyArgumentNotNull(g,"cell","fillRichTextFormat"),i.verifyArgumentNotNull(n,"model","fillRichTextFormat"),i.verifyArgumentNotNull(y,"formattedText","fillRichTextFormat"),i.verifyArgumentNotNull(y.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0!==y.Text.length){var N=y.TextRuns;i.verifyArgumentNotNull(N[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");var B=function(e,t,n){if(!n)return!1;if(v.isVerticalAlignmentJustifiedOrDistributedForVerticalText(e,t))return!(n.breakType===h.BreakType.Justify&&n.isProcessingLastLine);return f.isHorizontalAlignmentJustifiedAndDistributed(e,t)}(n,g,L),E=function(e,t,n,i,s,g,f,h){var C=o.getBidiContext(n),y=v.isVerticalTextPresentSlice3(t,n),S=function(e,t,n,r,i){var a,l,s=t.Fonts;if(n.WrapText){var d=o.measureTextRunsWidth(e,r,i,t,o.getBidiContext(n));l=d.totalSize,a=d.textRunsDrawingInformation}else l=o.getTextWidth(e,t,n),a=n.CachedDrawingLayout.TextRunDrawingInformation;if(!a||!r)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";var u=O(a,s);return{totalTextRunWidth:l,largestFont:u,preparedRuns:a}}(e,t,n,i,s),x=0,w=S.totalTextRunWidth,I=S.largestFont,M=S.preparedRuns;!y&&C.HasRtl&&c.trackDuration(c.RenderPerformanceMetric.ReorderBidiTextRuns,(function(){a.reorderTextRunsForBidiDrawing(M,s,C,w)}),!0);y&&(x=function(e,t){for(var n,r,i=0,a=0;a<t.length;a++){var l=t[a],s=l.CachedFont,d=o.getFontLineHeight(e,null===(n=s)||void 0===n?void 0:n.Size,null===(r=s)||void 0===r?void 0:r.FontName),u=o.measureTextHeightForVerticalText(d,l.Text);l.MaxGlyphHeightPx=d,l.HeightPx=u,i+=u}return i}(t,M));n.CachedStyle.ShrinkToFit&&(y?x=function(e,t,n,r){var i=u.getCellHeight(e,t,!1);if(r<i)return r;return function(e,t,n,r){for(var i=0,o=0;o<t.length;o++){var a=(d=t[o]).CachedFont,l=Math.floor(a.Size*r);A(e,d,l),i+=d.HeightPx}for(;i<n;){i=0;for(o=0;o<t.length;o++){if((d=t[o]).ShrunkSize<T.MaxAllowedFontSize){var s=d.ShrunkSize+1;A(e,d,s)}i+=d.HeightPx}}for(;i>n;){i=0;for(o=0;o<t.length;o++){var d;if((d=t[o]).ShrunkSize>T.MinAllowedFontSize){s=d.ShrunkSize-1;A(e,d,s)}i+=d.HeightPx}}return i}(e,n,i,i/r)}(t,n,M,x):w=function(e,t,n,i){var a=u.getCellWidth(e,t,!1),s=t.CachedStyle.Indentation||0,c=n[0].CachedFont,g=o.getHorizontalPadding(e,t,c.Size,t.CachedFont.Italic,s,!0,0,0),f=d.getTextDrawingMaxWidth(a,g,o.getDistanceFromCellStartToIconEnd(e,t),l.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)?F.getExpandCollapseButtonPadding(e,t):0);if(i<f)return i;for(var h=f/(i+g),m=0,p=0;p<n.length;p++){var C=n[p];b(C,h,e),m+=C.WidthPx}return m}(t,n,M,w));(function(e){var t=0;for(;t<e.length;){if(e[t].Underline===r.FontUnderline.None)t++;else for(var n=R(e,t),i=n.maxFontSize,a=n.sequenceEndRunIndex,l=n.hasMixedUnderlineTypes,s=o.getTextDecorationLineWidth(i);t<=a;t++)e[t].UnderlineWidth=s,e[t].HasMixedUnderline=l}})(M),!g||m.isNullOrUndefined(f)||m.isNullOrUndefined(h)||p.prepareTextRunsForJustifyAndDistributed(e,t,h,f,M,y);return{totalTextRunHeight:x,totalTextRunWidth:w,largestFont:I,preparedRuns:M}}(e,n,g,N,y.Text,B,P,L),H=E.totalTextRunHeight,W=E.totalTextRunWidth,z=E.largestFont,j=E.preparedRuns,_=i.getCellStyle(g,n);i.verifyArgumentNotNull(_,"cellStyle","fillRichTextFormat"),function(e,t,n,a,c,g,h,y,F,S,T,x,w){var b,A,R,P=e.textAlign,L=e.textBaseline,k=e.font,N=e.fillStyle,B=l.isRenderFlagEnabled(r.RenderFlags.FontVerticalAlignment,n),E=t.devicePixelRatio,H=v.isVerticalTextPresentSlice3(n,a),W=y;H&&(W=function(e,t,n,i,o,a){var l;if(!a&&(null===(l=t.CachedStyle)||void 0===l?void 0:l.VerticalAlignment)===r.VerticalAlignment.Justify){var s=O(n,e.Fonts),d=C.getCachedFontMetrics(s.FontName,s.Size,e).baseline;return u.getCellTop(e,t)+i-d}return o}(n,a,F,S,W,T));W=function(e,t,n,a,l,s,d){if(t)return function(e,t,n,i){var o,a=null===(o=e.CachedStyle)||void 0===o?void 0:o.VerticalAlignment,l=i.length-1,s=i[l].HeightPx||0;switch(a){case r.VerticalAlignment.Top:return t+n-s;case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:case r.VerticalAlignment.Bottom:return t;case r.VerticalAlignment.Center:return t+(n-s)/2}}(n,a,l,s);return function(e,t,n,a){var l=n.CachedStyle.VerticalAlignment,s=o.getFontLineHeight(e,t.Size,t.FontName),d=C.getCachedFontMetrics(t.FontName,t.Size,e).baseline;i.verifyArgumentNotNull(d,"textBaselineAdjustY","adjustYForVerticalAlignment");var u=a-d;if(l===r.VerticalAlignment.Center)return u+(s-d)/2;return u}(e,d,n,a)}(n,H,a,W,S,F,g);var z=H?h:function(e,t,n,r,i,o){var a=r&&!m.isNullOrUndefined(o)?o:i;return f.adjustXForHorizontalAlignment(e,t,n,a)}(n,a,h,T,c,w),j=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=d.getHighContrastTextColor(a,t.highContrastScheme));for(var _=0;_<F.length;_++){var V=p.getTextRun(H,F,_);i.verifyArgumentNotNull(V.CachedFont,"run.CachedFont","drawTextRuns");var U=V.CachedFont,G=U.VerticalAlign,Y=0,X=!1;!B||H||a.WrapText||(b=M(a,G,U,y,C.getCachedFontMetrics(U.FontName,U.Size,n),j),Y=b.subSuperOffsetY,X=b.isFontVerticalAlignment,j=b.hasVerticalAlignedFont),e.font=V.FontCss,t.highContrastScheme||(e.fillStyle=V.CachedFont.Color),A=D(e,n,a,E,z,I(y,Y,W,H,X),V,F,_,x,G,H,T,w),z=A.offsetX,W=A.offsetY}j&&!m.isNullOrUndefined(null===(R=a.CachedDrawingLayout)||void 0===R?void 0:R.UnderlineRuns)&&s.alignVerticalUnderlineRuns(n,a,a.CachedDrawingLayout.UnderlineRuns);e.textAlign=P,e.textBaseline=L,e.font=k,e.fillStyle=N}(e,t,n,g,W,z,S,x,j,H,B,w,null===(k=L)||void 0===k?void 0:k.maxWidth)}},t.substringFormattedText=function(e,t,n){if(i.verifyArgumentNotNull(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return g.EmptyFormattedText;var r=e.Text.substring(t,n);if(0===r.length)return{Text:r,Fonts:e.Fonts,TextRuns:[]};var o=e.TextRuns;if(i.verifyArgumentNotNull(o,"formattedText.runs","substringFormattedText"),0===o.length)throw Error("Invalid param: formattedText runs.length === 0");i.prepareTextRunRanges(o,e.Text);var a=e.Text.length,l={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:a,text:e.Text},s=w(t,o,l),d=n&&n<e.Text.length?w(n-1,o,l):o.length-1,u=[],c=o[s];u.push({StartIndex:0,FontID:c.FontID,CachedFont:c.CachedFont});for(var f=s+1;f<=d;f++){var h=o[f],m=h.StartIndex-t;u.push({StartIndex:m,FontID:h.FontID,CachedFont:h.CachedFont})}return{Text:r,Fonts:e.Fonts,TextRuns:u}},t.measureFormattedTextWidth=function(e,t,n){return o.measureTextRunsWidth(e,t.TextRuns,t.Text,n).totalSize}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(1);function a(e,t){var n=[d(e,0)];if(1===t.length)return n;for(var r=void 0,i=0;i<t.length;i++){if(c(t[i])){l(i,r)&&n.push(u(e,i));var o=i+1;s(o,t.length)&&n.push(d(e,o)),r=i}}return n}function l(e,t){return e>0&&!(e-1===t)}function s(e,t){return e<t}function d(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function u(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}function c(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}t.analyzeBidiText=function(e,t){for(var n=!1,i=!1,a=0;a<e.length;a++){var l=e[a];if(o.isRtlChar(l)?n=!0:i=!0,i&&n)break}return{HasLtr:i,HasRtl:n,HasBidi:i&&n,BaseDir:function(e,t){if(!e)return"ltr";switch(t){case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.Context:return o.isRtlChar(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=a(e[r],i.getTextRunText(r,e,t));n.push.apply(n,o)}return n},t.reorderTextRunsForBidiDrawing=function(e,t,n,r){if(!n.HasRtl||n.HasLtr){for(var a=o.getReOrderDiv(n,r),l=0;l<e.length;l++){var s=i.getTextRunText(l,e,t),d=document.createElement("span");d.innerText=s,d.setAttribute("rid",l.toString()),a.appendChild(d)}document.body.appendChild(a);for(var u=0;u<a.children.length;u++){var c=a.children[u],g=c.getAttribute("rid");if(!g)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var f=c.getBoundingClientRect().left;e[l=parseInt(g,10)].OffsetX=f}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(a)}else e.reverse()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(13);function o(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}t.fillAndStroke=o,t.drawIconFromPoints=function(e,t,n,r){e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var i=1;i<r.length;i++)e.lineTo(r[i].x,r[i].y);o(e,t,n)},t.isCFIconAlignedToTheLeft=function(e,t){var n,o=null===(n=t.CondFormat)||void 0===n?void 0:n.Icon;if(o){if(o.IconOnly){var a=i.getEffectiveHorizontalAlignment(e,t);return a===r.HorizontalAlignment.Left||a===r.HorizontalAlignment.Automatic}return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(5),o=n(0),a=n(1),l=n(6),s=n(7),d=n(13),u=n(4),c=n(8);function g(e,t,n,i,a){if(o.verifyArgumentNotNull(t,"cell","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),i.Underline!==r.FontUnderline.None&&!c.isVerticalTextPresentSlice2(e,t)){var l={underline:i.Underline},s=h(e,t,n,l,i,!1,a),d=t.CachedDrawingLayout.UnderlineRuns;if(s&&d.push(s),m(l)){var u=h(e,t,n,{underline:l.underline===r.FontUnderline.DoubleAccounting?r.FontUnderline.SingleAccounting:r.FontUnderline.Single},i,!0,a);u&&d.push(u)}}if(i.StrikeThrough){var g=h(e,t,n,{strikethrough:!0},i,!1,void 0);if(g)t.CachedDrawingLayout.StrikethroughRuns.push(g)}}function f(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function h(e,t,n,a,g,f,h){var p=n.dpr,v=n.clipRect,F=f||n.partOfMixedUnderlineSequence&&a.underline===r.FontUnderline.Single,S=o.getActualFontSizeFromFont(e,t,g,!1),T=function(e,t,n,i,a,g,f){var h,m,p,C,y=n.dpr,v=n.textPositionX,F=n.textWidth;if(i.underline===r.FontUnderline.SingleAccounting||i.underline===r.FontUnderline.DoubleAccounting){var S=l.getCellTextHorizontalPadding(t,e);m=s.getCellLeft(e,t,e.BlockWidth)+S,p=s.getCellRight(e,t,e.BlockWidth)-S}else{var T=!u.isNullOrUndefined(t.TextRuns)||d.isHorizontalAlignmentJustifiedAndDistributed(e,t);h=function(e,t,n,i,o){var a,l,s=o?r.HorizontalAlignment.Left:d.getEffectiveHorizontalAlignment(e,t);c.isVerticalTextPresentSlice2(e,t)&&(s=r.HorizontalAlignment.Center);switch(s){case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:a=n,l=n+i;break;case r.HorizontalAlignment.Right:a=n-i,l=n;break;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:a=n-i/2,l=n+i/2;break;default:a=n,l=n+i}return{startX:a,endX:l}}(e,t,v,F,T),m=h.startX,p=h.endX}C=i.strikethrough?function(e,t,n,r,i){var a=n.textPositionY;o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");var s=l.getTextDecorationLineWidth(i.Size);return l.getMiddleBaseline(e,a,i,r)-s/2}(e,t,n,a,g):function(e,t,n,r){var i=t.textPositionY;o.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var a=null!=r?r:l.getTextDecorationLineWidth(n);return i+2*a}(t,n,a,f);return m=Math.round(m*y),p=Math.round(p*y),C=Math.round(C*y),{startX:m,endX:p,Y:C}}(e,t,n,a,S,g,h),x=T.startX,w=T.endX,b=T.Y,A=function(e,t,n){var r=(null!=n?n:l.getTextDecorationLineWidth(t))*e;return Math.max(Math.floor(r),1)}(p,S,h),R=Math.round(i.UnderlineMarginFromTextBaseline*A);(m(a)&&(b+=R),F)&&(b=b-2*A+R);if(!function(e,t,n,r,i,o,a){return function(e,t,n,r){var i=s.getCellTopAdjustedForDrawing(e,t),o=r+n;return r<=i&&o<=i}(e,t,r,i)||C(e,t,r,i)||function(e,t,n){var r=e.dpr,i=e.clipRect,o=i?(i.x+i.width)*r:0,a=!1;i&&(a=t>=o&&n>=o);return a}(n,o,a)||function(e,t,n){var r=e.dpr,i=e.clipRect,o=i?i.x*r:0,a=!1;i&&(a=t<=o&&n<=o);return a}(n,o,a)}(e,t,n,A,b,x,w)||n.containSubscript&&C(e,t,A,b)){if(v){var I=y(x,w,M=Math.round(v.x*p),Math.round(v.width*p)+M);x=I.start,w=I.end}if(function(e,t,n,r){var o=r+n,a=s.getCellTopAdjustedForDrawing(e,t)+i.GridLineWidthPx,l=s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx;return r<=a||o>=l}(e,t,A,b)&&(!n.containSubscript||!C(e,t,A,b))){var M,D=y(b,b+A,M=s.getCellTopAdjustedForDrawing(e,t),s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx);b=D.start,A=D.end-b}return{StartX:x,EndX:w,Y:b,LineWidth:A,Color:g.Color}}}function m(e){return e.underline===r.FontUnderline.Double||e.underline===r.FontUnderline.DoubleAccounting}function p(e,t){return e[t].StartX===e[t+1].StartX}function C(e,t,n,r){var i=s.getCellBottomAdjustedForDrawing(e,t);return r>=i&&r+n>=i}function y(e,t,n,r){var i=Math.min(e,t),o=Math.max(e,t),a=Math.min(n,r),l=Math.max(n,r);return{start:Math.max(i,a),end:Math.min(o,l)}}function v(e,t){if(0!==t.LineWidth){var n=t.Y+o.getLinePixelTranslation(t.LineWidth);!function(e,t,n,r){e.moveTo(t,r),e.lineTo(n,r)}(e,t.StartX,t.EndX,n)}}t.measureAndCacheTextDecorationLayout=function(e,t,n,r){var i=n.CachedFont.Underline,o=n.CachedFont.StrikeThrough;(i||o)&&""!==n.CachedDisplayText&&(r.textWidth=l.getTextWidth(e,t,n),g(t,n,r,n.CachedFont))},t.cacheTextDecorationLayout=g,t.drawTextDecoration=function(e,t,n){var r,i,l,s,d;o.verifyArgumentNotNull(t.Cells,"model.cells","drawTextDecoration"),e.beginPath();for(var u=0;u<t.Cells.length;u++){var c=t.Cells[u];if(a.cellIntersectsRenderingRegion(c,n.renderingRegion)&&(o.verifyArgumentNotNull(c.CachedFont,"cell.CachedFont","drawTextDecoration"),(c.CachedFont.StrikeThrough||c.CachedFont.Underline||c.TextRuns)&&!(c.CondFormat&&(null===(r=c.CondFormat)||void 0===r?void 0:r.Icon)&&(null===(l=null===(i=c.CondFormat)||void 0===i?void 0:i.Icon)||void 0===l?void 0:l.IconOnly)))){o.verifyArgumentNotNull(c.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");for(var g=c.CachedDrawingLayout.UnderlineRuns,f=c.CachedDrawingLayout.StrikethroughRuns,h=n.highContrastScheme?a.getHighContrastTextColor(c,n.highContrastScheme):void 0,m=0,p=[g,f];m<p.length;m++){var C=p[m];if(C&&C.length>0){if(!s||!d){var y=C[0];s=S=null!=h?h:y.Color,d=y.LineWidth,e.strokeStyle=S,e.lineWidth=y.LineWidth}for(var F=0;F<C.length;F++){var S,T=C[F],x=s!==(S=null!=h?h:T.Color),w=d!==T.LineWidth;(x||w)&&(s=S,d=T.LineWidth,e.stroke(),e.strokeStyle=S,e.lineWidth=T.LineWidth,e.beginPath()),v(e,T)}}}}}e.stroke()},t.alignVerticalUnderlineRuns=function(e,t,n){if(!(u.isNullOrUndefined(n)||n.length<=0))for(var r=function(e,t,n){for(var r=-1,i=-1,o=0,a=!1,l=0;l<n.length;l++)if(!(l>0&&p(n,l-1)))if(l<n.length-1&&p(n,l)){var d=f([n[l],n[l+1]]),u=d.top,c=d.bottom;u.Y>r&&(r=u.Y),c.Y>i&&(i=c.Y,o=Math.max(c.LineWidth,1),a=!0)}else n[l].Y>r&&(r=n[l].Y,a||(o=Math.max(n[l].LineWidth,1)));C(e,t,o,i)&&(i=s.getCellBottomAdjustedForDrawing(e,t)-o,r=i-2*o);r-i<2*o&&(r=i-2*o);return{closestToBottomUnderline:r,closestToBottomDoubleUnderline:i,closestToBottomUnderlineWidth:o}}(e,t,n),i=0;i<n.length;i++)if(!(i>0&&n[i].StartX===n[i-1].StartX)){if(i<n.length-1&&n[i].StartX===n[i+1].StartX){var o=f([n[i],n[i+1]]),a=o.top,l=o.bottom;a.Y=r.closestToBottomUnderline,l.Y=r.closestToBottomDoubleUnderline,n[i+1].LineWidth=r.closestToBottomUnderlineWidth}else n[i].Y=r.closestToBottomUnderline;n[i].LineWidth=r.closestToBottomUnderlineWidth}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);function i(e){return"Sanitized_"+e}function o(e){return r.KnownFontNamesLowerCase.indexOf(e.replace(/\s/g,"").toLowerCase())>-1}t.getFontNameForLogging=function(e){var t="Custom Font";return o(e)&&(t=i(e)),t},t.sanitizeFontName=i,t.isKnownFont=o,t.canonizeFontName=function(e){var t=e,n=e.indexOf("(Body)");return n>0&&(t=e.substring(0,n).trim()),t.replace(/[\""]/g,"").toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(t.BreakType||(t.BreakType={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.LineDirection||(t.LineDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(1),o=n(0),a=n(4);function l(e,t,n){var o=Math.round(e*t)-r.GridLineWidthPx/2;if(n&&i.isSafari()){var a=window?window.devicePixelRatio:-1;2===a&&t===a/2&&(o-=1)}return o}function s(e,t,n,r){var i=e+t-n;return i=Math.min(i,r)}t.drawGridLines=function(e,t,n){if(!(t.RowOffsets&&t.ColumnOffsets&&t.RowHeights&&t.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: "+!t.RowOffsets+", ColumnOffsets: "+!t.ColumnOffsets+", RowHeights: "+!t.RowHeights+", ColumnWidths: "+!t.ColumnWidths;if(t.RowOffsets.length!==t.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(t.ColumnOffsets.length!==t.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";if(t.ShowGridLines&&!(n.devicePixelRatio<r.MinimalDprForGridlinesRendering)&&i.shouldRenderGridLines(o.isHighContrastMode(n),o.hasWorkbookBackgroundColor(t.BackgroundColor))){e.lineWidth=r.GridLineWidthPx,e.setLineDash(function(e){if(!a.isNullOrUndefined(e.GridLineColor))return r.ColoredGridLineDash;return r.DefaultDash}(t)),e.strokeStyle=function(e,t){if(!a.isNullOrUndefined(t.highContrastScheme))return""+i.rgbToColorHex(t.highContrastScheme.TextColor);if(!a.isNullOrUndefined(e.GridLineColor))return e.GridLineColor;return r.DefaultGridlineColor}(t,n);var d=o.getLinePixelTranslation(r.GridLineWidthPx),u=l(t.BlockWidth,n.devicePixelRatio,!1),c=l(t.BlockHeight,n.devicePixelRatio,!0);e.beginPath(),function(e,t,n,r,o,a){for(var l=a.startRow,d=a.endRow,u=l;u<=d;u++){var c=s(t[u],i.getRowHeightFromOffsets(u,t),r,o);i.drawLine(e,0,c,n,c)}}(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.devicePixelRatio,d,c,n.renderingRegion),function(e,t,n,r,o,a){for(var l=a.startColumn,d=a.endColumn,u=l;u<=d;u++){var c=s(t[u],i.getColWidthFromOffsets(u,t),r,o);i.drawLine(e,c,0,c,n)}}(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.devicePixelRatio,d,u,n.renderingRegion),e.stroke()}},t.getMaxLineOffset=l,t.getAdjustedDrawingOffset=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(r=t.FontLoadStatus||(t.FontLoadStatus={}));var o={};function a(){return void 0!==document.fonts}function l(e){return!!document.fonts.check(e)||window.parent.document.fonts.check(e)}function s(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function d(e,t){if("function"!=typeof document.fonts.values)return!1;for(var n=document.fonts.values(),i=n.next();!i.done;){if(i.value&&i.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case r.Loaded:if("loaded"===i.value.status)return!0;break;case r.Failed:if("error"===i.value.status)return!0}i=n.next()}return!1}function u(e,t){o[e]=t}function c(e){return null!==o[e]&&void 0!==o[e]}t.fontFaceSetSupported=a,t.getFontFaceSetReady=function(){return document.fonts.ready},t.documentFontsCheck=l,t.isFontValid=s,t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t},t.isValidCellFontLoaded=function(e,t){var n;return!!s(null===(n=t.CachedFont)||void 0===n?void 0:n.FontName)&&l(i.getFontCssStringFromCell(t,e))},t.isFontLoaded=function(e){return d(e,r.Loaded)},t.isFontLoadFailed=function(e){return d(e,r.Failed)},t.getFontLoadStatus=function(e){return o[e]},t.setFontLoadStatus=u,t.doesFontExist=c,t.updateFontLoadStatus=function(e){a()&&!c(e)&&s(e)&&function(e){return l("11pt "+e)}(e)&&u(e,r.Loaded)},t.isFontUsedInModel=function(e,t){return!(!e.Fonts||0===e.Fonts[t].RefCount)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164,t.ExpandCollapseButtonSizePx=9,t.ExpandCollapseButtonInnerColor="#FAFAFA",t.ExpandCollapseButtonOuterColor="#3A3A38",t.MinusPlusPaddingPx=1,t.MinusPlusWidthPx=1,t.PaddingBetweenExpandCollapseButtonAndTextPx=3,t.PlusMinusLineAdjustment=.5,t.WideIndentFactor=1.5,t.ExpandCollapseButtonVerticalPaddingPx=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),a=n(0),l=n(11);function s(e,t){return t?o.isNullOrUndefined(e.ColumnHeaderRange)?e.RowHeaderRange.FirstRow:e.ColumnHeaderRange.FirstRow:e.FirstRow}t.getPivotTableTopAdjustedForDrawing=function(e,t,n){i.verifyArgumentNotNull(e,"model","getPivotTableTopAdjustedForDrawing"),i.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var r=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(i.verifyArgumentNotNull(r,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),i.verifyArgumentNotNull(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing){var o=s(t,n);return r[a.getModelRowIndex(e,o)]}return r[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,n){i.verifyArgumentNotNull(e,"model","getPivotTableLeftAdjustedForDrawing"),i.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return i.verifyArgumentNotNull(r,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),i.verifyArgumentNotNull(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?r[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:r[r.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-r[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t,n,r){return i.verifyArgumentNotNull(e,"model","isPivotIntersectsRenderingRegion"),i.verifyArgumentNotNull(t,"pivotTable","isPivotIntersectsRenderingRegion"),i.verifyArgumentNotNull(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow)&&(!((t.IsEmptyPivot?t.FirstRowIndex:a.getModelRowIndex(e,s(t,r)))>n.endRow)&&(!(t.FirstColIndex<n.startColumn)&&!(t.LastColIndex>n.endColumn)))},t.canCellContainExpandCollapseAndCFIcon=function(e,t,n,o){var a,s;if(!i.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)||!(null===(s=null===(a=t.CondFormat)||void 0===a?void 0:a.Icon)||void 0===s?void 0:s.IconOnly))return!0;var d=t.CachedFont.Size,u=l.getIconHorizontalPadding(d,o),c=l.getIconSize(d,o),g=l.getExpandCollapseButtonPadding(e,t)*o;switch(t.CondFormat.Icon.CFIconHorizontalAlignment){case r.HorizontalAlignment.Left:case r.HorizontalAlignment.Right:return n-c-u-g>0;case r.HorizontalAlignment.Center:return n/2-c/2-g>0;default:return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(70);function o(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}t.breakToGraphemes=function(e){if(!e)return[];for(var t=[],n=0,a=e.charCodeAt(n),l=i.classifyChar(e.codePointAt(n)),s=r.CombiningClass.Other,d=1;d<e.length;d++){var u=e.charCodeAt(d);d>=1&&o(a,u)||(s=i.classifyChar(e.codePointAt(d)),r.shouldBreak(l,s)&&(t.push(e.substring(n,d)),n=d),l=s,a=u)}return n<=e.length-1&&t.push(e.substring(n)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),i=n(77),o=n(3),a=r.UserContentList.Cell.concat(r.UserContentList.GridBlockModel).concat(r.UserContentList.CellStyle).concat(r.UserContentList.Font).concat(r.UserContentList.BorderStyle).concat(r.UserContentList.AutoFilter).concat(r.UserContentList.PivotFilter).concat(r.UserContentList.MenuItem).concat(r.UserContentList.FormulaInformation).concat(r.UserContentList.NumberFormatInformation);function l(e){return e.toLowerCase().replace(i.DigitReplaceValue,i.CharacterReplaceValue).replace(i.Digit,i.DigitReplaceValue).replace(i.ValueAnnonymizerRegex,i.CharacterReplaceValue)}function s(e){return function(t,n){return n&&e&&e.indexOf(t)>-1?l(n):n}}t.serializeCell=function(e,t){return e&&t?(e.CachedStyle=o.getReferencedObjectToCache(e.StyleID,t.Styles),e.CachedBorderStyle=o.getReferencedObjectToCache(e.BorderStyleID,t.BorderStyles),e.CachedFont=o.getReferencedObjectToCache(e.CachedStyle.FontID,t.Fonts),a?JSON.stringify(e,s(a)):JSON.stringify(e)):""},t.serializeModel=function(e){return e?a?JSON.stringify(e,s(a)):JSON.stringify(e):""},t.annonymize=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(14),a=n(1),l=n(85),s=n(10);function d(e,t,n,r){var d=t.image,g=t.highContrastScheme,f=function(e){var t=e.left,n=e.bottom,r=e.size/2,i=r-s.ShapeOutlineWidthPx,o=Math.round(t+r),a=Math.round(n-r);return{centerX:o,centerY:a,innerRadius:i,outlineRadius:r}}(t),h=f.outlineRadius;h<=0||(u(e,f.centerX,f.centerY,h,i.Circle0Deg,i.Circle360Deg,n),r&&f.innerRadius>0&&function(e,t,n,r,s){var d=t.centerX,g=t.centerY,f=t.innerRadius;if(s)!function(e,t,n,r){var o=t.centerX,s=t.centerY,d=t.innerRadius,g=l.getHighContrastFillingType(r),f=a.rgbToColorHex(n.BackgroundColor),h=a.rgbToColorHex(n.TextColor);switch(g){case l.FillType.Full:break;case l.FillType.FillPortion:var m=c(r);u(e,o,s,d,m,i.Circle270Deg,f);break;case l.FillType.Empty:u(e,o,s,d,i.Circle0Deg,i.Circle360Deg,f);break;case l.FillType.InnerCircle:u(e,o,s,d,i.Circle0Deg,i.Circle360Deg,f);var p=l.getInnerCircleRadius(r,d);u(e,o,s,p,i.Circle0Deg,i.Circle360Deg,h);break;case l.FillType.Stripes:u(e,o,s,d,i.Circle0Deg,i.Circle360Deg,f),l.drawStripes(e,o,s,d,h);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,s,r);else switch(r){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:var h=c(r);u(e,d,g,f,i.Circle270Deg,h,n),u(e,d,g,f,h,i.Circle270Deg,o.CircleEmptyInnerColor);break;default:u(e,d,g,f,i.Circle0Deg,i.Circle360Deg,n)}}(e,f,r,d,g))}function u(e,t,n,r,i,o,a){e.fillStyle=a,e.beginPath(),e.moveTo(t,n),e.arc(t,n,r,i,o),e.fill()}function c(e){switch(e){case i.CFIconImage.Circle25:return i.Circle0Deg;case i.CFIconImage.CircleHalf:return i.Circle90Deg;case i.CFIconImage.Circle75:return i.Circle180Deg;default:throw Error("getFillAngle: image: "+e+" not supported")}}t.drawCircleIcon=function(e,t,n,l){r.verifyArgumentNotNull(e,"ctx","drawCircleIcon"),r.verifyArgumentNotNull(t,"model","drawCircleIcon"),r.verifyArgumentNotNull(n,"cell","drawCircleIcon"),r.verifyArgumentNotNull(l,"drawingContext","drawCircleIcon");var s=l.image,u=l.highContrastScheme;d(e,l,function(e,t){if(t)return a.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighOuterColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumOuterColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowOuterColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyOuterColor;case i.CFIconImage.CircleFilled:case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledOuterColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighOuterColor;case i.CFIconImage.FourCircleLow:return o.FourCircleLowOuterColor;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1OuterColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2OuterColor;default:throw Error("getCircleOutlineColor: unsupported image type = "+e)}}(s,u),function(e,t){if(t)return a.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighInnerColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumInnerColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowInnerColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyInnerColor;case i.CFIconImage.CircleFilled:return o.CircleFilledInnerColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighInnerColor;case i.CFIconImage.FourCircleLow:return;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1InnerColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2InnerColor;case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledInnerColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(s,u))},t.drawCircle=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3);!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(r=t.ImageLoadStatus||(t.ImageLoadStatus={})),function(e){e[e.Sparkline=0]="Sparkline"}(t.ImageType||(t.ImageType={}));var o={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function l(e,t,n,i){var o=g(e);if(o||(f(e,o={blockIdentifiers:[t],status:r.Initialized,version:n,url:i}),i))switch(o.status){case r.Loaded:return o.image;case r.LoadFailed:return;case r.Loading:return void u(t,o);case r.Initialized:return u(t,o),void(o.url&&c(o));default:throw Error("getOrLoadImageByKey: unexpected image statue: "+o.status)}}function s(e){return"STATIC"+e}function d(e,t){return e+t}function u(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function c(e){if(!e.url)throw Error("image url is not set, unexpected call");var t=new Image;t.onload=function(){e.status=r.Loaded,i.verifyArgumentNotNull(o.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),o.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=r.LoadFailed,i.verifyArgumentNotNull(o.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),o.onImageLoadFailureCallback("image failed to load, URL: "+e.url+", registeredModelsCount: "+e.blockIdentifiers.length+", registeredModelsCount: "+e.blockIdentifiers),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=r.Loading}function g(e){return a[e]}function f(e,t){a[e]=t}function h(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){o.onImageLoadSuccessCallback=e,o.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){i.verifyArgumentNotNull(t,"url","setStaticImageUrl");var n=s(e),o=g(n);if(o){if(o.url)throw Error("setStaticImageUrl: image url already defined. image: "+e+", old url: "+o.url+", new url: "+t);o.url=t,c(o)}else f(n,{blockIdentifiers:[],status:r.Initialized,url:t})},t.clearImageFromCache=function(e,t){var n=d(e,t);g(n)&&h(n)},t.getOrLoadVersionedImage=function(e,t,n,r,i){var o=d(e,r),a=g(o);return!a||a.version===t&&a.url===n||h(o),l(o,i,t,n)},t.getOrLoadStaticImage=function(e,t){return l(s(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:function(e){return g(e)},resetImageCache:function(){for(var e in a)delete a[e]},getImageKey:function(e,t){return d(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTextBaseline="alphabetic",t.IconTextMinimalPadding=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(23),o=n(26),a=n(2),l=n(3),s=document.createElement("div"),d=document.createElement("img"),u=document.createElement("img");s.innerText=".",s.style.visibility="hidden",d.style.height="0px",u.style.height="0px",s.appendChild(d),s.appendChild(u),document.body.appendChild(s);var c={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function g(e,t){return t+"pt "+i.canonizeFontName(e)}function f(e){var t=-1,n=-1,i=-1,o=d,a=u;return s.style.font=e,o.style.verticalAlign="baseline",a.style.verticalAlign="middle",r.trackDuration(r.RenderPerformanceMetric.GetFontMetrics,(function(){t=s.clientHeight,n=h(o),i=h(a)}),!0),{height:t,baseline:n,middle:i}}function h(e){if(!s||!e)throw Error("getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: "+s+", baselineLocator: "+e);try{var t=s.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return r.setDivMetricWarning("Error in getFontBaselineHeight: "+e),0}}function m(e,t){var n,r=g(e,t);if(t>=0&&t<1)return c[r]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},c[r].fontMetrics;try{n=f(r)}catch(n){return C(t,e,r,"Exception in getFontMetrics, error:"+n)}return 0===n.height&&t>=1?C(t,e,r,"fontMetricsDivHeight == 0."):(c[r]={fontSize:t,fontMetrics:n},n)}function p(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function C(e,t,n,o){var a=null!==s.parentNode?"Has Parent":"Parent is null",l=window.getComputedStyle(s).getPropertyValue("display");s.style.display="block",document.body.appendChild(s);var d=f(n),u=window.getComputedStyle(s),g=u.getPropertyValue("display"),h=u.getPropertyValue("height"),m=s.getBoundingClientRect();if(0!==d.height)return c[n]={fontSize:e,fontMetrics:d},d;s.style.overflow="hidden";var p=f(n);if(0!==p.height)return c[n]={fontSize:e,fontMetrics:d},p;var C="\n       "+o+"\n       Font name: "+i.getFontNameForLogging(t)+" }, font size: "+e+".\n       fontMetricsDiv "+a+". fontMetricsDivDisplayMode: "+l+".\n       After another appendChild:\n       FontMetricsDivHeight2: "+d.height+" (getFontMetricsDivHeight), fontMetricsDivDisplayMode: "+g+" (getComputedStyle),\n       fontBoundingClientRect.height: "+m.height+" }, top:"+m.top+" }, bottom:"+m.bottom+".\n       css.height: "+u.height+" }, css.line-height: "+u.lineHeight+" }, computedHeight: "+h+".\n       FontMetricsDiv.scrollWidth: "+s.scrollWidth+" }, fontMetricsDiv.scrollHeight: "+s.scrollHeight;if(r.setDivMetricWarning(C),!i.isKnownFont(t)){var y=Math.round(e)+"pt calibri";if(c[y])return c[y].fontMetrics}throw Error(C)}t.getCachedFontMetrics=function(e,t,n){l.isRenderFlagEnabled(a.RenderFlags.UpdateFontLoadStatus,n)&&o.updateFontLoadStatus(i.canonizeFontName(e));var r=g(e,t),s=c[r];return p(s?s.fontMetrics:m(e,t))},t.recalculateFontMetrics=function(e){for(var t=Object.getOwnPropertyNames(c),n=e.toLowerCase(),r=0;r<t.length;r++){var i=t[r];if(i.indexOf(n)>=0)m(n,c[i].fontSize)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(36),a=n(3),l=o.comparisonIgnoreLists.GridBlockModel.concat(["Cells"]),s=o.comparisonIgnoreLists.Cell,d=s.concat(["Text"]),u=o.comparisonIgnoreLists.ReferencedObject,c=o.comparisonIgnoreLists.CellStyle.concat(u),g=o.comparisonIgnoreLists.TextRun.concat(["Fonts"]);function f(e,t,n,i){e.CachedStyle=a.getReferencedObjectToCache(e.StyleID,n.Styles),t.CachedStyle=a.getReferencedObjectToCache(t.StyleID,i.Styles),e.CachedBorderStyle=a.getReferencedObjectToCache(e.BorderStyleID,n.BorderStyles),t.CachedBorderStyle=a.getReferencedObjectToCache(t.BorderStyleID,i.BorderStyles),e.CachedFont=a.getReferencedObjectToCache(e.CachedStyle.FontID,n.Fonts),t.CachedFont=a.getReferencedObjectToCache(t.CachedStyle.FontID,i.Fonts);var o=a.isAccAndCustomNumFmtApplicable(e,n)&&a.isAccAndCustomNumFmtApplicable(t,i);a.isRenderFlagEnabled(r.RenderFlags.RichTextFormat,n)&&v(e.TextRuns,t.TextRuns,n.Fonts,i.Fonts);var l=m(e,t,function(e){return(e?d:s).concat(["Row","Col"])}(o));return l.isEqual||(l.message+="\nareCellsEqual: cell1.Row = "+e.Row+", cell1.Col = "+e.Col+", cell2.Row = "+t.Row+", cell2.Col = "+t.Col),l}function h(e,t,n){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: "+e.length+", length2: "+t.length};for(var r=0;r<e.length;r++){var i=m(e[r],t[r],n);if(!i.isEqual)return i.message+="\nareArraysEqual: array objects are different. index: "+r,i}return{isEqual:!0}}function m(e,t,n){if(e===t)return{isEqual:!0};if(i.isNullOrUndefined(e)&&i.isNullOrUndefined(t))return{isEqual:!0};if(null==e||null==t)return{isEqual:!1,message:"areObjectsEqual: one object is null, o1 = "+!e+", o2 = "+!t};if(e!=e)return{isEqual:t!=t,message:"areObjectsEqual: NaN comparison"};var r=function(e,t){if(!e||!t)return e||t;var n=t.filter((function(t){return-1===e.indexOf(t)}));return e.concat(n)}(p(e,n),p(t,n));if(0===r.length)return F(e)&&F(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var o=0;o<r.length;o++){var a=r[o],l=e[a],s=t[a],d=typeof l,u=typeof s;if(!i.isNullOrUndefined(l)||!i.isNullOrUndefined(s)){if(d!==u){if(C(l)&&C(s))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = "+a+" type1 = "+d+", type2 = "+u}}switch(d){case"undefined":case"boolean":case"string":case"number":if(l!==s)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+a};break;case"object":if(l instanceof Array){if(!(s instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+a};if(!(c=h(l,s,y(a))).isEqual)return c.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+a,c}else{var c;if(!(c=m(l,s,y(a))).isEqual)return c.message+="\nareObjectsEqual: objects mismatch, propertyName = "+a,c}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: "+d+", propertyName = "+a}}}}return{isEqual:!0}}function p(e,t){if("object"!=typeof e)return[];var n=Object.getOwnPropertyNames(e);return t?n.filter((function(e){return-1===t.indexOf(e)})):n}function C(e){return null==e||""===e||!1===e}function y(e){var t=o.propertyToClassMap[e];if(t){for(var n=[],r=0;r<t.length;r++)n=n.concat(o.comparisonIgnoreLists[t[r]]);return n}}function v(e,t,n,r){if(e&&t&&e.length===t.length)for(var i=0;i<e.length;i++)e[i].CachedFont=a.getReferencedObjectToCache(e[i].FontID,n),t[i].CachedFont=a.getReferencedObjectToCache(t[i].FontID,r)}function F(e){if("object"==typeof e&&e.constructor===Object){for(var t in e)return!1;return!0}return!1}t.areGridBlockModelsEqual=function(e,t){var n=m(e,t,l);return n.isEqual&&(n=function(e,t,n,r){if(e===t)return{isEqual:!0};var i,o=e.length,l=t.length,s=0,d=0,u=a.getDefaultCell(-1,-1,n.Styles,n.Fonts);for(;s<o||d<l;){i=!0;var c=null;if(s>=o)c=f(u,t[d],r,r),d++;else if(d>=l)c=f(e[s],u,n,n),s++;else{var g=e[s],h=t[d];g.Row<h.Row||g.Row===h.Row&&g.Col<h.Col?(c=f(g,u,n,n),s++):g.Row!==h.Row||g.Col!==h.Col?(c=f(u,h,r,r),d++):(c=f(g,h,n,r),i=!1,s++,d++)}if(!c.isEqual){var m=c.message+"\nOne of the models contains a cell that doesn't exist in the other model";return c.message=i?m:c.message,c}}return{isEqual:!0}}(e.Cells,t.Cells,e,t)),n},t.areCellsEqual=f,t.areStylesEqual=function(e,t){return m(e,t,c)},t.areFormattedTextsEqual=function(e,t){if(e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};v(e.TextRuns,t.TextRuns,e.Fonts,t.Fonts)}return m(e,t,g)},t.areArraysEqual=h,t.testHelper={areObjectsEqual:function(e,t,n){return m(e,t,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["RowOutlines","ColumnOutlines","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlags","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache"],t.comparisonIgnoreLists.Cell=["StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","ShrunkSize","AutoFilter","PivotFilter","CommentID","RichValueType","RichValueFieldsIndexes","FormulaInfo","ValueType","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount"],t.comparisonIgnoreLists.CellStyle=["NamedStyleId","FontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType"],t.comparisonIgnoreLists.MergeInformation=["WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.TextRun=["FontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","CanExpandCollapse"],t.propertyToClassMap={},t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.Font=["FontName"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",tsOnly:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",tsOnly:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RenderFlags"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",tsOnly:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.Col"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Row"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Text"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Ifmt"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.Spill"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Merge"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",tsOnly:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CommentID"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",tsOnly:!0},t.SerializationProperties["Cell.Value"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",tsOnly:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",tsOnly:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",tsOnly:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",tsOnly:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",tsOnly:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",tsOnly:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",tsOnly:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",tsOnly:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",tsOnly:!1},t.SerializationProperties["BorderStyle.Borders"]={type:"object",tsOnly:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",tsOnly:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",tsOnly:!1},t.SerializationProperties["Font.Size"]={type:"number",tsOnly:!1},t.SerializationProperties["Font.FontName"]={type:"object",tsOnly:!1},t.SerializationProperties["Font.Color"]={type:"object",tsOnly:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",tsOnly:!1},t.SerializationProperties["Font.Underline"]={type:"number",tsOnly:!1},t.SerializationProperties["Font.ID"]={type:"number",tsOnly:!1},t.SerializationProperties["Font.RefCount"]={type:"number",tsOnly:!1},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(24),o=n(5),a=n(2),l=n(6),s=n(20),d=n(71),u=n(15),c=n(8),g=n(3);function f(e,t,n,a){if(void 0===a&&(a=0),e.isProcessingLastLine&&e.breakType===i.BreakType.Justify){var l=function(e,t,n){void 0===n&&(n=0);for(var r="",i=0,a=0;a<e.length;a++)r+=e[a].text,i+=e[a].width,a!==e.length-1&&(r+=o.Whitespace,i+=t);return{Start:{Offset:n,Text:r,Width:i},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,a);return e.lineDirection===i.LineDirection.Vertical&&(l.Start.Offset=e.maxWidth-l.Start.Width),l}if(e.lineDirection===i.LineDirection.Vertical&&function(e){if(e.length>=2){var t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){var s=a,d=0,c=t[d],g=(l={Start:{Offset:s,Text:c.text,Width:c.width},SpaceWidthBetweenWords:n},Math.floor(n/e.singleSpaceWidth));g<1&&(g=1);var f=function(e,t,n,r){if(e.lineDirection===i.LineDirection.Vertical&&r>3)return n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(r-3)/2):0;return 0}(e,g,n,t.length);s+=c.width+n+f,d++,(void 0===g||isNaN(g)||g===1/0)&&(u.setDivMetricWarning("getJustifyDistributedLine: Invalid count variable. numberOfSpaces: "+g+", spaceWidthBetweenTokens: "+n+", singleSpaceWidth: "+e.singleSpaceWidth+" "),g=1);for(var h="",m=s,p=0;d<t.length-1;d++)h+=(c=t[d]).text,p+=c.width,d!==t.length-2&&(h+=o.Whitespace.repeat(g),p+=e.singleSpaceWidth*g);if(""!==h&&(l.Middle={Offset:m,Text:h,Width:p}),t.length>1){var C=t[t.length-1],y=r.isNullOrUndefined(l.Middle)?s:m+p+n+f;l.End={Offset:y,Text:C.text,Width:C.width}}return l}}function h(e,t){var n=e;if(n.length<=1)return 0;if(t.breakType===i.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;for(var r=0,o=0;o<n.length;o++){r+=n[o].width}var a=(t.maxWidth-r)/(n.length-1);return a<t.singleSpaceWidth?t.singleSpaceWidth:a}function m(e,t,n){return e?t[t.length-1-n]:t[n]}function p(e,t){return e.isProcessingLastLine&&e.breakType===i.BreakType.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function C(e,t,n,r,i,o,a){for(var l=[],s=0,d=!1,u=0;u<n.length;u++){var c=n[u];if(v(c,r,i))if(F(c,r,i))l.push(c),s+=c.width;else{var g=S(e,t,c,r,i,o,a);d=o?d||!c.text.startsWith(g.text):T(c.text)?!c.text.startsWith(g.text):!c.text.endsWith(g.text),l.push(g),s+=g.width}}return{currentTextTokens:l,currentTokenWidthPx:s,combinePartialTokens:d}}function y(e){if(e.Start&&e.End){var t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords},n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function v(e,t,n){return e.start<n&&e.start+e.text.length>t}function F(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function S(e,t,n,r,i,o,s){var d=n.start<r?r-n.start:0,u=d+i-(r>n.start?r:n.start),c=n.text.substring(d,u);return{text:c,start:n.start>r?n.start:r,width:o?l.measureTextHeightForVerticalText(s,c):l.measureTextWidth(e,c,!0,g.isRenderFlagEnabled(a.RenderFlags.MeasureTextWidthUseNewRegex,t)),containsThaiCharacters:n.containsThaiCharacters}}function T(e){return!!e&&s.analyzeBidiText(e,a.ReadingOrderType.LeftToRight).HasRtl}function x(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function w(e,t,n){return e===i.LineDirection.Vertical?n:t.measureText(" ").width}t.getJustifyDistributedLine=f,t.getSpaceWidthBetweenWords=h,t.prepareTextRunsForJustifyAndDistributed=function(e,t,n,a,l,s){if(0===l.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0!==a.length){s&&(n.maxWidth=n.maxWidth-2*o.GridLineWidthPx);var d=p(n,a);if(1===l.length){var u=e.font,g=u,v=l[0],F=v.FontCss;g!==F&&(e.font=F,g=F);var S=x(n);S.singleSpaceWidth=w(n.lineDirection,e,v.MaxGlyphHeightPx);var b=f(S,a,h(a,n),d);s||!T(v.Text)||r.isNullOrUndefined(b)||(b=y(b)),v.JustifyDistributedLine=b,v.WidthPx=function(e,t){var n,r,o,a,l,s=0;if(t&&e.breakType===i.BreakType.Justify)return s+=null===(n=t)||void 0===n?void 0:n.Start.Width,(null===(r=t)||void 0===r?void 0:r.Middle)&&(s+=null===(o=t)||void 0===o?void 0:o.Middle.Width),(null===(a=t)||void 0===a?void 0:a.End)&&(s+=null===(l=t)||void 0===l?void 0:l.End.Width),s;return e.maxWidth}(n,b),g!==u&&(e.font=u)}else!function(e,t,n,o,a,l,s){void 0===s&&(s=0);for(var d=h(n,o),u=function(e){for(var t=e[0].start,n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),g=e.font,p=g,v=s,F=0;F<a.length;F++){var S=m(l,a,F),b=S.FontCss;p!==b&&(e.font=b,p=b);var A=x(o);A.singleSpaceWidth=w(o.lineDirection,e,S.MaxGlyphHeightPx);var R=S.StartIndex+u,I=R+(void 0!==S.Text?S.Text.length:0),M=C(e,t,n,R,I,l,S.MaxGlyphHeightPx),D=M.currentTextTokens,P=M.currentTokenWidthPx,L=M.combinePartialTokens;if(0!==D.length){var O=f(A,D,d,v);c.isVerticalTextPresentSlice3||r.isNullOrUndefined(O)||T(S.Text)&&(O=y(O)),S.JustifyDistributedLine=O,l&&o.lineDirection===i.LineDirection.Vertical?S.HeightPx=P+d*(D.length-1):S.WidthPx=P+d*(D.length-1),L||S.IsSpecialCharTextRun?v+=P+d*(D.length-1):v+=P+d*D.length}}p!==g&&(e.font=g)}(e,t,a,n,l,s,d)}},t.reorderTextTokens=function(e,t,n,r){if(!n.HasRtl||n.HasLtr)d.reorderTextTokensUsingDom(e,t,n,r);else for(var i=0;i<e.tokensPerLine.length;i++)e.tokensPerLine[i].tokens.reverse()},t.getTextRun=m,t.getStartOffset=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(29),a=n(22),l=n(3),s=n(8),d=n(52);function u(e,t,n,a,l,s,u,g,f,h,m,p){var C,y,v=e.textAlign;"center"!==v&&(e.textAlign="center");var F=o.breakToGraphemes(a),S=u||i.getTextLineHeight(n,t),T=function(e,t){return(e.length-1)*t}(F,S);!function(e,t,n,r,i,o,a,l,s,d,u){for(var g=o,f=r.length-1;f>=0;f--){var h=r[f];" "!==h&&(e.fillText(h,i,g),c(e,t,n,i,g,h,l,s,d,u)),g-=a}}(e,t,n,F,s,function(e,t,n,i,o){var a=function(e,t,n,i){var o=d.getVerticalTextPadding(t);switch(e){case r.VerticalAlignment.Top:return n+i+o;case r.VerticalAlignment.Center:return n+i/2;case r.VerticalAlignment.Bottom:default:return n-o}}(e,t,n,i);if(o&&e===r.VerticalAlignment.Distributed&&o<=0)return a-o;return a}(null===(C=n.CachedStyle)||void 0===C?void 0:C.VerticalAlignment,null===(y=n.CachedStyle)||void 0===y?void 0:y.Indentation,l,T,p),S,g,f,h,m),"center"!==v&&(e.textAlign=v)}function c(e,t,n,o,d,u,c,g,f,h){g&&s.isVerticalTextPresentSlice2(t,n)&&a.cacheTextDecorationLayout(t,n,{textPositionX:o,textPositionY:d,dpr:c,textWidth:i.measureTextWidth(e,u,l.isRenderFlagEnabled(r.RenderFlags.AdvancedTextMetrics,t),l.isRenderFlagEnabled(r.RenderFlags.MeasureTextWidthUseNewRegex,t)),clipRect:h},f)}t.fillVerticalText=function(e,t,n,r,i,o,a,l,s){u(e,t,n,r,o,i,void 0,a,!0===n.CachedFont.StrikeThrough,n.CachedFont,l,s)},t.fillVerticalTextForRTF=function(e,t,n,r,i,o,a,l,s,d,c,g){u(e,t,n,r,o,i,a,l,s,d,c,g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2);!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(r=t.AdvVerticalAlignmentFormat||(t.AdvVerticalAlignmentFormat={})),t.isVerticalAlignmentJustifyOrDistributed=function(e){switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return!0}return!1},t.getEffectiveVerticalAlignment=function(e,t,n,o,a,l){switch(e){case i.VerticalAlignment.Top:case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Center:return e;case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return function(e,t,n,o,a,l){switch(t){case r.WrapText:return function(e,t,n,r,o){if(1===o||t<r)switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Center}if(t<n&&t>=r)switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Top}return e}(e,n,o,a,l);case r.CFIcon:return function(e){switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Center}return i.VerticalAlignment.Center}(e)}}(e,t,n,o,a,l)}},t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=function(e,t,n){return(e-t)/(n-1)},t.getAdvancedVerticalAlignmentOffsetYForWrapText=function(e,t,n){return e-t*n}},function(e,t,n){"use strict";n.r(t);var r=n(41);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var o=n(59);n.d(t,"UnavailabilityToast",(function(){return o.a})),n.d(t,"UnavailabilityToastFactory",(function(){return o.b}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);r.__exportStar(n(60),t),r.__exportStar(n(43),t),r.__exportStar(n(42),t),r.__exportStar(n(113),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(111),o=n(0),a=n(45),l=function(){function e(){}return e.prototype.getModelAccessor=function(e){return o.verifyArgumentNotNull(e,"model","GridBlockRendererFactory.getModelAccessor"),new i.GridBlockModelAccessor(e)},e.prototype.getGridBlockRenderer=function(){return new r.GridBlockRenderer},e.prototype.createRenderingCanvasElement=function(){return new a.RenderingCanvasElement},e.prototype.tempCreateRenderingCanvasElement=function(e){return new a.RenderingCanvasElement(e)},e}();t.GridBlockRendererFactory=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(25),o=n(66),a=n(67),l=n(15),s=n(68),d=n(69),u=n(18),c=n(1),g=n(81),f=n(0),h=n(4),m=n(3),p=n(49),C=n(50),y=n(54),v=n(22),F=n(83),S=n(16),T=n(84),x=n(96),w=n(104),b=n(105),A=n(106),R=n(107),I=n(109),M=n(110),D=function(){function e(){}return e.prototype.renderBlock=function(e,t,n){var r=this;if(l.clearPerformanceMetrics(),x.loadPolyFills(),!e)return l.createRenderResult(!1,"renderBlock:: canvas is undefined");if(!t)return l.createRenderResult(!1,"renderBlock:: model is undefined");if(!n)return l.createRenderResult(!1,"renderBlock:: context is undefined");if(!s.isCanvasElement(e))return l.createRenderResult(!1,"renderBlock:: canvas is not HTMLCanvasElement");var i,o=null;return l.trackDuration(l.RenderPerformanceMetric.GetContextDurationMs,(function(){o=e.getContext2d({alpha:!n.subPixelRenderingEnabled})})),o?(l.trackDuration(l.RenderPerformanceMetric.ModelPreparationsMs,(function(){r.initializeCachedObjects(t),r.createOffsetsForDrawing(t,n.devicePixelRatio),r.updateCellsBeforeDrawing(o,t,n.devicePixelRatio),r.updatePivotTablesInformationBeforeDrawing(t.PivotTables,n.devicePixelRatio)})),l.trackDuration(l.RenderPerformanceMetric.RenderBlockInternalDurationMs,(function(){i=r.renderBlockInternal(e,o,t,n)})),t.ClientOnlyCache.IsDirty=!1,h.isNullOrUndefined(i)&&(i=l.createRenderResult(!0,"")),i.succeeded&&(i.message=h.isNullOrUndefined(i.message)?l.getRenderingMessage():i.message+"; "+l.getRenderingMessage()),i):l.createRenderResult(!1,"renderBlock:: ctx is undefined")},e.prototype.renderBlockInternal=function(t,n,s,u){try{var c,f,h=u.devicePixelRatio,y=n.canvas.width;this.validateRenderingRegion(u.renderingRegion,s),y=Math.round(s.BlockWidth*h);var F=u.renderingRegion;return f=-1*F.startOffsetY*h,c=this.getDrawingOffsetXForRenderingRegion(s,F)*h,e.clearCanvas(n,s,t.getWidth(),t.getHeight(),u),e.setTransform(n,1,s.IsRtl,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return i.drawGridLines(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesMs,(function(){l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){C.clearGridLinesForSpannedCells(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForPivotTable,(function(){C.clearGridLinesForPivotTables(n,s,u)}))})),e.setTransform(n,1,!1,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return g.drawBackgroundFill(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,(function(){return A.drawEmptyPivotTableTitleContainers(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableImages,(function(){return A.drawEmptyPivotTableImages(n,s,u)})),m.isRenderFlagEnabled(r.RenderFlags.DataBars,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawDataBarsMs,(function(){return R.drawDataBars(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawCFIconsMs,(function(){return T.drawConditionalFormattingIcons(n,s,u)})),u.modelFromCache||l.trackDuration(l.RenderPerformanceMetric.DrawSparklines,(function(){return I.drawSparklines(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){p.clearGridLinesForBorder(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawBordersMs,(function(){return p.drawBorders(n,s,u)})),u.debugMode&&a.addWatermark(n,u),e.setTransform(n,h,!1,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawTextDurationMs,(function(){return d.drawCellsText(n,s,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,(function(){return A.drawEmptyPivotTableTitleText(n,s,u)})),e.setTransform(n,1,!1,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawTextDecoration,(function(){return v.drawTextDecoration(n,s,u)})),m.isRenderFlagEnabled(r.RenderFlags.PivotTable,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawExpandCollapseButtonsMs,(function(){return M.drawExpandCollapseButtons(n,s,u)})),u.skeletonMode&&l.trackDuration(l.RenderPerformanceMetric.DrawSkeletonMs,(function(){return o.drawSkeleton(n,s,u)})),e.setTransform(n,1,s.IsRtl,c,f,y),u.renderPageLayout&&(m.isRenderFlagEnabled(r.RenderFlags.PrintArea,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawPrintAreasDurationMs,(function(){return b.drawPrintAreas(n,s,u)})),m.isRenderFlagEnabled(r.RenderFlags.PageBreaks,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawPageBreaksDurationMs,(function(){return w.drawPageBreaks(n,s,u)}))),l.createRenderResult(!0,"finished rendering.")}catch(e){return l.createRenderResult(!1,"exception caught in renderBlockInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},e.clearCanvas=function(e,t,n,r,i){i.subPixelRenderingEnabled||f.hasWorkbookBackgroundColor(t.BackgroundColor)?l.trackDuration(l.RenderPerformanceMetric.FillRectDurationMs,(function(){e.fillStyle=f.getWorkbookBackgroundColor(i.highContrastScheme,t.BackgroundColor),e.fillRect(0,0,n,r)})):l.trackDuration(l.RenderPerformanceMetric.ClearRectDurationMs,(function(){e.clearRect(0,0,n,r)}))},e.setTransform=function(e,t,n,r,i,o){n?e.setTransform(-t,0,0,t,o+r,i):e.setTransform(t,0,0,t,r,i)},e.prototype.initializeCachedObjects=function(e){f.verifyArgumentNotNull(e.Cells,"cells","GridBlockRenderer.initializeCachedObjects"),f.verifyArgumentNotNull(e.Styles,"styles","GridBlockRenderer.initializeCachedObjects"),f.verifyArgumentNotNull(e.Fonts,"fonts","GridBlockRenderer.initializeCachedObjects");var t=!h.isNullOrUndefined(e.BorderStyles);f.initModelClientCache(e);for(var n=0;n<e.Cells.length;n++){var i=e.Cells[n];if(i.CachedStyle=u.getReferencedObjectById(i.StyleID,e.Styles),t&&!h.isNullOrUndefined(i.BorderStyleID)&&(i.CachedBorderStyle=u.getReferencedObjectById(i.BorderStyleID,e.BorderStyles)),i.CachedFont=u.getReferencedObjectById(i.CachedStyle.FontID,e.Fonts),i.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},m.isRenderFlagEnabled(r.RenderFlags.RichTextFormat,e)&&!h.isNullOrUndefined(i.TextRuns))for(var o=0;o<i.TextRuns.length;o++){var a=i.TextRuns[o];a.CachedFont=u.getReferencedObjectById(a.FontID,e.Fonts)}i.CachedDisplayText=void 0,i.CachedDisplayTextRuns=void 0}},e.prototype.updateCellsBeforeDrawing=function(e,t,n){var i=t.Cells;f.verifyArgumentNotNull(i,"cells","GridBlockRenderer.updateCellsBeforeDrawing");for(var o=0;o<i.length;o++){var a=i[o],l=a.CachedFont.Italic,s=a.CachedFont.FontName!==S.DefaultFontName,d=a.TextRuns&&m.isRenderFlagEnabled(r.RenderFlags.RichTextFormat,t),u=a.CachedFont.Underline!==r.FontUnderline.None||a.CachedFont.StrikeThrough;a.Text&&(a.CachedDisplayText=f.getDisplayText(a,t)),a.Text&&f.cellHasShrinkToFit(a)&&F.updateCellShrinkToFit(e,t,a),(l||s||u||d)&&y.updateCellSpill(e,t,a),a.Merge&&this.updateCellMergeInformation(t,a,n)}},e.prototype.createOffsetsForDrawing=function(e,t){var n=e.RowHeights,r=e.ColumnWidths,i=e.RowOffsets,o=e.ColumnOffsets;f.verifyArgumentNotNull(n,"rowHeights","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(r,"colWidths","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(i,"rowOffsets","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(o,"colOffsets","GridBlockRenderer.createOffsetsForDrawing");var a=f.getModelClientCache(e);a.RowOffsetsAdjustedForDrawing=[];for(var l=0;l<i.length;l++){var s=i[l];a.RowOffsetsAdjustedForDrawing.push(Math.round(s*t))}a.ColOffsetsAdjustedForDrawing=[];for(l=0;l<o.length;l++){s=o[l];a.ColOffsetsAdjustedForDrawing.push(Math.round(s*t))}a.RowOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockHeight,t)),a.ColOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockWidth,t))},e.prototype.updateCellMergeInformation=function(e,t,n){var r=t.Merge;if(r.SpansBlocks){r.HeightAdjustedForDrawing=Math.round(r.Height*n),r.WidthAdjustedForDrawing=Math.round(r.Width*n),r.OriginDeltaXAdjustedForDrawing=Math.round(r.OriginDeltaX*n),r.OriginDeltaYAdjustedForDrawing=Math.round(r.OriginDeltaY*n);var i=e.RowOffsets[t.Row]-r.OriginDeltaY;r.SpansNextBlockVertically=i+r.Height>e.BlockHeight;var o=e.ColumnOffsets[t.Col]-r.OriginDeltaX;r.SpansNextBlockHorizontally=o+r.Width>e.BlockWidth}},e.prototype.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(var n=0;n<e.length;n++){var r=e[n];r.DeltaXFromOriginPTAdjustedForDrawing=Math.round(r.DeltaXFromOriginPT*t),r.DeltaYFromOriginPTAdjustedForDrawing=Math.round(r.DeltaYFromOriginPT*t),r.OriginPTHeightAdjustedForDrawing=Math.round(r.OriginPTHeight*t),r.OriginPTWidthAdjustedForDrawing=Math.round(r.OriginPTWidth*t)}},e.prototype.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},e.prototype.validateRenderingRegion=function(e,t){f.verifyArgumentNotNull(e,"renderingRegion","validateRenderingRegion");var n=t.RowOffsets[e.startRow],r=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],o=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(n>e.startOffsetY||r<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= "+e.startOffsetY+", endOffsetY = "+e.endOffsetY+", firstRowStartOffset= "+n+", lastRowEndOffset= "+r);if(i>e.startOffsetX||o<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= "+e.startOffsetX+", endOffsetX = "+e.endOffsetX+", firstColumnStartOffset= "+i+", lastColumnEndOffset= "+o)},e}();t.GridBlockRenderer=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(4);t.updateNumFmtFromCell=function(e){var t,n,o,a,l,s;if(r.verifyArgumentNotNull(e.Text,"cell.Text","updateNumFmt"),r.verifyArgumentNotNull(e.NumFmt,"cell.NumFmt","updateNumFmt"),!i.isNullOrUndefined(e.NumFmt.End)&&!i.isNullOrUndefined(e.NumFmt.Separator)){var d=function(e,t){for(var n=0,r=0;r<e.length&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),u=function(e,t){for(var n=0,r=e.length-1;r>0&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),c=function(e,t,n){var r=e.length-t,i=e.substring(0,r),o=i.lastIndexOf(n);if(-1===o)return i;return i.substr(o+1)}(e.Text,u,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,r){return t.repeat(n)+e+t.repeat(r)}(c,e.NumFmt.Separator,d,u),(null===(n=null===(t=e)||void 0===t?void 0:t.Text)||void 0===n?void 0:n.endsWith((null===(o=e.NumFmt)||void 0===o?void 0:o.Separator)+e.NumFmt.End))&&(null===(l=null===(a=e)||void 0===a?void 0:a.Text)||void 0===l?void 0:l.startsWith((null===(s=e.NumFmt)||void 0===s?void 0:s.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.renderingRegion=void 0,this.canvas=null!=e?e:document.createElement("canvas"),this.parentElement=null}return e.prototype.dispose=function(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.canvas.width=0,this.canvas.height=0},e.prototype.appendToParent=function(e){e&&(e.appendChild(this.canvas),this.parentElement=e)},e.prototype.getContext2d=function(e){return this.canvas.getContext("2d",e)},e.prototype.getWidth=function(){return this.canvas.width},e.prototype.getHeight=function(){return this.canvas.height},e.prototype.getStyle=function(){return this.canvas.style},e.prototype.setClassName=function(e){this.canvas.className=null!=e?e:""},e.prototype.updatePosition=function(e,t,n,r){if(this.canvas){var i=e+"px",o=t+"px",a=this.canvas.style;if(n||(r?a.right!==i:a.left!==i)||a.top!==o)return r?a.right=i:a.left=i,a.top=o,!0}return!1},e.prototype.setDimensions=function(e,t,n){var r=Math.round(e*n),i=Math.round(t*n);this.canvas.style.width=r/n+"px",this.canvas.style.height=i/n+"px",this.canvas.width=r,this.canvas.height=i},e.prototype.setRenderingRegion=function(e){e&&(this.renderingRegion=e)},e.prototype.getRenderingRegion=function(){return this.renderingRegion},e.prototype.tempGetCanvasElement=function(){return this.canvas},e}();t.RenderingCanvasElement=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),i=n(1),o=n(22),a=n(38),l=n(8);t.fillTextUnclipped=function(e,t,n,r,i,a,l,s){e.fillText(t,n,r,i);var d={dpr:s,textPositionX:n,textPositionY:r};o.measureAndCacheTextDecorationLayout(e,l,a,d)},t.fillTextClipped=function(e,t,n,s,d,u,c,g,f,h){if(i.applyClipping(e,u),!h&&l.isVerticalTextPresent(g,c))a.fillVerticalText(e,g,c,n,s,d,t.devicePixelRatio,u);else if(h&&!f)r.fillRichTextFormat(e,t,g,c,h,s,d,u);else{e.fillText(n,s,d);var m={dpr:t.devicePixelRatio,textPositionX:s,textPositionY:d,clipRect:u};o.measureAndCacheTextDecorationLayout(e,g,c,m)}i.restoreClipping(e,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);t.approximateValue=function(e,t){var n=Math.round(e);if(n<r.MinAllowedFontSize&&n>0&&(n=r.MinAllowedFontSize),n>r.MaxAllowedFontSize&&(n=r.MaxAllowedFontSize),n<0)throw Error("TextLayout.approximateValue: "+n+" in Excel must be between 1pt and 409pt");var i=t[n];if(i)return i;for(var o=n;o>r.MinAllowedFontSize&&!t[o];)o--;for(var a=n;a<r.MaxAllowedFontSize&&!t[a];)a++;return i=function(e,t,n,r,i){var o=(n-r)/(i-r)*(e-t);return Math.round(t+o)}(t[a],t[o],n,o,a),t[n]=i,i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:1,3:1,4:1,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(4),a=n(5),l=n(0),s=n(35),d=n(50),u=n(7),c={},g={};function f(e){l.verifyArgumentNotNull(e,"model","validateModel"),l.verifyArgumentNotNull(e.Cells,"model.Cells","validateModel"),l.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","validateModel"),l.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),l.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","validateModel"),l.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","validateModel")}function h(e,t){return{BorderLineStyle:r.BorderLineType.Thin,Color:t,Weight:a.ThinBorderWeight,BorderPosition:e}}function m(e,t,n,r,i,o){var a=y(e,t,n.BorderPosition,r),l=b(n);l in o||(i.push(n),o[l]=[]),o[l].push(a)}function p(e,t,n,r,i){var o=[],l="",d=a.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=a.ThinBorderWeight}(e),e.beginPath();for(var u=0;u<t.length;u++){var c=t[u],g=i||w(c.Color),f=A(c.BorderLineStyle),h=d!==c.Weight*r,m=l!==g,p=!s.areArraysEqual(o,f,[]).isEqual;(h||m||p)&&(e.stroke(),e.beginPath(),h&&(d=c.Weight*r,e.lineWidth=d),m&&(l=g,e.strokeStyle=g),p&&(e.setLineDash(f),o=f));for(var y=n[b(c)],v=0;v<y.length;v++){var F=y[v];C(e,c.Weight,F,r)}}e.stroke()}function C(e,t,n,r){!function(e){return e.Y1===e.Y2}(n)?i.drawLine(e,x(n.X1,t,r),n.Y1-r,x(n.X2,t,r),n.Y2):i.drawLine(e,n.X1-r,x(n.Y1,t,r),n.X2,x(n.Y2,t,r))}function y(e,t,n,i){if(!e.IsRtl){var o=T(e,t,n)?a.GridLineWidthPx:i;return v(n,{X:u.getCellLeftAdjustedForDrawing(e,t,!1),Y:u.getCellTopAdjustedForDrawing(e,t)},{X:u.getCellRightAdjustedForDrawing(e,t)+o,Y:u.getCellBottomAdjustedForDrawing(e,t)})}var l=T(e,t,n)?i-a.GridLineWidthPx:0,s=v(n,{X:u.getCellRightAdjustedForDrawing(e,t)+i,Y:u.getCellTopAdjustedForDrawing(e,t)},{X:u.getCellLeftAdjustedForDrawing(e,t,!1)+l,Y:u.getCellBottomAdjustedForDrawing(e,t)});if(n===r.BorderPositionType.Top||n===r.BorderPositionType.Bottom){var d=s.X2;s.X2=s.X1,s.X1=d}return s}function v(e,t,n){switch(e){case r.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case r.BorderPositionType.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case r.BorderPositionType.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case r.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function F(e){switch(e){case r.BorderLineType.Thin:case r.BorderLineType.Medium:case r.BorderLineType.Hair:case r.BorderLineType.Thick:return!0;default:return!1}}function S(e,t,n){return n.Row===t.RowNumbers.length-1||n.Col===t.ColumnNumbers.length-1||(!!T(t,n,e)||(n.HasError?I(e):e===r.BorderPositionType.Top||e===r.BorderPositionType.Left))}function T(e,t,n){return!(!t.Merge&&!l.isCellAdjacentToMergedCell(t.Row,t.Col,e))&&I(n)}function x(e,t,n){var r=l.getLinePixelTranslation(n);return t===a.MediumBorderWeight&&n%2==1?e:e-r}function w(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,n=c[t];return o.isNullOrUndefined(n)?(n="rgb("+e.Red+","+e.Green+","+e.Blue+")",c[t]=n,n):n}function b(e){return w(e.Color)+"-"+e.Weight+"-"+e.BorderLineStyle}function A(e){var t=g[e];if(!o.isNullOrUndefined(t))return t;switch(e){case r.BorderLineType.Dotted:t=a.DottedLineDash;break;case r.BorderLineType.DashDot:case r.BorderLineType.MediumDashDot:t=a.DashedDotLineDash;break;case r.BorderLineType.DashDotDot:case r.BorderLineType.MediumDashDotDot:t=a.DashedDotDotLineDash;break;case r.BorderLineType.MediumDashed:t=a.MediumDashedLineDash;break;case r.BorderLineType.SlantDashDot:case r.BorderLineType.Dashed:t=a.DashedLineDash;break;default:t=[]}return g[e]=t,t}function R(e){return e.HasError?a.FormulaErrorBorderStyle:e.CachedBorderStyle}function I(e){return e<=r.BorderPositionType.Right}t.clearGridLinesForBorder=function(e,t,n){if(t.ShowGridLines&&i.shouldRenderGridLines(l.isHighContrastMode(n),l.hasWorkbookBackgroundColor(t.BackgroundColor))){f(t),d.setContextForClearingGridLine(e,n,t.BackgroundColor);var o=t.Cells;e.beginPath();for(var s=0;s<o.length;s++){var u=o[s],c=R(u);if(i.cellIntersectsRenderingRegion(u,n.renderingRegion)&&(c&&c.Borders&&0!==c.Borders.length&&!u.CachedStyle.BackgroundColor))for(var g=c.Borders,h=0;h<g.length;h++){var m=g[h];m.BorderLineStyle!==r.BorderLineType.None&&(F(m.BorderLineStyle)||S(m.BorderPosition,t,u)&&C(e,a.ThinBorderWeight,y(t,u,m.BorderPosition,a.GridLineWidthPx),a.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,n){f(t);var o,a,s=i.getDefaultBorderLineWidth(n.devicePixelRatio),d=l.getWorkbookBackgroundColor(n.highContrastScheme,t.BackgroundColor),u=function(e,t,n,o){for(var a={},l=[],s=[],d={},u=e.Cells,c=0;c<u.length;c++){var g=u[c],f=R(g);if((i.cellIntersectsRenderingRegion(g,o.renderingRegion)||(T=g,x=o.renderingRegion,w=void 0,b=void 0,w=T.Col===x.endColumn+1&&T.Row>=x.startRow&&T.Row<=x.endRow,b=T.Row===x.endRow+1&&T.Col>=x.startColumn&&T.Col<=x.endColumn,w||b))&&(f&&f.Borders&&0!==f.Borders.length))for(var p=f.Borders,C=0;C<p.length;C++){var y=p[C];if(y.BorderLineStyle!==r.BorderLineType.None&&S(y.BorderPosition,e,g)){if(y.BorderLineStyle===r.BorderLineType.Double){var v=g.CachedStyle.BackgroundColor?i.hexToRgb(g.CachedStyle.BackgroundColor):n,F=h(y.BorderPosition,v);m(e,g,F,t,s,d)}m(e,g,y,t,l,a)}}}var T,x,w,b;return{distinctBorderTypes:l,borderTypeToLineMap:a,distinctClearingDoubleBorderTypes:s,clearingDoubleBordersToLineMap:d}}(t,s,i.hexToRgb(d),n);n.highContrastScheme?(a=i.rgbToColorHex(n.highContrastScheme.TextColor),o=i.rgbToColorHex(n.highContrastScheme.BackgroundColor),p(e,u.distinctBorderTypes,u.borderTypeToLineMap,s,a),p(e,u.distinctClearingDoubleBorderTypes,u.clearingDoubleBordersToLineMap,s,o)):(p(e,u.distinctBorderTypes,u.borderTypeToLineMap,s,void 0),p(e,u.distinctClearingDoubleBorderTypes,u.clearingDoubleBordersToLineMap,s,void 0))},t.getBorderPriorityByLineStyle=function(e){switch(e){case r.BorderLineType.Thick:return 1;case r.BorderLineType.Medium:return 2;case r.BorderLineType.MediumDashed:return 3;case r.BorderLineType.MediumDashDot:return 4;case r.BorderLineType.Thin:return 5;case r.BorderLineType.Dashed:return 6;case r.BorderLineType.Dotted:return 7;case r.BorderLineType.DashDot:return 9;case r.BorderLineType.DashDotDot:return 10;case r.BorderLineType.Hair:return 11;case r.BorderLineType.Double:default:return 12}},t.cellHasBottomDoubleBorder=function(e,t){l.verifyArgumentNotNull(e,"cell","cellHasBottomDoubleBorder");var n=l.getCell(e.Row+1,e.Col,t);if(o.isNullOrUndefined(n)||o.isNullOrUndefined(n.CachedBorderStyle)||o.isNullOrUndefined(n.CachedBorderStyle.Borders))return!1;for(var i=n.CachedBorderStyle.Borders,a=0;a<i.length;a++){var s=i[a];if(s.BorderPosition===r.BorderPositionType.Top&&s.BorderLineStyle===r.BorderLineType.Double)return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(3),a=n(1),l=n(25),s=n(4),d=n(7),u=n(5),c=n(28);function g(e,t,n){var r=i.getWorkbookBackgroundColor(t.highContrastScheme,n);e.strokeStyle=r,e.lineWidth=u.GridLineWidthPx,e.setLineDash(u.DefaultDash)}function f(e,t,n,r,i){var o=e.Col,s=e.Col,c=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(s+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(s=c.length-1)):e.Spill&&(o-=e.Spill.SpanToStart,s+=e.Spill.SpanToEnd),o=Math.max(0,o),s=Math.min(n.ColumnNumbers.length,s);for(var g=d.getCellHeightAdjustedForDrawing(n,e),f=d.getCellTopAdjustedForDrawing(n,e),h=g-u.GridLineWidthPx,m=o;m<s;m++){var p=l.getAdjustedDrawingOffset(c[m],a.getColWidthFromOffsets(m,c),r,i);a.drawLine(t,p,f,p,f+h)}}function h(e,t,n,r,i){var o=e.Row,s=e.Row+e.Merge.Rows,c=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;o=Math.max(0,o),s=Math.min(n.RowNumbers.length,s),e.Merge.SpansNextBlockVertically&&(s=c.length-1);for(var g=d.getCellLeftAdjustedForDrawing(n,e,n.IsRtl),f=d.getCellWidthAdjustedForDrawing(n,e)-u.GridLineWidthPx,h=o;h<s;h++){var m=l.getAdjustedDrawingOffset(c[h],a.getRowHeightFromOffsets(h,c),r,i);a.drawLine(t,g,m,g+f,m)}}t.clearGridLinesForSpannedCells=function(e,t,n){if(i.verifyArgumentNotNull(t,"model","clearGridLinesForText"),i.verifyArgumentNotNull(t.Cells,"model.Cells","clearGridLinesForText"),i.verifyArgumentNotNull(e,"ctx","clearGridLinesForText"),i.verifyArgumentNotNull(n,"context","clearGridLinesForText"),t.ShowGridLines&&a.shouldRenderGridLines(i.isHighContrastMode(n),i.hasWorkbookBackgroundColor(t.BackgroundColor))){var r=t.Cells,o=i.getLinePixelTranslation(u.GridLineWidthPx),c=l.getMaxLineOffset(t.BlockWidth,n.devicePixelRatio,!1),m=l.getMaxLineOffset(t.BlockHeight,n.devicePixelRatio,!0);g(e,n,t.BackgroundColor),e.beginPath();for(var p=0;p<r.length;p++){var C=r[p],y=!s.isNullOrUndefined(C)&&!s.isNullOrUndefined(C.Spill),v=!s.isNullOrUndefined(C)&&!s.isNullOrUndefined(C.Merge)&&(s.isNullOrUndefined(C.CachedStyle.BackgroundColor)||!s.isNullOrUndefined(n.highContrastScheme));a.cellIntersectsRenderingRegion(C,n.renderingRegion)&&((y||v)&&(f(C,e,t,o,c),v&&d.isCellSpansMultipleRowsOrBlocks(C)&&h(C,e,t,o,m)))}e.stroke()}},t.setContextForClearingGridLine=g,t.clearGridLinesForPivotTables=function(e,t,n){if(i.verifyArgumentNotNull(t,"model","clearGridLinesForEmptyPivotTables"),i.verifyArgumentNotNull(e,"ctx","clearGridLinesForEmptyPivotTables"),i.verifyArgumentNotNull(n,"context","clearGridLinesForEmptyPivotTables"),t.ShowGridLines&&a.shouldRenderGridLines(i.isHighContrastMode(n),i.hasWorkbookBackgroundColor(t.BackgroundColor))&&t.PivotTables&&0!==t.PivotTables.length){for(var l=o.isRenderFlagEnabled(r.RenderFlags.PivotTable,t),d=!1,g=0;g<t.PivotTables.length;g++){var f=t.PivotTables[g];if((l||f.IsEmptyPivot)&&(f.HideGridLines&&(f.IsEmptyPivot||!s.isNullOrUndefined(f.RowHeaderRange))&&c.isPivotIntersectsRenderingRegion(t,f,n.renderingRegion,!0))){d||(e.fillStyle=i.getWorkbookBackgroundColor(n.highContrastScheme,t.BackgroundColor),e.beginPath(),d=!0);var h=c.getPivotTableLeftAdjustedForDrawing(t,f,t.IsRtl),m=c.getPivotTableTopAdjustedForDrawing(t,f,!0),p=l?f.OriginPTWidthAdjustedForDrawing-u.GridLineWidthPx:f.OriginPTWidthAdjustedForDrawing,C=f.OriginPTHeightAdjustedForDrawing;e.rect(h,m,p,C)}}d&&e.fill()}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(r=t.CombiningClass||(t.CombiningClass={}));var i=0|r.Control|r.CR|r.LF,o=0|r.L|r.V|r.LV|r.LVT,a=0|r.V|r.LV,l=0|r.V|r.T,s=0|r.LVT|r.T;function d(e,t){return 0!=(e&t)}t.shouldBreak=function(e,t){return(e!==r.CR||t!==r.LF)&&(!!d(i,e)||(!!d(i,t)||(e!==r.L||!d(o,t))&&((!d(a,e)||!d(l,t))&&((!d(s,e)||t!==r.T)&&((e!==r.Regional_Indicator||t!==r.Regional_Indicator)&&(t!==r.Extend&&t!==r.ZWJ&&(t!==r.SpacingMark&&e!==r.Prepend)))))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.getVerticalTextPadding=function(e){return r.getIndentationPaddingPx(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(19),o=n(8),a=n(38),l=n(13),s=n(7),d=n(6);t.drawTextLine=function(e,t,n,r,l,s,d,u,c,g,f,h,m){g?i.fillRichTextFormat(e,t,n,r,g,d,u,f,h,m):o.isVerticalTextPresentSlice2(n,r)?a.fillVerticalText(e,n,r,s,d,u,t.devicePixelRatio,f,c):l?e.fillText(s,d,u):e.fillText(s,d,u,c)},t.adjustOrderingOfLinesForVerticalText=function(e,t,n){var i;(null===(i=e.CachedStyle)||void 0===i?void 0:i.ReadingOrder)!==r.ReadingOrderType.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())},t.getOffsetXForVerticalText=function(e,t,n,i,a){return function(e,t,n,i,o){switch(l.getEffectiveHorizontalAlignment(e,t)){case r.HorizontalAlignment.Right:return n-i*(o-1);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return n-i*(o-1)/2;default:case r.HorizontalAlignment.Left:return n}}(e,t,function(e,t,n,i){var a;if(1===i&&o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(e,t)){var l=d.getCellTextHorizontalPadding(t,e);switch(null===(a=t.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment){case r.HorizontalAlignment.Distributed:return d.getCellTextCenterX(e,t);case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:return s.getCellLeft(e,t,e.BlockWidth)+l}}return n}(e,t,n,a),i,a)},t.getSpaceWidthBetweenLines=function(e,t,n,r,i){if(!o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(e,t)||1===r)return 0;var a=n,l=s.getCellRight(e,t,e.BlockWidth)-d.getCellTextHorizontalPadding(t,e)-a-i*(r-1);return l<0?0:l/(r-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),o=n(3),a=n(8),l=n(0),s=n(6);function d(e,t,n){if(l.verifyArgumentNotNull(n,"cell","spillCell.updateCellSpill"),l.verifyArgumentNotNull(t,"model","spillCell.updateCellSpill"),!(!n.Text||n.WrapText||n.Merge||l.cellHasShrinkToFit(n)||o.isRenderFlagEnabled(i.RenderFlags.NumFmtAccountingAndCustom,t)&&n.ValueType===i.CellValueType.Number||a.isVerticalTextPresent(t,n))){e.font=l.getFontCssStringFromCell(n,t);var d=s.getTextWidth(e,t,n),c=u(n,t,d,r.End),h=u(n,t,d,r.Start),m=c.isSpillingOutsideOfBlock||h.isSpillingOutsideOfBlock,p=o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,t)&&(c.isBlockedByCellContent||h.isBlockedByCellContent);if(0!==c.spilledOverCellsCount||0!==h.spilledOverCellsCount){var C=g(n,t,r.Start),y=g(n,t,r.End),v=f(C,n,t,r.Start),F=f(y,n,t,r.End);n.Spill={SpanToStart:Math.min(h.spilledOverCellsCount,v),SpanToEnd:Math.min(c.spilledOverCellsCount,F),IsSpillBlocked:m||h.spilledOverCellsCount>v||c.spilledOverCellsCount>F}}else(m||p)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0})}}function u(e,t,n,r){var o=l.getCellStyle(e,t);l.verifyArgumentNotNull(o,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");var a=o.HorizontalAlignment,d=C(t,e,a,r);return d?function(e,t,n,r,o){var a=e.Col,d=function(e,t,n,r,o){var a=l.getColumnWidth(t.Col,e),d=s.getCellTextHorizontalPadding(t,e)+n-a;if(d<=0)return 0;if(r===i.HorizontalAlignment.Center)return d/2;var u=e.IsRtl;if(!p(r,o,u))return 0;return d}(t,e,n,r,o),u=0,g=!1;if(0===d)return{spilledOverCellsCount:u,isSpillingOutsideOfBlock:g,isBlockedByCellContent:!1};var f=t.ColumnNumbers.length;a+=o;for(;c(a,f)&&d>0;)u++,d-=l.getColumnWidth(a,t),a+=o;return g=!c(a,f)&&d>0,{spilledOverCellsCount:u,isSpillingOutsideOfBlock:g,isBlockedByCellContent:!1}}(e,t,n,a,r):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!d}}function c(e,t){return e>=0&&e<t}function g(e,t,n){for(var r=e.Row,i=e.Col+n;c(i,t.ColumnNumbers.length);){var o=l.getCell(r,i,t);if(o&&h(o))return o;i+=n}return null}function f(e,t,n,i){return e?Math.abs(e.Col-t.Col)-1:i===r.End?n.ColumnNumbers.length-t.Col:t.Col}function h(e){var t;return!(!e||!e.Text&&!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula))}function m(e,t,n,i,o){var a=f(t,n,i,o);if(t&&t.Spill){var s=l.getCellStyle(t,i);l.verifyArgumentNotNull(s,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");var u=s.HorizontalAlignment,c=-o;if(C(i,t,u,c)&&p(u,c,i.IsRtl))if(n&&n.Text){var g=o===r.End?t.Spill.SpanToStart:t.Spill.SpanToEnd;t.Spill.IsSpillBlocked=a<=g,o===r.End?t.Spill.SpanToStart=Math.min(g,a):t.Spill.SpanToEnd=Math.min(g,a)}else d(e,i,n)}return a}function p(e,t,n){return e===i.HorizontalAlignment.Center||(t===r.Start?n?e===i.HorizontalAlignment.Left:e===i.HorizontalAlignment.Right:t===r.End&&(e===i.HorizontalAlignment.Automatic||(n?e===i.HorizontalAlignment.Right:e===i.HorizontalAlignment.Left)))}function C(e,t,n,a){var l;return!o.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||a!==r.Start&&n!==i.HorizontalAlignment.Center||!(null===(l=t.LinkedEntity)||void 0===l?void 0:l.IconWidth)}t.updateCellSpill=d,t.updateClosestNonEmptyCellsSpill=function(e,t,n){var i=g(t,n,r.Start),o=g(t,n,r.End);m(e,i,t,n,r.Start),m(e,o,t,n,r.End)},function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.drawTriangle=function(e,t,n,i,o){r.verifyArgumentNotNull(e,"ctx","drawTriangle"),r.verifyArgumentNotNull(t,"model","drawTriangle"),r.verifyArgumentNotNull(n,"cell","drawTriangle"),r.verifyArgumentNotNull(i,"drawingContext","drawTriangle");var a=i.innerColor,l=i.outerColor,s=i.left,d=i.bottom,u=i.height,c=i.width,g=s+c/2,f=o?d+u:d-u;e.strokeStyle=l,e.beginPath(),e.moveTo(s,d),e.lineTo(s+c,d),e.lineTo(g,f),e.closePath(),a&&(e.fillStyle=a,e.fill()),l&&(e.strokeStyle=l,e.stroke())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(17),a=n(14),l=n(21),s=n(31),d=n(1),u=n(10);function c(e,t,n,r,i,a,l,s,d){var u={left:r,bottom:i,outerColor:d,height:a,width:l,innerColor:s};o.drawRectangle(e,t,n,u)}t.drawSymbols=function(e,t,n,g){r.verifyArgumentNotNull(e,"ctx","drawSymbols"),r.verifyArgumentNotNull(t,"model","drawSymbols"),r.verifyArgumentNotNull(n,"cell","drawSymbols"),r.verifyArgumentNotNull(g,"drawingContext","drawSymbols");var f=g.image,h=g.highContrastScheme,m=function(e,t){if(t)return d.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case i.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case i.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case i.CFIconImage.CircleSymbolHigh:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = "+e)}}(f,h),p=function(e,t){if(t)return d.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = "+e)}}(f,h);switch(f){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:!function(e,t,n,r){var o,a=t.size,s=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolHigh:var g=s+u.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=e+i.CheckMarkMiddleXRatio*n,a={x:e+i.CheckMarkTopLeftXRatio*n,y:i.CheckMarkTopLeftYRatio*n+r},l={x:e+i.CheckMarkTopMiddleXRatio*n,y:i.CheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CheckMarkBottomYRatio*n+r},d={x:e+n,y:i.CheckMarkMiddleRightYRatio*n+r},u={x:e+i.CheckMarkTopRightXRatio*n,y:i.CheckMarkTopRightYRatio*n+r},c={x:o,y:i.CheckMarkMiddleYRatio*n+r};return[a,l,s,d,u,c,a]}(g,d,a);break;case i.CFIconImage.CircleSymbolHigh:o=function(e,t,n){var r=t-n,o=e+i.CircledCheckMarkMiddleXRatio*n,a={x:e+i.CircledCheckMarkTopLeftXRatio*n,y:i.CircledCheckMarkTopLeftYRatio*n+r},l={x:e+i.CircledCheckMarkTopMiddleXRatio*n,y:i.CircledCheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CircledCheckMarkBottomYRatio*n+r},d={x:e+i.CircledCheckMarkMiddleRightXRatio*n,y:i.CircledCheckMarkMiddleRightYRatio*n+r},u={x:e+i.CircledCheckMarkTopRightXRatio*n,y:i.CircledCheckMarkTopRightYRatio*n+r},c={x:o,y:i.CircledCheckMarkMiddleYRatio*n+r};return[a,l,s,d,u,c,a]}(s,d,a);break;default:throw Error("drawCheckMark: unsupported image type = "+c)}l.drawIconFromPoints(e,n,r,o)}(e,g,m,p);break;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r,a,l){var d=r.image;switch(d){case i.CFIconImage.SymbolMedium:!function(e,t,n,r,a,l){var s=r.size,d=r.left,u=r.bottom,g=Math.floor(s*i.ExclamationMarkTopRectHeightSizeRatio),f=Math.floor(s*i.ExclamationMarkBottomRectHeightSizeRatio),h=Math.floor(s*i.ExclamationMarkWidthRectSizeRatio),m=g+Math.max(i.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(i.ExclamationMarkSpaceBetweenRectanglesRatio*s)),p=Math.floor(i.ExclamationMarkLeftRectanglePaddingRatio*s),C=d+p;c(e,t,n,C,u-(s-g),g,h,a,l),function(e,t,n,r,i,a,l,s,d,u,c){var g={left:r,bottom:i-(a-c-l),outerColor:u,height:l,width:s,innerColor:d};o.drawRectangle(e,t,n,g)}(e,t,n,C,u,s,f,h,a,l,m)}(e,t,n,r,a,l);break;case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r,o,a){var l=r.size,d=r.left,g=r.bottom,f=r.image,h=l-2*i.CircledExclamationMarkPaddingFromCircle,m=Math.floor(h*i.CircledExclamationMarkTopRectHeightSizeRatio),p=function(e){var t=Math.floor(e*i.CircledExclamationMarkWidthRectSizeRatio);return t%2==0?t-1:t}(m),C=d+l/2,y=Math.round(C-(p+1)/2),v=g-i.CircledExclamationMarkPaddingFromCircle,F=function(e){var t=Math.floor(e*i.CircledExclamationMarkLeftCircleSizeRatio);return t%2==0?t:t-1}(h),S=function(e,t,n){return e+u.ShapeLinesAdjustment-(t-n)/2}(y,F,p),T={image:f,bottom:v,highContrastScheme:void 0,left:S,size:F},x=Math.floor(g-i.CircledExclamationMarkPaddingFromCircle-(F+1));c(e,t,n,y,x,m,p,o,a),s.drawCircle(e,T,a,o)}(e,t,n,r,a,l);break;default:throw Error("drawExclamationMark: unsupported image type = "+d)}}(e,t,n,g,m,p);break;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:!function(e,t,n,r){var o,a=t.size,s=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolLow:var g=s+u.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=i.CrossMarkOuterSmallPaddingRatio*n,a=o+e,l=o+r,s=i.CrossMarkOuterBigPaddingRatio*n,d=s+e,u=s+r,c=i.CrossMarkInnerSmallPaddingRatio*n,g=c+e,f=c+r,h=i.CrossMarkInnerCenterRatio*n,m=h+e,p=h+r,C=i.CrossMarkInnerBigPaddingRatio*n,y={x:a,y:r};return[y,{x:e,y:l},{x:g,y:p},{x:e,y:u},{x:a,y:n+r},{x:m,y:C+r},{x:d,y:n+r},{x:e+n,y:u},{x:e+C,y:p},{x:e+n,y:l},{x:d,y:r},{x:m,y:f},y]}(g,d,a);break;case i.CFIconImage.CircleSymbolLow:o=function(e,t,n){var r=(S=n,S%2==1?S+1:S),o=t-n,a=i.CircledCrossMarkOuterSmallPaddingRatio*r,l=a+e,s=a+o,d=i.CircledCrossMarkOuterBigPaddingRatio*r,u=d+e,c=d+o,g=i.CircledCrossMarkInnerSmallPaddingRatio*r,f=g+e,h=g+o,m=i.CircledCrossMarkInnerCenterRatio*r,p=m+e,C=m+o,y=i.CircledCrossMarkInnerBigPaddingRatio*r,v=i.CircledCrossMarkPaddingFromCircleRatio*r,F={x:l,y:o+v};var S;return[F,{x:e+v,y:s},{x:f,y:C},{x:e+v,y:c},{x:l,y:r+o-v},{x:p,y:y+o},{x:u,y:r+o-v},{x:e+r-v,y:c},{x:e+y,y:C},{x:e+r-v,y:s},{x:u,y:o+v},{x:p,y:h},F]}(s,d,a);break;default:throw Error("drawCrossMark: unsupported image type = "+c)}l.drawIconFromPoints(e,n,r,o)}(e,g,m,p);break;default:throw Error("drawSymbols: unsupported image type = "+f)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(5);t.getClipRect=function(e,t,n,o,a){if(function(e,t,n,o,a){var l=r.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx;if(o>=l)return!0;var s=r.getCellTopAdjustedForDrawing(e,t);if(o-a<=s)return!0;var d=r.getCellLeftAdjustedForDrawing(e,t,!1);if(n<=d)return!0;var u=r.getCellRightAdjustedForDrawing(e,t)-i.GridLineWidthPx;if(n+a>=u)return!0;return!1}(e,t,n,o,a))return{x:r.getCellLeftAdjustedForDrawing(e,t,!1),y:r.getCellTopAdjustedForDrawing(e,t),width:r.getCellWidthAdjustedForDrawing(e,t)-i.GridLineWidthPx,height:r.getCellHeightAdjustedForDrawing(e,t)-i.GridLineWidthPx}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(4),o=n(1);t.setPageLayoutLine=function(e,t){e.lineWidth=r.GridLineWidthPx,e.setLineDash(r.DefaultDash),e.strokeStyle=i.isNullOrUndefined(t.highContrastScheme)?r.PageLayoutLineColor:""+o.rgbToColorHex(t.highContrastScheme.TextColor)}},function(e,t,n){"use strict";var r=function(){function e(e,t,n,r,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.elementsMargin=r?"margin-left: 8px;":"margin-right: 8px;",this.toastElement=this.createToastContainer(t,n,i),e.appendChild(this.toastElement)}return e.prototype.setVisibility=function(e){this.toastElement.style.visibility=e?"visible":"hidden"},e.prototype.dispose=function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)},e.prototype.createToastContainer=function(e,t,n){var r=document.createElement("div");return r.id="UnavailabilityToast",r.setAttribute("role","alert"),r.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;'),r.appendChild(this.createToastIcon(n)),r.appendChild(this.createToastTitle(e)),r.appendChild(this.createToastText(t)),r},e.prototype.createToastIcon=function(e){var t=document.createElement("span");t.id="UnavailabilityToastIcon";var n=null!=e?e:this.OpenWorkbookIcon;return t.setAttribute("style",'display: inline-block;\n      height: 20px;\n      width: 20px;\n      background-repeat: no-repeat;\n      background-image: url("data:image/svg+xml;charset=utf8,'+n+'");'+this.elementsMargin),t},e.prototype.createToastTitle=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t},e.prototype.createToastText=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t},e}(),i=function(){function e(){}return e.createInstance=function(e,t,n,i,o){return new r(e,t,n,i,o)},e}();n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.GridBlockRendererFactoryGlobal=new r.GridBlockRendererFactory},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,d=[],u=!1,c=-1;function g(){u&&s&&(u=!1,s.length?d=s.concat(d):c=-1,d.length&&f())}function f(){if(!u){var e=l(g);u=!0;for(var t=d.length;t;){for(s=d,d=[];++c<t;)s&&s[c].run();c=-1,t=d.length}s=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new h(e,t)),1!==d.length||u||l(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumFmtAccountingStartIndex=32,t.MaxBitsPerRenderFlag=32},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalAlignmentFontSizeAdjusted=function(e){return 2*e/3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(1),o=n(0);function a(e,t,n,r,i){var o=Math.min(r/4,16),a=Math.min(i/4,8),l=t+r/2-o/2,s=n+i/2-a/2;e.fillRect(l,s,o,a)}t.drawSkeleton=function(e,t,n){o.verifyArgumentNotNull(e,"ctx","drawSkeleton"),o.verifyArgumentNotNull(t,"model","drawSkeleton"),o.verifyArgumentNotNull(n,"context","drawSkeleton");var l=t.ClientOnlyCache;if(o.verifyArgumentNotNull(l,"ClientOnlyCache","drawSkeleton"),o.verifyArgumentNotNull(l.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(l.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(t.RowHeights,"RowHeights","drawSkeleton"),o.verifyArgumentNotNull(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(n.devicePixelRatio<r.MinimalDprForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=r.SkeletonColor;for(var s=0;s<l.RowOffsetsAdjustedForDrawing.length-1;s++)for(var d=l.RowOffsetsAdjustedForDrawing[s],u=i.getRowHeightFromOffsets(s,l.RowOffsetsAdjustedForDrawing),c=0;c<l.ColOffsetsAdjustedForDrawing.length-1;c++){a(e,i.getColOffsetsAdjustedForDrawing(c,t),d,i.getColWidthFromOffsets(c,l.ColOffsetsAdjustedForDrawing),u)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addWatermark=function(e,t){e.beginPath(),e.strokeStyle=t.modelFromCache?"blue":"red",e.lineWidth=1,e.setLineDash([]);var n=1*t.devicePixelRatio,r=5*t.devicePixelRatio;e.rect(n,n,r,r),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45);t.isCanvasElement=function(e){return e instanceof r.RenderingCanvasElement}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(46),a=n(5),l=n(72),s=n(0),d=n(73),u=n(3),c=n(6),g=n(7),f=n(79),h=n(13),m=n(80),p=n(33),C=n(39),y=n(8),v=n(11);function F(e,t,n,F,T,x,w){var b,A=c.getTextHorizontalPosition(n,F),R=c.getTextVerticalPosition(F,n,c.getTextLineHeight(F,n),w,null===(b=F.CachedStyle)||void 0===b?void 0:b.VerticalAlignment,void 0);!function(e,t,n,o,l){var d=h.getTextAlignment(o,n);t.textAlign!==d&&(t.textAlign=d,e.textAlign=d);var u=p.DefaultTextBaseline;u!==t.textBaseline&&(e.textBaseline=u,t.textBaseline=u);var c=s.getFontCssStringFromCell(n,o);t.fontProperties===c&&e.font===c||(t.fontProperties=c,e.font=c);var g=function(e,t){if(t)return i.getHighContrastTextColor(e,t);if(e.HasError)return a.FormulaErrorFontColor;return e.CachedFont.Color}(n,l);t.fontColor!==g&&(t.fontColor=g,e.fillStyle=g);var f=function(e,t){switch(e){case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.Context:return S(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(n.CachedStyle.ReadingOrder,o.IsRtl);f!==t.direction&&(t.direction=f,e.direction=f)}(e,T,F,n,t.highContrastScheme);var I=g.getCellWidth(n,F,!1),M=c.getDistanceFromCellStartToIconEnd(n,F),D=i.getTextDrawingMaxWidth(I,c.getCellTextHorizontalPaddingWithoutVisualElements(n,F),M,u.isRenderFlagEnabled(r.RenderFlags.PivotTable,n)?v.getExpandCollapseButtonPadding(n,F):0);if(u.doesNumFmtOverrideText(F,n)){var P=D;f.updateNumberFormattingInformation(e,n,F,P)}var L=m.isHorizontalAlignmentFillInCell(n,F);m.isHorizontalAlignmentFillInCell(n,F)&&m.updateCachedDisplayTextForFill(e,n,F);var O=s.getDisplayText(F,n),k=s.getFormattedText(O,F,n);if(F.WrapText&&function(e,t){var n;if(y.isVerticalTextPresentSlice2(e,t))return!0;if(h.isHorizontalAlignmentJustifiedAndDistributed(e,t)||C.isVerticalAlignmentJustifyOrDistributed(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalAlignment))return!(t.CachedIsTextWidthExceedsCellWidth&&t.ValueType===r.CellValueType.Number);return!(t.ValueType===r.CellValueType.Number)}(n,F)&&!L){var N=g.getCellLeft(n,F,n.BlockWidth),B=i.getContainerClipMaskWidth(I),E=g.isCellSpansMultipleRowsOrBlocks(F);d.drawWrapText(e,t,n,F,O,A,D,N,B,x,w,E,c.getTextLineHeight(F,n),k)}else if(F.Merge)!function(e,t,n,r,i,a,l,s,d,u,f){if(r.Merge.Rows>0||i||c.getTextWidth(e,n,r)>=u||y.isVerticalTextPresentSlice2(n,r)){var h=g.getCellLeft(n,r,n.BlockWidth),p=g.getCellTop(n,r),C=g.getCellHeight(n,r,!1),v=c.getCellTextClipMask(n,h,p,l,C,f);o.fillTextClipped(e,t,a,s,d,v,r,n,m.isHorizontalAlignmentFillInCell(n,r),i)}else o.fillTextUnclipped(e,a,s,d,u,r,n,t.devicePixelRatio)}(e,t,n,F,k,O,I,A,R,D,M);else if(F.Spill)l.drawSpillCellText(e,t,n,F,O,A,R,x,w,L,M,k);else if(k||L||h.isHorizontalAlignmentCenteredAcrossSelection(n,F)||y.isVerticalTextPresent(n,F)){N=g.getCellLeft(n,F,n.BlockWidth);var H=g.getCellTop(n,F),W=c.getCellTextClipMask(n,N,H,I,w,M);o.fillTextClipped(e,t,O,A,R,W,F,n,L,k)}else o.fillTextUnclipped(e,O,A,R,D,F,n,t.devicePixelRatio)}function S(e){return e?"rtl":"ltr"}function T(e,t,n,r){return i.restoreClipping(n,r),x(e,t)}function x(e,t){return{fontColor:e?i.rgbToColorHex(e.TextColor):a.DefaultCellFontColor,fontProperties:"",direction:S(t),textBaseline:"bottom",textAlign:"start"}}t.drawCellsText=function(e,t,n){var o,l,d,c;s.verifyArgumentNotNull(e,"ctx","drawCellsText"),s.verifyArgumentNotNull(t,"model","drawCellsText"),s.verifyArgumentNotNull(n,"context","drawCellsText"),s.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawCellsText"),s.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),s.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawCellsText"),s.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),s.verifyArgumentNotNull(t.Cells,"model.Cells","drawCellsText"),s.verifyArgumentNotNull(t.Styles,"model.Styles","drawCellsText");for(var f=t.Cells,h=t.BlockWidth,m=[],p=function(e,t,n){var r=x(t,n.IsRtl);return e.direction=r.direction,e.fillStyle=r.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){e.getLineDash()!==[]&&e.setLineDash([])}(e),r}(e,n.highContrastScheme,t),C=void 0,y=-1,v=0;v<f.length;v++){if((b=f[v])&&b.Text&&((!u.isRenderFlagEnabled(r.RenderFlags.RichValueIcon,t)||0!==b.ShrunkSize&&0!==(null===(o=b.CachedFont)||void 0===o?void 0:o.Size))&&i.cellIntersectsRenderingRegion(b,n.renderingRegion)&&!(b.CondFormat&&(null===(l=b.CondFormat)||void 0===l?void 0:l.Icon)&&(null===(c=null===(d=b.CondFormat)||void 0===d?void 0:d.Icon)||void 0===c?void 0:c.IconOnly)))){var S=t.RowHeights[b.Row]-a.GridLineWidthPx,w=t.RowOffsets[b.Row];b.Row!==y&&(-1!==y&&(p=T(n.highContrastScheme,t.IsRtl,e,C)),C={x:0,y:w,width:h,height:S},i.applyClipping(e,C),y=b.Row),g.isCellSpansMultipleRowsOrBlocks(b)?m.push(b):F(e,n,t,b,p,w,S)}}for(i.restoreClipping(e,C),p=x(n.highContrastScheme,t.IsRtl),v=0;v<m.length;v++){var b=m[v],A=g.getCellHeight(t,b,!1)-a.GridLineWidthPx;F(e,n,t,b,p,g.getCellTop(t,b),A)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51);t.classifyChar=function(e){return 8205===e?r.CombiningClass.ZWJ:13===e?r.CombiningClass.CR:10===e?r.CombiningClass.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?r.CombiningClass.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?r.CombiningClass.Extend:function(e){return 127462<=e&&e<=127487}(e)?r.CombiningClass.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?r.CombiningClass.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?r.CombiningClass.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?r.CombiningClass.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?r.CombiningClass.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?r.CombiningClass.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?r.CombiningClass.LV:r.CombiningClass.Other}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(1);t.reorderTextTokensUsingDom=function(e,t,n,o){for(var a=i.getReOrderDiv(n,o),l=0;l<e.textLines.length;l++){var s=e.textLines[l],d=e.tokensPerLine[l],u=r.analyzeBidiText(s.text,t);if(n.HasBidi)if(u.HasRtl&&!u.HasLtr)d.tokens.reverse();else{(h=document.createElement("div")).setAttribute("textLineId",l.toString());for(var c=0;c<d.tokens.length;c++){var g=d.tokens[c].text;(v=document.createElement("span")).innerText=g,v.setAttribute("textTokenId",c.toString()),h.appendChild(v)}a.appendChild(h)}}document.body.appendChild(a);for(var f=0;f<a.children.length;f++){var h,m=(h=a.children[f]).getAttribute("textLineId");if(!m)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");for(var p=parseInt(m,10),C=e.tokensPerLine[p].tokens,y=0;y<h.children.length;y++){var v,F=(v=h.children[y]).getAttribute("textTokenId");if(!F)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");var S=v.getBoundingClientRect().left;C[c=parseInt(F,10)].OffsetX=S}C.sort((function(e,t){return e.OffsetX-t.OffsetX}))}document.body.removeChild(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(46),a=n(0),l=n(6),s=n(3),d=n(7),u=n(11);t.drawSpillCellText=function(e,t,n,c,g,f,h,m,p,C,y,v){var F;a.verifyArgumentNotNull(c.Spill,"cell.Spill","spillCells.drawSpillCellText");var S=d.getSpillCellWidth(c,n),T=s.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentFillAndCAS,n)&&(null===(F=c.CachedStyle)||void 0===F?void 0:F.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection;if(c.Spill.IsSpillBlocked||v||T){var x=s.isRenderFlagEnabled(r.RenderFlags.RichValueIcon,n)?y:0,w=s.isRenderFlagEnabled(r.RenderFlags.PivotTable,n)?u.getExpandCollapseButtonPadding(n,c):0,b=i.getClipMaskWidth(S,x,w),A={x:d.getSpillCellStartOffset(c,n,x,w),y:m,width:b,height:p};o.fillTextClipped(e,t,g,f,h,A,c,n,C,v)}else{var R=s.isRenderFlagEnabled(r.RenderFlags.RichValueIcon,n)?l.getCellTextHorizontalPaddingWithoutVisualElements(n,c):l.getCellTextHorizontalPadding(c,n),I=s.isRenderFlagEnabled(r.RenderFlags.RichValueIcon,n)?y:l.getDistanceFromCellStartToIconEnd(n,c),M=i.getTextDrawingMaxWidth(S,R,I,s.isRenderFlagEnabled(r.RenderFlags.PivotTable,n)?u.getExpandCollapseButtonPadding(n,c):0);o.fillTextUnclipped(e,g,f,h,M,c,n,t.devicePixelRatio)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(24),o=n(2),a=n(3),l=n(6),s=n(22),d=n(19),u=n(74),c=n(78),g=n(37),f=n(5),h=n(4),m=n(53),p=n(13),C=n(39),y=n(8),v=n(52);function F(e,t,n,r,i,o,a,l){var s=l?e+t-n-r:e-n;return a&&(s=C.getAdvancedVerticalAlignmentOffsetYForWrapText(s,i,o)),s}function S(e,t,n,r){return e&&!t.HasRtl?0===n:n===r-1}t.drawWrapText=function(e,t,n,T,x,w,b,A,R,I,M,D,P,L){var O,k,N,B,E=y.isVerticalTextPresentSlice2(n,T),H=y.isVerticalTextPresentSlice3(n,T),W=E?r.getTextDrawingMaxHeight(M,v.getVerticalTextPadding(null===(O=T.CachedStyle)||void 0===O?void 0:O.Indentation)):M;if(!(b<=0||W<=0)){var z=H?P:e.measureText(f.Whitespace).width,j=T.WrapText,_=function(e,t){var n,r;if(y.isVerticalTextPresentSlice3(e,t))return function(e){switch(e){case o.VerticalAlignment.Justify:return i.BreakType.Justify;case o.VerticalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalAlignment);if(a.isRenderFlagEnabled(o.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,e))return function(e){switch(e){case o.HorizontalAlignment.Justify:return i.BreakType.Justify;case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment);return i.BreakType.Wrap}(n,T),V=(E?W:b)-l.getWrapTextAdditionalPadding(n,T);_===i.BreakType.Distributed&&(V-=l.getIndentationPaddingPx(T.CachedStyle.Indentation||0));var U=u.breakTextToLines(e,x,V,_,z,n,T,L,j),G=l.getBidiContext(T);E&&m.adjustOrderingOfLinesForVerticalText(T,U,G);var Y=U.textLines,X=function(e,t,n,r){var i=[],o=[],a=[];o=[0],a=[0];var s=0;if(n)for(var u=0;u<t.length;u++){var c=t.length-1-u,g=t[c],f=d.substringFormattedText(n,g.startIndex,g.endIndex);i[u]=f;var h=l.getFormattedTextLineFontMetrics(e,f);a[u]=h.baseline;var m=l.getFormattedTextLineHeight(e,f);o[u+1]=o[u]+m,s+=m}else o=function(e,t){for(var n=[],r=0;r<e;r++)n.push(r*t);return n}(t.length,r),s=r*t.length;return{rowsBottomY:o,rowsAlphabeticY:a,textHeight:s,formattedLines:i}}(n,Y,L,P),J=X.rowsBottomY,q=X.rowsAlphabeticY,Q=X.textHeight,K=X.formattedLines,Z=U.requireClipping||D||function(e,t,n,r){return e&&t<n*r}(E,R,P,Y.length),$={x:A,y:I,width:R,height:M},ee=void 0;Z&&(ee=$);var te=e.textAlign,ne=e.textBaseline,re=!1;p.isHorizontalAlignmentJustifiedAndDistributed(n,T)&&!E&&(e.textAlign="left",e.textBaseline="alphabetic",re=!0,G.HasRtl&&g.reorderTextTokens(U,null===(k=T.CachedStyle)||void 0===k?void 0:k.ReadingOrder,G,V));var ie=H?null===(N=T.CachedStyle)||void 0===N?void 0:N.VerticalAlignment:C.getEffectiveVerticalAlignment(null===(B=T.CachedStyle)||void 0===B?void 0:B.VerticalAlignment,C.AdvVerticalAlignmentFormat.WrapText,M,Q,P,Y.length),oe=H?y.isVerticalAlignmentJustifiedOrDistributedForVerticalText(n,T):C.isVerticalAlignmentJustifyOrDistributed(ie),ae=oe&&Y.length>1&&!H?C.getAdvancedVerticalAlignmentLineGapHeightForWraptext(M,Q,Y.length):0;!function(e,t){t&&r.applyClipping(e,t)}(e,ee);var le=q[0],se=l.getTextVerticalPosition(T,n,Q,M,ie,le),de=t.devicePixelRatio,ue=E?m.getOffsetXForVerticalText(n,T,w,P,Y.length):w,ce=0;y.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(n,T)&&(ce=m.getSpaceWidthBetweenLines(n,T,ue,Y.length,P));for(var ge=function(e,t,n,r,i){var o;if(e)return l.getTextVerticalPosition(t,n,r,i,null===(o=t.CachedStyle)||void 0===o?void 0:o.VerticalAlignment,void 0);return 0}(E,T,n,P,M),fe=0;fe<Y.length;fe++){var he=Y.length-1-fe,me=Y[he],pe=me.text;E&&fe>0&&(ue+=P+ce);var Ce=E?ge:F(se,le,J[fe],q[fe],ae,fe,oe,!h.isNullOrUndefined(L));if(_===i.BreakType.Wrap)m.drawTextLine(e,t,n,T,Z,pe,ue,Ce,b,K[fe],$),L||E||s.cacheTextDecorationLayout(n,T,{textPositionX:ue,textPositionY:Ce,dpr:de,textWidth:me.underlineWidth,clipRect:$},T.CachedFont);else{var ye={breakType:_,singleSpaceWidth:z,maxWidth:V,isProcessingLastLine:S(H,G,he,Y.length),isCompleteTextVisible:Q<M,lineDirection:H?i.LineDirection.Vertical:i.LineDirection.Horizontal};c.drawJustifyOrDistributedTextLine(e,t,n,T,U,he,ue,ye,Z,Ce,V,K[fe],$,pe,Ce,!h.isNullOrUndefined(L))}}re&&(e.textAlign=te,e.textBaseline=ne),function(e,t){r.restoreClipping(e,t)}(e,ee)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),i=n(0),o=n(75),a=n(76),l=n(5),s=n(19),d=n(30),u=n(24),c=n(6),g=n(8);function f(e,t){(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth)&&(M(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width);e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function h(e,t,n,r,i,l){if(t.type!==o.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),M(e));for(var d=l?s.substringFormattedText(l,t.start,t.start+t.len):void 0,u=e.isVerticalText?a.breakWideWordVerticalText(t.value,e.maxWidth,e.textLineHeight):a.breakWideWord(r,t.value,e.maxWidth,i,d),c=t.start,g=0;g<u.length-1;g++){var f=u[g],h={text:f.value,width:f.size,underlineWidth:f.size,startIndex:c,endIndex:c+f.value.length};if(c+=f.value.length,e.textLines.push(h),e.isBreakTypeJustifyOrDistributed){var m=P(f.value);e.tokensPerLine.push({tokens:[{text:f.value,width:f.size,start:c,containsThaiCharacters:m}],containsThaiCharacters:m}),L(e,m)}e.isSingleCharTooWide=b(h.width,h.text.length,e.maxWidth,e.isSingleCharTooWide)}var p,C,v,F,S,T=(C=t,v=(p=u)[p.length-1],F=C.start+C.len-v.value.length,S=v.size,{start:F,len:v.value.length,value:v.value,type:o.BreakOpTokenType.Word,width:S});e.lastFittingToken=T,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(T),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else y(e,t,n)}function m(e,t,n){void 0!==e.lastFittingToken&&M(e);var r=function(e){switch(e.type){case o.BreakOpTokenType.HardBreak:return e.len;case o.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&r--;for(var i=0;i<r;i++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.textLines.push(p(i,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function p(e,t){var n=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:n+function(e){return e.type===o.BreakOpTokenType.HardBreakCRLF?l.HardBreakCRLF.length:l.HardBreak.length}(t)}}function C(e,t,n){if(R(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){if(w(e.tokens,n),!S(e,n))return!1;return n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||x(e,t,n)}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||x(e,t,n)?y(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):T(e,t)}function y(e,t,n){R(t);var r=t.width/t.len,i=e.maxWidth-e.curLineWidth;if(!(i<0)){var o=Math.floor(i/r);t.width=r*o,e.curLineWidth+=t.width,e.lastFittingToken=t,(F(e.tokens,n)||S(e,n))&&T(e,t)}}function v(e,t){if(w(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function F(e,t){return w(e,t),v(e,t),0===t&&e[t].type===o.BreakOpTokenType.Space}function S(e,t){var n=e.tokens;return w(n,t),t>0&&n[t].type===o.BreakOpTokenType.Space&&I(n[t-1])&&void 0===e.lastFittingToken}function T(e,t){if(t.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var n=r.__assign({},l.EmptyLine),i=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=i,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.curLineStart=i,e.curLineWidth=0,e.lastFittingToken=void 0}function x(e,t,n){if(R(t),n>=e.tokens.length-1)return!1;var r=e.tokens[n+1];return e.curLineWidth+t.width+r.width>e.maxWidth}function w(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function b(e,t,n,r){if(r)return!0;if(e>n){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return r}function A(e,t){return e.width<t}function R(e){if(e.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function I(e){return e.type===o.BreakOpTokenType.HardBreak||e.type===o.BreakOpTokenType.HardBreakCRLF}function M(e,t){void 0===t&&(t=0),i.verifyArgumentNotNull(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var n=e.curLineWidth-t,r=n;if(e.lastFittingToken.type===o.BreakOpTokenType.Space&&(r-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){var a=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var i=e[r],o=P(i.value);t.push({text:i.value,width:i.width,start:i.start,containsThaiCharacters:o}),o&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(a),L(e,a.containsThaiCharacters),e.unprocessedTokens=[]}var l=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e),s=l.text,d=l.start,u=l.end;e.textLines.push({text:s,underlineWidth:n,width:r,startIndex:d,endIndex:u})}function D(e){for(var t,n,r={tokens:[],containsThaiCharacters:!0},i=void 0,o=0;o<e.length;o++){var a=e[o];P(a.text)?i?(n=a,i={text:(t=i).text+n.text,width:t.width+n.width,start:t.start,containsThaiCharacters:t.containsThaiCharacters||n.containsThaiCharacters}):i=a:(i&&(r.tokens.push(i),i=void 0),r.tokens.push(a))}return i&&r.tokens.push(i),r}function P(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n>=l.MinUnicodeThaiRange&&n<=l.MaxUnicodeThaiRange)return!0}return!1}function L(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}t.breakTextToLines=function(e,t,n,r,a,l,s,p,y){var S;if(i.verifyArgumentNotNull(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};for(var T,x=g.isVerticalTextPresentSlice2(l,s),w=x?c.getTextLineHeight(s,l):0,R=o.tokenizeTextToWrap(e,t,a,l,x,w,p,y),P={text:t,tokens:R,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(T=r,T===u.BreakType.Justify||T===u.BreakType.Distributed),containsThaiCharacters:!1,isVerticalText:x,textLineHeight:w},L=0;L<R.length;L++){var O=R[L];if(v(R,L),I(O))m(P,O,L);else if(A(O,n)){if(O.type===o.BreakOpTokenType.Space&&!F(R,L)){C(P,O,L);continue}f(P,O)}else h(P,O,L,e,l,p)}if(void 0!==P.lastFittingToken&&function(e){M(e),e.isSingleCharTooWide=b(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(P),P.isBreakTypeJustifyOrDistributed&&P.textLines.length!==P.tokensPerLine.length)throw new Error("breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = "+P.tokensPerLine.length+", textLineLength = "+P.textLines.length+", MaxWidth = "+n+", Text = "+d.annonymize(P.text));return P.isBreakTypeJustifyOrDistributed&&(null===(S=y)||void 0===S?void 0:S.BreakOp)&&P.containsThaiCharacters&&(P.tokensPerLine=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.containsThaiCharacters?t.push(D(r.tokens)):t.push(r)}return t}(P.tokensPerLine)),{textLines:P.textLines,tokensPerLine:P.tokensPerLine,requireClipping:P.isSingleCharTooWide}},t.testCombineThaiTokensPerLine=function(e){return D(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(5),o=n(19),a=n(6);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(r=t.BreakOpTokenType||(t.BreakOpTokenType={}));var l="1".charCodeAt(0);function s(e,t,n,r,i,l,s,d){return s?r?a.measureTextRunsHeightForVerticalText(e,r.TextRuns,r.Text,t,l,i).totalSize:a.measureTextHeightForVerticalText(d,n):r?o.measureFormattedTextWidth(e,r,t):function(e,t,n,r){if(r)return n*t.length;return e.measureText(t).width}(e,n,i,l)}function d(e){switch(e){case i.Whitespace:return r.Space;case i.HardBreak:return r.HardBreak;case i.HardBreakCRLF:return r.HardBreakCRLF}return r.Word}function u(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?i.HardBreakCRLF:e[t]}function c(e,t){return t===r.HardBreakCRLF?e+2:e+1}function g(e,t,n){return!(!t||n!==r.Word||e>t.length-1)&&t.charCodeAt(e)===l}t.tokenizeTextToWrap=function(e,t,n,i,a,l,f,h){for(var m,p=[],C=0,y=n,v=null===(m=h)||void 0===m?void 0:m.BreakOp;C<t.length;){for(var F=d(u(t,C)),S=c(C,F),T=u(t,S),x=d(T);S<t.length&&F===x&&!g(S,v,F);)x=d(T=u(t,S=c(S,F)));var w=S-C,b=t.substring(C,S),A=f?o.substringFormattedText(f,C,S):void 0,R=0;switch(F){case r.Word:case r.Space:R=s(e,i,b,A,y,F===r.Space,a,l);break;case r.HardBreak:case r.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}p.push({start:C,len:w,value:b,type:F,width:R}),C=S}return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(19),o=n(29),a=function(){function e(e,t,n,r,i){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=i,this.model=r}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=i.measureFormattedTextWidth(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=i.substringFormattedText(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!0,configurable:!0}),e}(),l=function(){function e(e,t,n,r){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=r,this.model=n}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new a(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t},e}();function s(e,t,n,o,a){if(0!==t.length){var s=new l(e,t,o,a),d={width:n,value:"IGNORED"},u=r.binarySearch(s,0,t.length,d,(function(e,t){return e.width-t.width}));u<0&&0!==(u=~u)&&(u-=1);var c=s.item(u);return{width:c.width,value:c.value,remaining:t.substring(c.value.length),formattedRemaining:a?i.substringFormattedText(a,c.value.length):void 0}}}t.breakWideWord=function(e,t,n,r,i){for(var o=[],a=s(e,t,n,r,i);a;)o.push({value:a.value,size:a.width}),a=s(e,a.remaining,n,r,a.formattedRemaining);return o},t.breakWideWordVerticalText=function(e,t,n){for(var r=[],i=o.breakToGraphemes(e),a=n,l=i[0],s=1;s<i.length;s++)a+n>t?(r.push({value:l,size:a}),a=n,l=i[s]):(a+=n,l+=i[s]);return l&&a>0&&r.push({value:l,size:a}),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencySymbols="$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\sꃂ",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),i=n(13),o=n(53),a=n(37),l=n(22);function s(e,t,n,i,o){var a=n,l=i;return e.lineDirection===r.LineDirection.Horizontal?a=o+t.Offset:e.lineDirection===r.LineDirection.Vertical&&(l=o-t.Offset),{textPortionOffsetX:a,textPortionOffsetY:l}}t.drawJustifyOrDistributedTextLine=function(e,t,n,d,u,c,g,f,h,m,p,C,y,v,F,S){var T=u.tokensPerLine[c].tokens,x=f.lineDirection===r.LineDirection.Horizontal?i.adjustXForHorizontalAlignment(n,d,g,p):m;if(C)o.drawTextLine(e,t,n,d,h,v,g,m,p,C,y,T,f);else{var w=a.getStartOffset(f,T),b=a.getJustifyDistributedLine(f,T,a.getSpaceWidthBetweenWords(T,f),w);if(b){var A=s(f,b.Start,g,m,x),R=A.textPortionOffsetX,I=A.textPortionOffsetY;if(o.drawTextLine(e,t,n,d,h,b.Start.Text,R,I,p,C,y),b.Middle){var M=s(f,b.Middle,g,m,x),D=M.textPortionOffsetX,P=M.textPortionOffsetY;o.drawTextLine(e,t,n,d,h,b.Middle.Text,D,P,p,C,y)}if(b.End){var L=s(f,b.End,g,m,x),O=L.textPortionOffsetX,k=L.textPortionOffsetY;o.drawTextLine(e,t,n,d,h,b.End.Text,O,k,p,C,y)}if(!S&&f.lineDirection!==r.LineDirection.Vertical){var N=u.textLines[c],B=function(e,t,n,i,o){switch(e){case r.BreakType.Justify:return i?t.underlineWidth:n;case r.BreakType.Distributed:return i&&1===o?t.underlineWidth:n;case r.BreakType.Wrap:default:return t.underlineWidth}}(f.breakType,N,f.maxWidth,f.isProcessingLastLine,T.length);l.cacheTextDecorationLayout(n,d,{textPositionX:f.lineDirection===r.LineDirection.Horizontal?x+w:g,textPositionY:F,dpr:t.devicePixelRatio,textWidth:B,clipRect:y},d.CachedFont)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(3),a=n(30),l=n(6),s=n(4),d=n(20),u=n(0),c=n(26),g=n(8),f=n(23),h=n(15);function m(e,t,n,r){var i=l.getNumFmtHashesWidth(e,t,r);i<0&&h.setDivMetricWarning("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+i+" MeasuredWidth: "+f.getFontNameForLogging(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);var o=Math.floor(n/i);(void 0===o||isNaN(o)||o===1/0)&&(h.setDivMetricWarning("buildNumFmtHashesString: Invalid count variable. hashCount: "+o+", cellWidth: "+n+", hashWidth: "+i+" "),o=0);var a="";return a+="#".repeat(o)}t.updateNumberFormattingInformation=function(e,t,n,h){var p,C,y,v,F,S;if(i.verifyArgumentNotNull(n,"cell","updateNumberFormattingInformation"),i.verifyArgumentNotNull(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),i.verifyArgumentNotNull(t,"model","updateNumberFormattingInformation"),!g.isVerticalTextPresent(t,n)){var T=o.isRenderFlagEnabled(r.RenderFlags.AdvancedTextMetrics,t),x=o.isRenderFlagEnabled(r.RenderFlags.MeasureTextWidthUseNewRegex,t);if(s.isNullOrUndefined(n.NumFmt)||s.isNullOrUndefined(n.NumFmt.Separator)||""===n.NumFmt.Separator){if((x?Math.round(l.getTextWidth(e,t,n)):l.getTextWidth(e,t,n))>h&&!u.cellHasShrinkToFit(n)){R=m(e,n,h,t);o.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,t)&&(n.CachedIsTextWidthExceedsCellWidth=!0),i.setCellCachedDisplayText(n,R),l.cacheLegacyTextWidthOnCell(e,t,n)}}else{var w=void 0;!s.isNullOrUndefined(n.Text)&&s.isNullOrUndefined(null===(p=n.CachedStyle)||void 0===p?void 0:p.ReadingOrder)&&d.analyzeBidiText(n.Text,null===(C=n.CachedStyle)||void 0===C?void 0:C.ReadingOrder).HasRtl&&(w=e.direction,e.direction="rtl");var b=l.measureTextWidth(e,null===(y=n.NumFmt)||void 0===y?void 0:y.Start,T,x),A=l.measureTextWidth(e,null===(v=n.NumFmt)||void 0===v?void 0:v.End,T,x);if(b+A>h&&!u.cellHasShrinkToFit(n)){var R=m(e,n,h,t);i.setCellCachedDisplayText(n,R),l.cacheLegacyTextWidthOnCell(e,t,n)}else{var I=l.getNumFmtSeparatorWidth(e,n,t),M=o.isRenderFlagEnabled(r.RenderFlags.NumFmtNewFontAPI,t);if(!c.fontFaceSetSupported())return;var D=M?c.isValidCellFontLoaded(t,n):c.isFontLoaded(null===(F=n.CachedFont)||void 0===F?void 0:F.FontName);if(o.isRenderFlagEnabled(r.RenderFlags.MeasureTextAfterFontDownload,t)&&0===I&&!D)return;if(0===I){var P=!!M&&c.isFontValid(null===(S=n.CachedFont)||void 0===S?void 0:S.FontName),L=!!P&&c.documentFontsCheck(i.getFontCssStringFromCell(n,t));throw Error("updateNumberFormattingInformation:: Invalid SeparatorWidth. SeparatorValue: "+a.annonymize(n.NumFmt.Separator)+" CachedWidth: "+I+" MeasuredWidth: "+e.measureText(n.NumFmt.Separator).width+", IsSpace: "+(" "===n.NumFmt.Separator)+", FontName:"+f.getFontNameForLogging(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+n.NumFmt.Separator.length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return document.contains(e.canvas)}catch(e){return!1}}(e)+", isFontValid: "+P+", FontLoadCheck: "+L)}var O=Math.floor((h-b-A)/I),R=function(e,t){var n=t>0?t:0,r=e.Start||"";return r+=e.Separator.repeat(n),r+=e.End||""}(n.NumFmt,O);i.setCellCachedDisplayText(n,R)}w&&(e.direction=w)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(3),a=n(0),l=n(6),s=n(7),d=n(4),u=n(20),c=n(15),g=n(11);t.isHorizontalAlignmentFillInCell=function(e,t){var n;return o.isRenderFlagEnabled(r.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)&&(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)===r.HorizontalAlignment.Fill},t.updateCachedDisplayTextForFill=function(e,t,n){var f,h,m=n.Text;if(m){var p=void 0;if(!d.isNullOrUndefined(n.Text)&&d.isNullOrUndefined(null===(f=n.CachedStyle)||void 0===f?void 0:f.ReadingOrder))u.analyzeBidiText(n.Text,null===(h=n.CachedStyle)||void 0===h?void 0:h.ReadingOrder).HasRtl&&(p=e.direction,e.direction="rtl");var C=function(e,t){var n=t.Spill?s.getSpillCellWidth(t,e):s.getCellWidth(e,t,!1);return i.getTextDrawingMaxWidth(n,l.getCellTextHorizontalPadding(t,e),l.getDistanceFromCellStartToIconEnd(e,t),o.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)?g.getExpandCollapseButtonPadding(e,t):0)}(t,n),y=l.measureTextWidth(e,m,!1,o.isRenderFlagEnabled(r.RenderFlags.MeasureTextWidthUseNewRegex,t)),v=Math.floor(C/y);v<1&&(v=1),(void 0===v||isNaN(v)||v===1/0)&&(c.setDivMetricWarning("updateCachedDisplayTextForFill: Invalid count variable. repeatCount: "+v+", maxTextWidth: "+C+", textWidth: "+y+" "),v=1);var F=m.repeat(v);a.setCellCachedDisplayText(n,F),p&&(e.direction=p)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(1),o=n(7),a=n(0),l=n(4),s=n(5),d=n(82);function u(e,t,n,i,a){var l=o.getCellDimensionsAdjustedForDrawing(t,n,!1);if(i===r.Gradient)return d.fillCellWithGradientBackground(e,n.CachedStyle.Gradient,l,a);var u=function(e,t){if(t===r.FormulaParseError)return s.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}(n,i);return a!==u&&(e.fillStyle=u),e.fillRect(l.x,l.y,l.width,l.height),u}function c(e){return e.HasError?r.FormulaParseError:l.isNullOrUndefined(e.CachedStyle.Gradient)?l.isNullOrUndefined(e.CachedStyle.BackgroundColor)?r.None:r.Solid:r.Gradient}t.drawBackgroundFill=function(e,t,n){if(a.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),a.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),a.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawBackgroundFill"),a.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),a.verifyArgumentNotNull(t.Cells,"model.Cells","drawBackgroundFill"),a.verifyArgumentNotNull(t.Styles,"model.Styles","drawBackgroundFill"),!n.highContrastScheme){for(var l,s=t.Cells,d=[],g=0;g<s.length;g++){(h=c(f=s[g]))!==r.None&&(i.cellIntersectsRenderingRegion(f,n.renderingRegion)&&(o.isCellSpansMultipleRowsOrBlocks(f)?d.push([f,h]):l=u(e,t,f,h,l)))}for(g=0;g<d.length;g++){var f,h,m=d[g];l=u(e,t,f=m[0],h=m[1],l)}}},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0);function o(e,t,n,o){i.verifyArgumentNotNull(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var a=function(e,t){var n=t.x,i=t.y,o=t.width,a=t.height;switch(e){case r.GradientShadingStyle.Vertical:case r.GradientShadingStyle.Center:case r.GradientShadingStyle.TopRightCorner:return{x0:n,y0:0,x1:n+o,y1:0};case r.GradientShadingStyle.ReversedVertical:case r.GradientShadingStyle.TopLeftCorner:return{x0:n+o,y0:0,x1:n,y1:0};case r.GradientShadingStyle.Horizontal:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:i,x1:0,y1:i+a};case r.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:i+a,x1:0,y1:i};case r.GradientShadingStyle.DiagonalUp:case r.GradientShadingStyle.DiagonalDown:case r.GradientShadingStyle.ReversedDiagonalUp:case r.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var n=t.width*t.width,i=t.height*t.height,o=n+i,a=t.x+t.width/2,l=t.y+t.height/2,s=t.width*i/o,d=n*t.height/o;switch(e){case r.GradientShadingStyle.DiagonalUp:break;case r.GradientShadingStyle.DiagonalDown:s=-s;break;case r.GradientShadingStyle.ReversedDiagonalUp:d=-d;break;case r.GradientShadingStyle.ReversedDiagonalDown:s=-s,d=-d;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:a-s,y0:l-d,x1:a+s,y1:l+d}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,o),l=e.createLinearGradient(a.x0,a.y0,a.x1,a.y1),s=0;s<n.length;s++)l.addColorStop(n[s].Position,n[s].Color);return l}t.fillCellWithGradientBackground=function(e,t,n,i){var a=o(e,t.ShadingStyle,t.Stops,n);return a!==i&&(e.fillStyle=a),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(a=e.fillStyle=o(e,function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:return r.GradientShadingStyle.ReversedHorizontal;case r.GradientShadingStyle.BottomLeftCorner:return r.GradientShadingStyle.ReversedVertical;case r.GradientShadingStyle.BottomRightCorner:return r.GradientShadingStyle.Vertical;case r.GradientShadingStyle.Center:return r.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){var i=n.x,o=n.y,a=n.width,l=n.height;switch(e.beginPath(),e.moveTo(i,o),e.lineTo(i+a,o),t){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.BottomRightCorner:e.lineTo(i+a,o+l);break;case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:e.lineTo(i,o+l);break;case r.GradientShadingStyle.Center:e.lineTo(i,o+l),e.lineTo(i+a,o+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(i,o)}(e,t.ShadingStyle,n),e.fill()),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(7),o=n(1),a=n(2),l=n(0),s=n(15),d=n(11),u=n(16),c=n(8),g=n(3),f=n(4);function h(e,t,n,r,i,o){return e+i<t?n:n*function(e,t,n,r,i){var o=e+r;if(i){return Math.max(t-r,0)/(e+n)}return t/(o+n)}(e,t,r,i,o)}function m(e,t,n){return r.getFontLineHeight(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}t.updateCellShrinkToFit=function(e,t,n){c.isVerticalTextPresentSlice2(t,n)?function(e,t){var n=t.CachedFont.Size,r=m(e,t,n),o=i.getCellHeight(e,t,!1);t.ShrunkSize=function(e,t,n,r){var i=Math.floor(r),o=m(e,t,i);if(i<u.MinAllowedFontSize)return u.MinAllowedFontSize;for(;o<n&&i<u.MaxAllowedFontSize;)o=m(e,t,i+=1);for(;o>n&&i>u.MinAllowedFontSize;)o=m(e,t,i-=1);return i}(e,t,o,h(r,o,n,0,0,!1))}(t,n):function(e,t,n){var u,c=l.getFontCssStringFromFont(n.CachedFont,void 0,t);e.font=c;var m=r.getTextWidthNoCaching(e,t,n),p=i.getCellWidth(t,n,!1),C=n.CachedStyle.Indentation||0,y=n.CachedFont.Size,v=r.getHorizontalPadding(t,n,y,n.CachedFont.Italic,C,!0,0,0),F=g.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,t)&&!f.isNullOrUndefined(null===(u=n.LinkedEntity)||void 0===u?void 0:u.IconWidth),S=d.getIconSizeAndPadding(t,n,y),T=o.getTextDrawingMaxWidth(p,v,0,0);n.ShrunkSize=h(m,T,y,v,S,F),n.ShrunkSize<0&&s.setActualFontSizeWarning("\n    ShrinkSize was calculated to be negative: "+n.ShrunkSize+",\n    textWidth: "+m+",\n    cellWidth: "+p+",\n    cellIndentation "+C+",\n    maxTextWidth: "+T+",\n    originalFontSize: "+y+",\n    padding: "+v+"\n    ")}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(9),a=n(31),l=n(5),s=n(86),d=n(87),u=n(11),c=n(88),g=n(89),f=n(90),h=n(91),m=n(92),p=n(93),C=n(56),y=n(94),v=n(95),F=n(57),S=n(10);function T(e,t,n,l,S){var T=function(e,t,n,i){var a=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:r.getActualFontSize(t,e),l=u.getIconSize(a,n),s=t.CondFormat.Icon,c=o.IconImageLookup[s.Set][s.Index],g=d.getIconLeftPosition(e,t,l,a,n),f=d.getIconVerticalPosition(e,t,n,l);return{size:l,image:c,left:g,bottom:f,highContrastScheme:i}}(t,n,l,S),x=F.getClipRect(t,n,T.left,T.bottom,T.size);switch(i.applyClipping(e,x),T.image){case o.CFIconImage.CircleLow:case o.CFIconImage.CircleMedium:case o.CFIconImage.CircleHigh:case o.CFIconImage.CircleEmpty:case o.CFIconImage.CircleFilled:case o.CFIconImage.FourCircleHigh:case o.CFIconImage.FourCircleLow:case o.CFIconImage.FourCircleMedium1:case o.CFIconImage.FourCircleMedium2:case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:a.drawCircleIcon(e,t,n,T);break;case o.CFIconImage.CircleSymbolHigh:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolLow:v.drawCircledSymbols(e,t,n,T);break;case o.CFIconImage.TrafficHigh:case o.CFIconImage.TrafficMedium:case o.CFIconImage.TrafficLow:s.drawTrafficLightRimmed(e,t,n,T);break;case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:case o.CFIconImage.SignalBarMedium1:case o.CFIconImage.SignalBarMedium2:case o.CFIconImage.SignalBarHigh:c.drawSignalBar(e,t,n,T);break;case o.CFIconImage.QuadrantEmpty:case o.CFIconImage.Quadrant25:case o.CFIconImage.QuadrantHalf:case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:g.drawQuadrantBoxes(e,t,n,T);break;case o.CFIconImage.FlagHigh:case o.CFIconImage.FlagMedium:case o.CFIconImage.FlagLow:f.drawFlag(e,t,n,T);break;case o.CFIconImage.TriangleHigh:case o.CFIconImage.TriangleMedium:case o.CFIconImage.TriangleLow:h.drawTriangleSet(e,t,n,T);break;case o.CFIconImage.StarHigh:case o.CFIconImage.StarMedium:case o.CFIconImage.StarLow:m.drawStarIcon(e,t,n,T);break;case o.CFIconImage.SignLow:case o.CFIconImage.SignMedium:p.drawSigns(e,t,n,T);break;case o.CFIconImage.SymbolHigh:case o.CFIconImage.SymbolMedium:case o.CFIconImage.SymbolLow:C.drawSymbols(e,t,n,T);break;case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowDownRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:y.drawArrows(e,t,n,T);break;default:throw Error("drawConditionalFormattingIcon: imageType: "+T.image+" not supported")}i.restoreClipping(e,x)}t.drawConditionalFormattingIcons=function(e,t,n){var o,a;r.verifyArgumentNotNull(e,"ctx","drawConditionalFormattingIcons"),r.verifyArgumentNotNull(t,"model","drawConditionalFormattingIcons"),r.verifyArgumentNotNull(n,"context","drawConditionalFormattingIcons");var s=t.Cells;s.length>0&&(e.lineWidth=S.ShapeOutlineWidthPx,e.setLineDash(l.DefaultDash));for(var d=null!==n.highContrastScheme?n.highContrastScheme:void 0,u=0;u<s.length;u++){var c=s[u];(null===(a=null===(o=c)||void 0===o?void 0:o.CondFormat)||void 0===a?void 0:a.Icon)&&(i.cellIntersectsRenderingRegion(c,n.renderingRegion)&&T(e,t,c,n.devicePixelRatio,d))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(9),o=n(1),a=n(10);!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(r=t.FillType||(t.FillType={})),t.getHighContrastFillingType=function(e){switch(e){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return r.FillPortion;case i.CFIconImage.CircleLow:case i.CFIconImage.CircleEmpty:case i.CFIconImage.FourCircleHigh:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolHigh:return r.Empty;case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleFilled:return r.Full;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:return r.Stripes;case i.CFIconImage.FourCircleLow:case i.CFIconImage.FourCircleMedium1:case i.CFIconImage.FourCircleMedium2:return r.InnerCircle;default:throw Error("getHighContrastFillingType: image: "+e+" not supported")}},t.getInnerCircleRadius=function(e,t){switch(e){case i.CFIconImage.FourCircleMedium2:return t*i.CircleHighContrastSmallRadiusPortion;case i.CFIconImage.FourCircleMedium1:return t*i.CircleHighContrastMediumRadiusPortion;case i.CFIconImage.FourCircleLow:return t*i.CircleHighContrastLargeRadiusPortion;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}},t.drawStripes=function(e,t,n,r,l){e.strokeStyle=l,e.beginPath();var s={p1:{x:t+r*Math.cos(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment}},d={p1:{x:t+r*Math.cos(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment}},u={p1:{x:t+r*Math.cos(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment}};o.drawLine(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),o.drawLine(e,d.p1.x,d.p1.y,d.p2.x,d.p2.y),o.drawLine(e,u.p1.x,u.p1.y,u.p2.x,u.p2.y),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(17),a=n(31),l=n(14),s=n(1);t.drawTrafficLightRimmed=function(e,t,n,d){r.verifyArgumentNotNull(e,"ctx","drawTrafficLightRimmed"),r.verifyArgumentNotNull(t,"model","drawTrafficLightRimmed"),r.verifyArgumentNotNull(n,"cell","drawTrafficLightRimmed"),r.verifyArgumentNotNull(d,"drawingContext","drawTrafficLightRimmed");var u=d.size,c=u;u%2==0&&(c=u-1);var g={left:d.left,bottom:d.bottom,outerColor:function(e){return e?s.rgbToColorHex(e.TextColor):l.TrafficHighRimmedRectColor}(d.highContrastScheme),height:c,width:c,innerColor:void 0};o.drawRectangle(e,t,n,g),d.size=c;var f=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.highContrastScheme,a=e.size-2*i.CirclePaddingFromBoundariesPx,l=n+i.CirclePaddingFromBoundariesPx+.5,s=r-i.CirclePaddingFromBoundariesPx-.5;return{size:a,left:l,bottom:s,image:t,highContrastScheme:o}}(d);a.drawCircleIcon(e,t,n,f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(7),a=n(11),l=n(9),s=n(0),d=n(39),u=n(3),c=n(28);t.getIconVerticalPosition=function(e,t,n,u){var c,g=d.getEffectiveVerticalAlignment(null===(c=t.CachedStyle)||void 0===c?void 0:c.VerticalAlignment,d.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0),f=function(e,t,n,r,a){var l=i.getTextVerticalPosition(t,e,i.getTextLineHeight(t,e),o.getCellHeight(e,t,!1),a,void 0),d=i.getMiddleBaseline(e,l,t.CachedFont,s.getActualFontSize(t,e))*n+.5*r;return Math.round(d)}(e,t,n,u,g),h=t.CondFormat.Icon.IconOnly,m=o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding,p=o.getCellTopAdjustedForDrawing(e,t)+l.MinimalIconPadding+u;switch(g){case r.VerticalAlignment.Bottom:return h?m:a.adjustNumberToRange(f,p,m);case r.VerticalAlignment.Top:return h?p:a.adjustNumberToRange(f,p,m);case r.VerticalAlignment.Center:return h||function(e,t,n,r){if(o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding<n)return!0;if(o.getCellTopAdjustedForDrawing(e,t)+l.MinimalIconPadding>n+r)return!0;return!1}(e,t,f,u)?Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)+u/2):f;default:throw Error("getIconVerticalPosition: Vertical alignment "+g+" is not supported in CF Icon!")}},t.getIconLeftPosition=function(e,t,n,i,l){var s,d;return(null===(d=null===(s=t.CondFormat)||void 0===s?void 0:s.Icon)||void 0===d?void 0:d.IconOnly)?function(e,t,n,i,l){var s=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(s){case r.HorizontalAlignment.Right:var d=a.getIconHorizontalPadding(i,l)+function(e,t,n,i){if(!u.isRenderFlagEnabled(r.RenderFlags.PivotTable,e)||!t.PivotTable||!t.PivotTable.HasExpandCollapseIndicator)return 0;if(!c.canCellContainExpandCollapseAndCFIcon(e,t,o.getCellWidthAdjustedForDrawing(e,t),i))return 0;if(n===r.HorizontalAlignment.Right)return a.getExpandCollapseButtonPadding(e,t)*i;return 0}(e,t,s,l)+n;return Math.floor(o.getCellRightAdjustedForDrawing(e,t)-d);case r.HorizontalAlignment.Fill:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1)+a.getIconHorizontalPadding(i,l));case r.HorizontalAlignment.Center:return Math.floor(o.getCellCenterXAdjustedForDrawing(e,t)-n/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: "+s)}}(e,t,n,i,l):o.getCellLeftAdjustedForDrawing(e,t,!1)+a.getIconHorizontalPadding(i,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(17),o=n(9),a=n(14),l=n(1),s=n(10);function d(e,t,n,r){var i=r.left,o=r.bottom;return{innerColor:t,outerColor:function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(r.highContrastScheme),bottom:o,left:i+n*(e+1),height:n*(e+2),width:n}}t.drawSignalBar=function(e,t,n,u){r.verifyArgumentNotNull(e,"ctx","drawSignalBar"),r.verifyArgumentNotNull(t,"model","drawSignalBar"),r.verifyArgumentNotNull(n,"cell","drawSignalBar"),r.verifyArgumentNotNull(u,"drawingContext","drawSignalBar");for(var c=u.image,g=u.size,f=u.highContrastScheme,h=Math.floor(g/5),m=function(e,t){var n=function(e){if(e)return l.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t),r=function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t);switch(e){case o.CFIconImage.SignalBarEmpty:return[n,n,n,n];case o.CFIconImage.SignalBarLow:return[r,n,n,n];case o.CFIconImage.SignalBarMedium1:return[r,r,n,n];case o.CFIconImage.SignalBarMedium2:return[r,r,r,n];case o.CFIconImage.SignalBarHigh:return[r,r,r,r];default:throw Error("getBarsColors: image: "+e+" not supported")}}(c,f),p=0;p<m.length;p++){var C=d(p,m[p],h,u);i.drawRectangle(e,t,n,C)}f&&function(e,t,n,r){var i=n.left,a=n.bottom,d=n.highContrastScheme,u=function(e,t,n,r){for(var i=function(e){switch(e){case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:return 0;case o.CFIconImage.SignalBarMedium1:return 1;case o.CFIconImage.SignalBarMedium2:return 2;case o.CFIconImage.SignalBarHigh:return 3;default:throw Error("getSeperators: image: "+e+" not supported")}}(e),a=[],l=n-2*r+s.ShapeLinesAdjustment,d=t+2*r+s.ShapeLinesAdjustment,u=0;u<i;u++)a.push({X:d,startY:l,endY:n-1.5}),l-=r,d+=r;return a}(e,i,a,r);t.strokeStyle=l.rgbToColorHex(d.BackgroundColor),t.beginPath();for(var c=0;c<u.length;c++)l.drawLine(t,u[c].X,u[c].startY,u[c].X,u[c].endY);t.stroke()}(c,e,u,h)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(17),o=n(9),a=n(14),l=n(1),s=n(10);function d(e,t,n,r,i){var o=i.left,s=i.bottom;return{innerColor:n,outerColor:function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(i.highContrastScheme),bottom:s-e*r,left:o+t*r,height:r,width:r}}t.drawQuadrantBoxes=function(e,t,n,u){r.verifyArgumentNotNull(e,"ctx","drawQuadrantBoxes"),r.verifyArgumentNotNull(t,"model","drawQuadrantBoxes"),r.verifyArgumentNotNull(n,"cell","drawQuadrantBoxes"),r.verifyArgumentNotNull(u,"drawingContext","drawQuadrantBoxes");for(var c=u.image,g=u.size,f=u.highContrastScheme,h=Math.floor(g/2),m=function(e,t){var n=function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t),r=function(e){if(e)return l.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t);switch(e){case o.CFIconImage.QuadrantEmpty:return[[r,r],[r,r]];case o.CFIconImage.Quadrant25:return[[n,r],[r,r]];case o.CFIconImage.QuadrantHalf:return[[n,n],[r,r]];case o.CFIconImage.Quadrant75:return[[n,n],[n,r]];case o.CFIconImage.QuadrantFull:return[[n,n],[n,n]];default:throw Error("getBoxesColors: image: "+e+" not supported")}}(c,f),p=0;p<m.length;p++)for(var C=0;C<m.length;C++){var y=d(p,C,m[p][C],h,u);i.drawRectangle(e,t,n,y)}f&&function(e,t,n,r){var i=t.left,a=t.bottom,d=t.highContrastScheme,u=i+n+s.ShapeLinesAdjustment,c=a-n-s.ShapeLinesAdjustment,g=function(e,t,n,r){switch(e){case o.CFIconImage.QuadrantEmpty:return[];case o.CFIconImage.Quadrant25:return[{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];case o.CFIconImage.QuadrantHalf:return[{x:t+r,y:n},{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:return[{x:t,y:n-r+s.ShapeLinesAdjustment},{x:t+r-s.ShapeLinesAdjustment,y:n},{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];default:throw Error("getSeperatorsCoordinates: image: "+e+" not supported")}}(r,u,c,n);e.strokeStyle=l.rgbToColorHex(d.BackgroundColor),e.beginPath();for(var f=0;f<g.length;f++)l.drawLine(e,u,c,g[f].x,g[f].y);e.stroke()}(e,u,h,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(17),a=n(14),l=n(1),s=n(5),d=n(10);function u(e,t){var n,r,o,a,s,u,c,g,f,h=t.outerColor,m=(r=(n=t).left,o=n.bottom,a=n.width,s=n.height,u=s/2,c={x:r+a+d.ShapeLinesAdjustment,y:o-u-d.ShapeLinesAdjustment},g=r+a-u/i.QuarterPiTan+d.ShapeLinesAdjustment,f=o-s-d.ShapeLinesAdjustment,{p1:c,p2:{x:g,y:f}}),p=function(e){var t=e.left,n=e.bottom,r=e.width/2,o={x:t+r+d.ShapeLinesAdjustment,y:n-d.ShapeLinesAdjustment},a=n-r*i.QuarterPiTan-d.ShapeLinesAdjustment,l={x:t+d.ShapeLinesAdjustment,y:a};return{p1:o,p2:l}}(t);e.strokeStyle=h,e.beginPath(),l.drawLine(e,m.p1.x,m.p1.y,m.p2.x,m.p2.y),l.drawLine(e,p.p1.x,p.p1.y,p.p2.x,p.p2.y),e.stroke()}t.drawFlag=function(e,t,n,c){r.verifyArgumentNotNull(e,"ctx","drawFlags"),r.verifyArgumentNotNull(t,"model","drawFlags"),r.verifyArgumentNotNull(n,"cell","drawFlags"),r.verifyArgumentNotNull(c,"drawingContext","drawFlags");var g=c.image,f=c.size,h=c.left,m=c.bottom,p=c.highContrastScheme,C=Math.floor(f/2),y=Math.floor(f/3),v=function(e,t){if(t)return function(e,t){if(e===i.CFIconImage.FlagHigh)return l.rgbToColorHex(t.TextColor);return}(e,t);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case i.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case i.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(g,p),F=function(e,t){if(t)return l.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case i.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case i.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(g,p);!function(e,t,n,r,a,l,s,d){var c=d.left,g=d.bottom,f=d.image,h=d.highContrastScheme,m={left:c,bottom:g-r,outerColor:s,height:r,width:a,innerColor:l};o.drawRectangle(e,t,n,m),f===i.CFIconImage.FlagMedium&&h&&u(e,m)}(e,t,n,C,y,v,F,c),function(e,t,n,r,a,l,s,d){var c=d.left,g=d.bottom,f=d.size,h=d.image,m=d.highContrastScheme,p=Math.floor(f/8),C={left:c+a,bottom:g-r+p,outerColor:s,height:r,width:a,innerColor:l};o.drawRectangle(e,t,n,C),h===i.CFIconImage.FlagMedium&&m&&u(e,C)}(e,t,n,C,y,v,F,c),function(e,t,n,r,o){var u=r-d.ShapeLinesAdjustment,c=u-n,g=t+d.ShapeLinesAdjustment;e.lineWidth=i.FlagPoleWidth,e.setLineDash(s.DefaultDash),e.strokeStyle=function(e){return e?l.rgbToColorHex(e.TextColor):a.FlagPoleColor}(o),e.beginPath(),l.drawLine(e,g,u,g,c),e.stroke()}(e,h,2*C,m,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(14),a=n(55),l=n(1),s=n(17),d=n(10);function u(e,t){if(t)return l.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowOuterColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumOuterColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighOuterColor;default:throw Error("getTriangleOuterColor: unsupported image type = "+e)}}function c(e,t){if(t)return l.rgbToColorHex(t.BackgroundColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowInnerColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumInnerColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighInnerColor;default:throw Error("getTriangleInnerColor: unsupported image type = "+e)}}t.drawTriangleSet=function(e,t,n,o){r.verifyArgumentNotNull(e,"ctx","drawTriangleSet"),r.verifyArgumentNotNull(t,"model","drawTriangleSet"),r.verifyArgumentNotNull(n,"cell","drawTriangleSet"),r.verifyArgumentNotNull(o,"drawingContext","drawTriangleSet");var l=o.image,g=o.size,f=o.left,h=o.bottom,m=o.highContrastScheme;switch(l){case i.CFIconImage.TriangleHigh:case i.CFIconImage.TriangleLow:var p=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.size,a=e.highContrastScheme,l=Math.floor(o/2),s=Math.floor(o/4),g=r-s-d.ShapeLinesAdjustment,f=n+d.ShapeLinesAdjustment;switch(t){case i.CFIconImage.TriangleHigh:return{outerColor:u(t,a),innerColor:c(t,a),left:f,bottom:g,height:l,width:o};case i.CFIconImage.TriangleLow:return{outerColor:u(t,a),innerColor:c(t,a),left:n+d.ShapeLinesAdjustment,bottom:r-s-l-d.ShapeLinesAdjustment,height:l,width:o};default:throw Error("getTriangleDrawingContext: unsupported image type = "+t)}}(o);a.drawTriangle(e,t,n,p,l===i.CFIconImage.TriangleLow);break;case i.CFIconImage.TriangleMedium:var C=Math.floor(g/3),y={left:f,outerColor:u(l,m),innerColor:c(l,m),bottom:h-C,height:C,width:g};s.drawRectangle(e,t,n,y);break;default:throw Error("drawTriangleSet: unsupported image type = "+l)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(14),a=n(21),l=n(1),s=n(10);t.drawStarIcon=function(e,t,n,d){r.verifyArgumentNotNull(e,"ctx","drawStarIcon"),r.verifyArgumentNotNull(t,"model","drawStarIcon"),r.verifyArgumentNotNull(n,"cell","drawStarIcon"),r.verifyArgumentNotNull(d,"drawingContext","drawStarIcon");var u=d.image,c=d.size,g=d.left,f=d.bottom,h=d.highContrastScheme,m=Math.floor(c/2);if(!(m<=1)){var p=function(e,t,n){var r=n*i.StarInset,o=e+n+.5,a=t-n,l=r*i.StarRotationSin,d=r*i.StarRotationCos,u=n*i.StarRotation2Sin,c=r*i.StarRotation2Sin,g=r*i.StarRotation2Cos,f=n*i.StarRotationSin,h=n*i.StarRotationCos,m=Math.floor(d)+s.ShapeLinesAdjustment,p=a+(d-m),C=p-d,y=p+g,v=p+h;return{topOuter:{x:o,y:p-n},topRightInner:{x:o+l,y:C},topRightOuter:{x:o+u,y:C},middleRightInner:{x:o+c,y:y},bottomRightOuter:{x:o+f,y:v},bottomInner:{x:o,y:p+r},bottomLeftOuter:{x:o-f,y:v},middleLeftInner:{x:o-c,y:y},topLeftOuter:{x:o-u,y:C},topLeftInner:{x:o-l,y:C}}}(g,f,m),C=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return l.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:return;default:throw Error("getStarLeftInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledInnerColor;case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = "+e)}}(u,h),y=function(e,t){if(t)return l.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledOuterColor;case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = "+e)}}(u,h),v=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:return l.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:case i.CFIconImage.StarMedium:return;default:throw Error("getStarRightInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledInnerColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = "+e)}}(u,h),F=function(e,t){if(t)return l.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledOuterColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = "+e)}}(u,h),S=u===i.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,p),S&&(a.fillAndStroke(e,v,F),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,p),a.fillAndStroke(e,C,y)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(14),a=n(55),l=n(21),s=n(1),d=n(10);function u(e,t){if(!t)switch(e){case i.CFIconImage.SignLow:return o.SignLowInnerColor;case i.CFIconImage.SignMedium:return o.SignMediumInnerColor;default:throw Error("getInnerColor: unsupported image type = "+e)}}function c(e,t){if(t)return s.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SignLow:return o.SignLowOuterColor;case i.CFIconImage.SignMedium:return o.SignMediumOuterColor;default:throw Error("getOuterColor: unsupported image type = "+e)}}t.drawSigns=function(e,t,n,o){r.verifyArgumentNotNull(e,"ctx","drawSigns"),r.verifyArgumentNotNull(t,"model","drawSigns"),r.verifyArgumentNotNull(n,"cell","drawSigns"),r.verifyArgumentNotNull(o,"drawingContext","drawSigns");var s=o.image;switch(s){case i.CFIconImage.SignLow:!function(e,t){var n=t.image,r=t.highContrastScheme,i=u(n,r),o=c(n,r),a=function(e){var t=e.size,n=e.left,r=e.bottom,i=Math.floor(t/2),o=n+i+d.ShapeLinesAdjustment,a=r-i-d.ShapeLinesAdjustment;return{top:{x:o,y:a-i},right:{x:o+i,y:a},bottom:{x:o,y:a+i},left:{x:o-i,y:a}}}(t);e.beginPath(),e.moveTo(a.top.x,a.top.y),e.lineTo(a.right.x,a.right.y),e.lineTo(a.bottom.x,a.bottom.y),e.lineTo(a.left.x,a.left.y),e.lineTo(a.top.x,a.top.y),l.fillAndStroke(e,i,o)}(e,o);break;case i.CFIconImage.SignMedium:var g=function(e){var t=e.left,n=e.bottom,r=e.size,i=e.highContrastScheme,o=e.image,a=t+d.ShapeLinesAdjustment,l=n-d.ShapeLinesAdjustment,s=u(o,i);return{outerColor:c(o,i),innerColor:s,left:a,bottom:l,height:r,width:r}}(o);a.drawTriangle(e,t,n,g,!1);break;default:throw Error("drawSigns: unsupported image type = "+s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(14),o=n(9),a=n(21),l=n(1),s=n(10);function d(e){var t=Math.round(o.ArrowWidthRatio*e);return t=t%2!=0?t+1:t}function u(e){var t=Math.round(o.ArrowHeightRatio*e);return t=t%2!=0?t+1:t}t.drawArrows=function(e,t,n,c){r.verifyArgumentNotNull(e,"ctx","drawArrows"),r.verifyArgumentNotNull(t,"model","drawArrows"),r.verifyArgumentNotNull(n,"cell","drawArrows"),r.verifyArgumentNotNull(c,"drawingContext","drawArrows");var g=c.image,f=c.size,h=c.left,m=c.bottom,p=c.highContrastScheme,C=function(e,t){if(t)return l.rgbToColorHex(t.TextColor);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayOuterColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpOuterColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownOuterColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightOuterColor;default:throw Error("getArrowOuterColor: unsupported image type = "+e)}}(g,p),y=function(e,t){if(t)return function(e,t){switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return l.rgbToColorHex(t.TextColor);case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return l.rgbToColorHex(t.BackgroundColor);default:throw Error("getArrowHighContrastInnerColor: unsupported image type = "+e)}}(e,t);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayInnerColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpInnerColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownInnerColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightInnerColor;default:throw Error("getArrowInnerColor: unsupported image type = "+e)}}(g,p),v=[];switch(g){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.ColoredArrowDown:v=function(e,t,n){var r=o.ArrowHeightRatio*n,i=d(n),a=Math.floor(n/2+e)+s.ShapeLinesAdjustment,l=Math.round(t),u=a+r*Math.cos(-3*o.ArrowAngle),c=l+r*Math.sin(-3*o.ArrowAngle),g=u+i*Math.cos(-o.ArrowAngle),f=c+i*Math.sin(-o.ArrowAngle),h=a-i/2,m=f+r/2*Math.sin(o.ArrowAngle),p=m-r,C=h+i,y=p,v=C,F=m,S=a+(a-g),T=f,x=a+(a-u),w=c,b={x:a,y:l},A={x:u,y:c},R={x:g,y:f},I={x:h,y:m},M={x:h,y:Math.round(p)-s.ShapeLinesAdjustment},D={x:C,y:Math.round(y)-s.ShapeLinesAdjustment};return[b,A,R,I,M,D,{x:v,y:F},{x:S,y:T},{x:x,y:w},b]}(h,m,f);break;case o.CFIconImage.GrayArrowUp:case o.CFIconImage.ColoredArrowUp:v=function(e,t,n){var r=t-n,i=o.ArrowHeightRatio*n,a=d(n),l=Math.floor(n/2+e)+s.ShapeLinesAdjustment,u=Math.round(r),c=l+i*Math.cos(3*o.ArrowAngle),g=u+i*Math.sin(3*o.ArrowAngle),f=c+a*Math.cos(o.ArrowAngle),h=g+a*Math.sin(o.ArrowAngle),m=l-a/2,p=h+i/2*Math.sin(-o.ArrowAngle),C=p+i,y=m+a,v=C,F=y,S=p,T=l+(l-f),x=h,w=l+(l-c),b=g,A={x:l,y:u},R={x:c,y:g},I={x:f,y:h},M={x:m,y:p},D={x:m,y:Math.round(C)-s.ShapeLinesAdjustment},P={x:y,y:Math.round(v)-s.ShapeLinesAdjustment};return[A,R,I,M,D,P,{x:F,y:S},{x:T,y:x},{x:w,y:b},A]}(h,m,f);break;case o.CFIconImage.GrayArrowRight:case o.CFIconImage.ColoredArrowRight:v=function(e,t,n){var r=t-n,i=o.ArrowHeightRatio*n,a=d(n),l=Math.round(e+n),u=Math.floor(n/2+r)+s.ShapeLinesAdjustment,c=l+i*Math.cos(-3*o.ArrowAngle),g=u+i*Math.sin(-3*o.ArrowAngle),f=c+a*Math.cos(3*o.ArrowAngle),h=g+a*Math.sin(3*o.ArrowAngle),m=f+i/2*Math.cos(o.ArrowAngle),p=u-a/2,C=m-i,y=p,v=C,F=y+a,S=m,T=u+(u-p),x=f,w=u+(u-h),b=c,A=u+(u-g),R={x:l,y:u},I={x:c,y:g},M={x:f,y:h},D={x:m,y:p},P={x:Math.round(C)+s.ShapeLinesAdjustment,y:y},L={x:Math.round(v)+s.ShapeLinesAdjustment,y:F};return[R,I,M,D,P,L,{x:S,y:T},{x:x,y:w},{x:b,y:A},R]}(h,m,f);break;case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.ColoredArrowDownRight:v=function(e,t,n){var r=t-n,i=Math.round(o.ArrowWidthRatio*n),a=u(n),l=Math.floor(o.ArrowDownRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(o.ArrowDownRightTipYRatio*n+r)+s.ShapeLinesAdjustment,c=l,g=d-a,f=c-i,h=g,m=f,p=d-i-i/Math.sqrt(2),C=m+a*Math.cos(-3*o.ArrowAngle),y=p+a*Math.sin(-3*o.ArrowAngle),v=C+i*Math.cos(3*o.ArrowAngle),F=y+i*Math.sin(3*o.ArrowAngle),S=l-a,T=d,x=S,w=T-i,b=l-i-i/Math.sqrt(2),A={x:l,y:d};return[A,{x:c,y:g},{x:f,y:h},{x:m,y:p},{x:C,y:y},{x:v,y:F},{x:b,y:w},{x:x,y:w},{x:S,y:T},A]}(h,m,f);break;case o.CFIconImage.GrayArrowUpRight:case o.CFIconImage.ColoredArrowUpRight:v=function(e,t,n){var r=t-n,i=Math.round(o.ArrowWidthRatio*n),a=u(n),l=Math.floor(o.ArrowUpRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(o.ArrowUpRightTipYRatio*n+r)+s.ShapeLinesAdjustment,c=l-a,g=d,f=c,h=g+i,m=l-i-i/Math.sqrt(2),p=h,C=m+a*Math.cos(3*o.ArrowAngle),y=p+a*Math.sin(3*o.ArrowAngle),v=C+i*Math.cos(o.ArrowAngle),F=y+i*Math.sin(o.ArrowAngle),S=l,T=d+a,x=S-i,w=T,b=x,A=d+i+i/Math.sqrt(2),R={x:l,y:d};return[R,{x:c,y:g},{x:f,y:h},{x:m,y:p},{x:C,y:y},{x:v,y:F},{x:b,y:A},{x:x,y:w},{x:S,y:T},R]}(h,m,f);break;default:throw Error("drawArrows: unsupported image type = "+g)}a.drawIconFromPoints(e,y,C,v)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(31),o=n(56);t.drawCircledSymbols=function(e,t,n,a){r.verifyArgumentNotNull(e,"ctx","drawCircleSymbols"),r.verifyArgumentNotNull(t,"model","drawCircleSymbols"),r.verifyArgumentNotNull(n,"cell","drawCircleSymbols"),r.verifyArgumentNotNull(a,"drawingContext","drawCircleSymbols"),a.size>0&&(i.drawCircleIcon(e,t,n,a),o.drawSymbols(e,t,n,function(e){var t=e.left,n=e.bottom,r=e.image,i=e.highContrastScheme,o=e.size,a=Math.round(t),l=Math.round(n);return{size:Math.round(o),left:a,bottom:l,image:r,highContrastScheme:i}}(a)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),i=n(98),o=n(99),a=n(100),l=n(101),s=n(102),d=n(103),u=!1;t.loadPolyFills=function(){u||(r.loadStringRepeat(),i.loadStringTrimRight(),o.loadStringStartsWith(),a.loadStringEndsWith(),d.loadGetLineDash(),l.loadSetLineDash(),s.loadStringCodeAtPoint(),u=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,n=0;if(r.isNullOrUndefined(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var i=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,i-t.length)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=function(){var e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringStartsWith=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=t>0?0|t:0;return this.substring(n,n+e.length)===e}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringEndsWith=function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSetLineDash=function(){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringCodeAtPoint=function(){
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;if(!(r<0||r>=n)){var i,o=t.charCodeAt(r);return o>=55296&&o<=56319&&n>r+1&&(i=t.charCodeAt(r+1))>=56320&&i<=57343?1024*(o-55296)+i-56320+65536:o}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadGetLineDash=function(){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(25),o=n(0),a=n(5),l=n(58);function s(e,t,n,i,o,a,l){var s=i.Index,d=i.Min,f=i.Max;if(u(s,d,f,n.renderingRegion,!0)){var h=t.ClientOnlyCache,m=g(h.RowOffsetsAdjustedForDrawing,s,o,l),p=-1===i.Min?0:c(h.ColOffsetsAdjustedForDrawing,d,o,a),C=-1===i.Max?t.BlockWidth*n.devicePixelRatio:c(h.ColOffsetsAdjustedForDrawing,f,o,a);r.drawLine(e,p,m,C,m)}}function d(e,t,n,i,o,a,l){var s=i.Index,d=i.Min,f=i.Max;if(u(s,d,f,n.renderingRegion,!1)){var h=t.ClientOnlyCache,m=c(h.ColOffsetsAdjustedForDrawing,s,o,a),p=-1===i.Min?0:g(h.RowOffsetsAdjustedForDrawing,d,o,l),C=-1===i.Max?t.BlockHeight*n.devicePixelRatio:g(h.RowOffsetsAdjustedForDrawing,f,o,l);r.drawLine(e,m,p,m,C)}}function u(e,t,n,r,i){var o,a,l=i?r.startRow:r.startColumn,s=i?r.endRow:r.endColumn;return a=s,l<=(o=e)&&o<=a&&(s=i?r.endColumn:r.endRow,!(-1!==t&&t>s)&&(l=i?r.startColumn:r.startRow,!(-1!==n&&n<l)))}function c(e,t,n,o){return t>=0?i.getAdjustedDrawingOffset(e[t],r.getColWidthFromOffsets(t,e),n,o):0}function g(e,t,n,o){return t>=0?i.getAdjustedDrawingOffset(e[t],r.getRowHeightFromOffsets(t,e),n,o):0}t.drawPageBreaks=function(e,t,n){if(null!=t.PageBreaks){l.setPageLayoutLine(e,n);var r=o.getLinePixelTranslation(a.GridLineWidthPx),u=i.getMaxLineOffset(t.BlockWidth,n.devicePixelRatio,!1),c=i.getMaxLineOffset(t.BlockHeight,n.devicePixelRatio,!0);e.beginPath(),function(e,t,n,r,i,o){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Row;if(null==l)return;for(var d=0;d<l.length;++d)s(e,t,n,l[d],r,i,o)}(e,t,n,r,u,c),function(e,t,n,r,i,o){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Col;if(null==l)return;for(var s=0;s<l.length;++s)d(e,t,n,l[s],r,i,o)}(e,t,n,r,u,c),e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),i=n(5),o=n(0),a=n(58),l=n(1);function s(e,t){return!(e.startRow>t.LastRow)&&(!(e.startColumn>t.LastColumn)&&(!(e.endRow+1<t.FirstRow)&&(!(e.endColumn+1<t.FirstColumn)&&!(e.startRow>t.FirstRow&&e.startColumn>t.FirstColumn&&e.endRow<t.LastRow&&e.endColumn<t.LastColumn))))}function d(e,t,n,i,o,a,s){var d=t.ClientOnlyCache,u=s.FirstColumn<=0?-1:r.getAdjustedDrawingOffset(d.ColOffsetsAdjustedForDrawing[s.FirstColumn],0,i,a),c=s.FirstRow<=0?-1:r.getAdjustedDrawingOffset(d.RowOffsetsAdjustedForDrawing[s.FirstRow],0,i,o),g=s.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.devicePixelRatio+1:r.getAdjustedDrawingOffset(d.ColOffsetsAdjustedForDrawing[s.LastColumn],l.getColWidthFromOffsets(s.LastColumn,d.ColOffsetsAdjustedForDrawing),i,a),f=s.LastRow>=t.RowNumbers.length?t.BlockHeight*n.devicePixelRatio+1:r.getAdjustedDrawingOffset(d.RowOffsetsAdjustedForDrawing[s.LastRow],l.getRowHeightFromOffsets(s.LastRow,d.RowOffsetsAdjustedForDrawing),i,o);e.rect(u,c,g-u,f-c)}t.drawPrintAreas=function(e,t,n){var l;if(function(e){o.verifyArgumentNotNull(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),o.verifyArgumentNotNull(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),o.verifyArgumentNotNull(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),o.verifyArgumentNotNull(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),o.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),o.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),o.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),t.PrintAreas){a.setPageLayoutLine(e,n);var u=o.getLinePixelTranslation(i.GridLineWidthPx),c=r.getMaxLineOffset(t.BlockWidth,n.devicePixelRatio,!1),g=r.getMaxLineOffset(t.BlockHeight,n.devicePixelRatio,!0);e.beginPath();for(var f=0;f<(null===(l=t.PrintAreas)||void 0===l?void 0:l.length);f++)s(n.renderingRegion,t.PrintAreas[f])&&d(e,t,n,u,g,c,t.PrintAreas[f]);e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(2),o=n(1),a=n(5),l=n(27),s=n(28),d=n(0),u=n(32),c=n(18),g=n(6),f=n(33);function h(e,t,n){var r=l.EmptyPivotTableImagePlaceholderThicknessPx,i=d.getLinePixelTranslation(r);e.lineWidth=r,e.fillStyle=e.strokeStyle=n?o.rgbToColorHex(n.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+i,t.y+i,t.width,t.height)}function m(e,t,n,r){var i=n?o.rgbToColorHex(n.TextColor):l.EmptyPivotTableTitleTextColor;e.font=d.getFontCssStringFromFont(t,void 0,r),e.fillStyle=i,e.textBaseline=f.DefaultTextBaseline,e.textAlign="center"}function p(e,t,n){var r=C(e,t,n),i=s.getPivotTableLeftAdjustedForDrawing(e,t,!1),o=s.getPivotTableTopAdjustedForDrawing(e,t,!1),a=t.OriginPTWidthAdjustedForDrawing,d=t.OriginPTHeightAdjustedForDrawing,u=r.y+r.height,c=o+d,g=r.width,f=c-u-2*l.EmptyPivotTableImageMinimalPaddingYPx*n,h=Math.min(g,l.EmptyPivotTableImageWidthHeightRatio*f),m=Math.min(f,g/l.EmptyPivotTableImageWidthHeightRatio),p=(u+c)/2;return{x:i+Math.round((a-h)/2),y:Math.round(p-m/2),width:h,height:m}}function C(e,t,n){var r=Math.round(t.OriginPTWidthAdjustedForDrawing*l.EmptyPivotTableTitleContainerWidthRatio);return{x:S(e,t,r),y:v(e,t,n),width:r,height:Math.round(l.EmptyPivotTableTitleContainerHeightPx*n)}}function y(e,t){var n=Math.round(t.OriginPTWidth*l.EmptyPivotTableTitleContainerWidthRatio);return{x:T(e,t,n),y:F(e,t),width:n-l.EmptyPivotTableTitleContainerBorderThicknessPx,height:l.EmptyPivotTableTitleContainerHeightPx-l.EmptyPivotTableTitleContainerBorderThicknessPx}}function v(e,t,n){return s.getPivotTableTopAdjustedForDrawing(e,t,!1)+Math.round(l.EmptyPivotTableTitleContainerTopPaddingPx*n)}function F(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+l.EmptyPivotTableTitleContainerTopPaddingPx+l.EmptyPivotTableTitleContainerBorderThicknessPx}function S(e,t,n){var r=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return s.getPivotTableLeftAdjustedForDrawing(e,t,!1)+r}function T(e,t,n){var r=(t.OriginPTWidth-n)/2+l.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){var n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+r}t.drawEmptyPivotTableTitleContainers=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleContainers"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleContainers"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableTitleContainers"),t.PivotTables&&0!==t.PivotTables.length){for(var i=Math.max(Math.round(l.EmptyPivotTableTitleContainerBorderThicknessPx*n.devicePixelRatio),1),u=d.getLinePixelTranslation(i),c=!1,g=0;g<t.PivotTables.length;g++){var f=t.PivotTables[g];if(f.IsEmptyPivot&&(!(f.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&s.isPivotIntersectsRenderingRegion(t,f,n.renderingRegion,!1))){c||(e.strokeStyle=n.highContrastScheme?o.rgbToColorHex(n.highContrastScheme.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=i,e.setLineDash(a.DefaultDash),e.beginPath(),c=!0);var h=C(t,f,n.devicePixelRatio);e.rect(u+h.x,u+h.y,h.width,h.height)}}c&&e.stroke()}},t.drawEmptyPivotTableImages=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableImages"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableImages"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(var i=0;i<t.PivotTables.length;i++){var o=t.PivotTables[i];if(o.IsEmptyPivot&&(!(o.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingImage)&&s.isPivotIntersectsRenderingRegion(t,o,n.renderingRegion,!1))){var a=p(t,o,n.devicePixelRatio);if(!(a.width<l.EmptyPivotTableMinimalImageWidthPx)){var d=u.getOrLoadStaticImage(0,n.blockIdentifier);d?e.drawImage(d,a.x,a.y,a.width,a.height):h(e,a,n.highContrastScheme)}}}},t.drawEmptyPivotTableTitleText=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleText"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleText"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableTitleText"),t.PivotTables&&0!==t.PivotTables.length)for(var a=!1,d=void 0,u=0;u<t.PivotTables.length;u++){var f=t.PivotTables[u];if(f.IsEmptyPivot&&(!(f.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&s.isPivotIntersectsRenderingRegion(t,f,n.renderingRegion,!1)&&f.PivotTableName)){if(!a){var h=c.getReferencedObjectById(i.UniqueStyleID.Default,t.Styles);m(e,d=c.getReferencedObjectById(h.FontID,t.Fonts),n.highContrastScheme,t),a=!0}var p=y(t,f),C=p.x+p.width/2,v=g.getTextOffsetYAlphabeticBaseline(t,p.y+p.height,p.height,d.Size,d.FontName,i.VerticalAlignment.Center);o.applyClipping(e,p),e.fillText(f.PivotTableName,C,v),o.restoreClipping(e,p)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(7),a=n(1),l=n(108),s=n(5),d=n(0),u=n(4);function c(e,t,n){return function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(t*e/100),t,n)}function g(e,t,n,r){if(function(e){return e>0&&e<100}(e))return{X:t+n-d.getLinePixelTranslation(s.GridLineWidthPx),startY:r.y+s.GridLineWidthPx,endY:r.y+r.height-s.GridLineWidthPx}}function f(e,t,n,r,i){var o=Math.round(t.width*e/100);r&&(o=-o);var a=i&&o<0?l.DataBarAxisWidth:0,s=Math.min(n,n+o),d=t.x+s,u=Math.max(Math.abs(o)-a,0);return{x:d,y:t.y,width:u,height:t.height}}function h(e,t){return t.information.GradientColor?function(e,t){var n=function(e){var t,n=e.bar,r=n.x,i=r+n.width,o=null===(t=e.axis)||void 0===t?void 0:t.X;if(u.isNullOrUndefined(o)?e.isRtl:r<o)return{startX:i,endX:r,Y:n.y};return{startX:r,endX:i,Y:n.y}}(t),r=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return r.addColorStop(l.GradientStartingPositing,t.information.Color),r.addColorStop(l.GradientEndingPositing,t.information.GradientColor),r}(e,t):t.information.Color}function m(e,t,n,r){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=r}function p(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function C(e,t,n){var o=i.isRenderFlagEnabled(r.RenderFlags.AdjustDataBarPaddingToDpr,e),a=y(l.DataBarHorizontalPadding,n,o),d=y(l.DataBarTopPadding,n,o),u=y(l.DataBarBottomPadding,n,o);return{x:t.x+a+s.GridLineWidthPx,y:t.y+a+s.GridLineWidthPx,width:Math.max(0,t.width-2*a-2*s.GridLineWidthPx),height:Math.max(0,t.height-d-u-2*s.GridLineWidthPx)}}function y(e,t,n){return n?Math.max(e,Math.round(e*t)):e}t.drawDataBars=function(e,t,n){i.verifyArgumentNotNull(t,"model","drawDataBars"),i.verifyArgumentNotNull(e,"ctx","drawDataBars"),i.verifyArgumentNotNull(n,"context","drawDataBars"),i.verifyArgumentNotNull(t.Cells,"model.Cells","drawDataBars");var s=function(e,t){for(var n,i=e.Cells,l=[],s=0;s<i.length;s++){var d=i[s];if(a.cellIntersectsRenderingRegion(d,t.renderingRegion)){var h=null===(n=d.CondFormat)||void 0===n?void 0:n.DataBar;if(h){var m=h.Direction===r.ReadingOrderType.RightToLeft||e.IsRtl&&h.Direction===r.ReadingOrderType.Context,p=o.getCellDimensionsAdjustedForDrawing(e,d,!1),y=C(e,p,t.devicePixelRatio),v=c(h.AxisPostion,y.width,m),F=g(h.AxisPostion,y.x,v,p),S=!u.isNullOrUndefined(F),T=f(h.Length,y,v,m,S);l.push({information:h,axis:F,bar:T,isRtl:m})}}}return l}(t,n),y=function(e){if(u.isNullOrUndefined(e))return;return""+a.rgbToColorHex(e.TextColor)}(n.highContrastScheme);!function(e,t,n){for(var r,i=!1,o=!u.isNullOrUndefined(n),s=0;s<t.length;s++){var d=t[s].axis;if(!u.isNullOrUndefined(d)){if(i||(r=o?n:t[s].information.AxisColor,m(e,l.DataBarAxisWidth,l.DataBarAxisLineDash,r),e.beginPath(),i=!0),!o){var c=t[s].information.AxisColor;p(e,c,r),r=c}a.drawLine(e,d.X,d.startY,d.X,d.endY)}}i&&e.stroke()}(e,s,y),u.isNullOrUndefined(y)&&function(e,t){for(var n,r=0;r<t.length;r++){var i=t[r],o=i.bar,a=h(e,i);n!==a&&(e.fillStyle=a,n=a),e.fillRect(o.x,o.y,o.width,o.height)}}(e,s),function(e,t,n){for(var r,i=!1,o=!u.isNullOrUndefined(n),a=0;a<t.length;a++){var s=t[a].information.BorderColor;if(!u.isNullOrUndefined(n)||!u.isNullOrUndefined(s)){var c=(g=t[a].bar,f=void 0,h=void 0,C=void 0,y=void 0,f=g.x+d.getLinePixelTranslation(l.DataBarBorderWidth),h=g.y+d.getLinePixelTranslation(l.DataBarBorderWidth),C=Math.max(g.width-l.DataBarBorderWidth,0),y=Math.max(g.height-l.DataBarBorderWidth,0),{x:f,y:h,width:C,height:y});i||(r=o?n:s,m(e,l.DataBarBorderWidth,[],r),e.beginPath(),i=!0),o||(p(e,s,r),r=s),c.width>0&&e.rect(c.x,c.y,c.width,c.height)}}var g,f,h,C,y;i&&e.stroke()}(e,s,y)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarBorderWidth=1,t.GradientStartingPositing=0,t.GradientEndingPositing=1,t.DataBarAxisLineDash=[3,1]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(1),o=n(32),a=n(7);function l(e,t,n,r){var i=n.Sparkline.ClusterOffsetX,o=n.Sparkline.ClusterOffsetY,l=a.getCellWidth(t,n,!1),s=a.getCellHeight(t,n,!1),d=a.getCellLeftAdjustedForDrawing(t,n,!1),u=a.getCellTopAdjustedForDrawing(t,n),c=a.getCellWidthAdjustedForDrawing(t,n),g=a.getCellHeightAdjustedForDrawing(t,n);e.drawImage(r,i,o,l,s,d,u,c,g)}t.drawSparklines=function(e,t,n){var a;if(r.verifyArgumentNotNull(e,"ctx","drawSparklines"),r.verifyArgumentNotNull(t,"model","drawSparklines"),r.verifyArgumentNotNull(n,"context","drawSparklines"),t.Sparklines){var s=t.Cells,d=o.getOrLoadVersionedImage(o.ImageType.Sparkline,t.Sparklines.Version,t.Sparklines.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(d)for(var u=0;u<s.length;u++){var c=s[u];(null===(a=c)||void 0===a?void 0:a.Sparkline)&&(i.cellIntersectsRenderingRegion(c,n.renderingRegion)&&l(e,t,c,d))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(5),a=n(7),l=n(13),s=n(27),d=n(1),u=n(6),c=n(10),g=n(57),f=n(17),h=n(0),m=n(8),p=n(28),C=n(11);function y(e,t,n,i){var o=function(e){var t=Math.floor(s.ExpandCollapseButtonSizePx*e);if(t%2==0)return t;return t-1}(i),c=function(e,t,n,r){if(function(e){if(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)return!0;return!1}(n))return Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*r);return Math.ceil(u.getTextWidthNoCaching(e,t,n)*r)}(e,t,n,i),h=m.isVerticalTextPresent(t,n),p=function(e,t,n,i,o,d){var c=s.PaddingBetweenExpandCollapseButtonAndTextPx*n;if(d)return e.IsRtl?Math.floor(a.getCellRightAdjustedForDrawing(e,t)-c)-i:Math.floor(a.getCellLeftAdjustedForDrawing(e,t,!1)+c);var g=l.getEffectiveHorizontalAlignment(e,t),f=u.getTextHorizontalPosition(e,t)*n;switch(g){case r.HorizontalAlignment.Left:if(e.IsRtl)return Math.floor(f+o+c);var h=u.getDistanceFromCellStartToIconEnd(e,t),m=t.CachedStyle.Indentation||0,p=(u.getCellHorizontalIndentationPaddingPx(e,t,m)+h+s.PaddingBetweenExpandCollapseButtonAndTextPx)*n;return Math.floor(a.getCellLeftAdjustedForDrawing(e,t,!1)+p);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return e.IsRtl?Math.floor(f+o/2+c):Math.max(Math.floor(f-o/2-c)-i,a.getCellLeftAdjustedForDrawing(e,t,!1));case r.HorizontalAlignment.Right:return e.IsRtl?Math.floor(a.getCellRightAdjustedForDrawing(e,t)-c)-i:Math.floor(f-o)-i;default:throw Error("getAdjustedButtonLeft: unsupported horizontalAlignment: "+g)}}(t,n,i,o,c,h),C=function(e,t,n,i,o){var l;if(o)return Math.floor(a.getCellCenterYAdjustedForDrawing(e,t)-i/2);var d=null===(l=t.CachedStyle)||void 0===l?void 0:l.VerticalAlignment,u=s.ExpandCollapseButtonVerticalPaddingPx*n;switch(d){case r.VerticalAlignment.Top:case r.VerticalAlignment.Justify:return Math.floor(a.getCellTopAdjustedForDrawing(e,t)+u);case r.VerticalAlignment.Bottom:return Math.floor(a.getCellBottomAdjustedForDrawing(e,t)-i-u);case r.VerticalAlignment.Center:case r.VerticalAlignment.Distributed:return Math.floor(a.getCellCenterYAdjustedForDrawing(e,t)-i/2);default:throw Error("getAdjustedButtonTop: unsupported verticalAlignment: "+d)}}(t,n,i,o,h),y={outerColor:s.ExpandCollapseButtonOuterColor,innerColor:s.ExpandCollapseButtonInnerColor,left:p,bottom:C+o,height:o,width:o},F=g.getClipRect(t,n,y.left,y.bottom,o);d.applyClipping(e,F),f.drawRectangle(e,t,n,y),n.PivotTable.IsExpanded?v(e,p,C,o):function(e,t,n,r){v(e,t,n,r),function(e,t,n,r){var i=t+Math.round(r/2)+s.PlusMinusLineAdjustment,o=n+s.MinusPlusPaddingPx,a=n+r-s.MinusPlusPaddingPx-s.MinusPlusWidthPx;e.beginPath(),d.drawLine(e,i,o,i,a),e.stroke()}(e,t,n,r)}(e,p,C,o),d.restoreClipping(e,F)}function v(e,t,n,r){var i=Math.round(n+r/2)-s.PlusMinusLineAdjustment,o=t+s.MinusPlusPaddingPx+s.MinusPlusWidthPx,a=t+r-s.MinusPlusWidthPx;e.strokeStyle=s.ExpandCollapseButtonOuterColor,e.beginPath(),d.drawLine(e,o,i,a,i),e.stroke()}t.drawExpandCollapseButtons=function(e,t,n){var r,l,s,u,g;if(i.verifyArgumentNotNull(e,"ctx","drawExpandCollapseButtons"),i.verifyArgumentNotNull(t,"model","drawExpandCollapseButtons"),i.verifyArgumentNotNull(n,"context","drawExpandCollapseButtons"),t.PivotTables)for(var f=t.Cells,m=!1,v=0;v<f.length;v++){var F=f[v];(null===(r=F)||void 0===r?void 0:r.PivotTable)&&(null===(l=F)||void 0===l?void 0:l.PivotTable).HasExpandCollapseIndicator&&(d.cellIntersectsRenderingRegion(F,n.renderingRegion)&&((null===(u=null===(s=F.CondFormat)||void 0===s?void 0:s.Icon)||void 0===u?void 0:u.IconOnly)&&!p.canCellContainExpandCollapseAndCFIcon(t,F,a.getCellWidthAdjustedForDrawing(t,F),n.devicePixelRatio)||(null===(g=F.CondFormat)||void 0===g?void 0:g.Icon)&&C.cellTextReplacedWithHashes(F)||(m||(e.lineWidth=c.ShapeOutlineWidthPx,e.setLineDash(o.DefaultDash),m=!0),e.font=h.getFontCssStringFromFont(F.CachedFont,void 0,t),y(e,t,F,n.devicePixelRatio))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(18),a=n(54),l=n(3),s=n(112),d=n(4),u=n(30),c=n(35),g=n(7),f=n(44),h=n(32),m=n(1),p=n(6),C=n(11),y=function(){function e(t){this.canvasInstance=null,e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},e.prototype.getCell=function(e,t){return r.getCell(e,t,this.model)},e.prototype.getOrCreateCell=function(t,n){var r=this.getCell(t,n);return r||(e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.Styles,"Styles","getOrCreateCell"),(t<0||n<0||t>=this.model.RowNumbers.length||n>=this.model.ColumnNumbers.length)&&this.throwErrorWrapper("cell requested for a cell which is not in range of the model. rowIndex:  "+t+", RowNumbers.length: "+this.model.RowNumbers.length+",  colIndex:  "+n+", ColumnNumbers.length: "+this.model.ColumnNumbers.length,"getOrCreateCell"),l.getDefaultCell(t,n,this.model.Styles,this.model.Fonts))},e.prototype.getColumnWidth=function(e){return r.getColumnWidth(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowHeight"),e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&this.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnOffset"),e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&this.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowOffset"),e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&this.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowNumber"),e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnNumber"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getCellStyle=function(e){return r.getCellStyle(e,this.model)},e.prototype.getCellFont=function(e){return r.getCellFont(e,this.model)},e.prototype.hasRichText=function(t){var n;return e.verifyArgumentNotNull(t,"cell","hasRichText"),!d.isNullOrUndefined(null===(n=t)||void 0===n?void 0:n.TextRuns)},e.prototype.cloneCellFont=function(e){var t=r.getCellFont(e,this.model);return t?this.duplicateFont(t,t.ID,t.RefCount):t},e.prototype.getBorderStyle=function(t){return e.verifyArgumentNotNull(t,"cell","getBorderStyle"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","getBorderStyle"),d.isNullOrUndefined(t.CachedBorderStyle)&&(t.CachedBorderStyle=o.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)),t.CachedBorderStyle},e.prototype.removeBorder=function(t){e.verifyArgumentNotNull(t,"cell","removeBorder"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),t.BorderStyleID=i.UniqueStyleID.DefaultBorder,t.CachedBorderStyle=o.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)},e.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},e.prototype.isRtl=function(){return this.model.IsRtl},e.prototype.replaceCellInModel=function(t,n){e.verifyArgumentNotNull(t,"cell","replaceCellInModel"),e.verifyArgumentNotNull(n,"immediateModel","replaceCellInModel"),e.verifyArgumentNotNull(n.Styles,"immediateModel!.Styles","replaceCellInModel");var i=n.Styles[0];e.verifyArgumentNotNull(i,"style","replaceCellInModel"),e.verifyArgumentNotNull(n.Fonts,"immediateModel!.Fonts","replaceCellInModel");var o=this.duplicateAndSetFontsInModel(n.Fonts);t.TextRuns&&(t.TextRuns=this.duplicateTextRuns(t.TextRuns,o)),i.FontID=o[i.FontID],t.CachedFont=this.model.Fonts[i.FontID];var a=this.getLastNonUniqueStyleID()+1;if(i.ID=a,this.model.Styles.splice(a,0,i),t.StyleID=a,t.CachedStyle=i,!d.isNullOrUndefined(n.BorderStyles)){var s=n.BorderStyles[0];!d.isNullOrUndefined(s)&&!d.isNullOrUndefined(s.Borders)&&s.Borders.length>0&&(s.RefCount=1,this.setBorders(t,s))}if(this.getCell(t.Row,t.Col)){var u=r.getCellPositionInArray(t,this.model.Cells);this.model.Cells[u]=t,this.model.ClientOnlyCache.CellLookup[l.cellLookupKey(t.Row,t.Col)]=t}else this.attachCellToModel(t);i.RefCount=1},e.prototype.attachCellToModel=function(t){if(e.verifyArgumentNotNull(t,"cell","attachCellToModel"),e.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","attachCellToModel"),!this.getCell(t.Row,t.Col)){var n=r.getModelClientCache(this.model),i=r.getCellPositionInArray(t,this.model.Cells);this.model.Cells.splice(i,0,t),n.CellLookup[l.cellLookupKey(t.Row,t.Col)]=t;var o=this.getCellStyle(t);e.verifyArgumentNotNull(o,"style","attachCellToModel"),o.RefCount++;var a=this.getBorderStyle(t);e.verifyArgumentNotNull(a,"borderStyle","attachCellToModel"),a.RefCount++,t.CachedBorderStyle=a}},e.prototype.prepareCellStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareCellStyleForEdit");var n=this.getCellStyle(t);if(!this.isStyleUnique(n.ID)&&n.RefCount<=1)return!0;var r=this.getLastNonUniqueStyleID()+1,i=this.duplicateStyle(n,r,1);return n.RefCount=Math.max(0,n.RefCount-1),this.model.Styles.splice(r,0,i),t.CachedStyle=i,t.StyleID=r,!1},e.prototype.setDefaultHyperlinkStyleOnCell=function(t){e.verifyArgumentNotNull(t,"cell","setDefaultHyperlinkStyleOnCell");var n=o.getReferencedObjectById(i.UniqueStyleID.Hyperlink,this.model.Styles);n||this.throwErrorWrapper("default hyperlink style is not present in the model.","setDefaultHyperlinkStyleOnCell"),t.StyleID=i.UniqueStyleID.Hyperlink,t.CachedStyle=n,n.RefCount+=1},e.prototype.editCellFontAttributes=function(t,n){if(e.verifyArgumentNotNull(t,"cell","editFont"),e.verifyArgumentNotNull(t,"editFontAction","editFont"),this.attachCellToModel(t),this.prepareFontForEdit(t),l.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,this.model)&&t.TextRuns)for(var r=0;r<t.TextRuns.length;r++){var a=t.TextRuns[r];d.isNullOrUndefined(a.CachedFont)&&(a.CachedFont=o.getReferencedObjectById(a.FontID,this.model.Fonts)),n(a.CachedFont)}n(t.CachedFont)},e.prototype.prepareFontForEdit=function(e){var t;if(l.isRenderFlagEnabled(i.RenderFlags.RichTextFormat,this.model)&&(null===(t=e)||void 0===t?void 0:t.TextRuns))for(var n=0;n<e.TextRuns.length;n++){var r=e.TextRuns[n],a=d.isNullOrUndefined(r.CachedFont)?o.getReferencedObjectById(r.FontID,this.model.Fonts):r.CachedFont;this.prepareTextRunFontForEdit(a,r)}this.prepareCellFontForEdit(e)},e.prototype.prepareTextRunFontForEdit=function(e,t){e.RefCount<=1||this.duplicateAndSetNewFontOnTextRun(e,t)},e.prototype.prepareCellFontForEdit=function(e){var t=this.getCellFont(e);this.prepareCellStyleForEdit(e)&&t.RefCount<=1||this.duplicateAndSetNewFontOnCell(t,e)},e.prototype.prepareBorderStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareBorderStyleForEdit");var n=this.getBorderStyle(t);if(!(n.ID!==i.UniqueStyleID.DefaultBorder&&n.RefCount<=1)){var r=this.duplicateBorderStyle(n,0,1);this.setBorders(t,r)}},e.prototype.cloneBorderStyle=function(t){e.verifyArgumentNotNull(t,"cell","cloneBorderStyle");var n=this.getBorderStyle(t);return this.duplicateBorderStyle(n,n.ID,1)},e.prototype.setBorders=function(t,n){e.verifyArgumentNotNull(t,"cell","setBorders"),e.verifyArgumentNotNull(n,"BorderStyle","setBorders");var r=this.getBorderStyle(t),i=this.getLastBorderStyleID()+1;n.ID=i,r.RefCount=Math.max(0,r.RefCount-1),this.model.BorderStyles.splice(i,0,n),t.BorderStyleID=i,t.CachedBorderStyle=n},e.prototype.getCellCssFont=function(e){return this.verifyCellStyleAndFont(e,"getCellCssFont"),r.getFontCssStringFromCell(e,this.model)},e.prototype.isDirty=function(){var e,t;return null!=(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.IsDirty)&&t},e.prototype.setDirty=function(){var e=r.getModelClientCache(this.model);e.IsDirty||(e.DirtyTimestamp=Date.now()),e.IsDirty=!0},e.prototype.getCalcBlockModel=function(){var e=new s.CalcBlockModel,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(var r=0;r<this.model.Cells.length;r++){var i=this.model.Cells[r],o=e.createCell(i);e.addCell(o)}return e},e.prototype.getDirtyTimestamp=function(){var e,t;return null!=(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyTimestamp)?t:-1},e.prototype.updateCellSpillInformation=function(e){var t,n,r,o;if(this.verifyCellStyleAndFont(e,"updateCellSpillInformation"),d.isNullOrUndefined(null===(n=null===(t=e)||void 0===t?void 0:t.CachedDrawingLayout)||void 0===n?void 0:n.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),!(e.Merge||l.isRenderFlagEnabled(i.RenderFlags.AdvHorizontalAlignmentFillAndCAS,this.model)&&(null===(o=null===(r=e)||void 0===r?void 0:r.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)===i.HorizontalAlignment.CenterAcrossSelection)){e.Spill=void 0;var s;s=this.getOrCreateCanvasContext(),this.setContextCellFont(s,e),a.updateCellSpill(s,this.model,e),l.isRenderFlagEnabled(i.RenderFlags.RemoveBordersWithinASpillCell,this.model)&&void 0!==e.Spill&&this.removeBordersWithinASpillCell(e)}},e.prototype.updateClosestNonEmptyCellsSpillInformation=function(t){e.verifyArgumentNotNull(t,"cell","updateClosestNonEmptyCellsSpillInformation");var n;n=this.getOrCreateCanvasContext(),this.setContextCellFont(n,t),a.updateClosestNonEmptyCellsSpill(n,t,this.model)},e.prototype.getUserInput=function(t){return e.verifyArgumentNotNull(t,"cell","getUserInput"),t.UserInput},e.prototype.setUserInput=function(t,n){e.verifyArgumentNotNull(t,"cell","setUserInput"),e.verifyArgumentNotNull(n,"userInput","setUserInput"),t.UserInput=n},e.prototype.clearCellFormat=function(e){var t=o.getReferencedObjectById(i.UniqueStyleID.Default,this.model.Styles);e.StyleID=i.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=o.getReferencedObjectById(t.FontID,this.model.Fonts),e.BorderStyleID=i.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=o.getReferencedObjectById(i.UniqueStyleID.DefaultBorder,this.model.BorderStyles)},e.prototype.getRowIndex=function(e){return r.getModelRowIndex(this.model,e)},e.prototype.getColumnIndex=function(e){return r.verifyArgumentNotNull(this.model,"model","getColumnIndex"),r.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),r.binarySearch(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,r.numbersComparer)},e.prototype.getCellWidth=function(e){return r.verifyArgumentNotNull(this.model,"model","getCellWidth"),r.verifyArgumentNotNull(e,"cell","getCellWidth"),g.getCellWidth(this.model,e,!0)},e.prototype.getCellHeight=function(e){return r.verifyArgumentNotNull(this.model,"model","getCellHeight"),r.verifyArgumentNotNull(e,"cell","getCellHeight"),g.getCellHeight(this.model,e,!0)},e.prototype.getTextMaxWidth=function(e){return r.verifyArgumentNotNull(this.model,"model","getTextDrawingMaxWidth"),r.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth"),m.getTextDrawingMaxWidth(this.getCellWidth(e),p.getCellTextHorizontalPadding(e,this.model),p.getDistanceFromCellStartToIconEnd(this.model,e),l.isRenderFlagEnabled(i.RenderFlags.PivotTable,this.model)?C.getExpandCollapseButtonPadding(this.model,e):0)},e.prototype.getFormattedText=function(t){var n=this;e.verifyArgumentNotNull(t,"cell","getFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");var r=new Set,i=[];if(t.TextRuns)t.TextRuns.forEach((function(e){r.add(e.FontID),i.push(n.duplicateTextRun(e))}));else{var o=t.CachedStyle?t.CachedStyle:this.getCellStyle(t),a={FontID:o.FontID,StartIndex:0};r.add(o.FontID),i.push(a)}var l=[];return r.forEach((function(e){if(e<n.model.Fonts.length){var t=n.model.Fonts[e];l[e]=n.duplicateFont(t,t.ID,t.RefCount)}else n.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")})),{Text:t.Text||"",TextRuns:i,Fonts:l}},e.prototype.setFormattedText=function(t,n){e.verifyArgumentNotNull(t,"cell","setFormattedText"),e.verifyArgumentNotNull(n,"formattedText","setFormattedText"),e.verifyArgumentNotNull(n.TextRuns,"formattedText.TextRuns","setFormattedText"),e.verifyArgumentNotNull(n.Fonts,"formattedText.Fonts","setFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(t),t.Text=n.Text;for(var r=this.duplicateAndSetFontsInModel(n.Fonts),i=t.TextRuns=this.duplicateTextRuns(n.TextRuns,r),o=0;o<i.length;o++)i[o].CachedFont=l.getReferencedObjectToCache(i[o].FontID,this.model.Fonts)},e.prototype.serializeCell=function(e){return u.serializeCell(e,this.model)},e.prototype.getOutlineState=function(e,t){var n=e?this.model.RowOutlines:this.model.ColumnOutlines;return n?n[t]:i.OutlineState.None},e.prototype.compareCells=function(e,t,n){return c.areCellsEqual(e,t,n,this.model)},e.prototype.updateNumFmt=function(t){e.verifyArgumentNotNull(t,"cell","updateNumFmt"),l.isAccAndCustomNumFmtApplicable(t,this.model)?f.updateNumFmtFromCell(t):t.NumFmt=void 0},e.prototype.updateCellText=function(t,n){e.verifyArgumentNotNull(t,"cell","updateCellText"),e.verifyArgumentNotNull(n,"text","updateCellText"),t.TextRuns=void 0,r.updateCellText(this.model,t,n)},e.prototype.hasPageLayout=function(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas},e.prototype.getPivotTableRanges=function(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)},e.prototype.getSparklineRanges=function(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)},e.prototype.getSparklinesUrl=function(){var e,t;return null!=(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)?t:""},e.prototype.getAllRichValueFields=function(){return this.duplicateRichValueFields(this.model.AllRichValueFields)},e.prototype.disposeBlock=function(e){d.isNullOrUndefined(e)||""===e||h.clearImageFromCache(h.ImageType.Sparkline,e)},e.prototype.isStyleUnique=function(e){return e===i.UniqueStyleID.Default||e===i.UniqueStyleID.Hyperlink},e.prototype.getLastNonUniqueStyleID=function(){return this.model.Styles.length-2-1},e.prototype.getLastBorderStyleID=function(){return this.model.BorderStyles.length-1},e.prototype.duplicateStyle=function(e,t,n){var r={BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment,ID:t,NamedStyleId:e.NamedStyleId,RefCount:n,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder,FontID:e.FontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient};this.model.Fonts&&o.getReferencedObjectById(e.FontID,this.model.Fonts).RefCount++;return r},e.prototype.duplicateBorderStyle=function(e,t,n){for(var r=[],i=0;i<e.Borders.length;i++){var o=e.Borders[i],a={BorderLineStyle:o.BorderLineStyle,BorderPosition:o.BorderPosition,Weight:o.Weight,Color:{Red:o.Color.Red,Blue:o.Color.Blue,Green:o.Color.Green}};r.push(a)}return{Borders:r,ID:t,RefCount:n}},e.prototype.removeBordersWithinASpillCell=function(e){for(var t=1;t<=e.Spill.SpanToEnd;t++){var n=this.getCell(e.Row,e.Col+t);if(n){var r=o.getReferencedObjectById(n.BorderStyleID,this.model.BorderStyles);r&&r.Borders&&r.Borders.length>0&&this.removeCellLeftBorder(n,r)}}},e.prototype.removeCellLeftBorder=function(e,t){var n=this.duplicateBorderStyle(t,t.ID,1);if(n&&n.Borders)for(var r=n.Borders.length,o=0;o<r;o++){var a=n.Borders[o];a&&a.BorderPosition===i.BorderPositionType.Left&&(n.Borders.splice(o),this.setBorders(e,n))}},e.prototype.duplicateFont=function(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,ID:t,Italic:e.Italic,RefCount:n,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}},e.prototype.duplicateTextRun=function(e,t){return{FontID:null!=t?t:e.FontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}},e.prototype.duplicateAndSetNewFontOnTextRun=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont},e.prototype.duplicateAndSetNewFontOnCell=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1),r=n.newFontId,i=n.newFont;t.CachedFont=i,t.CachedStyle.FontID=r},e.prototype.duplicateAndSetFontsInModel=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var i=e[parseInt(n[r],10)],o=this.duplicateAndSetNewFontInModel(i,!0).newFontId;t[i.ID]=o}return t},e.prototype.duplicateTextRuns=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];n[r]=this.duplicateTextRun(i,t[i.FontID])}return n},e.prototype.duplicatePivotTableRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}},e.prototype.duplicatePivotTableRangeInformation=function(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid}},e.prototype.duplicateRangeInformation=function(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}},e.prototype.duplicatePivotTableFieldInfos=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}},e.prototype.duplicatePivotTableFieldInfo=function(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop}},e.prototype.duplicateAndSetNewFontInModel=function(e,t){var n=this.model.Fonts.length,r=t?e.RefCount:1,i=this.duplicateFont(e,n,r);return t||(e.RefCount=Math.max(0,e.RefCount-1)),this.model.Fonts.splice(n,0,i),{newFontId:n,newFont:i}},e.prototype.throwErrorWrapper=function(e,t){r.throwError(e,"GridBlockModelAccessor."+t)},e.verifyArgumentNotNull=function(e,t,n){r.verifyArgumentNotNull(e,t,"GridBlockModelAccessor."+n)},e.prototype.duplicateSparklineRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}},e.prototype.duplicateSparklineRangeInformation=function(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}},e.prototype.duplicateRichValueFields=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}},e.prototype.duplicateRichValueField=function(e){return{Index:e.Index,Value:e.Value}},e.prototype.verifyCellStyleAndFont=function(e,t){r.verifyArgumentNotNull(e,"cell",t),e.CachedStyle||r.getCellStyle(e,this.model),e.CachedFont||r.getCellFont(e,this.model)},e.prototype.setContextCellFont=function(e,t){e.font=r.getFontCssStringFromCell(t,this.model)},e}();t.GridBlockModelAccessor=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(4),o=n(2),a=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,n={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:e.Value,ifmt:e.Ifmt,formulaType:e.FormulaInfo?e.FormulaInfo.FormulaType:o.CellFormulaType.Value};return n.valueType=e.ValueType,n},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[r.cellLookupKey(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return i.isNullOrUndefined(this.Cells)?null:this.Cells[r.cellLookupKey(e,t)]},e.prototype.reset=function(){this.index=0,i.isNullOrUndefined(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if(i.isNullOrUndefined(this.Cells)||i.isNullOrUndefined(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(35),o=n(30),a=n(6),l=n(114),s=n(0),d=n(115),u=n(32),c=n(26),g=n(23),f=function(){function e(){}return e.lookupPerfMetricName=function(e){return r.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,n,r,i){var o=e.canvasInstance().getContext("2d");if(!o)throw Error("calculateTextWidth: ctx is undefined");return o.font=n,a.measureTextWidth(o,t,r,!!i)},e.compareFormattedTexts=function(e,t){return i.areFormattedTextsEqual(e,t)},e.compareGridBlockModels=function(e,t){return i.areGridBlockModelsEqual(e,t)},e.serializeCell=function(e,t){return o.serializeCell(e,t)},e.registerActionOnFontLoad=function(e,t,n){d.registerActionOnFontLoadIfRequired(e,t,n)},e.cleanModelBeforeSerialization=function(e){s.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),l.cleanModelBeforeSerialization(e)},e.restoreModelAfterSerialization=function(e){s.verifyArgumentNotNull(e,"model","restoreModelAfterSerialization"),l.restoreModelAfterSerialization(e)},e.cleanModelJsonReplacer=function(e,t){return l.cleanModelJsonReplacer(e,t)},e.initializeGridRendererImageLoader=function(e,t){u.initializeGridRendererImageLoader(e,t)},e.setStaticImageUrl=function(e,t){u.setStaticImageUrl(e,t)},e.loadPreviewFont=function(e){d.loadPreviewFont(e)},e.isFontLoadApiSupported=function(){return c.fontFaceSetSupported()},e.getFontNameForLogging=function(e){return g.getFontNameForLogging(e)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e}();t.GridBlockRendererGlobals=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),i=n(3),o=n(4),a={},l={};function s(e,t,n){var r=e[n];if(r)for(var i=0;i<r.length;i++){var a=r[i];o.isNullOrUndefined(a)||d(a,t)}}function d(e,t){for(var n=Object.getOwnPropertyNames(e),i=0;i<n.length;i++){var o=n[i];c(e,r.SerializationProperties[v(t,o)],o)&&u(e,o)}}function u(e,t){y(e,t,void 0)}function c(e,t,n){if(o.isNullOrUndefined(t))return!1;if(t.tsOnly)return!0;switch(t.type){case"number":return 0===C(e,n);case"boolean":return!1===C(e,n);case"object":return null===C(e,n)}return!1}function g(e,t,n){var r=e[n];if(r)for(var i=0;i<r.length;i++){var a=r[i];o.isNullOrUndefined(a)||h(a,t)}}Object.getOwnPropertyNames(r.SerializationProperties).forEach((function(e){var t=r.SerializationProperties[e],n=e.substring(e.indexOf(".")+1);t.tsOnly?a[n]=!0:"boolean"===t.type&&(l[n]=!0)})),t.cleanModelBeforeSerialization=function(e){i.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),d(e,"GridBlockModel");for(var t=Object.keys(r.SerializationClasses),n=0;n<t.length;n++)s(e,t[n],r.SerializationClasses[t[n]])},t.restoreModelAfterSerialization=function(e){i.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),h(e,"GridBlockModel");for(var t=Object.keys(r.SerializationClasses),n=0;n<t.length;n++)g(e,t[n],r.SerializationClasses[t[n]])},t.cleanModelJsonReplacer=function(e,t){if(null!=t&&!(a[e]||l[e]&&!1===t))return t};var f={};function h(e,t){for(var n=function(e){var t=f[e];t||(t=Object.keys(r.SerializationProperties).filter((function(t){return t.startsWith(e)})),f[e]=t);return t}(t),i=0;i<n.length;i++){var o=n[i],a=o.substring(o.indexOf(".")+1),l=r.SerializationProperties[v(t,a)];m(e,l,a)&&p(e,l,a)}}function m(e,t,n){return t&&!t.tsOnly&&void 0===C(e,n)}function p(e,t,n){switch(t.type){case"number":y(e,n,0);break;case"boolean":y(e,n,!1)}}function C(e,t){return e[t]}function y(e,t,n){e[t]=n}function v(e,t){return r.SerializationPropertyKey.replace("{className}",e).replace("{propertyName}",t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),i=n(26),o=n(0),a=n(23),l=document.createElement("div");l.innerText=".",l.style.visibility="hidden",document.body.appendChild(l),t.registerActionOnFontLoadIfRequired=function(e,t,n){i.fontFaceSetSupported()&&o.isDefined(t)&&function(e){if(!e.Fonts||0===e.Fonts.length)return!1;for(var t=0;t<e.Fonts.length;t++){var n=a.canonizeFontName(e.Fonts[t].FontName);if(i.isFontUsedInModel(e,t)&&(!i.doesFontExist(n)||i.getFontLoadStatus(n)===i.FontLoadStatus.Pending))return!0}return!1}(e)&&(t(0),function(e){for(var t=0;t<e.Fonts.length;t++){var n=a.canonizeFontName(e.Fonts[t].FontName);i.doesFontExist(n)||(i.setFontLoadDivWithFontFamily(l,n),i.setFontLoadStatus(n,i.FontLoadStatus.Pending))}}(e),function(e,t,n){i.getFontFaceSetReady().then((function(){o.isDefined(t)&&(function(e,t){if(!e.Fonts)return!1;for(var n=!1,l=0;l<e.Fonts.length;l++){var s=a.canonizeFontName(e.Fonts[l].FontName);i.isFontLoaded(s)?(i.getFontLoadStatus(s)!==i.FontLoadStatus.Loaded&&(r.recalculateFontMetrics(s),i.setFontLoadStatus(s,i.FontLoadStatus.Loaded)),n=!0):(i.setFontLoadStatus(s,i.FontLoadStatus.Failed),o.isDefined(t)&&a.isKnownFont(s)&&t(a.sanitizeFontName(s)))}return n}(e,n)&&t(1),t(2))}),(function(){o.isDefined(t)&&o.isDefined(n)&&(n("API_Failure"),t(2))}))}(e,t,n))},t.loadPreviewFont=function(e){i.setFontLoadDivWithFontFamily(l,"msofp"),document.fonts.ready.then((function(){i.isFontLoadFailed("msofp")&&e("ERROR")}),(function(){e("API_Faliure")}))}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"RumShepherdFactoryGlobal",(function(){return W})),n.d(r,"VISUALLY_READY",(function(){return i})),n.d(r,"FUNCTIONALLY_READY",(function(){return o})),n.d(r,"STABLE_INTERACTIVITY",(function(){return a})),n.d(r,"FIRST_INPUT",(function(){return l})),n.d(r,"FIRST_INTERACTION",(function(){return s})),n.d(r,"FIRST_IDLE",(function(){return d})),n.d(r,"SubComponentInitEventName",(function(){return u})),n.d(r,"SubComponentSetLoadStateEventName",(function(){return c})),n.d(r,"AppLoadMetricReportEventName",(function(){return g})),n.d(r,"setupDefaultRumShepherd",(function(){return E})),n.d(r,"dispatchRumShepherdEvent",(function(){return H}));var i="visually-ready",o="functionally-ready",a="stable-interactivity",l="first-input",s="first-interaction",d="first-idle",u="Wac-SubComponentsInit",c="Wac-SubComponentSetLoadState",g="Wac-AppLoadMetricReport",f=n(12);function h(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function m(){var e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function p(){var e=window.performance;return e&&e.now?e.now():(new Date).getDate()-m()}function C(){var e=window.performance;return e&&e.now?m()+e.now():(new Date).getDate()}var y,v,F=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(y||(y={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker"}(v||(v={}));var S;(function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,n,r){return"tag_"+e.tagIntToString(t)+" ["+v[n]+"] "+r},e.prototype.sendTraceTag=function(t,n,r,i){var o=this.logMessage;switch(r){case y.Error:o=this.logError;break;case y.Warning:o=this.logWarning;break;case y.Info:o=this.logInfo;break;case y.Verbose:o=this.logVerbose;break;case y.Spam:default:o=this.logMessage}try{o(e.getLogMessage(t,n,i))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,n,r,i){console.assert(r,e.getLogMessage(t,n,i))},e.prototype.debugAssertTag=function(e,t,n,r){this.shipAssertTag(e,t,n,r)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function e(){this.externalLogger=new F}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());function T(e,t,n,r){var i=e.map((function(e){return function(e,t){var n={};n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category;var r=1e3*e.type+e.level;return n.D=r,n}(e,r)})),o=function(e,t,n,r){var i={};return i.T=e,i.L=t,i.S=n,i.I=r,i.V=1,i}(r,i,t,n);return JSON.stringify(o)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(S||(S={}));!function(){function e(t,n){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){(window.clearTimeout(r.timeoutId),r.logCache.length>0)&&(r.uploadId+=1,function(e,t,n){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,n),r.send(e))}}(T(r.logCache,r.userSessionId,r.uploadId,r.timestampBase),r.remoteUrlEndpoint,n),r.logCache=[],r.timestampBase=Date.now());t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===y.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}();y.Info;!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(f.__extends)(t,e)}(F);function x(e){return e?Object(f.__assign)({},e):{}}function w(e,t){return{time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:x(e.measures),data:x(e.data)}}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,Object(f.__spreadArrays)(["[RumShepherd]"+e],t))}function A(e){void 0===window._pageTimings&&(window._pageTimings={}),e.error||(window._pageTimings[function(e){switch(e){case i:return"TTVR";case o:return"TTF";case a:return"TTSI";default:return e}}(e.metric)]=e.time)}var R=function(){function e(e){var t=this;this._components={},this._metrics={},this._monitoring={},this._firstTabHiddenTime=0,this._monitorTabVisibility=function(){t._firstTabHiddenTime="hidden"===document.visibilityState?0:1/0,document.addEventListener("visibilitychange",(function(e){t._firstTabHiddenTime=Math.min(t._firstTabHiddenTime,e.timeStamp)}),{once:!0})},this._getAppStateTime=function(e){var n,r=0;for(var i in t._components){var o=null===(n=t._components[i].states[e])||void 0===n?void 0:n.time;if(!o)return;r=Math.max(r,o)}return r},this._getComponentStateTime=function(e,t){var n=0,r=e.subComponents;for(var i in r){var o=r[i].states[t];if(!o)return;n=Math.max(n,o)}return n},this._invokeAppMetricReportCallback=function(e){try{var n=t._metrics[e],r={metric:e,timeOrigin:t._timeOrigin,time:n.time,error:n.error||(t._firstTabHiddenTime<n.time?"tab-switch":void 0),monitor:n.monitor,measures:x(n.measures),data:x(n.data),auxMetrics:[]};if(function(e){return e===i||e===o}(e))for(var a in t._components){var l=t._components[a].states[e];r.measures[a]=l.time,r.error=r.error||l.error;var s={metric:e+"-"+a,time:l.time,monitor:l.monitor,error:l.error,measures:x(l.measures)};r.auxMetrics.push(s)}A(r),t._shepherdInit.appLoadMetricReportCallback&&t._shepherdInit.appLoadMetricReportCallback(r)}catch(e){b("invokeAppMetricReportCallback:",e)}},this._setComponentStateMonitorResult=function(e,n,r){e.states[n]=w(r);var i=t._getAppStateTime(n);i&&(t._startAppStateMonitors(n),t._metrics[n]=w(r,i),t._invokeAppMetricReportCallback(n))},this._startComponentMonitor=function(e,n,r){if(!e.states[n]){var i=p();e.states[n]={time:0,monitor:""};var o=(0,t._shepherdInit.monitors[n])(e);t._processMonitorResult(o,i,n,r)}},this._monitorMetric=function(e,n){if(!t._monitoring[e]){t._monitoring[e]=!0;var r=p(),i=(0,t._shepherdInit.monitors[e])();t._processMonitorResult(i,r,e,(function(r){n&&(r.error=n(r)),t.metrics[e]=w(r),t._invokeAppMetricReportCallback(e)}))}},this._setSubComponentStateTime=function(e,n,r,i){n.states[r]=i,t._getComponentStateTime(e,r)&&(e.reported=!0,t._startComponentMonitor(e,r,(function(n){t._setComponentStateMonitorResult(e,r,n)})))},this._startAppStateMonitors=function(e){e!==i&&e!==o||(t._monitorMetric(l),t._monitorMetric(s),t._monitorMetric(d),t._monitorMetric(a,(function(e){if(!e.error){var n=t._metrics[l]?t._metrics[l].time:0,r=t._metrics[s]?t._metrics[s].time:0;if(n>0&&n<e.time&&(0===r||n<=r))return"first-input";if(r>0&&r<e.time)return"first-interaction"}})))},this._processMonitorResult=function(e,t,n,r){"then"in e?e.then((function(e){r(e)})).catch((function(e){var i="Error in invokeMonitor ["+n+"}]";b(i,e),r({time:t,monitor:"",error:i+": "+e})})):r(e)},this._addSubComponent=function(e,t,n){n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:p(),states:{}})},this._timeOrigin=Number(m().toFixed()),this._shepherdInit=Object(f.__assign)({},e);for(var n=0,r=e.components;n<r.length;n++){var u=r[n];this._components[u.id]={id:u.id,rootElementId:u.rootElementId,reported:!1,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}this._monitorTabVisibility()}return e.prototype.addSubComponents=function(e){if(e&&e.component&&e.subComponents){var t=this._components[e.component];if(t){var n=t.ignoreNewSubComponents;if(!t.reported||n)try{for(var r=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents],i=0;i<r.length;i+=1)this._addSubComponent(t,r[i],n)}catch(e){b("addSubComponents",e)}else b("Component state reported.Can't add",e)}else b("Invalid component",e)}else b("Invalid data",e)},e.prototype.setSubComponentState=function(e){var t=p();if(e&&e.subComponent&&e.component&&e.state){var n=this._components[e.component];if(n){if(!n.ignoredSubComponents[e.subComponent])if(n.states[e.state])b("Component state reported.Can't set state",e);else{n.ignoreNewSubComponents=n.ignoreNewSubComponents||!!e.ignoreNewSubComponents;var r=n.subComponents[e.subComponent];r?this._shepherdInit.monitors[e.state]?this._setSubComponentStateTime(n,r,e.state,t):b("Unknown state reported",e):b("Unexpected sub-component",e)}}else b("Invalid component",e)}else b("Invalid data",e)},Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._metrics},enumerable:!0,configurable:!0}),e}();function I(e,t){if(h("element")){var n="testimg-"+e,r=function(e){var t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t}(n);if(r){var i=null!=t?t:document.documentElement;return new Promise((function(e){var t=new PerformanceObserver((function(o){for(var a=0,l=o.getEntries();a<l.length;a++){var s=l[a];if(s.identifier===n)try{return i.removeChild(r),t.disconnect(),void e({time:s.renderTime,monitor:"image-paint-api"})}catch(e){return void b("measureImagePaintTime",e)}}}));t.observe({type:"element",buffered:!0}),i.appendChild(r)}))}}}function M(){return window.requestAnimationFrame?new Promise((function(e){requestAnimationFrame((function(){e({time:p(),monitor:"rAF"})}))})):Promise.resolve({time:0,monitor:"",error:"rAF Unsupported"})}function D(){return new Promise((function(e){requestAnimationFrame((function(){setTimeout((function(){e({time:p(),monitor:"rAF-setTimeout"})}),0)}))}))}function P(e,t){if(void 0===e&&(e=500),void 0===t&&(t=12e4),!h("longtask"))return function(e,t){if(void 0===e&&(e=500),void 0===t&&(t=12e4),!window.requestAnimationFrame)return Promise.resolve({time:0,monitor:"",error:"rAF unsupported"});var n=p(),r=0,i=n,o=0,a=0,l=n;return new Promise((function(s){var d=function(e,t){s({time:e,monitor:"long-frames",error:t,measures:{longTasksCount:r,longestTaskDuration:a,longTasksDuration:o}})},u=function(s){var c=s-i,g=s-l;l=s,g>=50&&(c=0,o+=g,r+=1,i=s,a=Math.max(a,g)),c>=e?d(i):p()-n>t?d(0,"timeout"):window.requestAnimationFrame(u)};window.requestAnimationFrame(u)}))}(e,t);var n=performance.now(),r=0,i=n,o=0,a=0;return new Promise((function(l){var s=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){r+=1,o+=e.duration;var t=e.startTime+e.duration;i=Math.max(t,i),a=Math.max(a,e.duration)}))}));s.observe({entryTypes:["longtask"]});var d=function(){var u,c=performance.now(),g=c-i,f=c-n;g>=e||f>t?(u=f>t?"timeout":void 0,s.disconnect(),l({time:i,monitor:"longtask-api",error:u,measures:{longTasksDuration:o,longTasksCount:r,longestTaskDuration:a}})):setTimeout(d,e-g)};setTimeout(d,e)}))}function L(){return h("first-input")?new Promise((function(e){try{new PerformanceObserver((function(t,n){t.getEntries().forEach((function(t){return function(t,n){var r=t.processingStart-t.startTime;n.disconnect();var i={time:t.startTime,monitor:"first-input-api",measures:{fid:r}};e(i)}(t,n)}))})).observe({type:"first-input",buffered:!0})}catch(t){e(void 0)}})):Promise.resolve({time:0,monitor:"",error:"FID unsupported"})}function O(){var e=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],t={passive:!0,capture:!0},n=C();return new Promise((function(r){var i=function(e){if(e.cancelable){var t=C(),i=e.timeStamp>1e12,a=(i?C():performance.now())-e.timeStamp;o(removeEventListener),(a<0||a>t-n)&&(a=0);var l={time:i?e.timeStamp-m():e.timeStamp,monitor:"first-interaction",data:{eventName:e.type},measures:{delay:a}};r(l)}},o=function(n){e.forEach((function(e){n(e,i,t)}))};o(addEventListener)}))}function k(e){return void 0===e&&(e=12e4),window.requestIdleCallback?new Promise((function(t){try{window.requestIdleCallback((function(e){var n={time:p(),monitor:"first-idle",error:e.didTimeout?"timeout":""};t(n)}),{timeout:e})}catch(e){t(void 0)}})):Promise.resolve({time:0,monitor:"",error:"requestIdleCallback unsupported"})}var N=function(e){!function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.info.apply(console,Object(f.__spreadArrays)(["[RumShepherd]"+e],t))}("report "+e.metric+":"+e.time+"ms",e);var t=new CustomEvent(g,{detail:e});self.dispatchEvent(t)},B=function(e){if(e){var t="vr-"+e.id,n=document.documentElement;return function(e,t){var n=t?I(e,t):void 0;return n||(n=M()),n}(t,null!=n?n:void 0)}return M()};function E(e){var t=new R({appLoadMetricReportCallback:N,monitors:{"visually-ready":B,"functionally-ready":D,"stable-interactivity":P,"first-input":L,"first-interaction":O,"first-idle":k},components:e});window.addEventListener(u,(function(e){var n=e.detail;t.addSubComponents(n)})),window.addEventListener(c,(function(e){var n=e.detail;t.setSubComponentState(n)}))}var H=function(e,t){var n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)},W=new(function(){function e(){}return e.prototype.setupDefault=function(e){if(e)return E(e),null},e}()),z=n(40);n.d(t,"rumShepherd",(function(){return r})),n.d(t,"gridRenderer",(function(){return z}))}])}));
//# sourceMappingURL=gridRenderer.min.js.map